{"version":3,"file":"js/app.5fffbb7e.js","mappings":"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","sources":["webpack://my-vue-app/./src/App.vue","webpack://my-vue-app/./src/components/Home.vue","webpack://my-vue-app/./src/firebase.js","webpack://my-vue-app/./src/components/Comments.vue","webpack://my-vue-app/./src/utils/toast.js","webpack://my-vue-app/./src/components/Comments.vue?bff9","webpack://my-vue-app/./src/components/StarRating.vue","webpack://my-vue-app/./src/components/StarRating.vue?3b7a","webpack://my-vue-app/./src/utils/geolocation.js","webpack://my-vue-app/./src/components/Home.vue?08c6","webpack://my-vue-app/./src/components/Restaurants.vue","webpack://my-vue-app/./src/components/EditRestaurantModal.vue","webpack://my-vue-app/./src/components/EditRestaurantModal.vue?95b0","webpack://my-vue-app/./src/components/AddReviewModal.vue","webpack://my-vue-app/./src/components/AddReviewModal.vue?122a","webpack://my-vue-app/./src/components/RestaurantReviewsModal.vue","webpack://my-vue-app/./src/components/RestaurantReviewsModal.vue?292d","webpack://my-vue-app/./src/components/Restaurants.vue?77bd","webpack://my-vue-app/./src/components/UserSearch.vue","webpack://my-vue-app/./src/components/UserReviewsModal.vue","webpack://my-vue-app/./src/components/UserReviewsModal.vue?7212","webpack://my-vue-app/./src/components/UserSearch.vue?3330","webpack://my-vue-app/./src/components/Review.vue","webpack://my-vue-app/./src/components/Review.vue?483a","webpack://my-vue-app/./src/components/Recommendations.vue","webpack://my-vue-app/./src/components/Recommendations.vue?77a3","webpack://my-vue-app/./src/components/DatabaseStats.vue","webpack://my-vue-app/./src/components/DatabaseStats.vue?5e68","webpack://my-vue-app/./src/components/MyReviews.vue","webpack://my-vue-app/./src/components/MyReviews.vue?9029","webpack://my-vue-app/./src/components/Leaderboard.vue","webpack://my-vue-app/./src/components/Leaderboard.vue?23d5","webpack://my-vue-app/./src/components/Followers.vue","webpack://my-vue-app/./src/components/Followers.vue?990e","webpack://my-vue-app/./src/components/BucketList.vue","webpack://my-vue-app/./src/components/BucketList.vue?ed3b","webpack://my-vue-app/./src/components/Following.vue","webpack://my-vue-app/./src/components/Following.vue?4786","webpack://my-vue-app/./src/components/ReviewDetailModal.vue","webpack://my-vue-app/./src/utils/meta.js","webpack://my-vue-app/./src/components/ReviewDetailModal.vue?261b","webpack://my-vue-app/./src/components/Toast.vue","webpack://my-vue-app/./src/components/Toast.vue?44c7","webpack://my-vue-app/./src/App.vue?7ccd","webpack://my-vue-app/./src/main.js","webpack://my-vue-app/./src/utils/geocoding.js","webpack://my-vue-app/webpack/bootstrap","webpack://my-vue-app/webpack/runtime/chunk loaded","webpack://my-vue-app/webpack/runtime/define property getters","webpack://my-vue-app/webpack/runtime/global","webpack://my-vue-app/webpack/runtime/hasOwnProperty shorthand","webpack://my-vue-app/webpack/runtime/jsonp chunk loading","webpack://my-vue-app/webpack/startup"],"sourcesContent":["<template>\n  <div id=\"app\">\n    <div class=\"main-layout\" :class=\"{ 'sidebar-collapsed': isSidebarCollapsed }\">\n      <aside class=\"sidebar\">\n        <div class=\"sidebar-top\">\n          <button class=\"sidebar-toggle\" @click=\"toggleSidebar\" title=\"Toggle Sidebar\">\n            <svg v-if=\"!isSidebarCollapsed\" xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z\"/></svg>\n            <img v-else src=\"/logo.svg\" class=\"sidebar-toggle-logo\" alt=\"Expand menu\" />\n          </button>\n          <div class=\"sidebar-branding\">\n            <img src=\"/logo.svg\" alt=\"PorkHub Logo\" class=\"sidebar-logo\" />\n            <h1 class=\"sidebar-title\">PorkHub</h1>\n          </div>\n          <div v-if=\"user\" class=\"sidebar-header\">\n            <img :src=\"user.photoURL || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" class=\"sidebar-avatar\" alt=\"User Avatar\" referrerpolicy=\"no-referrer\" />\n            <div class=\"sidebar-user\">{{ user.displayName }}</div>\n          </div>\n          <nav class=\"sidebar-nav\">\n            <button class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'home' }\" @click=\"goToHome\" title=\"Home\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8h5z\"/></svg>\n              <span>Home</span>\n            </button>\n            <button class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'leaderboard' }\" @click=\"goToLeaderboard\" title=\"Leaderboard\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M16 11V3H8v6H2v12h20V11h-6zm-6-6h4v14h-4V5zm-6 6h4v8H4v-8zm16 8h-4v-8h4v8z\"/></svg>\n              <span>Leaderboard</span>\n            </button>\n            <button class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'restaurants' }\" @click=\"goToRestaurants\" title=\"Restaurants\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M16 6v8h3v8h-3v-2h-2v2h-2v-2h-2v2H8v-2H6v2H3v-8h3V6c0-3.31 2.69-6 6-6s6 2.69 6 6zm-2 0c0-2.21-1.79-4-4-4s-4 1.79-4 4v8h8V6zm-5 3h2v2h-2z\"/></svg>\n              <span>Restaurants</span>\n            </button>\n            <button class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'recommendations' }\" @click=\"goToRecommendations\" title=\"Recommendations\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27z\"/></svg>\n              <span>Recommendations</span>\n            </button>\n            <!-- Protected Links -->\n            <button v-if=\"user\" class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'review' }\" @click=\"goToReview\" title=\"Write a Review\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M12 2C8.14 2 5 5.14 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.86-3.14-7-7-7zm-1.5 9h-2v-2h2v2zm5 0h-2v-2h2v2zm-2.5-4h-2V5h2v2z\"/></svg>\n              <span>Write a Review</span>\n            </button>\n            <button v-if=\"user\" class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'user-search' }\" @click=\"goToUserSearch\" title=\"Follow Users\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 5 1.41-1.41L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM12 10V7H8v3H5v2h3v3h2v-3h3v-2h-3z\"/></svg>\n              <span>Follow Users</span>\n            </button>\n            <button v-if=\"user\" class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'bucket-list' }\" @click=\"goToBucketList\" title=\"My Bucket List\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M18 7h-2.06c-.33-3.2-2.46-5.8-5.94-5.8S4.39 3.8 4.06 7H2v12h16V7zM6.14 7c.2-1.92 1.6-3.48 3.86-3.8A4.002 4.002 0 0 1 14 7h-2.14c-.2-1.92-1.6-3.48-3.86-3.8zM16 17H4v-8h12v8z\"/></svg>\n              <span>My Bucket List</span>\n            </button>\n            <button v-if=\"user\" class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'my-reviews' }\" @click=\"goToMyReviews\" title=\"My Reviews\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z\"/></svg>\n              <span>My Reviews</span>\n            </button>\n            <button v-if=\"user\" class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'followers' }\" @click=\"goToFollowers\" title=\"My Followers\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5s-3 1.34-3 3 1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z\"/></svg>\n              <span>My Followers</span>\n            </button>\n            <button v-if=\"user\" class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'following' }\" @click=\"goToFollowing\" title=\"Following\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><circle cx=\"6.18\" cy=\"17.82\" r=\"2.18\"/><path d=\"M4 4.44v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9zM4 10.1v2.83c2.39 0 4.33 1.94 4.33 4.33h2.83c0-3.98-3.23-7.16-7.16-7.16z\"/></svg>\n              <span>Following</span>\n            </button>\n          </nav>\n        </div>\n        <div class=\"sidebar-bottom\">\n            <button v-if=\"isAdmin\" class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'database-stats' }\" @click=\"goToDatabaseStats\" title=\"Database Stats\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M5 9.2h3V19H5zM10.6 5h2.8v14h-2.8zm5.6 8H19v6h-2.8z\"/></svg>\n              <span>Database Stats</span>\n            </button>\n            <button v-if=\"user\" class=\"sidebar-link\" @click=\"logout\" title=\"Logout\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5-5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z\"/></svg>\n              <span>Logout</span>\n            </button>\n            <button v-else class=\"login-btn-sidebar\" @click=\"loginWithGoogle\" title=\"Login with Google\">\n              <span>Login with</span>\n              <svg viewBox=\"0 0 48 48\" width=\"22px\" height=\"22px\">\n                <path fill=\"#EA4335\" d=\"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z\"></path>\n                <path fill=\"#4285F4\" d=\"M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z\"></path>\n                <path fill=\"#FBBC05\" d=\"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z\"></path>\n                <path fill=\"#34A853\" d=\"M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z\"></path>\n                <path fill=\"none\" d=\"M0 0h48v48H0z\"></path>\n              </svg>\n            </button>\n            <div class=\"app-version\">v{{ appVersion }}</div>\n        </div>\n      </aside>\n      <main class=\"main-content\">\n        <keep-alive include=\"Home\">\n          <component \n            :is=\"currentComponent\" \n            :user=\"user\"\n            @reviewed=\"goToHome\"\n            @check-in-at=\"reviewAt\"\n            @review-at=\"reviewAt\"\n            @go-to-review=\"goToReview\"\n            :selected-restaurant-id=\"selectedRestaurantForReview\"\n          />\n        </keep-alive>\n      </main>\n      <ReviewDetailModal \n        v-if=\"sharedReviewId\"\n        :review-id=\"sharedReviewId\"\n        :user=\"user\"\n        @close=\"closeReviewModal\"\n      />\n      <Toast />\n    </div>\n  </div>\n</template>\n\n<script>\nimport Home from './components/Home.vue';\nimport Restaurants from './components/Restaurants.vue';\nimport UserSearch from './components/UserSearch.vue';\nimport Review from './components/Review.vue';\nimport Recommendations from './components/Recommendations.vue';\nimport DatabaseStats from './components/DatabaseStats.vue';\nimport MyReviews from './components/MyReviews.vue';\nimport Leaderboard from './components/Leaderboard.vue';\nimport Followers from './components/Followers.vue';\nimport BucketList from './components/BucketList.vue';\nimport Following from './components/Following.vue';\nimport ReviewDetailModal from './components/ReviewDetailModal.vue';\nimport Toast from './components/Toast.vue';\nimport { resetMetaTags } from './utils/meta.js';\nimport { ref, computed, onMounted, onUnmounted } from 'vue';\nimport { onAuthStateChanged } from \"firebase/auth\";\nimport { auth, provider, signInWithPopup, signOut, db } from './firebase';\nimport { collection, query, where, getDocs, doc, setDoc, getDoc, writeBatch } from 'firebase/firestore';\n\nexport default {\n  name: 'App',\n  components: {\n    Home,\n    Restaurants,\n    BucketList,\n    UserSearch,\n    Review,\n    Recommendations,\n    DatabaseStats,\n    MyReviews,\n    Leaderboard,\n    Followers,\n    Following,\n    ReviewDetailModal,\n    Toast\n  },\n  setup() {\n    const user = ref(null);\n    const currentPage = ref('home');\n    const selectedRestaurantForReview = ref(null);\n    const isSidebarCollapsed = ref(window.innerWidth < 768);\n    const appVersion = ref(process.env.VUE_APP_VERSION || 'dev');\n    const sharedReviewId = ref(null);\n\n    const isAdmin = computed(() => {\n      return user.value && user.value.email === 'kennected.com@gmail.com';\n    });\n\n    const protectedPages = new Set([\n      'review', 'user-search', 'bucket-list', 'my-reviews', \n      'followers', 'following', 'database-stats'\n    ]);\n\n    const componentMap = {\n      'home': 'Home',\n      'restaurants': 'Restaurants',\n      'bucket-list': 'BucketList',\n      'user-search': 'UserSearch',\n      'review': 'Review',\n      'my-reviews': 'MyReviews',\n      'recommendations': 'Recommendations',\n      'leaderboard': 'Leaderboard',\n      'database-stats': 'DatabaseStats',\n      'followers': 'Followers',\n      'following': 'Following'\n    };\n    const currentComponent = computed(() => componentMap[currentPage.value] || 'Home');\n\n    const toggleSidebar = () => {\n      isSidebarCollapsed.value = !isSidebarCollapsed.value;\n    };\n\n    window.addEventListener('resize', () => {\n      isSidebarCollapsed.value = window.innerWidth < 768;\n    });\n\n    onAuthStateChanged(auth, async (u) => {\n      user.value = u;\n      if (u) { // User is logged in\n        try {\n          const userRef = doc(db, 'users', u.uid);\n          const userSnap = await getDoc(userRef);\n          if (!userSnap.exists()) {\n            await setDoc(userRef, {\n              uid: u.uid,\n              displayName: u.displayName,\n              email: u.email,\n              photoURL: u.photoURL,\n              createdAt: new Date(),\n              reviewCount: 0\n            });\n          }\n        } catch (error) {\n          console.error('Error checking/creating user document:', error);\n        }\n      } else { // User is logged out or a guest\n        // If they were on a protected page, redirect to home\n        if (protectedPages.has(currentPage.value)) {\n          currentPage.value = 'home';\n        }\n      }\n    });\n\n    const loginWithGoogle = async () => {\n      try {\n        await signInWithPopup(auth, provider);\n      } catch (error) {\n        alert('Login failed: ' + error.message);\n      }\n    };\n\n    const logout = async () => {\n      await signOut(auth);\n    };\n\n    const goToHome = () => {\n      currentPage.value = 'home';\n    };\n\n    const goToRestaurants = () => {\n      currentPage.value = 'restaurants';\n    };\n\n    const goToUserSearch = () => {\n      currentPage.value = 'user-search';\n    };\n\n    const goToReview = () => {      \n      currentPage.value = 'review';\n    };\n\n    const goToMyReviews = () => {\n      currentPage.value = 'my-reviews';\n    };\n\n    const goToRecommendations = () => {\n      currentPage.value = 'recommendations';\n    };\n\n    const goToLeaderboard = () => {\n      currentPage.value = 'leaderboard';\n    };\n\n    const goToDatabaseStats = () => {\n      currentPage.value = 'database-stats';\n    };\n\n    const goToFollowers = () => {\n      currentPage.value = 'followers';\n    };\n\n    const goToFollowing = () => {\n      currentPage.value = 'following';\n    };\n\n    const goToBucketList = () => {\n      currentPage.value = 'bucket-list';\n    };\n\n    const reviewAt = (restaurantId) => {\n      selectedRestaurantForReview.value = restaurantId;\n      currentPage.value = 'review';\n    };\n\n    const handleDeepLink = () => {\n      // Check for new format: /review/{reviewId}\n      const pathMatch = window.location.pathname.match(/\\/review\\/([^\\/]+)/);\n      if (pathMatch) {\n        const reviewId = pathMatch[1];\n        if (reviewId) {\n          sharedReviewId.value = reviewId;\n          currentPage.value = 'home';\n          // Clean up URL without reloading\n          window.history.replaceState(null, '', '/');\n          return;\n        }\n      }\n      \n      // Check for old hash format: #review/{reviewId} (for backward compatibility)\n      const hash = window.location.hash;\n      const reviewMatch = hash.match(/#review\\/([^/]+)/);\n      if (reviewMatch) {\n        const reviewId = reviewMatch[1];\n        if (reviewId) {\n          sharedReviewId.value = reviewId;\n          // Navigate to home so sidebar works correctly\n          currentPage.value = 'home';\n          // Update to new URL format\n          window.history.replaceState(null, '', `/review/${reviewId}`);\n        }\n      }\n    };\n\n    const closeReviewModal = () => {\n      sharedReviewId.value = null;\n      resetMetaTags();\n    };\n\n    onMounted(() => {\n      // Check for deep links on mount\n      handleDeepLink();\n      \n      // Listen for hash changes (in case user navigates with back/forward)\n      window.addEventListener('hashchange', handleDeepLink);\n    });\n\n    onUnmounted(() => {\n      window.removeEventListener('hashchange', handleDeepLink);\n    });\n\n    return { user, loginWithGoogle, logout, currentPage, goToHome, goToRestaurants, goToUserSearch, goToReview, goToMyReviews, goToRecommendations, goToLeaderboard, goToDatabaseStats, goToFollowers, goToFollowing, goToBucketList, reviewAt, selectedRestaurantForReview, isSidebarCollapsed, toggleSidebar, isAdmin, currentComponent, appVersion, sharedReviewId, closeReviewModal };\n  }\n}; \n</script>\n\n<style>\n:root {\n  --primary-color: #3498db;\n  --secondary-color: #2c3e50;\n  --background-color: #ecf0f1;\n  --sidebar-background: #ffffff;\n  --text-color: #34495e;\n  --card-background: #ffffff;\n  --shadow-color: rgba(0, 0, 0, 0.1);\n}\n\nbody {\n  font-family: 'Roboto', sans-serif;\n  background-color: var(--background-color);\n  color: var(--text-color);\n  margin: 0;\n}\n\n#app {\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  touch-action: manipulation;\n}\n\n.main-layout {\n  display: flex;\n  height: 100vh;\n}\n\n.sidebar {\n  width: 200px;\n  background: var(--sidebar-background);\n  padding: 2em 1em 0.5em;\n  box-shadow: 2px 0 5px var(--shadow-color);\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  transition: width 0.3s;\n}\n\n.sidebar-top {\n  position: relative;\n}\n\n.main-layout.sidebar-collapsed .sidebar {\n  width: 70px;\n  padding: 2em 0;\n}\n\n.main-layout.sidebar-collapsed .sidebar-link span,\n.main-layout.sidebar-collapsed .sidebar-user {\n  display: none;\n}\n\n.main-layout.sidebar-collapsed .sidebar-link,\n.main-layout.sidebar-collapsed .sidebar-nav button {\n  justify-content: center;\n}\n\n.main-layout.sidebar-collapsed .sidebar-header {\n  display: none;\n}\n\n.main-layout.sidebar-collapsed .sidebar-branding {\n  display: none;\n}\n\n.sidebar-bottom {\n    display: flex;\n    flex-direction: column;\n    gap: 0.2em;\n}\n\n.sidebar-header {\n  text-align: center;\n  margin-bottom: 1em;\n}\n\n.sidebar-branding {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.5em;\n  margin-bottom: 1em;\n}\n\n.sidebar-logo {\n  width: 40px;\n  height: 40px;\n}\n\n.sidebar-title {\n  font-family: 'Arial Black', Gadget, sans-serif;\n  font-size: 1.5em;\n  font-weight: 900;\n  margin: 0;\n  color: var(--secondary-color);\n  letter-spacing: -1.5px;\n}\n\n.sidebar-avatar {\n  width: 60px;\n  height: 60px;\n  border-radius: 50%;\n  margin-bottom: 0.75em;\n}\n\n.sidebar-user {\n  font-weight: 600;\n  font-size: 1.1em;\n}\n\n.sidebar-nav {\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  gap: 0.2em;\n}\n\n.sidebar-link, .sidebar-nav button {\n  background: none;\n  border: none;\n  color: var(--text-color);\n  padding: 0.5em 1em;\n  text-align: left;\n  font-size: 1em;\n  border-radius: 8px;\n  cursor: pointer;\n  transition: background-color 0.2s, color 0.2s;\n  display: flex;\n  align-items: center;\n  gap: 0.8em;\n  width: 100%;\n}\n\n.sidebar-link:hover, .sidebar-nav button:hover, .sidebar-toggle:hover {\n  background-color: var(--primary-color);\n  color: white;\n}\n\n.sidebar-link.active {\n  background-color: var(--primary-color);\n  color: white;\n}\n\n.sidebar-link svg {\n  flex-shrink: 0;\n}\n\n.main-content {\n  flex: 1;\n  padding: 2em;\n  overflow-y: auto;\n  position: relative;\n}\n\n@media (max-width: 768px) {\n  .main-content {\n    padding: 1em;\n  }\n}\n\n.sidebar-toggle {\n  position: absolute;\n  top: -1em;\n  right: -0.5em;\n  background: none;\n  border: none;\n  padding: 0.5em;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 50%;\n  color: var(--text-color);\n  transition: background-color 0.2s, color 0.2s;\n}\n\n.sidebar-toggle-logo {\n  width: 40px;\n  height: 40px;\n}\n\n.main-layout.sidebar-collapsed .sidebar-toggle {\n  position: static;\n  margin: -1em auto 1em;\n  background-color: transparent;\n  padding: 0;\n}\n\n.main-layout.sidebar-collapsed .sidebar-toggle:hover {\n  background-color: transparent;\n}\n\n.app-version {\n  font-size: 0.8em;\n  color: #7f8c8d;\n  text-align: center;\n  margin-top: 0;\n  padding: 0 0.5em;\n}\n\n.main-layout.sidebar-collapsed .app-version {\n  display: none;\n}\n\n.login-btn-sidebar {\n  background-color: var(--primary-color);\n  color: white;\n  border: none;\n  border-radius: 8px;\n  padding: 12px 20px;\n  font-size: 1em;\n  font-weight: 600;\n  cursor: pointer;\n  transition: background-color 0.3s;\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.5em;\n}\n\n.login-btn-sidebar:hover {\n  background-color: #2980b9;\n}\n</style>","<template>\n  <div class=\"home-page\">\n    <div v-if=\"locationPermission === 'prompt'\" class=\"location-prompt-banner\">\n      <div class=\"banner-content\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.86-3.14-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z\"/></svg>\n        <p>Share your location to see posts and restaurants near you!</p>\n      </div>\n      <button @click=\"requestLocationAccess\" class=\"btn-primary\">Share Location</button>\n    </div>\n    <div v-if=\"locationPermission === 'denied'\" class=\"location-prompt-banner warning\">\n      <div class=\"banner-content\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z\"/></svg>\n        <p>Location access is denied. To see local content, please enable location services for this site in your browser settings.</p>\n      </div>\n    </div>\n\n    <div class=\"sort-toggle\" v-if=\"userLocation\">\n      <button @click=\"setSortOrder('time')\" :class=\"{ active: sortOrder === 'time' }\">Most Recent</button>\n      <button @click=\"setSortOrder('distance')\" :class=\"{ active: sortOrder === 'distance' }\">Nearby</button>\n    </div>\n\n    <div class=\"feed\">\n      <div v-if=\"loading\" class=\"loading-indicator\">Loading feed...</div>\n      <div v-else>\n        <div v-if=\"posts.length === 0\" class=\"no-posts-message\">\n          <div v-if=\"user\">\n            <h3>Your Feed is Empty</h3>\n            <p>Follow some users to see their reviews here, or check out the Restaurants page to find new places.</p>\n          </div>\n          <div v-else>\n            <h3>Welcome to PorkHub!</h3>\n            <p>There are no reviews to show right now. Check out the Restaurants page to discover new places!</p>\n          </div>\n        </div>\n        <div v-for=\"post in posts\" :key=\"post.id\" class=\"post-card\">\n          <div class=\"post-header\">\n            <img :src=\"post.userPhoto || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" alt=\"User\" class=\"user-avatar\" referrerpolicy=\"no-referrer\" />\n            <div class=\"post-info\">\n              <div class=\"user-line\">\n                <span class=\"user-name\">{{ post.userName }}</span>\n                <span v-if=\"post.medal\" class=\"medal\">{{ post.medal }}</span>\n              </div>\n              <span class=\"post-date\">{{ post.createdAt.toDate().toLocaleString() }}</span>\n            </div>\n          </div>\n          <div class=\"post-content\">\n            <div class=\"post-title-line\">\n              <div class=\"restaurant-title-group\">\n                <h2 class=\"restaurant-name\">{{ post.restaurantName }}</h2>\n              <button v-if=\"user\" @click=\"toggleBucketList(post)\" class=\"action-btn bucket-list-btn\" :class=\"{ 'in-bucket-list': isInBucketList(post.restaurantId) }\" :title=\"isInBucketList(post.restaurantId) ? 'In Bucket List' : 'Add to Bucket List'\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"20px\" viewBox=\"0 0 24 24\" width=\"20px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M18 7h-2.06c-.33-3.2-2.46-5.8-5.94-5.8S4.39 3.8 4.06 7H2v12h16V7zM6.14 7c.2-1.92 1.6-3.48 3.86-3.8A4.002 4.002 0 0 1 14 7h-2.14c-.2-1.92-1.6-3.48-3.86-3.8zM16 17H4v-8h12v8z\"/></svg>\n              </button>\n              </div>\n              <div v-if=\"post.distance !== null\" class=\"distance\">\n                {{ post.distance.toFixed(1) }} miles away\n              </div>\n            </div>\n            <div v-if=\"post.restaurantCity || post.restaurantState\" class=\"restaurant-location\">\n              {{ post.restaurantCity }}<template v-if=\"post.restaurantCity && post.restaurantState\">, </template>{{ post.restaurantState }}\n            </div>\n            <div class=\"review-body\">\n              <StarRating :rating=\"post.rating\" />\n              <p v-if=\"post.text\" class=\"review-text\">\"{{ post.text }}\"</p>\n              <img v-if=\"post.photoURL\" :src=\"post.photoURL\" alt=\"Review photo\" class=\"review-photo\" loading=\"lazy\" />\n              <div v-if=\"post.tags && post.tags.length > 0\" class=\"tags-container\">\n                <span v-for=\"tag in post.tags\" :key=\"tag\" class=\"tag\">{{ tag }}</span>\n              </div>\n            </div>\n            <div class=\"post-actions\">\n              <button @click=\"toggleLike(post.id)\" class=\"like-btn\" :class=\"{ 'liked': post.isLiked }\" :disabled=\"!user\" :aria-label=\"post.isLiked ? 'Unlike this review' : 'Like this review'\" :aria-pressed=\"post.isLiked\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"20px\" viewBox=\"0 0 24 24\" width=\"20px\" fill=\"currentColor\">\n                  <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n                  <path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\"/>\n                </svg>\n                <span>{{ post.likeCount || 0 }}</span>\n              </button>\n              <button @click=\"shareReview(post.id)\" class=\"share-btn\" title=\"Share this review\" aria-label=\"Share this review\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"20px\" viewBox=\"0 0 24 24\" width=\"20px\" fill=\"currentColor\">\n                  <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n                  <path d=\"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z\"/>\n                </svg>\n                <span>Share</span>\n              </button>\n            </div>\n            <Comments :post-id=\"post.id\"\n                      :user=\"user\"\n                      post-type=\"reviews\"\n                      :post-author-id=\"post.userId\" />\n          </div>\n        </div>\n        <div ref=\"loadMoreTrigger\"></div>\n        <div v-if=\"loadingMore\" class=\"loading-indicator\">Loading more...</div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted, onUnmounted, watch, computed } from 'vue';\nimport { db } from '../firebase';\nimport { collection, query, where, getDocs, onSnapshot, orderBy, limit, addDoc, deleteDoc, serverTimestamp, doc, getDoc } from 'firebase/firestore';\nimport Comments from './Comments.vue';\nimport StarRating from './StarRating.vue';\nimport { getDistance } from '../utils/geolocation.js';\nimport { showToast } from '../utils/toast.js';\n\nexport default {\n  name: 'Home',\n  components: {\n    StarRating,\n    Comments\n  },\n  props: {\n    user: {\n      type: Object,\n      default: null\n    }\n  },\n  setup(props) {\n    const posts = ref([]);\n    const loading = ref(true);\n    const userLocation = ref(null);\n    const locationPermission = ref(''); // 'prompt', 'granted', 'denied'\n    const loadMoreTrigger = ref(null);\n    const loadingMore = ref(false);\n    const allPosts = new Map();\n    const fullSortedPosts = ref([]);\n    const pageSize = 10;\n    let observer = null;\n    const unsubscribes = [];\n    const bucketList = ref(new Set());\n    const leaderboardRanks = ref(new Map());\n    const restaurantsMap = ref(new Map());\n    const sortOrder = ref('time'); // 'time' or 'distance'\n    let isSettingUpListeners = false; // Guard to prevent concurrent setup\n\n    const processAndSetPosts = () => {\n      // Always re-calculate medals before sorting and displaying\n      allPosts.forEach(post => {\n        const rank = leaderboardRanks.value.get(post.userId);\n        post.medal = getMedal(rank);\n      });\n\n      const sortedPosts = Array.from(allPosts.values()).sort((a, b) => {\n          if (sortOrder.value === 'distance' && userLocation.value) {\n            const distanceA = a.distance ?? Infinity;\n            const distanceB = b.distance ?? Infinity;\n\n            if (distanceA !== distanceB) {\n              return distanceA - distanceB;\n            }\n            // If distances are equal (e.g. same restaurant), sub-sort by time\n            const timeA = a.lastActivityAt || a.createdAt;\n            const timeB = b.lastActivityAt || b.createdAt;\n            return timeB.seconds - timeA.seconds;\n          }\n\n          // Default sort by time\n          const timeA = a.lastActivityAt || a.createdAt;\n          const timeB = b.lastActivityAt || b.createdAt;\n          return timeB.seconds - timeA.seconds;\n      });\n      fullSortedPosts.value = sortedPosts;\n      // Update the displayed posts, preserving the current scroll length\n      posts.value = fullSortedPosts.value.slice(0, posts.value.length || pageSize);\n    };\n\n    onUnmounted(() => {\n      unsubscribes.forEach(unsub => unsub());\n      if (observer) {\n        observer.disconnect();\n      }\n    });\n\n    onMounted(() => {\n      observer = new IntersectionObserver((entries) => {\n        if (entries[0].isIntersecting) {\n          loadMorePosts();\n        }\n      });\n      checkLocationPermission(); // Now called once on mount.\n    });\n\n    watch(userLocation, (newLocation) => {\n      if (newLocation && allPosts.size > 0) {\n        // Location has been granted/updated after posts were already loaded.\n        // We need to update distances on existing posts.\n        allPosts.forEach(post => {\n          const restaurant = restaurantsMap.value.get(post.restaurantId);\n          if (restaurant?.location) {\n            post.distance = getDistance(newLocation.lat, newLocation.lng, restaurant.location.lat, restaurant.location.lng);\n          } else {\n            post.distance = null;\n          }\n        });\n        processAndSetPosts(); // Re-sort and update the view\n      }\n    });\n\n    watch(() => props.user, (newUser, oldUser) => {\n      // Re-fetch the feed if the user logs in or out.\n      // The check ensures this doesn't run unnecessarily on initial load\n      // if the user was already logged in.\n      if (newUser?.uid !== oldUser?.uid && !isSettingUpListeners) {\n        setupFeedListeners();\n      }\n    });\n\n    watch(loadMoreTrigger, (newValue, oldValue) => {\n      if (oldValue) observer.unobserve(oldValue);\n      if (newValue) observer.observe(newValue);\n    });\n\n    const setupFeedListeners = async () => {\n      // Prevent concurrent calls\n      if (isSettingUpListeners) {\n        return;\n      }\n      \n      isSettingUpListeners = true;\n      loading.value = true;\n      \n      try {\n        // Clear existing listeners and posts\n        // Unsubscribe from all existing listeners first\n        unsubscribes.forEach(unsub => {\n          try {\n            unsub();\n          } catch (err) {\n            console.warn('Error unsubscribing listener:', err);\n          }\n        });\n        unsubscribes.length = 0;\n        allPosts.clear();\n        \n        // Give Firestore a moment to clean up before setting up new listeners\n        await new Promise(resolve => setTimeout(resolve, 100));\n\n        const currentUser = props.user;\n        if (!currentUser) {\n          bucketList.value.clear();\n        } else {\n          const bucketListQuery = query(collection(db, 'bucketListItems'), where('userId', '==', currentUser.uid));\n          const unsubBucketList = onSnapshot(\n            bucketListQuery, \n            (snapshot) => {\n              const newBucketList = new Set();\n              snapshot.forEach(doc => newBucketList.add(doc.data().restaurantId));\n              bucketList.value = newBucketList;\n            },\n            (error) => {\n              console.error('Error in bucket list listener:', error);\n            }\n          );\n          unsubscribes.push(unsubBucketList);\n        }\n\n        // Fetch initial data including the leaderboard to avoid race conditions\n        const followsPromise = currentUser ? getDocs(query(collection(db, 'follows'), where('followerId', '==', currentUser.uid))) : Promise.resolve({ docs: [] });\n        const [followsSnap, restaurantsSnap, usersSnap, leaderboardSnap] = await Promise.all([\n          followsPromise,\n          getDocs(collection(db, 'restaurants')),\n          getDocs(collection(db, 'users')),\n          getDocs(query(collection(db, 'users'), orderBy('reviewCount', 'desc'), limit(30)))\n        ]);\n\n        // Filter out users with 0 or undefined reviewCount, then sort and assign ranks\n        const usersWithReviews = leaderboardSnap.docs\n          .map(doc => ({ id: doc.id, ...doc.data() }))\n          .filter(user => {\n            const count = Number(user.reviewCount) || 0;\n            return count > 0;\n          })\n          .sort((a, b) => {\n            const countA = Number(a.reviewCount) || 0;\n            const countB = Number(b.reviewCount) || 0;\n            return countB - countA;\n          })\n          .slice(0, 10); // Take only top 10\n        \n        const initialRanks = new Map();\n        usersWithReviews.forEach((user, index) => {\n          initialRanks.set(user.id, index);\n        });\n        leaderboardRanks.value = initialRanks;\n\n        restaurantsMap.value.clear();\n        restaurantsSnap.forEach(doc => {\n          restaurantsMap.value.set(doc.id, doc.data());\n        });\n        \n        const usersMap = new Map();\n        usersSnap.forEach(doc => {\n          usersMap.set(doc.id, doc.data());\n        });\n\n        const leaderboardQuery = query(collection(db, 'users'), orderBy('reviewCount', 'desc'), limit(30));\n        const unsubLeaderboard = onSnapshot(\n          leaderboardQuery, \n          (leaderboardSnap) => {\n            // Filter out users with 0 or undefined reviewCount, then sort and assign ranks\n            const usersWithReviews = leaderboardSnap.docs\n              .map(doc => ({ id: doc.id, ...doc.data() }))\n              .filter(user => {\n                const count = Number(user.reviewCount) || 0;\n                return count > 0;\n              })\n              .sort((a, b) => {\n                const countA = Number(a.reviewCount) || 0;\n                const countB = Number(b.reviewCount) || 0;\n                return countB - countA;\n              })\n              .slice(0, 10); // Take only top 10\n            \n            const newRanks = new Map();\n            usersWithReviews.forEach((user, index) => {\n              newRanks.set(user.id, index);\n            });\n            leaderboardRanks.value = newRanks;\n            processAndSetPosts();\n          },\n          (error) => {\n            console.error('Error in leaderboard listener:', error);\n          }\n        );\n        unsubscribes.push(unsubLeaderboard);\n\n        const processSnapshot = (snapshot) => {\n          snapshot.docChanges().forEach(change => {\n            if (change.type === 'removed') {\n              allPosts.delete(change.doc.id);\n            } else {\n              const docData = change.doc.data();\n              const restaurant = restaurantsMap.value.get(docData.restaurantId);\n              const user = usersMap.get(docData.userId);\n              const rank = leaderboardRanks.value.get(docData.userId); // Now guaranteed to have initial ranks\n              const post = {\n                ...docData,\n                id: change.doc.id,\n                restaurantName: restaurant?.name || 'Unknown Restaurant',\n                restaurantCity: restaurant?.city,\n                restaurantState: restaurant?.state,\n                location: restaurant?.location || null,\n                distance: userLocation.value && restaurant?.location ? getDistance(userLocation.value.lat, userLocation.value.lng, restaurant.location.lat, restaurant.location.lng) : null,\n                userName: user?.displayName || 'Unknown User',\n                userPhoto: user?.photoURL || null,\n                medal: getMedal(rank),\n                likeCount: 0,\n                isLiked: false\n              };\n              allPosts.set(post.id, post);\n              \n              // Set up like listener for this post\n              setupLikeListener(post.id);\n            }\n          });\n          processAndSetPosts();\n          loading.value = false;\n        };\n\n        if (currentUser) {\n          // --- LOGGED-IN USER LOGIC ---\n          const followingIds = followsSnap.docs.map(doc => doc.data().followingId);\n          // Add current user's ID to see their own posts\n          if (!followingIds.includes(currentUser.uid)) {\n            followingIds.push(currentUser.uid);\n          }\n          if (followingIds.length > 0) {\n            // Firestore 'in' query is limited to 30 elements, so we batch\n            for (let i = 0; i < followingIds.length; i += 30) {\n                const batchIds = followingIds.slice(i, i + 30);\n                const q = query(collection(db, 'reviews'), where('userId', 'in', batchIds), orderBy('lastActivityAt', 'desc'));\n                const unsub = onSnapshot(q, processSnapshot, (error) => console.error(\"Feed error (followed):\", error));\n                unsubscribes.push(unsub);\n            }\n          }\n\n          if (userLocation.value) {\n            const nearbyRestaurantIds = [];\n            restaurantsSnap.forEach(doc => {\n              const restaurant = doc.data();\n              if (restaurant.location) {\n                const distance = getDistance(userLocation.value.lat, userLocation.value.lng, restaurant.location.lat, restaurant.location.lng);\n                if (distance !== null && distance <= 100) {\n                  nearbyRestaurantIds.push(doc.id);\n                }\n              }\n            });\n            if (nearbyRestaurantIds.length > 0) {\n                for (let i = 0; i < nearbyRestaurantIds.length; i += 30) {\n                    const batchIds = nearbyRestaurantIds.slice(i, i + 30);\n                    const q = query(collection(db, 'reviews'), where('restaurantId', 'in', batchIds), orderBy('lastActivityAt', 'desc'));\n                    const unsub = onSnapshot(q, processSnapshot, (error) => console.error(\"Feed error (nearby):\", error));\n                    unsubscribes.push(unsub);\n                }\n            }\n          }\n        } else {\n          // --- GUEST USER LOGIC ---\n          // Fetch a pool of the 50 most recent reviews globally.\n          // The sorting function will then correctly order them by distance if location is available,\n          // or by time if not.\n          const recentReviewsQuery = query(collection(db, 'reviews'), orderBy('lastActivityAt', 'desc'), limit(50));\n          const unsub = onSnapshot(recentReviewsQuery, processSnapshot, (error) => console.error(\"Feed error (recent for guests):\", error));\n          unsubscribes.push(unsub);\n        }\n\n        if (unsubscribes.length === 0) {\n          loading.value = false;\n        }\n      } catch (error) {\n        console.error('Error setting up feed listeners:', error);\n        loading.value = false;\n        // Make sure to clean up any listeners that might have been set up\n        unsubscribes.forEach(unsub => {\n          try {\n            unsub();\n          } catch (err) {\n            // Ignore cleanup errors\n          }\n        });\n        unsubscribes.length = 0;\n      } finally {\n        isSettingUpListeners = false;\n      }\n    };\n\n    const loadMorePosts = () => {\n      if (loadingMore.value || posts.value.length >= fullSortedPosts.value.length) {\n        return;\n      }\n      loadingMore.value = true;\n\n      setTimeout(() => {\n        const currentLength = posts.value.length;\n        const nextPosts = fullSortedPosts.value.slice(currentLength, currentLength + pageSize);\n        posts.value.push(...nextPosts);\n        loadingMore.value = false;\n      }, 300);\n    };\n\n    const requestLocationAccess = () => {\n      navigator.geolocation.getCurrentPosition(\n        position => {\n          locationPermission.value = 'granted';\n          userLocation.value = {\n            lat: position.coords.latitude,\n            lng: position.coords.longitude\n          };\n        },\n        () => {\n          locationPermission.value = 'denied';\n        },\n        { timeout: 10000 }\n      );\n    };\n\n    const checkLocationPermission = async () => {\n      if (!navigator.permissions) {\n        requestLocationAccess(); // Fallback for older browsers\n        return;\n      }\n\n      try {\n        const permissionStatus = await navigator.permissions.query({ name: 'geolocation' });\n        locationPermission.value = permissionStatus.state;\n\n        permissionStatus.onchange = () => {\n          locationPermission.value = permissionStatus.state;\n          if (permissionStatus.state === 'granted') {\n            requestLocationAccess();\n          }\n        };\n\n        if (permissionStatus.state === 'granted') {\n          // Asynchronously request location. Don't wait for it.\n          requestLocationAccess();\n        }\n      } catch (error) {\n        console.error(\"Error checking location permission:\", error);\n        // If permission query fails (e.g. in Firefox private mode), fallback to just asking.\n        requestLocationAccess();\n      } finally {\n        // ALWAYS set up the feed listeners after checking permission.\n        setupFeedListeners();\n      }\n    };\n\n    const setSortOrder = (order) => {\n      if (sortOrder.value === order) return;\n      sortOrder.value = order;\n      processAndSetPosts();\n    };\n\n    const getMedal = (index) => {\n      // Medals are assigned based on position (0-indexed)\n      // Position 1 (index 0): Gold medal \n      // Position 2 (index 1): Silver medal \n      // Position 3 (index 2): Bronze medal \n      // Positions 4-10 (index 3-9): Participation medal \n      if (typeof index !== 'number') return null;\n      if (index === 0) return '';\n      if (index === 1) return '';\n      if (index === 2) return '';\n      if (index >= 3 && index < 10) return '';\n      return null;\n    };\n\n    const isInBucketList = (restaurantId) => {\n      return bucketList.value.has(restaurantId);\n    };\n\n    const toggleBucketList = async (post) => {\n      const currentUser = props.user;\n      if (!currentUser) return;\n\n      if (isInBucketList(post.restaurantId)) {\n        const q = query(collection(db, 'bucketListItems'), where('userId', '==', currentUser.uid), where('restaurantId', '==', post.restaurantId));\n        const snapshot = await getDocs(q);\n        snapshot.forEach(doc => deleteDoc(doc.ref));\n      } else {\n        await addDoc(collection(db, 'bucketListItems'), {\n          userId: currentUser.uid,\n          restaurantId: post.restaurantId,\n          createdAt: serverTimestamp()\n        });\n      }\n    };\n\n    const setupLikeListener = (reviewId) => {\n      const currentUser = props.user;\n      const reviewRef = doc(db, 'reviews', reviewId);\n      const likesCollection = collection(reviewRef, 'likes');\n      const likesQuery = query(likesCollection);\n      \n      const unsub = onSnapshot(likesQuery, (snapshot) => {\n        const post = allPosts.get(reviewId);\n        if (post) {\n          post.likeCount = snapshot.size;\n          post.isLiked = currentUser ? snapshot.docs.some(doc => doc.data().userId === currentUser.uid) : false;\n          // Update the post in the map\n          allPosts.set(reviewId, post);\n          // Trigger re-render by updating posts\n          processAndSetPosts();\n        }\n      }, (error) => {\n        console.error('Error fetching likes:', error);\n      });\n      \n      unsubscribes.push(unsub);\n    };\n\n    const toggleLike = async (reviewId) => {\n      const currentUser = props.user;\n      if (!currentUser) return;\n      \n      const reviewRef = doc(db, 'reviews', reviewId);\n      const likesCollection = collection(reviewRef, 'likes');\n      const likeQuery = query(likesCollection, where('userId', '==', currentUser.uid));\n      const likeSnap = await getDocs(likeQuery);\n      \n      if (!likeSnap.empty) {\n        // Unlike - delete the like document\n        await deleteDoc(likeSnap.docs[0].ref);\n      } else {\n        // Like - create a like document\n        await addDoc(likesCollection, {\n          userId: currentUser.uid,\n          createdAt: serverTimestamp()\n        });\n      }\n    };\n\n    const shareReview = async (reviewId) => {\n      const baseUrl = window.location.origin;\n      // Use clean URL format for better social media previews\n      // The Cloud Function will handle /review/{reviewId} format\n      const shareableLink = `${baseUrl}/review/${reviewId}`;\n      \n      // Try Web Share API first (mobile-friendly)\n      if (navigator.share) {\n        try {\n          await navigator.share({\n            title: 'Check out this review on PorkHub',\n            text: 'Check out this review on PorkHub',\n            url: shareableLink\n          });\n          return;\n        } catch (err) {\n          // User cancelled or error - fall through to copy\n          if (err.name !== 'AbortError') {\n            console.error('Error sharing:', err);\n          }\n        }\n      }\n      \n      // Fallback: Copy to clipboard\n      try {\n        await navigator.clipboard.writeText(shareableLink);\n        showToast('Link copied to clipboard!', 'success');\n      } catch (err) {\n        console.error('Failed to copy link:', err);\n        // Fallback: Show link in prompt\n        const copied = prompt('Copy this link:', shareableLink);\n        if (copied) {\n          showToast('Link copied!', 'success');\n        }\n      }\n    };\n\n    return {\n      posts,\n      loading,\n      locationPermission,\n      requestLocationAccess,\n      loadMoreTrigger,\n      loadingMore,\n      isInBucketList,\n      toggleBucketList,\n      userLocation,\n      sortOrder,\n      setSortOrder,\n      toggleLike,\n      shareReview\n    };\n  }\n};\n</script>\n\n<style scoped>\n.home-page {\n  max-width: 800px;\n  margin: 0 auto;\n}\n\n.location-prompt-banner {\n  background-color: #eaf5ff;\n  border: 1px solid var(--primary-color);\n  border-radius: 8px;\n  padding: 1em 1.5em;\n  margin-bottom: 2em;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 1em;\n}\n\n.location-prompt-banner.warning {\n  background-color: #fff4e5;\n  border-color: #ff9800;\n}\n\n.banner-content {\n  display: flex;\n  align-items: center;\n  gap: 1em;\n}\n\n.banner-content p {\n  margin: 0;\n  color: var(--secondary-color);\n}\n\n.location-prompt-banner .btn-primary {\n  background-color: var(--primary-color);\n  color: white;\n  border: none;\n  padding: 0.6em 1.2em;\n  border-radius: 8px;\n  cursor: pointer;\n  font-weight: 600;\n  white-space: nowrap;\n}\n\n.sort-toggle {\n  display: flex;\n  justify-content: center;\n  margin-bottom: 1.5em;\n  background-color: #e9ecef;\n  border-radius: 8px;\n  padding: 4px;\n  width: fit-content;\n  margin-left: auto;\n  margin-right: auto;\n}\n\n.sort-toggle button {\n  background: none;\n  border: none;\n  padding: 8px 16px;\n  cursor: pointer;\n  border-radius: 6px;\n  font-weight: 500;\n  color: var(--secondary-color);\n  transition: background-color 0.2s, color 0.2s;\n}\n\n.sort-toggle button.active {\n  background-color: white;\n  color: var(--primary-color);\n  box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n}\n\n.loading-indicator, .no-posts-message {\n  text-align: center;\n  color: #777;\n  padding: 3em;\n}\n\n.no-posts-message h3 {\n  margin-bottom: 0.5em;\n}\n\n.post-card {\n  background: var(--card-background);\n  border-radius: 12px;\n  box-shadow: 0 4px 15px var(--shadow-color);\n  margin-bottom: 2em;\n  overflow: hidden;\n}\n\n.post-header {\n  display: flex;\n  align-items: center;\n  gap: 1em;\n  padding: 1em 1.5em;\n  border-bottom: 1px solid #eee;\n}\n\n.user-avatar {\n  width: 45px;\n  height: 45px;\n  border-radius: 50%;\n}\n\n.post-info {\n  display: flex;\n  flex-direction: column;\n}\n\n.user-line {\n  display: flex;\n  align-items: center;\n  gap: 0.5em;\n}\n\n.action-btn {\n    background: none;\n    border: none;\n    cursor: pointer;\n    padding: 0;\n    display: flex;\n    align-items: center;\n}\n\n.bucket-list-btn {\n  color: #ccc;\n}\n.bucket-list-btn.in-bucket-list, .bucket-list-btn:hover {\n  color: var(--primary-color);\n}\n\n.post-actions {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-top: 0.5em;\n  padding-top: 0.5em;\n  margin-bottom: 0;\n  padding-bottom: 0;\n  border-top: 1px solid #eee;\n}\n\n.share-btn {\n  display: flex;\n  align-items: center;\n  gap: 0.5em;\n  background: none;\n  border: none;\n  cursor: pointer;\n  padding: 0.5em 0.75em;\n  border-radius: 8px;\n  color: #555;\n  transition: all 0.2s;\n}\n\n.share-btn:hover {\n  background-color: #f0f0f0;\n}\n\n.share-btn svg {\n  width: 20px;\n  height: 20px;\n  fill: currentColor;\n}\n\n.like-btn {\n  display: flex;\n  align-items: center;\n  gap: 0.5em;\n  background: none;\n  border: none;\n  cursor: pointer;\n  padding: 0.5em 0.75em;\n  border-radius: 8px;\n  color: #555;\n  transition: all 0.2s;\n}\n\n.like-btn:hover:not(:disabled) {\n  background-color: #f0f0f0;\n}\n\n.like-btn:disabled {\n  cursor: not-allowed;\n  opacity: 0.6;\n}\n\n.like-btn.liked {\n  color: #e74c3c;\n}\n\n.like-btn svg {\n  width: 20px;\n  height: 20px;\n  fill: currentColor;\n}\n\n.medal {\n  font-size: 1.1em;\n}\n\n.user-name {\n  font-weight: 600;\n}\n\n.post-date {\n  color: #7f8c8d;\n  font-size: 0.85em;\n}\n\n.post-content {\n  padding: 0.5em 1.5em 1.5em;\n}\n\n.post-title-line {\n  display: flex;\n  justify-content: space-between;\n  align-items: baseline;\n  margin-bottom: 0.25em;\n}\n\n.restaurant-name {\n  font-size: 1.1em;\n  font-weight: 600;\n  margin: 0;\n}\n\n.restaurant-location {\n  font-size: 0.9em;\n  color: #777;\n  margin-bottom: 0.75em;\n}\n\n.restaurant-title-group {\n  display: flex;\n  align-items: center;\n  gap: 0.5em;\n}\n\n.review-photo {\n  max-width: 100%;\n  border-radius: 8px;\n  margin-top: 1em;\n}\n\n.review-text {\n  font-style: italic;\n  color: #333;\n  margin: 0.5em 0;\n}\n\n.tags-container {\n  margin-top: 1em;\n}\n\n.tag {\n  background-color: var(--primary-color);\n  color: white;\n  padding: 0.3em 0.8em;\n  border-radius: 15px;\n  font-size: 0.8em;\n  margin-right: 0.5em;\n  display: inline-block;\n}\n\n.distance {\n  font-size: 0.9em;\n  color: #777;\n  flex-shrink: 0;\n  padding-left: 1em;\n}\n</style>","// Firebase configuration and initialization\nimport { initializeApp } from \"firebase/app\";\nimport { getAuth, GoogleAuthProvider, signInWithPopup, signOut, OAuthProvider } from \"firebase/auth\";\nimport { getFirestore } from \"firebase/firestore\";\nimport { getStorage } from \"firebase/storage\";\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyDxzi70xuS1KxemDBF1logZ6zyHxINFfp4\",\n  authDomain: \"porko-c0f87.firebaseapp.com\",\n  projectId: \"porko-c0f87\",\n  storageBucket: \"porko-c0f87.firebasestorage.app\",\n  messagingSenderId: \"1050714930836\",\n  appId: \"1:1050714930836:web:5b4c9bdf93e95748a23e81\",\n  measurementId: \"G-3LCKP815FM\"\n};\n\nconst app = initializeApp(firebaseConfig);\nconst auth = getAuth(app);\nconst provider = new GoogleAuthProvider();\nconst db = getFirestore(app);\nconst storage = getStorage(app);\n\n// Example Firestore data models\n// users: { uid, displayName, photoURL, bio }\n// restaurants: { id, name, address, location: { lat, lng }, description }\n// reviews: { id, restaurantId, userId, rating, text, photoURL, createdAt }\n// checkins: { id, restaurantId, userId, comment, photoURL, createdAt }\n// follows: { followerId, followingId }\n\nexport { auth, provider, signInWithPopup, signOut, db, storage };\n","<template>\n  <div class=\"comments-section\">\n    <div class=\"comment-list\">\n      <div v-for=\"comment in comments\" :key=\"comment.id\" class=\"comment\">\n        <img :src=\"comment.userPhoto || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" :alt=\"comment.userName\" class=\"comment-user-photo\" referrerpolicy=\"no-referrer\" />\n        <div class=\"comment-content\">\n          <div class=\"comment-header\">\n            <span class=\"comment-user-name\">{{ comment.userName }}</span>\n            <span class=\"comment-date\">{{ formatDate(comment.createdAt) }}</span>\n          </div>\n          <div v-if=\"editingCommentId !== comment.id\">\n            <p class=\"comment-text\">{{ comment.text }}</p>\n            <div class=\"comment-actions\">\n              <button v-if=\"canEdit(comment)\" @click=\"startEditing(comment)\" class=\"action-btn\">Edit</button>\n              <button v-if=\"canDelete(comment)\" @click=\"deleteComment(comment.id)\" class=\"action-btn delete\">Delete</button>\n            </div>\n          </div>\n          <div v-else class=\"edit-comment\">\n            <input v-model=\"editingText\" @keyup.enter=\"saveEdit\" class=\"edit-input\" />\n            <div class=\"edit-actions\">\n              <button @click=\"saveEdit\" class=\"btn-primary\">Save</button>\n              <button @click=\"cancelEdit\" class=\"btn-secondary\">Cancel</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div v-if=\"user\" class=\"add-comment\">\n      <input v-model=\"newComment\" placeholder=\"Add a comment...\" @keyup.enter=\"addComment\" />\n      <button @click=\"addComment\" :disabled=\"!newComment.trim()\">Post</button>\n    </div>\n    <div v-else class=\"add-comment-login-prompt\">\n      <p>Please log in to comment.</p>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted, onUnmounted } from 'vue';\nimport { db } from '../firebase';\nimport { collection, query, where, getDocs, orderBy, onSnapshot, addDoc, serverTimestamp, doc, updateDoc, deleteDoc, documentId } from 'firebase/firestore';\nimport { showToast } from '../utils/toast.js';\n\nexport default {\n  name: 'Comments',\n  props: {\n    postId: { type: String, required: true },\n    postType: { type: String, required: true },\n    postAuthorId: { type: String, required: true },\n    user: {\n      type: Object,\n      default: null\n    }\n  },\n  setup(props) {\n    const comments = ref([]);\n    const newComment = ref('');\n    const editingCommentId = ref(null);\n    const editingText = ref('');\n    let unsubscribe = () => {};\n\n    onMounted(() => {\n      // Use a DocumentReference for the parent, then get the subcollection correctly.\n      const parentDocRef = doc(db, props.postType, props.postId);\n      const commentsCollection = collection(parentDocRef, 'comments');\n      const commentsQuery = query(commentsCollection, orderBy('createdAt', 'asc'));\n      unsubscribe = onSnapshot(commentsQuery, async (snapshot) => {\n        const commentData = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n        \n        const userIds = [...new Set(commentData.map(c => c.userId))];\n        \n        if (userIds.length > 0) {\n          const usersMap = new Map();\n          // Firestore 'in' query is limited to 30 elements\n          for (let i = 0; i < userIds.length; i += 30) {\n            const batchIds = userIds.slice(i, i + 30);\n            const usersQuery = query(collection(db, 'users'), where(documentId(), 'in', batchIds));\n            const usersSnapshot = await getDocs(usersQuery);\n            usersSnapshot.forEach(doc => usersMap.set(doc.id, doc.data()));\n          }\n          \n          comments.value = commentData.map(comment => {\n            const user = usersMap.get(comment.userId);\n            return {\n              ...comment,\n              userName: user?.displayName || comment.userName || 'Unknown User',\n              userPhoto: user?.photoURL || comment.userPhoto || null\n            };\n          });\n        } else {\n          comments.value = [];\n        }\n      });\n    });\n\n    onUnmounted(() => {\n      unsubscribe();\n    });\n\n    const addComment = async () => {\n      if (newComment.value.trim() === '') return;\n      const currentUser = props.user;\n      if (!currentUser) return;\n\n      const now = serverTimestamp();\n      const parentDocRef = doc(db, props.postType, props.postId);\n      const commentsCollection = collection(parentDocRef, 'comments');\n      const reviewDocRef = doc(db, 'reviews', props.postId);\n\n      await Promise.all([\n        addDoc(commentsCollection, {\n          userId: currentUser.uid,\n          text: newComment.value,\n          createdAt: now,\n        }),\n        updateDoc(reviewDocRef, { lastActivityAt: now })\n      ]);\n      newComment.value = '';\n    };\n\n    const canEdit = (comment) => {\n      const currentUser = props.user;\n      return currentUser && currentUser.uid === comment.userId;\n    };\n\n    const canDelete = (comment) => {\n      const currentUser = props.user;\n      return currentUser && (currentUser.uid === comment.userId || currentUser.uid === props.postAuthorId);\n    };\n\n    const startEditing = (comment) => {\n      editingCommentId.value = comment.id;\n      editingText.value = comment.text;\n    };\n\n    const cancelEdit = () => {\n      editingCommentId.value = null;\n      editingText.value = '';\n    };\n\n    const saveEdit = async () => {\n      if (editingText.value.trim() === '' || !editingCommentId.value) return;\n      const parentDocRef = doc(db, props.postType, props.postId);\n      const commentsCollection = collection(parentDocRef, 'comments');\n      const commentDoc = doc(commentsCollection, editingCommentId.value);\n      const reviewDocRef = doc(db, 'reviews', props.postId);\n      await Promise.all([\n        updateDoc(commentDoc, { text: editingText.value }),\n        updateDoc(reviewDocRef, { lastActivityAt: serverTimestamp() })\n      ]);\n      cancelEdit();\n    };\n\n    const deleteComment = async (commentId) => {\n      if (confirm('Are you sure you want to delete this comment?')) {\n        try {\n          const parentDocRef = doc(db, props.postType, props.postId);\n          const commentsCollection = collection(parentDocRef, 'comments');\n          const commentDoc = doc(commentsCollection, commentId);\n          const reviewDocRef = doc(db, 'reviews', props.postId);\n          await Promise.all([\n            deleteDoc(commentDoc),\n            updateDoc(reviewDocRef, { lastActivityAt: serverTimestamp() })\n          ]);\n          showToast('Comment deleted successfully', 'success');\n        } catch (error) {\n          console.error('Error deleting comment:', error);\n          showToast('Failed to delete comment. Please try again.', 'error');\n        }\n      }\n    };\n\n    const formatDate = (timestamp) => {\n      if (!timestamp || !timestamp.toDate) return '';\n      return timestamp.toDate().toLocaleString();\n    };\n\n    return {\n      comments, newComment, addComment, canEdit, canDelete, startEditing,\n      cancelEdit, saveEdit, deleteComment, editingCommentId, editingText, formatDate\n    };\n  },\n};\n</script>\n\n<style scoped>\n.comments-section {\n  margin-top: 0.5em;\n  padding-top: 0.75em;\n  border-top: 1px solid #eee;\n}\n.comment-list { margin-bottom: 1em; }\n.comment { display: flex; gap: 0.75em; margin-bottom: 1em; }\n.comment-user-photo { width: 32px; height: 32px; border-radius: 50%; }\n.comment-content { flex-grow: 1; }\n.comment-header { display: flex; align-items: center; gap: 0.5em; margin-bottom: 0.25em; }\n.comment-info { display: flex; align-items: baseline; gap: 0.5em; }\n.comment-user-name { font-weight: 600; font-size: 0.9em; }\n.comment-date { font-size: 0.75em; color: #777; }\n.comment-text { margin: 0 0 0.5em; font-size: 0.95em; line-height: 1.4; }\n.comment-actions { font-size: 0.8em; }\n.action-btn { background: none; border: none; color: #777; cursor: pointer; padding: 0 5px 0 0; }\n.action-btn.delete { color: #e74c3c; }\n.edit-comment { display: flex; flex-direction: column; gap: 0.5em; }\n.edit-input { width: 100%; padding: 0.5em; border-radius: 4px; border: 1px solid #ccc; }\n.edit-actions { display: flex; gap: 0.5em; justify-content: flex-end; }\n.add-comment { display: flex; gap: 0.5em; margin-top: 1em; }\n.add-comment input { flex-grow: 1; border: 1px solid #ddd; border-radius: 15px; padding: 0.5em 1em; }\n.add-comment button { background-color: var(--primary-color); color: white; border: none; border-radius: 15px; padding: 0.5em 1em; cursor: pointer; }\n.add-comment button:disabled { background-color: #bdc3c7; cursor: not-allowed; }\n.btn-primary { background-color: var(--primary-color); color: white; border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer; }\n.btn-secondary { background-color: #ecf0f1; color: var(--secondary-color); border: 1px solid #bdc3c7; padding: 4px 8px; border-radius: 4px; cursor: pointer; }\n.add-comment-login-prompt {\n  text-align: center;\n  color: #777;\n  font-size: 0.9em;\n}\n</style>","// Toast notification utility\r\nconst toastListeners = [];\r\nlet toastId = 0;\r\n\r\nexport const showToast = (message, type = 'info', duration = 3000) => {\r\n  const id = toastId++;\r\n  const toast = { id, message, type, duration };\r\n  \r\n  // Notify all listeners\r\n  toastListeners.forEach(listener => listener(toast));\r\n  \r\n  return id;\r\n};\r\n\r\nexport const subscribeToToasts = (callback) => {\r\n  toastListeners.push(callback);\r\n  // Return unsubscribe function\r\n  return () => {\r\n    const index = toastListeners.indexOf(callback);\r\n    if (index > -1) {\r\n      toastListeners.splice(index, 1);\r\n    }\r\n  };\r\n};\r\n","import { render } from \"./Comments.vue?vue&type=template&id=ba2e816a&scoped=true\"\nimport script from \"./Comments.vue?vue&type=script&lang=js\"\nexport * from \"./Comments.vue?vue&type=script&lang=js\"\n\nimport \"./Comments.vue?vue&type=style&index=0&id=ba2e816a&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-ba2e816a\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"star-rating\" :class=\"{ 'is-editable': editable }\">\r\n    <span\r\n      v-for=\"n in 5\"\r\n      :key=\"n\"\r\n      @click=\"setRating(n)\"\r\n      @mouseover=\"handleMouseover(n)\"\r\n      @mouseleave=\"handleMouseleave\"\r\n      class=\"star\"\r\n    >\r\n      <svg height=\"16px\" width=\"16px\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n        <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\r\n        <path :d=\"getStarPath(n)\" />\r\n      </svg>\r\n    </span>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref } from 'vue';\r\n\r\nexport default {\r\n  name: 'StarRating',\r\n  props: {\r\n    rating: {\r\n      type: Number,\r\n      required: true,\r\n      default: 0\r\n    },\r\n    editable: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n  emits: ['update:rating'],\r\n  setup(props, { emit }) {\r\n    const hoverRating = ref(0);\r\n\r\n    const fullStarPath = \"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27z\";\r\n    const halfStarPath = \"M22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27V6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L18.18 21l-1.64-7.03L22 9.24zM12 15.4z\";\r\n    const emptyStarPath = \"M22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.64-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z\";\r\n\r\n    const getStarPath = (starIndex) => {\r\n      const displayRating = hoverRating.value || props.rating;\r\n      if (displayRating >= starIndex) {\r\n        return fullStarPath;\r\n      }\r\n      if (!hoverRating.value && props.rating >= starIndex - 0.5) {\r\n        return halfStarPath;\r\n      }\r\n      return emptyStarPath;\r\n    };\r\n\r\n    const setRating = (n) => {\r\n      if (props.editable) {\r\n        emit('update:rating', n);\r\n      }\r\n    };\r\n\r\n    const handleMouseover = (n) => {\r\n      if (props.editable) {\r\n        hoverRating.value = n;\r\n      }\r\n    };\r\n\r\n    const handleMouseleave = () => {\r\n      if (props.editable) {\r\n        hoverRating.value = 0;\r\n      }\r\n    };\r\n\r\n    return { getStarPath, setRating, handleMouseover, handleMouseleave };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.star-rating {\r\n  display: inline-flex;\r\n  color: #f39c12;\r\n  gap: 2px;\r\n}\r\n.star-rating.is-editable .star {\r\n  cursor: pointer;\r\n}\r\n</style>","import { render } from \"./StarRating.vue?vue&type=template&id=32f96f7e&scoped=true\"\nimport script from \"./StarRating.vue?vue&type=script&lang=js\"\nexport * from \"./StarRating.vue?vue&type=script&lang=js\"\n\nimport \"./StarRating.vue?vue&type=style&index=0&id=32f96f7e&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-32f96f7e\"]])\n\nexport default __exports__","export function getDistance(lat1, lon1, lat2, lon2) {\r\n  if (lat1 === null || lon1 === null || lat2 === null || lon2 === null) {\r\n    return null;\r\n  }\r\n  if (lat1 === lat2 && lon1 === lon2) {\r\n    return 0;\r\n  }\r\n  const R = 3959; // Radius of the earth in miles\r\n  const dLat = (lat2 - lat1) * Math.PI / 180;\r\n  const dLon = (lon2 - lon1) * Math.PI / 180;\r\n  const a =\r\n    Math.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n    Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *\r\n    Math.sin(dLon / 2) * Math.sin(dLon / 2);\r\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n  return R * c;\r\n}","import { render } from \"./Home.vue?vue&type=template&id=2fec4a57&scoped=true\"\nimport script from \"./Home.vue?vue&type=script&lang=js\"\nexport * from \"./Home.vue?vue&type=script&lang=js\"\n\nimport \"./Home.vue?vue&type=style&index=0&id=2fec4a57&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2fec4a57\"]])\n\nexport default __exports__","<template>\n  <div class=\"restaurants-page\">\n    <EditRestaurantModal \n      v-if=\"isEditModalVisible\"\n      :restaurant=\"restaurantToEdit\"\n      @close=\"closeEditModal\"\n      @save=\"saveRestaurantChanges\"\n    />\n    <AddReviewModal\n      v-if=\"isAddReviewModalVisible\"\n      :restaurant-id=\"restaurantIdForNewReview\"\n      :user=\"user\"\n      @close=\"closeAddReviewModal\"\n      @review-added=\"handleReviewAdded\"\n    />\n    <RestaurantReviewsModal\n      v-if=\"isReviewsModalVisible\"\n      :restaurant=\"restaurantForReviews\"\n      :user=\"user\"\n      @close=\"closeReviewsModal\"\n      @reviews-updated=\"handleReviewOrUpdate\"\n    />\n    <div class=\"search-box\">\n      <input type=\"text\" v-model=\"searchQuery\" placeholder=\"Search by name, address, city, state, or zip...\" class=\"search-input\" aria-label=\"Search restaurants\" />\n    </div>\n    <div v-if=\"user\" class=\"add-restaurant-container\">\n      <button @click=\"showAddForm = !showAddForm\" class=\"btn-toggle-add\">\n        {{ showAddForm ? 'Cancel' : 'Add New Restaurant' }}\n      </button>\n      <form v-if=\"showAddForm\" @submit.prevent=\"addNewRestaurant\" class=\"add-restaurant-form\">\n        <h3>Add a New Restaurant</h3>\n        <div class=\"form-group\">\n          <label for=\"new-name\">Name</label>\n          <input id=\"new-name\" type=\"text\" v-model=\"newRestaurant.name\" required />\n        </div>\n        <div class=\"form-group\">\n          <label for=\"new-address\">Address</label>\n          <input id=\"new-address\" type=\"text\" v-model=\"newRestaurant.address\" required />\n        </div>\n        <div class=\"form-group-row\">\n          <div class=\"form-group\"><label for=\"new-city\">City</label><input id=\"new-city\" type=\"text\" v-model=\"newRestaurant.city\" /></div>\n          <div class=\"form-group\"><label for=\"new-state\">State</label><input id=\"new-state\" type=\"text\" v-model=\"newRestaurant.state\" /></div>\n          <div class=\"form-group\"><label for=\"new-zip\">Zip</label><input id=\"new-zip\" type=\"text\" v-model=\"newRestaurant.zip\" /></div>\n        </div>\n        <div class=\"form-group\">\n          <label for=\"new-url\">Website URL</label>\n          <input id=\"new-url\" type=\"url\" v-model=\"newRestaurant.url\" placeholder=\"https://example.com\" />\n        </div>\n        <p v-if=\"addError\" class=\"error-message\">{{ addError }}</p>\n        <button type=\"submit\" :disabled=\"isSaving\" class=\"btn-save\">{{ isSaving ? 'Saving...' : 'Save Restaurant' }}</button>\n      </form>\n    </div>\n    <div v-if=\"loading\" class=\"loading-indicator\">Loading restaurants...</div>\n    <div v-else class=\"restaurant-list-container\">\n      <ul v-if=\"filteredRestaurants.length > 0\" class=\"restaurant-list\">\n        <li v-for=\"restaurant in filteredRestaurants\" :key=\"restaurant.id\" class=\"restaurant-item\">\n          <div class=\"restaurant-details\">\n            <span class=\"restaurant-name\">{{ restaurant.name }}</span>\n            <div class=\"restaurant-meta\">\n              <div v-if=\"restaurant.averageRating > 0\" class=\"rating\" :title=\"`${restaurant.averageRating.toFixed(2)} average rating`\">\n                <StarRating :rating=\"restaurant.averageRating\" />\n                <span class=\"rating-text\">{{ restaurant.averageRating.toFixed(1) }}</span>\n                <span class=\"rating-count\">({{ restaurant.ratingCount }})</span>\n              </div>\n              <span v-if=\"restaurant.distance !== null\" class=\"distance\">{{ restaurant.distance.toFixed(1) }} miles away </span>\n            </div>\n            <span class=\"restaurant-address\">\n              {{ restaurant.address }}<template v-if=\"restaurant.city\">, {{ restaurant.city }}</template><template v-if=\"restaurant.state\">, {{ restaurant.state }}</template><template v-if=\"restaurant.zip\"> {{ restaurant.zip }}</template>\n            </span>\n          </div>\n          <div class=\"restaurant-actions\">\n            <button v-if=\"user\" @click=\"toggleBucketList(restaurant)\" class=\"action-btn\" :class=\"{ 'in-bucket-list': isInBucketList(restaurant.id) }\" :title=\"isInBucketList(restaurant.id) ? 'Remove from Bucket List' : 'Add to Bucket List'\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M18 7h-2.06c-.33-3.2-2.46-5.8-5.94-5.8S4.39 3.8 4.06 7H2v12h16V7zM6.14 7c.2-1.92 1.6-3.48 3.86-3.8A4.002 4.002 0 0 1 14 7h-2.14c-.2-1.92-1.6-3.48-3.86-3.8zM16 17H4v-8h12v8z\"/></svg>\n            </button>\n            <button @click=\"openReviewsModal(restaurant)\" class=\"action-btn\" title=\"View Reviews\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z\"/></svg>\n            </button>\n            <button v-if=\"user\" @click=\"openEditModal(restaurant)\" class=\"action-btn\" title=\"Edit Restaurant\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z\"/></svg>\n            </button>\n            <a :href=\"getDirectionsUrl(restaurant)\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"action-btn\" title=\"Get Directions\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M22.43 10.59l-9.01-9.01c-.75-.75-2.07-.76-2.83 0l-9.01 9.01c-.76.75-.76 2.07 0 2.83l9.01 9.01c.75.75 2.07.75 2.83 0l9.01-9.01c.75-.76.75-2.08 0-2.83zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4z\"/></svg>\n            </a>\n            <a :href=\"getDetailsUrl(restaurant)\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"action-btn\" title=\"View Details on Google\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 5 1.41-1.41L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\"/></svg>\n            </a>\n            <a v-if=\"restaurant.url\" :href=\"getValidUrl(restaurant.url)\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"action-btn\" title=\"Visit Website\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z\"/></svg>\n            </a>\n            <button v-if=\"user\" class=\"check-in-btn\" @click=\"openAddReviewModal(restaurant.id)\">Review</button>\n          </div>\n        </li>\n      </ul>\n      <p v-else class=\"no-restaurants-message\">No restaurants found matching your search.</p>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted, onUnmounted, computed, watch } from 'vue';\nimport { db } from '../firebase';\nimport { collection, getDocs, doc, updateDoc, query, where, addDoc, deleteDoc, serverTimestamp, onSnapshot } from 'firebase/firestore';\nimport StarRating from './StarRating.vue';\nimport EditRestaurantModal from './EditRestaurantModal.vue'; \nimport AddReviewModal from './AddReviewModal.vue';\nimport RestaurantReviewsModal from './RestaurantReviewsModal.vue'; \nimport { getDistance } from '../utils/geolocation.js';\nimport { showToast } from '../utils/toast.js';\n\nexport default {\n  name: 'Restaurants',\n  components: { EditRestaurantModal, StarRating, RestaurantReviewsModal, AddReviewModal },\n  props: {\n    user: {\n      type: Object,\n      default: null\n    }\n  },\n  setup(props) {\n    const restaurants = ref([]);\n    const rawReviews = ref([]);\n    const loading = ref(true);\n    const searchQuery = ref('');\n    const isEditModalVisible = ref(false);\n    const isAddReviewModalVisible = ref(false);\n    const isReviewsModalVisible = ref(false);\n    const restaurantToEdit = ref(null);\n    const restaurantIdForNewReview = ref(null);\n    const restaurantForReviews = ref(null);\n    const userLocation = ref(null);\n    const bucketList = ref(new Set());\n    const showAddForm = ref(false);\n    const newRestaurant = ref({\n      name: '',\n      address: '',\n      city: '',\n      state: '',\n      zip: '',\n      url: ''\n    });\n    const addError = ref('');\n    const isSaving = ref(false);\n    let bucketListUnsubscribe = () => {};\n    let restaurantsUnsubscribe = () => {};\n    let reviewsUnsubscribe = () => {};\n\n    const restaurantsWithRatings = computed(() => {\n      const ratings = {};\n      rawReviews.value.forEach(review => {\n        if (review.restaurantId && typeof review.rating === 'number') {\n          if (!ratings[review.restaurantId]) {\n            ratings[review.restaurantId] = { total: 0, count: 0, reviews: [] };\n          }\n          ratings[review.restaurantId].total += review.rating;\n          ratings[review.restaurantId].count++;\n          ratings[review.restaurantId].reviews.push(review);\n        }\n      });\n\n      return restaurants.value.map(restaurantDoc => {\n        const ratingInfo = ratings[restaurantDoc.id];\n        const sortedReviews = ratingInfo ? ratingInfo.reviews.sort((a, b) => (b.createdAt?.seconds ?? 0) - (a.createdAt?.seconds ?? 0)) : [];\n        return {\n          ...restaurantDoc,\n          averageRating: ratingInfo ? ratingInfo.total / ratingInfo.count : 0,\n          ratingCount: ratingInfo ? ratingInfo.count : 0,\n          reviews: sortedReviews,\n        };\n      });\n    });\n\n\n    onMounted(() => {\n      loading.value = true;\n      \n      const restaurantsQuery = collection(db, 'restaurants');\n      restaurantsUnsubscribe = onSnapshot(restaurantsQuery, (snapshot) => {\n        restaurants.value = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n        // If reviews are already loaded, we can stop loading. Otherwise, wait for reviews.\n        if (rawReviews.value.length > 0) {\n          loading.value = false;\n        }\n      }, (error) => {\n        console.error(\"Error fetching restaurants:\", error);\n        loading.value = false;\n      });\n\n      const reviewsQuery = collection(db, 'reviews');\n      reviewsUnsubscribe = onSnapshot(reviewsQuery, (snapshot) => {\n        rawReviews.value = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n        loading.value = false; // Data is ready to be computed and displayed\n      }, (error) => {\n        console.error(\"Error fetching reviews:\", error);\n        loading.value = false;\n      });\n\n      if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(position => {\n          userLocation.value = {\n            lat: position.coords.latitude,\n            lng: position.coords.longitude\n          };\n        }, (error) => {\n          console.error(\"Error getting location\", error);\n        });\n      } else {\n        console.error(\"Geolocation is not supported by this browser.\");\n      }\n    });\n\n    onUnmounted(() => {\n      bucketListUnsubscribe();\n      restaurantsUnsubscribe();\n      reviewsUnsubscribe();\n    });\n\n    const subscribeToBucketList = (userId) => {\n      bucketListUnsubscribe();\n      const q = query(collection(db, 'bucketListItems'), where('userId', '==', userId));\n      bucketListUnsubscribe = onSnapshot(q, (snapshot) => {\n        const newBucketList = new Set();\n        snapshot.forEach(doc => newBucketList.add(doc.data().restaurantId));\n        bucketList.value = newBucketList;\n      });\n    };\n\n    watch(() => props.user, (newUser) => {\n      if (newUser) {\n        subscribeToBucketList(newUser.uid);\n      } else {\n        bucketListUnsubscribe();\n        bucketList.value.clear();\n      }\n    }, { immediate: true });\n\n    const restaurantsWithDistance = computed(() => {\n      return restaurantsWithRatings.value.map(r => {\n        const distance = userLocation.value && r.location ? getDistance(userLocation.value.lat, userLocation.value.lng, r.location.lat, r.location.lng) : null;\n        return { ...r, distance };\n      }).sort((a, b) => {\n        if (a.distance === null) return 1;\n        if (b.distance === null) return -1;\n        return a.distance - b.distance;\n      });\n    });\n\n    const filteredRestaurants = computed(() => {\n      if (!searchQuery.value.trim()) {\n        return restaurantsWithDistance.value;\n      }\n      const lowerCaseQuery = searchQuery.value.toLowerCase();\n      return restaurantsWithDistance.value.filter(r =>\n        (r.name && r.name.toLowerCase().includes(lowerCaseQuery)) ||\n        (r.address && r.address.toLowerCase().includes(lowerCaseQuery)) ||\n        (r.city && r.city.toLowerCase().includes(lowerCaseQuery)) ||\n        (r.state && r.state.toLowerCase().includes(lowerCaseQuery)) ||\n        (r.zip && r.zip.toLowerCase().includes(lowerCaseQuery))\n      );\n    });\n\n    const getDirectionsUrl = (restaurant) => {\n      const destination = encodeURIComponent(`${restaurant.name}, ${restaurant.address}`);\n      return `https://www.google.com/maps/dir/?api=1&destination=${destination}`;\n    };\n\n    const getDetailsUrl = (restaurant) => {\n      const query = encodeURIComponent(`${restaurant.name}, ${restaurant.address}`);\n      return `https://www.google.com/search?q=${query}`;\n    };\n\n    const getValidUrl = (url) => {\n      if (!url) return '#';\n      if (url.startsWith('http://') || url.startsWith('https://')) {\n        return url;\n      }\n      return `https://${url}`;\n    };\n\n    const openEditModal = (restaurant) => {\n      restaurantToEdit.value = restaurant;\n      isEditModalVisible.value = true;\n    };\n\n    const closeEditModal = () => {\n      isEditModalVisible.value = false;\n      restaurantToEdit.value = null;\n    };\n\n    const openReviewsModal = (restaurant) => {\n      restaurantForReviews.value = restaurant;\n      isReviewsModalVisible.value = true;\n    };\n\n    const closeReviewsModal = () => {\n      isReviewsModalVisible.value = false;\n      restaurantForReviews.value = null;\n    };\n    \n    const openAddReviewModal = (restaurantId) => {\n      restaurantIdForNewReview.value = restaurantId;\n      isAddReviewModalVisible.value = true;\n    };\n\n    const closeAddReviewModal = () => {\n      isAddReviewModalVisible.value = false;\n      restaurantIdForNewReview.value = null;\n    };\n\n    const handleReviewAdded = async (restaurantId) => {\n      closeAddReviewModal();\n    };\n\n    const handleReviewOrUpdate = async () => {\n      // This is now handled automatically by the real-time listeners.\n      // We can keep the function in case the modal needs to be closed or other UI logic is added.\n    };\n\n    const saveRestaurantChanges = async (updatedData) => {\n      const updatedRestaurant = { ...updatedData };\n      if (!updatedRestaurant || !updatedRestaurant.id) return;\n\n      const original = restaurantToEdit.value;\n      const dataToSave = {};\n\n      const nameChanged = original.name !== updatedRestaurant.name;\n      if (nameChanged) {\n        dataToSave.name = updatedRestaurant.name;\n        dataToSave.name_lowercase = updatedRestaurant.name.trim().toLowerCase();\n      }\n\n      const addressParts = ['address', 'city', 'state', 'zip'];\n      const addressChanged = addressParts.some(part => original[part] !== updatedRestaurant[part]);\n\n      if (addressChanged) {\n        dataToSave.address = updatedRestaurant.address;\n        dataToSave.city = updatedRestaurant.city;\n        dataToSave.state = updatedRestaurant.state;\n        dataToSave.zip = updatedRestaurant.zip;\n        dataToSave.address_lowercase = (updatedRestaurant.address || '').trim().toLowerCase();\n        \n        const fullAddress = [updatedRestaurant.address, updatedRestaurant.city, updatedRestaurant.state, updatedRestaurant.zip].filter(Boolean).join(', ');\n        const { geocodeAddress } = await import('../utils/geocoding.js');\n        const location = await geocodeAddress(fullAddress);\n        if (location) {\n          dataToSave.location = location;\n        } else {\n          showToast(\"Could not find a location for the provided address. The restaurant will be saved without a location.\", 'warning', 5000);\n          dataToSave.location = null;\n        }\n      }\n\n      if (original.url !== updatedRestaurant.url) {\n        dataToSave.url = updatedRestaurant.url;\n      }\n\n      if (Object.keys(dataToSave).length === 0) {\n        closeEditModal();\n        return;\n      }\n\n      const restaurantRef = doc(db, 'restaurants', updatedRestaurant.id);\n      try {\n        await updateDoc(restaurantRef, dataToSave);\n        closeEditModal();\n      } catch (error) {\n        console.error(\"Error updating restaurant: \", error);\n        showToast(\"Failed to save changes. Please try again.\", 'error');\n      }\n    };\n\n    const addNewRestaurant = async () => {\n      if (!props.user) {\n        addError.value = \"You must be logged in to add a restaurant.\";\n        return;\n      }\n      if (!newRestaurant.value.name.trim() || !newRestaurant.value.address.trim()) {\n        addError.value = 'Restaurant name and address are required.';\n        return;\n      }\n      isSaving.value = true;\n      addError.value = '';\n      const normalizedName = newRestaurant.value.name.trim().toLowerCase();\n      const normalizedAddress = newRestaurant.value.address.trim().toLowerCase();\n      try {\n        const q = query(collection(db, 'restaurants'), where('name_lowercase', '==', normalizedName), where('address_lowercase', '==', normalizedAddress));\n        const querySnapshot = await getDocs(q);\n        if (!querySnapshot.empty) {\n          addError.value = 'This restaurant already exists.';\n          isSaving.value = false;\n          return;\n        }\n        const fullAddress = [newRestaurant.value.address, newRestaurant.value.city, newRestaurant.value.state, newRestaurant.value.zip].filter(Boolean).join(', ');\n        const { geocodeAddress } = await import('../utils/geocoding.js');\n        const location = await geocodeAddress(fullAddress);\n        if (!location) {\n          addError.value = \"Could not find a location for the provided address. Please check the address and try again.\";\n          isSaving.value = false;\n          return;\n        }\n        const docData = {\n          name: newRestaurant.value.name.trim(),\n          address: newRestaurant.value.address.trim(),\n          city: newRestaurant.value.city.trim(),\n          state: newRestaurant.value.state.trim(),\n          zip: newRestaurant.value.zip.trim(),\n          url: newRestaurant.value.url.trim(),\n          name_lowercase: normalizedName,\n          address_lowercase: normalizedAddress,\n          location,\n          createdAt: serverTimestamp(),\n          userId: props.user.uid,\n          userDisplayName: props.user.displayName || 'Anonymous'\n        };\n        const docRef = await addDoc(collection(db, 'restaurants'), docData);\n        showAddForm.value = false;\n        newRestaurant.value = { name: '', address: '', city: '', state: '', zip: '', url: '' };\n      } catch (error) {\n        console.error(\"Error adding new restaurant:\", error);\n        addError.value = 'Failed to add restaurant. Please try again.';\n      } finally {\n        isSaving.value = false;\n      }\n    };\n\n    const isInBucketList = (restaurantId) => {\n      return bucketList.value.has(restaurantId);\n    };\n\n    const toggleBucketList = async (restaurant) => {\n      const currentUser = props.user;\n      if (!currentUser) return;\n\n      if (isInBucketList(restaurant.id)) {\n        const q = query(collection(db, 'bucketListItems'), where('userId', '==', currentUser.uid), where('restaurantId', '==', restaurant.id));\n        const snapshot = await getDocs(q);\n        snapshot.forEach(doc => deleteDoc(doc.ref));\n      } else {\n        await addDoc(collection(db, 'bucketListItems'), {\n          userId: currentUser.uid,\n          restaurantId: restaurant.id,\n          createdAt: serverTimestamp()\n        });\n      }\n    };\n\n    return {\n      user: props.user,\n      loading,\n      searchQuery,\n      filteredRestaurants,\n      getDirectionsUrl,\n      getDetailsUrl,\n      getValidUrl,\n      isEditModalVisible,\n      restaurantToEdit,\n      isReviewsModalVisible,\n      restaurantForReviews,\n      openEditModal,\n      closeEditModal,\n      saveRestaurantChanges,\n      openReviewsModal,\n      closeReviewsModal,\n      handleReviewOrUpdate,\n      isInBucketList,\n      toggleBucketList,\n      showAddForm,\n      newRestaurant,\n      addNewRestaurant,\n      addError,\n      isSaving,\n      isAddReviewModalVisible,\n      restaurantIdForNewReview,\n      openAddReviewModal,\n      closeAddReviewModal,\n      handleReviewAdded\n    };\n  }\n};\n</script>\n\n<style scoped>\n.search-box {\n  margin-bottom: 2em;\n}\n.search-input {\n  width: 100%;\n  padding: 12px;\n  border-radius: 8px;\n  border: 1px solid #ddd;\n  font-size: 1em;\n}\n.add-restaurant-container {\n  background: var(--card-background);\n  border-radius: 12px;\n  padding: 1.5em;\n  margin-bottom: 2em;\n  box-shadow: 0 4px 15px var(--shadow-color);\n}\n.btn-toggle-add {\n  background-color: var(--primary-color);\n  color: white;\n  border: none;\n  padding: 10px 20px;\n  border-radius: 8px;\n  cursor: pointer;\n  font-weight: 600;\n  width: 100%;\n}\n.add-restaurant-form {\n  margin-top: 1.5em;\n  border-top: 1px solid #eee;\n  padding-top: 1.5em;\n}\n.add-restaurant-form h3 {\n  margin-top: 0;\n  margin-bottom: 1em;\n}\n.form-group {\n  margin-bottom: 1em;\n}\n.form-group-row {\n  display: flex;\n  gap: 1em;\n}\n.form-group-row .form-group {\n  flex: 1;\n}\n.form-group label {\n  display: block;\n  margin-bottom: 0.5em;\n  font-weight: 600;\n}\n.form-group input {\n  width: 100%;\n  padding: 10px;\n  border-radius: 8px;\n  border: 1px solid #ccc;\n  box-sizing: border-box;\n}\n.loading-indicator, .no-restaurants-message {\n  text-align: center;\n  color: #777;\n  padding: 3em;\n}\n.restaurant-list {\n  list-style: none;\n  padding: 0;\n  margin: 0;\n}\n.restaurant-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1.5em;\n  background: var(--card-background);\n  border-radius: 12px;\n  box-shadow: 0 4px 15px var(--shadow-color);\n  margin-bottom: 1.5em;\n}\n.restaurant-details {\n  display: flex;\n  flex-direction: column;\n}\n.restaurant-name {\n  font-weight: 600;\n  font-size: 1.2em;\n  margin-bottom: 0.25em;\n  word-break: break-word;\n}\n.restaurant-meta {\n  display: flex;\n  align-items: center;\n  flex-wrap: wrap;\n  gap: 1em;\n  margin-bottom: 0.5em;\n  color: #555;\n  font-size: 0.9em;\n}\n.rating {\n  display: flex;\n  align-items: center;\n  gap: 0.25em;\n}\n.rating-text {\n  font-weight: bold;\n  margin-left: 0.25em;\n}\n.rating-count {\n  color: #777;\n}\n.distance {\n  font-style: italic;\n}\n.restaurant-address {\n  color: #777;\n  font-size: 0.9em;\n  word-break: break-word;\n}\n.restaurant-actions {\n  display: flex;\n  gap: 0.75em;\n}\n.action-btn, .check-in-btn {\n  background: none;\n  border: 1px solid #ccc;\n  border-radius: 8px;\n  padding: 8px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s;\n  color: #555;\n}\n.action-btn:hover {\n  background-color: #f0f0f0;\n  border-color: #bbb;\n}\n.action-btn svg {\n  width: 20px;\n  height: 20px;\n}\n.check-in-btn {\n  background-color: var(--primary-color);\n  color: white;\n  border-color: var(--primary-color);\n  padding: 8px 16px;\n  font-weight: 600;\n}\n.check-in-btn:hover {\n  background-color: var(--primary-dark-color);\n}\n.btn-save {\n  background-color: #27ae60;\n  color: white;\n  border: none;\n  padding: 10px 20px;\n  border-radius: 8px;\n  cursor: pointer;\n  font-weight: 600;\n}\n.btn-save:disabled {\n  background-color: #bdc3c7;\n  cursor: not-allowed;\n}\n.error-message {\n  color: #e74c3c;\n  margin-top: 1em;\n}\n\n.in-bucket-list {\n  color: var(--primary-color) !important;\n}\n\n@media (max-width: 768px) {\n  .restaurant-item {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 1em;\n  }\n  .restaurant-actions {\n    width: 100%;\n    flex-wrap: wrap;\n    gap: 0.5em;\n  }\n  .restaurant-actions .action-btn,\n  .restaurant-actions .check-in-btn {\n    flex-grow: 1;\n    justify-content: center;\n  }\n}\n</style>","<template>\r\n  <div class=\"modal-overlay\" @click.self=\"$emit('close')\">\r\n    <div class=\"modal-content\">\r\n      <h2>Edit Restaurant</h2>\r\n      <form @submit.prevent=\"onSave\" v-if=\"editableRestaurant\">\r\n        <div class=\"form-group\">\r\n          <label for=\"name\">Name</label>\r\n          <input id=\"name\" v-model=\"editableRestaurant.name\" type=\"text\" required>\r\n        </div>\r\n        <div class=\"form-group\">\r\n          <label for=\"address\">Address</label>\r\n          <input id=\"address\" v-model=\"editableRestaurant.address\" type=\"text\">\r\n        </div>\r\n        <div class=\"form-group\">\r\n          <label for=\"city\">City</label>\r\n          <input id=\"city\" v-model=\"editableRestaurant.city\" type=\"text\">\r\n        </div>\r\n        <div class=\"form-group\">\r\n          <label for=\"state\">State</label>\r\n          <input id=\"state\" v-model=\"editableRestaurant.state\" type=\"text\">\r\n        </div>\r\n        <div class=\"form-group\">\r\n          <label for=\"zip\">Zip Code</label>\r\n          <input id=\"zip\" v-model=\"editableRestaurant.zip\" type=\"text\">\r\n        </div>\r\n        <div class=\"form-group\">\r\n          <label for=\"url\">Website URL</label>\r\n          <input id=\"url\" v-model=\"editableRestaurant.url\" type=\"url\" placeholder=\"https://example.com\">\r\n        </div>\r\n        <div class=\"modal-actions\">\r\n          <button type=\"button\" class=\"btn-cancel\" @click=\"$emit('close')\">Cancel</button>\r\n          <button type=\"submit\" class=\"btn-save\">Save Changes</button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, watch } from 'vue';\r\n\r\nexport default {\r\n  name: 'EditRestaurantModal',\r\n  props: {\r\n    restaurant: {\r\n      type: Object,\r\n      required: true\r\n    }\r\n  },\r\n  emits: ['close', 'save'],\r\n  setup(props, { emit }) {\r\n    const editableRestaurant = ref(null);\r\n\r\n    watch(() => props.restaurant, (newVal) => {\r\n      if (newVal) {\r\n        // Create a deep copy to avoid mutating the prop directly\r\n        editableRestaurant.value = JSON.parse(JSON.stringify(newVal));\r\n      }\r\n    }, { immediate: true, deep: true });\r\n\r\n    const onSave = () => {\r\n      emit('save', editableRestaurant.value);\r\n    };\r\n\r\n    return {\r\n      editableRestaurant,\r\n      onSave\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.modal-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: rgba(0, 0, 0, 0.6);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 1000;\r\n}\r\n.modal-content {\r\n  background: var(--card-background);\r\n  padding: 2em;\r\n  border-radius: 12px;\r\n  width: 90%;\r\n  max-width: 500px;\r\n  box-shadow: 0 5px 15px rgba(0,0,0,0.3);\r\n}\r\n.form-group {\r\n  margin-bottom: 1.5em;\r\n}\r\n.form-group label {\r\n  display: block;\r\n  margin-bottom: 0.5em;\r\n  font-weight: 600;\r\n}\r\n.form-group input {\r\n  width: 100%;\r\n  padding: 10px;\r\n  border-radius: 8px;\r\n  border: 1px solid #ccc;\r\n  box-sizing: border-box;\r\n}\r\n.modal-actions {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  gap: 1em;\r\n  margin-top: 2em;\r\n}\r\n.modal-actions button {\r\n  padding: 10px 20px;\r\n  border-radius: 8px;\r\n  border: none;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n}\r\n.btn-save {\r\n  background-color: var(--primary-color);\r\n  color: white;\r\n}\r\n.btn-cancel {\r\n  background-color: #ecf0f1;\r\n  color: var(--secondary-color);\r\n}\r\n</style>","import { render } from \"./EditRestaurantModal.vue?vue&type=template&id=2288406c&scoped=true\"\nimport script from \"./EditRestaurantModal.vue?vue&type=script&lang=js\"\nexport * from \"./EditRestaurantModal.vue?vue&type=script&lang=js\"\n\nimport \"./EditRestaurantModal.vue?vue&type=style&index=0&id=2288406c&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2288406c\"]])\n\nexport default __exports__","<template>\n  <div class=\"modal-overlay\" @click.self=\"$emit('close')\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h2>Add Your Review</h2>\n        <button @click=\"$emit('close')\" class=\"close-btn\" :disabled=\"isUploading\">&times;</button>\n      </div>\n      <div class=\"modal-body\">\n        <form @submit.prevent=\"submitReview\">\n          <div class=\"form-group\">\n            <label>Your Rating</label>\n            <StarRating :rating=\"review.rating\" :editable=\"true\" @update:rating=\"newVal => review.rating = newVal\" />\n          </div>\n          <div class=\"form-group\">\n            <label for=\"review-text\">Your Review</label>\n            <textarea id=\"review-text\" v-model=\"review.text\" placeholder=\"What did you think?\"></textarea>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"review-photo\">Add a Photo</label>\n            <input type=\"file\" id=\"review-photo\" @change=\"handleFileChange\" accept=\"image/*\" />\n            <div v-if=\"photoPreview\" class=\"photo-preview-container\">\n              <img :src=\"photoPreview\" alt=\"Photo preview\" class=\"photo-preview\" />\n            </div>\n          </div>\n          <div v-if=\"isUploading\" class=\"upload-progress\">\n            <p>Uploading... {{ uploadProgress.toFixed(0) }}%</p>\n            <progress :value=\"uploadProgress\" max=\"100\"></progress>\n          </div>\n          <div v-if=\"error\" class=\"error-message\">{{ error }}</div>\n          <div class=\"form-actions\">\n            <button type=\"submit\" class=\"btn-primary\" :disabled=\"isUploading || review.rating === 0\">\n              {{ isUploading ? 'Submitting...' : 'Submit Review' }}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref } from 'vue';\nimport { db, storage } from '../firebase';\nimport { collection, addDoc, serverTimestamp, doc, updateDoc, increment } from 'firebase/firestore';\nimport { ref as storageRef, uploadBytesResumable, getDownloadURL } from 'firebase/storage';\nimport StarRating from './StarRating.vue';\nimport { showToast } from '../utils/toast.js';\n\nexport default {\n  name: 'AddReviewModal',\n  components: { StarRating },\n  props: {\n    restaurantId: { type: String, required: true },\n    user: { type: Object, required: true }\n  },\n  emits: ['close', 'review-added'],\n  setup(props, { emit }) {\n    const review = ref({ rating: 0, text: '' });\n    const photoFile = ref(null);\n    const photoPreview = ref(null);\n    const isUploading = ref(false);\n    const uploadProgress = ref(0);\n    const error = ref('');\n\n    const handleFileChange = (event) => {\n      const file = event.target.files[0];\n      if (!file) {\n        photoFile.value = null;\n        photoPreview.value = null;\n        return;\n      }\n      if (!file.type.startsWith('image/')) {\n        error.value = 'Please select an image file.';\n        return;\n      }\n      photoPreview.value = URL.createObjectURL(file);\n\n      // Image resizing logic\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        const img = new Image();\n        img.onload = () => {\n          const MAX_DIMENSION = 1024;\n          let { width, height } = img;\n\n          if (width > height) {\n            if (width > MAX_DIMENSION) {\n              height *= MAX_DIMENSION / width;\n              width = MAX_DIMENSION;\n            }\n          } else {\n            if (height > MAX_DIMENSION) {\n              width *= MAX_DIMENSION / height;\n              height = MAX_DIMENSION;\n            }\n          }\n\n          const canvas = document.createElement('canvas');\n          canvas.width = width;\n          canvas.height = height;\n          const ctx = canvas.getContext('2d');\n          ctx.drawImage(img, 0, 0, width, height);\n\n          canvas.toBlob((blob) => {\n            photoFile.value = blob;\n          }, file.type, 0.9); // Compress JPEG to 90% quality\n        };\n        img.src = e.target.result;\n      };\n      reader.readAsDataURL(file);\n    };\n\n    const submitReview = async () => {\n      if (review.value.rating === 0) {\n        error.value = \"Please provide a star rating.\";\n        return;\n      }\n      isUploading.value = true;\n      error.value = '';\n\n      try {\n        let photoURL = null;\n        if (photoFile.value) {\n          const filePath = `reviews/${props.restaurantId}/${Date.now()}_${props.user.uid}`;\n          const fileRef = storageRef(storage, filePath);\n          const uploadTask = uploadBytesResumable(fileRef, photoFile.value);\n\n          await new Promise((resolve, reject) => {\n            uploadTask.on('state_changed',\n              (snapshot) => {\n                uploadProgress.value = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\n              },\n              (uploadError) => {\n                console.error(\"Upload failed:\", uploadError);\n                error.value = \"Image upload failed. Please try again.\";\n                isUploading.value = false;\n                reject(uploadError);\n              },\n              async () => {\n                photoURL = await getDownloadURL(uploadTask.snapshot.ref);\n                resolve();\n              }\n            );\n          });\n        }\n\n        const timestamp = serverTimestamp();\n        const reviewData = {\n          userId: props.user.uid,\n          userName: props.user.displayName || 'Anonymous',\n          userPhoto: props.user.photoURL,\n          restaurantId: props.restaurantId,\n          rating: review.value.rating,\n          text: review.value.text,\n          photoURL: photoURL,\n          tags: [], // AddReviewModal doesn't support tags yet\n          createdAt: timestamp,\n          lastActivityAt: timestamp\n        };\n\n        await addDoc(collection(db, 'reviews'), reviewData);\n        \n        // Update the user's reviewCount atomically\n        // Using increment() ensures thread-safe updates and handles the case where reviewCount doesn't exist yet\n        const userRef = doc(db, 'users', props.user.uid);\n        try {\n          await updateDoc(userRef, { reviewCount: increment(1) });\n        } catch (countError) {\n          console.warn(\"Failed to update reviewCount (non-critical):\", countError);\n        }\n        \n        showToast('Review added successfully!', 'success', 2000);\n        emit('review-added', props.restaurantId);\n      } catch (e) {\n        if (!error.value) { // Don't overwrite upload-specific error\n          console.error(\"Error submitting review:\", e);\n          error.value = \"Failed to submit review. Please try again.\";\n          showToast(\"Failed to submit review. Please try again.\", 'error');\n        }\n        isUploading.value = false;\n      }\n    };\n\n    return { review, photoPreview, isUploading, uploadProgress, error, handleFileChange, submitReview };\n  }\n};\n</script>\n\n<style scoped>\n.modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.6); display: flex; justify-content: center; align-items: center; z-index: 1000; }\n.modal-content { background: var(--card-background); padding: 2em; border-radius: 12px; width: 90%; max-width: 500px; max-height: 90vh; display: flex; flex-direction: column; box-shadow: 0 5px 20px rgba(0,0,0,0.3); }\n.modal-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #eee; padding-bottom: 1em; margin-bottom: 1em; }\n.modal-header h2 { margin: 0; }\n.close-btn { background: none; border: none; font-size: 2em; cursor: pointer; color: #777; }\n.modal-body { overflow-y: auto; }\n.form-group { margin-bottom: 1.5em; }\n.form-group label { display: block; margin-bottom: 0.5em; font-weight: 600; }\n.form-group textarea { width: 100%; min-height: 100px; border: 1px solid #ccc; border-radius: 8px; padding: 10px; font-family: inherit; }\n.form-group input[type=\"file\"] { width: 100%; }\n.photo-preview-container { margin-top: 1em; }\n.photo-preview { max-width: 100%; max-height: 200px; border-radius: 8px; }\n.upload-progress { margin-top: 1em; }\n.upload-progress progress { width: 100%; }\n.error-message { color: #e74c3c; margin-bottom: 1em; }\n.form-actions { display: flex; justify-content: flex-end; }\n.btn-primary { background-color: var(--primary-color); color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; }\n.btn-primary:disabled { background-color: #bdc3c7; cursor: not-allowed; }\n</style>","import { render } from \"./AddReviewModal.vue?vue&type=template&id=b8084282&scoped=true\"\nimport script from \"./AddReviewModal.vue?vue&type=script&lang=js\"\nexport * from \"./AddReviewModal.vue?vue&type=script&lang=js\"\n\nimport \"./AddReviewModal.vue?vue&type=style&index=0&id=b8084282&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-b8084282\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"modal-overlay\" @click.self=\"$emit('close')\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h2>Reviews for {{ restaurant.name }}</h2>\r\n        <button @click=\"$emit('close')\" class=\"close-btn\">&times;</button>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <div v-if=\"restaurant.reviews && restaurant.reviews.length === 0\" class=\"no-reviews-message\">\r\n          No reviews yet for this restaurant.\r\n        </div>\r\n        <ul v-else class=\"reviews-list\">\r\n          <li v-for=\"review in restaurant.reviews\" :key=\"review.id\" class=\"review-item\">\r\n            <div v-if=\"editingReview && editingReview.id === review.id\">\r\n              <!-- Edit Form -->\r\n              <div class=\"edit-review-form\">\r\n                <StarRating :rating=\"editingReview.rating\" :editable=\"true\" @update:rating=\"newVal => editingReview.rating = newVal\" />\r\n                <textarea v-model=\"editingReview.text\" class=\"edit-textarea\"></textarea>\r\n                <div class=\"edit-actions\">\r\n                  <button @click=\"saveEdit\" class=\"btn-primary\">Save</button>\r\n                  <button @click=\"cancelEdit\" class=\"btn-secondary\">Cancel</button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div v-else>\r\n              <!-- Display Review -->\r\n              <div class=\"review-header\">\r\n                <img :src=\"review.userPhoto || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" alt=\"User\" class=\"user-avatar\" />\r\n                <div class=\"user-info\">\r\n                  <span class=\"user-name\">{{ review.userName }}</span>\r\n                  <span class=\"review-date\">{{ formatDate(review.createdAt) }}</span>\r\n                </div>\r\n                <div class=\"review-actions\" v-if=\"user && user.uid === review.userId\">\r\n                  <button @click=\"startEditing(review)\" class=\"action-btn\" title=\"Edit Review\">\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"18px\" viewBox=\"0 0 24 24\" width=\"18px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z\"/></svg>\r\n                  </button>\r\n                  <button @click=\"deleteReview(review.id)\" class=\"action-btn\" title=\"Delete Review\">\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"18px\" viewBox=\"0 0 24 24\" width=\"18px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z\"/></svg>\r\n                  </button>\r\n                </div>\r\n              </div>\r\n              <div class=\"review-body\">\r\n                <StarRating :rating=\"review.rating\" />\r\n                <p v-if=\"review.text\" class=\"review-text\">\"{{ review.text }}\"</p>\r\n                <div v-if=\"review.photoURL\" class=\"review-photo-container\">\r\n                  <img :src=\"review.photoURL\" alt=\"Review photo\" class=\"review-photo\" loading=\"lazy\" />\r\n                </div>\r\n                <div v-if=\"review.tags && review.tags.length > 0\" class=\"tags-container\">\r\n                  <span v-for=\"tag in review.tags\" :key=\"tag\" class=\"tag\">{{ tag }}</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref } from 'vue';\r\nimport { db } from '../firebase';\r\nimport { doc, updateDoc, deleteDoc } from 'firebase/firestore';\r\nimport StarRating from './StarRating.vue';\r\nimport { showToast } from '../utils/toast.js';\r\n\r\nexport default {\r\n  name: 'RestaurantReviewsModal',\r\n  components: { StarRating },\r\n  props: {\r\n    restaurant: {\r\n      type: Object,\r\n      required: true\r\n    },\r\n    user: {\r\n      type: Object,\r\n      default: null\r\n    }\r\n  },\r\n  emits: ['close', 'reviews-updated'],\r\n  setup(props, { emit }) {\r\n    const editingReview = ref(null);\r\n\r\n    const formatDate = (timestamp) => {\r\n      if (!timestamp || !timestamp.toDate) return '';\r\n      return timestamp.toDate().toLocaleDateString();\r\n    };\r\n\r\n    const startEditing = (review) => {\r\n      editingReview.value = JSON.parse(JSON.stringify(review));\r\n    };\r\n\r\n    const cancelEdit = () => {\r\n      editingReview.value = null;\r\n    };\r\n\r\n    const saveEdit = async () => {\r\n      if (!editingReview.value) return;\r\n      const reviewRef = doc(db, 'reviews', editingReview.value.id);\r\n      try {\r\n        await updateDoc(reviewRef, {\r\n          rating: editingReview.value.rating,\r\n          text: editingReview.value.text\r\n        });\r\n        emit('reviews-updated');\r\n        cancelEdit();\r\n        showToast('Review updated successfully!', 'success');\r\n      } catch (error) {\r\n        console.error(\"Error updating review:\", error);\r\n        showToast(\"Failed to save review. Please try again.\", 'error');\r\n      }\r\n    };\r\n\r\n    const deleteReview = async (reviewId) => {\r\n      if (confirm(\"Are you sure you want to delete this review?\")) {\r\n        try {\r\n          await deleteDoc(doc(db, 'reviews', reviewId));\r\n          emit('reviews-updated');\r\n          showToast('Review deleted successfully', 'success');\r\n        } catch (error) {\r\n          console.error(\"Error deleting review:\", error);\r\n          showToast(\"Failed to delete review. Please try again.\", 'error');\r\n        }\r\n      }\r\n    };\r\n\r\n    return {\r\n      formatDate,\r\n      editingReview,\r\n      startEditing,\r\n      cancelEdit,\r\n      saveEdit,\r\n      deleteReview\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.6); display: flex; justify-content: center; align-items: center; z-index: 1000; }\r\n.modal-content { background: var(--card-background); padding: 2em; border-radius: 12px; width: 90%; max-width: 700px; max-height: 90vh; display: flex; flex-direction: column; box-shadow: 0 5px 20px rgba(0,0,0,0.3); }\r\n.modal-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #eee; padding-bottom: 1em; margin-bottom: 1em; }\r\n.modal-header h2 { margin: 0; }\r\n.close-btn { background: none; border: none; font-size: 2em; cursor: pointer; color: #777; }\r\n.modal-body { overflow-y: auto; }\r\n.loading-indicator, .no-reviews-message { text-align: center; color: #777; padding: 3em; }\r\n.reviews-list { list-style: none; padding: 0; margin: 0; }\r\n.review-item { border-bottom: 1px solid #eee; padding: 1.5em 0; }\r\n.review-item:last-child { border-bottom: none; }\r\n.review-header { display: flex; align-items: center; gap: 1em; margin-bottom: 1em; position: relative; }\r\n.user-avatar { width: 40px; height: 40px; border-radius: 50%; }\r\n.user-info { display: flex; flex-direction: column; }\r\n.user-name { font-weight: 600; }\r\n.review-date { font-size: 0.85em; color: #777; }\r\n.review-body { padding-left: 50px; }\r\n.review-text { margin: 0.5em 0; font-style: italic; }\r\n.review-photo-container { margin-top: 1em; }\r\n.review-photo { max-width: 100%; max-height: 300px; border-radius: 8px; }\r\n.tags-container { margin-top: 1em; display: flex; flex-wrap: wrap; gap: 0.5em; }\r\n.tag { background-color: #ecf0f1; color: var(--secondary-color); padding: 4px 10px; border-radius: 15px; font-size: 0.85em; }\r\n.review-actions { margin-left: auto; display: flex; gap: 0.5em; }\r\n.action-btn { background: none; border: none; cursor: pointer; color: #777; padding: 4px; }\r\n.action-btn:hover { color: #333; }\r\n.edit-review-form { display: flex; flex-direction: column; gap: 1em; }\r\n.edit-textarea { width: 100%; min-height: 80px; border: 1px solid #ccc; border-radius: 8px; padding: 10px; font-family: inherit; }\r\n.edit-actions { display: flex; justify-content: flex-end; gap: 0.5em; }\r\n.btn-primary {\r\n  background-color: var(--primary-color);\r\n  color: white;\r\n  border: none;\r\n  padding: 8px 16px;\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n}\r\n.btn-secondary {\r\n  background-color: #ecf0f1;\r\n  color: #34495e;\r\n  border: none;\r\n  padding: 8px 16px;\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n}\r\n</style>","import { render } from \"./RestaurantReviewsModal.vue?vue&type=template&id=6bcdd790&scoped=true\"\nimport script from \"./RestaurantReviewsModal.vue?vue&type=script&lang=js\"\nexport * from \"./RestaurantReviewsModal.vue?vue&type=script&lang=js\"\n\nimport \"./RestaurantReviewsModal.vue?vue&type=style&index=0&id=6bcdd790&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-6bcdd790\"]])\n\nexport default __exports__","import { render } from \"./Restaurants.vue?vue&type=template&id=14b51ebe&scoped=true\"\nimport script from \"./Restaurants.vue?vue&type=script&lang=js\"\nexport * from \"./Restaurants.vue?vue&type=script&lang=js\"\n\nimport \"./Restaurants.vue?vue&type=style&index=0&id=14b51ebe&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-14b51ebe\"]])\n\nexport default __exports__","<template>\n  <UserReviewsModal v-if=\"isReviewsModalVisible\" :user=\"userForReviews\" @close=\"closeReviewsModal\" />\n  <div class=\"user-search-page\">\n    <div class=\"search-box\">\n      <input type=\"text\" v-model=\"searchQuery\" placeholder=\"Search for users by name...\" class=\"search-input\">\n    </div>\n\n    <div v-if=\"loading\">Loading users...</div>\n    <div v-else>\n      <div v-if=\"filteredUsers.length === 0\" class=\"no-users-message\">\n        <div v-if=\"searchQuery\">\n          <h3>No users found</h3>\n          <p>Try adjusting your search terms or check out the Leaderboard to find active reviewers.</p>\n        </div>\n        <div v-else>\n          <h3>No other users yet</h3>\n          <p>Be the first to share reviews! Create your first review and invite others to join.</p>\n        </div>\n      </div>\n      <div v-for=\"user in filteredUsers\" :key=\"user.uid\" class=\"user-card\">\n        <div class=\"user-card-content\">\n          <div class=\"user-info\">\n            <img :src=\"user.photoURL || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" class=\"user-avatar\" alt=\"User\" />\n            <div class=\"user-details\">\n              <div class=\"user-name-line\">\n                <span class=\"user-name\">{{ user.displayName }}</span>\n                <span v-if=\"user.medal\" class=\"medal\">{{ user.medal }}</span>\n              </div>\n              <div v-if=\"user.distance !== null\" class=\"user-distance\">{{ user.distance.toFixed(1) }} miles away</div>\n            </div>\n          </div>\n          <div v-if=\"user.lastReview\" class=\"last-review\">\n            <div class=\"review-header\">\n              Latest review: <strong>{{ user.lastReview.restaurantName }}</strong>\n            </div>\n            <div class=\"review-body\">\n              <StarRating :rating=\"user.lastReview.rating\" />\n              <p v-if=\"user.lastReview.text\" class=\"review-text\">\"{{ user.lastReview.text }}\"</p>\n            </div>\n          </div>\n          <div v-else class=\"last-review no-review\">\n            No reviews yet.\n          </div>\n        </div>\n        <div class=\"user-actions\">\n          <button @click=\"openReviewsModal(user)\" class=\"action-btn\" title=\"View Reviews\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z\"/></svg>\n          </button>\n          <button @click=\"toggleFollow(user)\" class=\"follow-btn\" :class=\"{ 'unfollow-btn': user.isFollowing }\">{{ user.isFollowing ? 'Unfollow' : 'Follow' }}</button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted, onUnmounted, computed } from 'vue';\nimport { db, auth } from '../firebase';\nimport { collection, query, where, getDocs, doc, deleteDoc, addDoc, orderBy, limit, onSnapshot } from 'firebase/firestore';\nimport StarRating from './StarRating.vue';\nimport { getDistance } from '../utils/geolocation.js';\nimport UserReviewsModal from './UserReviewsModal.vue';\n\nexport default {\n  name: 'UserSearch',\n  components: { StarRating, UserReviewsModal },\n  setup() {\n    const users = ref([]);\n    const loading = ref(true);\n    const userLocation = ref(null);\n    const following = ref([]);\n    const searchQuery = ref('');\n    const isReviewsModalVisible = ref(false);\n    const userForReviews = ref(null);\n    const leaderboardRanks = ref(new Map());\n    let followsUnsubscribe = () => {};\n    \n    const getMedal = (index) => {\n      // Medals are assigned based on position (0-indexed)\n      // Position 1 (index 0): Gold medal \n      // Position 2 (index 1): Silver medal \n      // Position 3 (index 2): Bronze medal \n      // Positions 4-10 (index 3-9): Participation medal \n      if (typeof index !== 'number') return null;\n      if (index === 0) return '';\n      if (index === 1) return '';\n      if (index === 2) return '';\n      if (index >= 3 && index < 10) return '';\n      return null;\n    };\n\n    const fetchUsers = async () => {\n      loading.value = true;\n      const currentUser = auth.currentUser;\n      if (!currentUser) return;\n\n      // Subscribe to real-time updates for the user's follows\n      const followsQuery = query(collection(db, 'follows'), where('followerId', '==', currentUser.uid));\n      followsUnsubscribe = onSnapshot(followsQuery, (snapshot) => {\n        const newFollowing = snapshot.docs.map(d => d.data().followingId);\n        following.value = newFollowing;\n        // Update the isFollowing status on the already-loaded users\n        users.value = users.value.map(u => ({\n          ...u,\n          isFollowing: newFollowing.includes(u.uid)\n        }));\n      });\n\n      // Fetch leaderboard ranks\n      const leaderboardSnap = await getDocs(query(collection(db, 'users'), orderBy('reviewCount', 'desc'), limit(30)));\n      const usersWithReviews = leaderboardSnap.docs\n        .map(doc => ({ id: doc.id, ...doc.data() }))\n        .filter(user => {\n          const count = Number(user.reviewCount) || 0;\n          return count > 0;\n        })\n        .sort((a, b) => {\n          const countA = Number(a.reviewCount) || 0;\n          const countB = Number(b.reviewCount) || 0;\n          return countB - countA;\n        })\n        .slice(0, 10);\n      \n      const ranks = new Map();\n      usersWithReviews.forEach((user, index) => {\n        ranks.set(user.id, index);\n      });\n      leaderboardRanks.value = ranks;\n\n      const restaurantsSnap = await getDocs(collection(db, 'restaurants'));\n      const restaurantsMap = new Map();\n      restaurantsSnap.forEach(doc => {\n        restaurantsMap.set(doc.id, doc.data());\n      });\n\n      // NOTE: This page performs a query for every user to get their last review.\n      // This can be inefficient (N+1 problem). For better performance at scale,\n      // consider denormalizing the last review data onto the user document.\n      const usersQuery = query(collection(db, 'users'), where('uid', '!=', currentUser.uid));\n      const usersSnap = await getDocs(usersQuery);\n      const allUsers = usersSnap.docs\n        .map(doc => ({ uid: doc.id, ...doc.data() }))\n\n      const usersWithDetails = await Promise.all(\n        allUsers.map(async user => {\n          const reviewQuery = query(\n            collection(db, 'reviews'),\n            where('userId', '==', user.uid),\n            orderBy('createdAt', 'desc'),\n            limit(1)\n          );\n          const reviewSnap = await getDocs(reviewQuery);\n          let lastReview = null;\n          let distance = null;\n\n          if (!reviewSnap.empty) {\n            const reviewData = reviewSnap.docs[0].data();\n            const restaurant = restaurantsMap.get(reviewData.restaurantId);\n            lastReview = {\n              ...reviewData,\n              restaurantName: restaurant?.name || 'Unknown Restaurant'\n            };\n            \n            if (userLocation.value && restaurant?.location) {\n              distance = getDistance(\n                userLocation.value.lat,\n                userLocation.value.lng,\n                restaurant.location.lat,\n                restaurant.location.lng\n              );\n            }\n          }\n\n          const rank = leaderboardRanks.value.get(user.uid);\n          return {\n            ...user,\n            isFollowing: following.value.includes(user.uid),\n            lastReview,\n            distance,\n            medal: getMedal(rank)\n          };\n        })\n      );\n\n      users.value = usersWithDetails;\n      loading.value = false;\n    };\n\n    onMounted(() => {\n      if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(pos => {\n          userLocation.value = {\n            lat: pos.coords.latitude,\n            lng: pos.coords.longitude\n          };\n          fetchUsers();\n        }, (error) => {\n          console.error(\"Error getting location\", error);\n          fetchUsers();\n        });\n      } else {\n        console.error(\"Geolocation is not supported by this browser.\");\n        fetchUsers();\n      }\n    });\n\n    onUnmounted(() => {\n      followsUnsubscribe();\n    });\n\n    const filteredUsers = computed(() => {\n      const sorted = [...users.value].sort((a, b) => {\n        if (a.distance === null && b.distance !== null) return 1;\n        if (a.distance !== null && b.distance === null) return -1;\n        if (a.distance === null && b.distance === null) return 0;\n        return a.distance - b.distance;\n      });\n\n      if (!searchQuery.value.trim()) {\n        return sorted;\n      }\n      const lowerCaseQuery = searchQuery.value.toLowerCase();\n      return sorted.filter(user =>\n        user.displayName.toLowerCase().includes(lowerCaseQuery)\n      );\n    });\n\n    const toggleFollow = async (user) => {\n      const currentUser = auth.currentUser;\n      if (!currentUser) return;\n\n      const followsRef = collection(db, 'follows');\n      if (user.isFollowing) {\n        // Unfollow\n        const q = query(followsRef, where('followerId', '==', currentUser.uid), where('followingId', '==', user.uid));\n        const followsSnap = await getDocs(q);\n        if (!followsSnap.empty) {\n          const docId = followsSnap.docs[0].id;\n          await deleteDoc(doc(db, 'follows', docId));\n        }\n      } else {\n        // Follow\n        await addDoc(followsRef, {\n          followerId: currentUser.uid,\n          followingId: user.uid,\n        });\n      }\n    };\n\n    const openReviewsModal = (user) => {\n      userForReviews.value = user;\n      isReviewsModalVisible.value = true;\n    };\n\n    const closeReviewsModal = () => {\n      isReviewsModalVisible.value = false;\n      userForReviews.value = null;\n    };\n\n    return { \n      filteredUsers, \n      loading, \n      toggleFollow, \n      searchQuery,\n      isReviewsModalVisible,\n      userForReviews,\n      openReviewsModal,\n      closeReviewsModal\n    };\n  }\n};\n</script>\n\n<style scoped>\n.user-search-page {\n  max-width: 800px;\n  margin: 0 auto;\n}\n\n.search-box {\n  margin-bottom: 2em;\n}\n\n.search-input {\n  width: 100%;\n  padding: 12px 15px;\n  font-size: 1em;\n  border-radius: 8px;\n  border: 1px solid #ddd;\n  box-sizing: border-box;\n}\n\n.no-users-message {\n  text-align: center;\n  color: #777;\n  padding: 3em 2em;\n  background: var(--card-background);\n  border-radius: 12px;\n  box-shadow: 0 4px 15px var(--shadow-color);\n}\n\n.no-users-message h3 {\n  margin: 0 0 0.5em 0;\n  color: var(--text-color);\n}\n\n.no-users-message p {\n  margin: 0;\n  font-size: 0.95em;\n}\n\n.user-card {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  background: var(--card-background);\n  padding: 1.5em;\n  border-radius: 12px;\n  box-shadow: 0 4px 15px var(--shadow-color);\n  margin-bottom: 1.5em;\n  gap: 1.5em;\n}\n.user-card-content { flex-grow: 1; min-width: 0; }\n.user-info {\n  display: flex;\n  align-items: center;\n  gap: 1em;\n  min-width: 0;\n}\n.user-details {\n  min-width: 0;\n}\n.user-avatar {\n  width: 60px;\n  height: 60px;\n  border-radius: 50%;\n  flex-shrink: 0;\n}\n.user-name-line {\n  display: flex;\n  align-items: center;\n  gap: 0.5em;\n}\n.user-name {\n  font-weight: 600;\n  font-size: 1.1em;\n  word-break: break-word;\n}\n.medal {\n  font-size: 1.1em;\n}\n.user-distance {\n  font-size: 0.9em;\n  color: #777;\n}\n.user-actions {\n  display: flex;\n  gap: 0.75em;\n  align-items: center;\n}\n.user-actions .action-btn {\n  background: none;\n  border: 1px solid #ccc;\n  border-radius: 8px;\n  padding: 8px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s;\n  color: #555;\n}\n.user-actions .action-btn:hover {\n  background-color: #f0f0f0;\n  border-color: #bbb;\n}\n.user-actions .follow-btn {\n  background-color: var(--primary-color);\n  color: white;\n  border: none;\n  padding: 10px 20px;\n  border-radius: 8px;\n  cursor: pointer;\n  font-weight: 600;\n  transition: background-color 0.2s;\n}\n.user-actions .follow-btn.unfollow-btn {\n  background-color: #e74c3c;\n}\n.user-actions .follow-btn:hover {\n  opacity: 0.9;\n}\n.last-review { margin-top: 1em; padding-top: 1em; border-top: 1px solid #eee; font-size: 0.9em; min-width: 0; }\n.review-header { margin-bottom: 0.5em; color: #555; word-break: break-word; }\n.review-body .star-rating { margin-bottom: 0.5em; }\n.review-text {\n  margin: 0.5em 0 0;\n  font-style: italic;\n  color: #333;\n  word-break: break-word;\n}\n.no-review { color: #888; font-style: italic; }\n\n@media (max-width: 768px) {\n  .user-card {\n    flex-direction: column;\n    align-items: stretch;\n  }\n  .user-actions {\n    margin-top: 1em;\n  }\n  .user-actions button {\n    width: 100%;\n  }\n}\n</style>\n","<template>\r\n  <div class=\"modal-overlay\" @click.self=\"$emit('close')\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h2>Reviews by {{ user.displayName }}</h2>\r\n        <button @click=\"$emit('close')\" class=\"close-btn\">&times;</button>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <div v-if=\"loading\" class=\"loading-indicator\">Loading reviews...</div>\r\n        <p v-else-if=\"reviews.length === 0\" class=\"no-reviews-message\">\r\n          This user hasn't posted any reviews yet.\r\n        </p>\r\n        <ul v-else class=\"reviews-list\">\r\n          <li v-for=\"review in reviews\" :key=\"review.id\" class=\"review-item\">\r\n            <div class=\"review-header\">\r\n              <span class=\"restaurant-name\">{{ review.restaurantName }}</span>\r\n              <span class=\"review-date\">{{ formatDate(review.createdAt) }}</span>\r\n            </div>\r\n            <div class=\"review-body\">\r\n              <StarRating :rating=\"review.rating\" />\r\n              <p v-if=\"review.text\" class=\"review-text\">\"{{ review.text }}\"</p>\r\n              <img v-if=\"review.photoURL\" :src=\"review.photoURL\" alt=\"Review photo\" class=\"review-photo\" />\r\n              <div v-if=\"review.tags && review.tags.length > 0\" class=\"tags-container\">\r\n                <span v-for=\"tag in review.tags\" :key=\"tag\" class=\"tag\">{{ tag }}</span>\r\n              </div>\r\n            </div>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, watch } from 'vue';\r\nimport { db } from '../firebase';\r\nimport { collection, query, where, getDocs, orderBy } from 'firebase/firestore';\r\nimport StarRating from './StarRating.vue';\r\n\r\nexport default {\r\n  name: 'UserReviewsModal',\r\n  components: { StarRating },\r\n  props: {\r\n    user: {\r\n      type: Object,\r\n      required: true\r\n    }\r\n  },\r\n  emits: ['close'],\r\n  setup(props) {\r\n    const reviews = ref([]);\r\n    const loading = ref(true);\r\n\r\n    const fetchReviews = async () => {\r\n      if (!props.user?.uid) {\r\n        reviews.value = [];\r\n        loading.value = false;\r\n        return;\r\n      }\r\n      loading.value = true;\r\n      reviews.value = [];\r\n      try {\r\n        const restaurantsSnap = await getDocs(collection(db, 'restaurants'));\r\n        const restaurantsMap = new Map();\r\n        restaurantsSnap.forEach(doc => {\r\n          restaurantsMap.set(doc.id, doc.data().name);\r\n        });\r\n\r\n        const q = query(\r\n          collection(db, 'reviews'),\r\n          where('userId', '==', props.user.uid),\r\n          orderBy('createdAt', 'desc')\r\n        );\r\n        const querySnapshot = await getDocs(q);\r\n        reviews.value = querySnapshot.docs.map(doc => {\r\n          const data = doc.data();\r\n          return {\r\n            id: doc.id,\r\n            ...data,\r\n            restaurantName: restaurantsMap.get(data.restaurantId) || 'Unknown Restaurant'\r\n          };\r\n        });\r\n      } catch (error) {\r\n        console.error(\"Error fetching user reviews:\", error);\r\n      } finally {\r\n        loading.value = false;\r\n      }\r\n    };\r\n\r\n    watch(() => props.user, (newUser) => {\r\n      if (newUser) {\r\n        fetchReviews();\r\n      }\r\n    }, { immediate: true });\r\n\r\n    const formatDate = (timestamp) => {\r\n      return timestamp && timestamp.toDate ? timestamp.toDate().toLocaleDateString() : '';\r\n    };\r\n\r\n    return { reviews, loading, formatDate };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.6); display: flex; justify-content: center; align-items: center; z-index: 1000; }\r\n.modal-content { background: white; padding: 2em; border-radius: 12px; width: 90%; max-width: 600px; max-height: 90vh; display: flex; flex-direction: column; }\r\n.modal-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #eee; padding-bottom: 1em; margin-bottom: 1em; }\r\n.modal-header h2 { margin: 0; font-size: 1.5em; }\r\n.close-btn { background: none; border: none; font-size: 2em; cursor: pointer; line-height: 1; }\r\n.modal-body { overflow-y: auto; }\r\n.loading-indicator, .no-reviews-message { text-align: center; padding: 2em; color: #777; }\r\n.reviews-list { list-style: none; padding: 0; margin: 0; }\r\n.review-item { padding: 1.5em 0; border-bottom: 1px solid #eee; }\r\n.review-item:last-child { border-bottom: none; }\r\n.review-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1em; }\r\n.restaurant-name { font-weight: 600; font-size: 1.1em; }\r\n.review-date { font-size: 0.9em; color: #777; }\r\n.review-body .star-rating { margin-bottom: 0.5em; }\r\n.review-text { margin: 0.5em 0 0; font-style: italic; color: #333; }\r\n.review-photo { max-width: 100%; border-radius: 8px; margin-top: 1em; }\r\n.tags-container { margin-top: 1em; display: flex; flex-wrap: wrap; gap: 0.5em; }\r\n.tag { background-color: #ecf0f1; color: var(--secondary-color); padding: 4px 10px; border-radius: 15px; font-size: 0.85em; }\r\n</style>","import { render } from \"./UserReviewsModal.vue?vue&type=template&id=4e60c4e2&scoped=true\"\nimport script from \"./UserReviewsModal.vue?vue&type=script&lang=js\"\nexport * from \"./UserReviewsModal.vue?vue&type=script&lang=js\"\n\nimport \"./UserReviewsModal.vue?vue&type=style&index=0&id=4e60c4e2&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4e60c4e2\"]])\n\nexport default __exports__","import { render } from \"./UserSearch.vue?vue&type=template&id=51cdc354&scoped=true\"\nimport script from \"./UserSearch.vue?vue&type=script&lang=js\"\nexport * from \"./UserSearch.vue?vue&type=script&lang=js\"\n\nimport \"./UserSearch.vue?vue&type=style&index=0&id=51cdc354&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-51cdc354\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"review-page\">\r\n    <div class=\"review-card\">\r\n      <form @submit.prevent=\"submitReview\">\r\n        <div class=\"form-group\">\r\n          <label for=\"restaurant\">Restaurant</label>\r\n          <select id=\"restaurant\" v-model=\"selectedRestaurant\" :disabled=\"!!selectedRestaurantId\" required>\r\n            <option disabled value=\"\">Please select a restaurant</option>\r\n            <option v-for=\"restaurant in restaurants\" :key=\"restaurant.id\" :value=\"restaurant.id\">\r\n              {{ restaurant.name }}\r\n            </option>\r\n          </select>\r\n          <div class=\"add-restaurant-prompt\" v-if=\"!selectedRestaurantId\">\r\n            Can't find the restaurant?\r\n            <button type=\"button\" class=\"link-button\" @click=\"showAddRestaurantForm = !showAddRestaurantForm\">\r\n              {{ showAddRestaurantForm ? 'Cancel' : 'Add a new one' }}\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div v-if=\"showAddRestaurantForm\" class=\"add-restaurant-form\">\r\n          <h3 class=\"add-restaurant-header\">Add New Restaurant</h3>\r\n          <div class=\"form-group\">\r\n            <label for=\"new-rest-name\">Name</label>\r\n            <input id=\"new-rest-name\" v-model=\"newRestaurant.name\" type=\"text\" required>\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"new-rest-address\">Address</label>\r\n            <input id=\"new-rest-address\" v-model=\"newRestaurant.address\" type=\"text\" required>\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"new-rest-city\">City</label>\r\n            <input id=\"new-rest-city\" v-model=\"newRestaurant.city\" type=\"text\">\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"new-rest-state\">State</label>\r\n            <input id=\"new-rest-state\" v-model=\"newRestaurant.state\" type=\"text\">\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"new-rest-zip\">Zip Code</label>\r\n            <input id=\"new-rest-zip\" v-model=\"newRestaurant.zip\" type=\"text\">\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"url\">Website URL</label>\r\n            <input id=\"url\" v-model=\"newRestaurant.url\" type=\"url\" placeholder=\"https://example.com\" />\r\n          </div>\r\n          <button type=\"button\" class=\"btn-save-restaurant\" @click=\"saveNewRestaurant\" :disabled=\"isSavingRestaurant\">\r\n            {{ isSavingRestaurant ? 'Saving...' : 'Save Restaurant' }}\r\n          </button>\r\n          <p v-if=\"addRestaurantError\" class=\"error-message\">{{ addRestaurantError }}</p>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label>Photo</label>\r\n          <div v-if=\"!photoDataUrl\" class=\"photo-actions\">\r\n            <button type=\"button\" @click=\"openCamera\" class=\"btn-secondary\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><circle cx=\"12\" cy=\"12\" r=\"3.2\"/><path d=\"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z\"/></svg>\r\n              Take a Picture\r\n            </button>\r\n            <button type=\"button\" @click=\"triggerFileUpload\" class=\"btn-secondary\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M9 16h6v-6h4l-7-7-7 7h4v6zm3-10.17L14.17 8H13v6h-2V8H9.83L12 5.83zM5 18h14v2H5v-2z\"/></svg>\r\n              Upload Photo\r\n            </button>\r\n            <input type=\"file\" ref=\"fileInput\" @change=\"handleFileUpload\" accept=\"image/*\" style=\"display: none\">\r\n          </div>\r\n          <div v-else class=\"photo-preview\">\r\n            <img :src=\"photoDataUrl\" alt=\"Review photo preview\" />\r\n            <button type=\"button\" @click=\"removePhoto\" class=\"btn-remove-photo\" title=\"Remove Photo\">&times;</button>\r\n          </div>\r\n        </div>\r\n        <div v-if=\"isCameraOpen\" class=\"camera-modal\">\r\n          <video ref=\"videoPlayer\" class=\"camera-video\" autoplay playsinline></video>\r\n          <button type=\"button\" @click=\"capturePhoto\" class=\"btn-capture\">Capture</button>\r\n          <button type=\"button\" @click=\"closeCamera\" class=\"btn-cancel-camera\">Cancel</button>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label>Rating</label>\r\n          <div class=\"star-rating-input\">\r\n            <span v-for=\"star in 5\" :key=\"star\"\r\n              class=\"star\"\r\n              @mouseover=\"hoverRating = star\"\r\n              @mouseleave=\"hoverRating = 0\"\r\n              @click=\"rating = star\"\r\n              :title=\"`${star} star${star > 1 ? 's' : ''}`\"\r\n            >\r\n              <svg height=\"28px\" width=\"28px\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\r\n                <path :d=\"getStarPath(star)\" />\r\n              </svg>\r\n            </span>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label>Tags</label>\r\n          <div class=\"tags-container\">\r\n            <button\r\n              v-for=\"tag in tags\"\r\n              :key=\"tag.id\"\r\n              type=\"button\"\r\n              class=\"tag-btn\"\r\n              :class=\"{ selected: selectedTags.includes(tag.name) }\"\r\n              @click=\"toggleTag(tag.name)\"\r\n            >\r\n              {{ tag.name }}\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label for=\"new-tag\">Add a new tag</label>\r\n          <div class=\"new-tag-input\">\r\n            <input id=\"new-tag\" v-model.trim=\"newTag\" @keydown.enter.prevent=\"addNewTag\" placeholder=\"e.g., crispy, peppery, huge\">\r\n            <button type=\"button\" @click=\"addNewTag\" :disabled=\"!newTag.trim()\">Add Tag</button>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label for=\"comment\">Comment</label>\r\n          <textarea id=\"comment\" v-model=\"comment\" rows=\"4\" placeholder=\"How was the tenderloin?\"></textarea>\r\n          <span v-if=\"comment.length > 0\" class=\"char-count\">{{ comment.length }} characters</span>\r\n        </div>\r\n\r\n        <div v-if=\"showPreview && selectedRestaurant && rating\" class=\"review-preview\">\r\n          <h3>Preview</h3>\r\n          <div class=\"preview-content\">\r\n            <div class=\"preview-restaurant\">{{ getRestaurantName(selectedRestaurant) }}</div>\r\n            <StarRating :rating=\"rating\" />\r\n            <p v-if=\"comment\">{{ comment }}</p>\r\n            <div v-if=\"selectedTags.length > 0\" class=\"tags-container\">\r\n              <span v-for=\"tag in selectedTags\" :key=\"tag\" class=\"tag\">{{ tag }}</span>\r\n            </div>\r\n            <div v-if=\"photoDataUrl\" class=\"photo-preview\">\r\n              <img :src=\"photoDataUrl\" alt=\"Review photo preview\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"form-actions\">\r\n          <button type=\"button\" @click=\"showPreview = !showPreview\" class=\"btn-secondary\" v-if=\"selectedRestaurant && rating\">\r\n            {{ showPreview ? 'Hide Preview' : 'Preview Review' }}\r\n          </button>\r\n          <button type=\"submit\" :disabled=\"submitting || !selectedRestaurant || !rating\">\r\n            {{ submitting ? 'Submitting...' : 'Submit Review' }}\r\n          </button>\r\n        </div>\r\n        <p v-if=\"errorMessage\" class=\"error-message\">{{ errorMessage }}</p>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { ref, onMounted, nextTick } from 'vue';\r\nimport { db, auth } from '../firebase';\r\nimport { collection, getDocs, addDoc, serverTimestamp, query, orderBy, where, doc, getDoc, updateDoc, increment } from 'firebase/firestore';\r\nimport { getDistance } from '../utils/geolocation.js';\r\nimport { geocodeAddress } from '../utils/geocoding.js';\r\nimport { getStorage, ref as storageRef, uploadString, getDownloadURL } from 'firebase/storage';\r\nimport { showToast } from '../utils/toast.js';\r\n\r\nexport default {\r\n  name: 'Review',\r\n  props: {\r\n    selectedRestaurantId: {\r\n      type: String,\r\n      default: null\r\n    }\r\n  },\r\n  emits: ['reviewed'],\r\n  setup(props, { emit }) {\r\n    const restaurants = ref([]);\r\n    const selectedRestaurant = ref(props.selectedRestaurantId || null);\r\n    const rating = ref(null);\r\n    const hoverRating = ref(0);\r\n    const comment = ref('');\r\n    const submitting = ref(false);\r\n    const errorMessage = ref('');\r\n    const tags = ref([]);\r\n    const selectedTags = ref([]);\r\n    const newTag = ref('');\r\n    const showAddRestaurantForm = ref(false);\r\n    const newRestaurant = ref({ name: '', address: '', city: '', state: '', zip: '', url: '' });\r\n    const isSavingRestaurant = ref(false);\r\n    const addRestaurantError = ref('');\r\n    const isCameraOpen = ref(false);\r\n    const photoDataUrl = ref(null);\r\n    const videoPlayer = ref(null);\r\n    const stream = ref(null);\r\n    const fileInput = ref(null);\r\n    const userLocation = ref(null);\r\n    const showPreview = ref(false);\r\n\r\n    // SVG paths for stars\r\n    const fullStarPath = \"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27z\";\r\n    const emptyStarPath = \"M22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.64-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z\";\r\n\r\n    const fetchTags = async () => {\r\n      const tagsQuery = query(collection(db, 'tags'), orderBy('name'));\r\n      const tagsSnapshot = await getDocs(tagsQuery);\r\n      tags.value = tagsSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n    };\r\n\r\n    const getUserLocation = () => {\r\n      return new Promise((resolve) => {\r\n        if (navigator.geolocation && !props.selectedRestaurantId) {\r\n          navigator.geolocation.getCurrentPosition(\r\n            (position) => {\r\n              userLocation.value = {\r\n                lat: position.coords.latitude,\r\n                lng: position.coords.longitude,\r\n              };\r\n              resolve();\r\n            },\r\n            () => resolve(), // Resolve even on error to not block\r\n            { timeout: 5000 }\r\n          );\r\n        } else {\r\n          resolve();\r\n        }\r\n      });\r\n    };\r\n\r\n    const selectClosestRestaurant = () => {\r\n      if (!userLocation.value || restaurants.value.length === 0) return;\r\n\r\n      let closestRestaurant = null;\r\n      let minDistance = Infinity;\r\n\r\n      restaurants.value.forEach(restaurant => {\r\n        if (restaurant.location) {\r\n          const distance = getDistance(\r\n            userLocation.value.lat,\r\n            userLocation.value.lng,\r\n            restaurant.location.lat,\r\n            restaurant.location.lng\r\n          );\r\n          if (distance !== null && distance < minDistance) {\r\n            minDistance = distance;\r\n            closestRestaurant = restaurant;\r\n          }\r\n        }\r\n      });\r\n\r\n      if (closestRestaurant) {\r\n        selectedRestaurant.value = closestRestaurant.id;\r\n      }\r\n    };\r\n\r\n    const fetchInitialData = async () => {\r\n      if (props.selectedRestaurantId) {\r\n        const restaurantRef = doc(db, 'restaurants', props.selectedRestaurantId);\r\n        const restaurantSnap = await getDoc(restaurantRef);\r\n        if (restaurantSnap.exists()) {\r\n            restaurants.value = [{ id: restaurantSnap.id, ...restaurantSnap.data() }];\r\n        }\r\n      } else {\r\n        const restaurantsQuery = query(collection(db, 'restaurants'), orderBy('name'));\r\n        const restaurantsSnapshot = await getDocs(restaurantsQuery);\r\n        restaurants.value = restaurantsSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n        await getUserLocation();\r\n        selectClosestRestaurant();\r\n      }\r\n    };\r\n\r\n    onMounted(async () => {\r\n      await Promise.all([fetchTags(), fetchInitialData()]);\r\n    });\r\n\r\n    const getStarPath = (starIndex) => {\r\n      const displayRating = hoverRating.value || rating.value;\r\n      return displayRating >= starIndex ? fullStarPath : emptyStarPath;\r\n    };\r\n\r\n    const getRestaurantName = (restaurantId) => {\r\n      const restaurant = restaurants.value.find(r => r.id === restaurantId);\r\n      return restaurant?.name || 'Selected Restaurant';\r\n    };\r\n\r\n    const toggleTag = (tagName) => {\r\n      const index = selectedTags.value.indexOf(tagName);\r\n      if (index > -1) {\r\n        selectedTags.value.splice(index, 1);\r\n      } else {\r\n        selectedTags.value.push(tagName);\r\n      }\r\n    };\r\n\r\n    const addNewTag = async () => {\r\n      const tagName = newTag.value.toLowerCase();\r\n      if (!tagName || tags.value.some(t => t.name === tagName)) {\r\n        newTag.value = '';\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const newDocRef = await addDoc(collection(db, 'tags'), {\r\n          name: tagName,\r\n          createdAt: serverTimestamp()\r\n        });\r\n        const newTagObject = { id: newDocRef.id, name: tagName };\r\n        tags.value.push(newTagObject);\r\n        tags.value.sort((a, b) => a.name.localeCompare(b.name));\r\n        selectedTags.value.push(tagName);\r\n        newTag.value = '';\r\n      } catch (error) {\r\n        errorMessage.value = \"Failed to add new tag.\";\r\n        console.error(\"Error adding new tag: \", error);\r\n      }\r\n    };\r\n\r\n    const saveNewRestaurant = async () => {\r\n      const name = newRestaurant.value.name.trim();\r\n      const address = newRestaurant.value.address.trim();\r\n\r\n      if (!name || !address) {\r\n        addRestaurantError.value = \"Restaurant name and address are required.\";\r\n        return;\r\n      }\r\n      isSavingRestaurant.value = true;\r\n      addRestaurantError.value = '';\r\n\r\n      try {\r\n        // Check for duplicates\r\n        const q = query(collection(db, 'restaurants'), where('name', '==', name), where('address', '==', address));\r\n        const querySnapshot = await getDocs(q);\r\n\r\n        if (!querySnapshot.empty) {\r\n          addRestaurantError.value = \"This restaurant already exists in the database.\";\r\n          isSavingRestaurant.value = false;\r\n          return;\r\n        }\r\n\r\n        const fullAddress = [newRestaurant.value.address, newRestaurant.value.city, newRestaurant.value.state, newRestaurant.value.zip].filter(Boolean).join(', ');\r\n        const location = await geocodeAddress(fullAddress);\r\n\r\n        if (!location) {\r\n          addRestaurantError.value = \"Could not find a location for the provided address. Please check the address and try again.\";\r\n          isSavingRestaurant.value = false;\r\n          return;\r\n        }\r\n\r\n        // Add new restaurant\r\n        const docData = {\r\n          ...newRestaurant.value,\r\n          name,\r\n          address,\r\n          location,\r\n          createdAt: serverTimestamp(),\r\n        };\r\n        const newDocRef = await addDoc(collection(db, 'restaurants'), docData);\r\n\r\n        // Update local state\r\n        const addedRestaurant = { id: newDocRef.id, ...docData };\r\n        restaurants.value.push(addedRestaurant);\r\n        restaurants.value.sort((a, b) => a.name.localeCompare(b.name));\r\n        selectedRestaurant.value = newDocRef.id;\r\n\r\n        // Reset form\r\n        showAddRestaurantForm.value = false;\r\n        newRestaurant.value = { name: '', address: '', city: '', state: '', zip: '', url: '' };\r\n      } catch (error) {\r\n        console.error(\"Error saving new restaurant:\", error);\r\n        addRestaurantError.value = \"Failed to save restaurant. Please try again.\";\r\n      } finally {\r\n        isSavingRestaurant.value = false;\r\n      }\r\n    };\r\n\r\n    const openCamera = async () => {\r\n      isCameraOpen.value = true;\r\n      await nextTick();\r\n      try {\r\n        stream.value = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });\r\n        if (videoPlayer.value) {\r\n          videoPlayer.value.srcObject = stream.value;\r\n        }\r\n      } catch (err) {\r\n        console.error(\"Error accessing camera: \", err);\r\n        errorMessage.value = \"Could not access the camera. Please check permissions.\";\r\n        isCameraOpen.value = false;\r\n      }\r\n    };\r\n\r\n    const closeCamera = () => {\r\n      if (stream.value) {\r\n        stream.value.getTracks().forEach(track => track.stop());\r\n      }\r\n      isCameraOpen.value = false;\r\n    };\r\n\r\n    const capturePhoto = () => {\r\n      const canvas = document.createElement('canvas');\r\n      const video = videoPlayer.value;\r\n      const MAX_WIDTH = 1280;\r\n      const MAX_HEIGHT = 1280;\r\n      let width = video.videoWidth;\r\n      let height = video.videoHeight;\r\n\r\n      if (width > height) {\r\n        if (width > MAX_WIDTH) {\r\n          height *= MAX_WIDTH / width;\r\n          width = MAX_WIDTH;\r\n        }\r\n      } else {\r\n        if (height > MAX_HEIGHT) {\r\n          width *= MAX_HEIGHT / height;\r\n          height = MAX_HEIGHT;\r\n        }\r\n      }\r\n      canvas.width = width;\r\n      canvas.height = height;\r\n      const context = canvas.getContext('2d');\r\n      context.drawImage(video, 0, 0, width, height);\r\n      photoDataUrl.value = canvas.toDataURL('image/jpeg', 0.8);\r\n      closeCamera();\r\n    };\r\n\r\n    const removePhoto = () => {\r\n      photoDataUrl.value = null;\r\n    };\r\n\r\n    const triggerFileUpload = () => {\r\n      fileInput.value.click();\r\n    };\r\n\r\n    const handleFileUpload = (event) => {\r\n      const file = event.target.files[0];\r\n      if (file) {\r\n        const reader = new FileReader();\r\n        reader.onload = (e) => {\r\n          photoDataUrl.value = e.target.result;\r\n        };\r\n        reader.readAsDataURL(file);\r\n      }\r\n    };\r\n\r\n    const submitReview = async () => {\r\n      const currentUser = auth.currentUser;\r\n      if (!currentUser || !selectedRestaurant.value || !rating.value) {\r\n        errorMessage.value = \"Please select a restaurant and provide a rating.\";\r\n        return;\r\n      }\r\n      submitting.value = true;\r\n      errorMessage.value = '';\r\n\r\n      try {\r\n        let photoURL = null;\r\n        if (photoDataUrl.value) {\r\n            const storage = getStorage();\r\n            const filePath = `reviews/${currentUser.uid}/${Date.now()}.jpg`;\r\n            const photoRef = storageRef(storage, filePath);\r\n            const uploadResult = await uploadString(photoRef, photoDataUrl.value, 'data_url');\r\n            photoURL = await getDownloadURL(uploadResult.ref);\r\n        }\r\n\r\n        const timestamp = serverTimestamp();\r\n\r\n        // Add a review document\r\n        await addDoc(collection(db, 'reviews'), {\r\n          userId: currentUser.uid,\r\n          userName: currentUser.displayName || 'Anonymous',\r\n          userPhoto: currentUser.photoURL || null,\r\n          restaurantId: selectedRestaurant.value,\r\n          photoURL,\r\n          rating: rating.value,\r\n          text: comment.value,\r\n          tags: selectedTags.value,\r\n          createdAt: timestamp,\r\n          lastActivityAt: timestamp\r\n        });\r\n\r\n        // Update the user's reviewCount atomically (non-blocking - don't fail if this errors)\r\n        // Using increment() ensures thread-safe updates and handles the case where reviewCount doesn't exist yet\r\n        try {\r\n          const userRef = doc(db, 'users', currentUser.uid);\r\n          await updateDoc(userRef, { reviewCount: increment(1) });\r\n        } catch (countError) {\r\n          console.warn(\"Failed to update reviewCount (non-critical):\", countError);\r\n          // Don't fail the entire submission if reviewCount update fails\r\n        }\r\n\r\n        // Check if this restaurant is on the bucket list and mark as complete (non-blocking)\r\n        try {\r\n          const bucketListQuery = query(\r\n            collection(db, 'bucketListItems'),\r\n            where('userId', '==', currentUser.uid),\r\n            where('restaurantId', '==', selectedRestaurant.value)\r\n          );\r\n          const bucketListSnapshot = await getDocs(bucketListQuery);\r\n          if (!bucketListSnapshot.empty) {\r\n            const bucketListItemDoc = bucketListSnapshot.docs[0];\r\n            await updateDoc(bucketListItemDoc.ref, { completedAt: timestamp });\r\n          }\r\n        } catch (bucketError) {\r\n          console.warn(\"Failed to update bucket list (non-critical):\", bucketError);\r\n          // Don't fail the entire submission if bucket list update fails\r\n        }\r\n\r\n        showToast('Review submitted successfully!', 'success', 2000);\r\n        // Small delay to show success message before navigation\r\n        await new Promise(resolve => setTimeout(resolve, 500));\r\n        emit('reviewed');\r\n      } catch (error) {\r\n        console.error(\"Error submitting check-in: \", error);\r\n        errorMessage.value = \"Failed to submit check-in. Please try again.\";\r\n        showToast(\"Failed to submit check-in. Please try again.\", 'error');\r\n      } finally {\r\n        submitting.value = false;\r\n      }\r\n    };\r\n\r\n    return {\r\n      restaurants,\r\n      selectedRestaurant,\r\n      rating,\r\n      hoverRating,\r\n      comment,\r\n      submitting,\r\n      errorMessage,\r\n      getStarPath,\r\n      submitReview,\r\n      tags,\r\n      selectedTags,\r\n      newTag,\r\n      toggleTag,\r\n      addNewTag,\r\n      showAddRestaurantForm,\r\n      newRestaurant,\r\n      isSavingRestaurant,\r\n      addRestaurantError,\r\n      saveNewRestaurant,\r\n      isCameraOpen,\r\n      photoDataUrl,\r\n      videoPlayer,\r\n      openCamera, closeCamera, capturePhoto, removePhoto,\r\n      fileInput,\r\n      triggerFileUpload,\r\n      handleFileUpload,\r\n      showPreview,\r\n      getRestaurantName\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.review-page {\r\n  max-width: 700px;\r\n  margin: 0 auto;\r\n}\r\n.review-card {\r\n  background: var(--card-background);\r\n  padding: 2em;\r\n  border-radius: 12px;\r\n  box-shadow: 0 4px 15px var(--shadow-color);\r\n}\r\n.form-group {\r\n  margin-bottom: 1.5em;\r\n}\r\n.form-group label {\r\n  display: block;\r\n  margin-bottom: 0.5em;\r\n  font-weight: 600;\r\n}\r\n.form-group input[type=\"text\"],\r\n.form-group input[type=\"url\"],\r\n.form-group select,\r\n.form-group textarea {\r\n  width: 100%;\r\n  padding: 12px;\r\n  border-radius: 8px;\r\n  border: 1px solid #ddd;\r\n  box-sizing: border-box;\r\n  font-family: inherit;\r\n  font-size: 1em;\r\n}\r\n.star-rating-input {\r\n  display: flex;\r\n  gap: 0.5em;\r\n}\r\n.star {\r\n  cursor: pointer;\r\n  color: #ccc;\r\n  transition: color 0.2s;\r\n}\r\n.star:hover,\r\n.star:hover ~ .star {\r\n  color: #ccc;\r\n}\r\n.photo-actions {\r\n  display: flex;\r\n  gap: 1em;\r\n}\r\n.star-rating-input:hover .star {\r\n  color: #f39c12;\r\n}\r\n.photo-actions .btn-secondary {\r\n  background-color: #ecf0f1;\r\n  color: var(--secondary-color);\r\n  border: 1px solid #bdc3c7;\r\n  padding: 10px 15px;\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  gap: 0.5em;\r\n}\r\n.photo-preview {\r\n  position: relative;\r\n  display: inline-block;\r\n}\r\n.photo-preview img {\r\n  max-width: 100%;\r\n  max-height: 200px;\r\n  border-radius: 8px;\r\n  border: 1px solid #ddd;\r\n}\r\n.btn-remove-photo {\r\n  position: absolute;\r\n  top: -10px;\r\n  right: -10px;\r\n  background-color: #e74c3c;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 50%;\r\n  width: 28px;\r\n  height: 28px;\r\n  font-size: 1.2em;\r\n  line-height: 1;\r\n  cursor: pointer;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n.camera-modal {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: rgba(0, 0, 0, 0.9);\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 1001;\r\n}\r\n.camera-video {\r\n  width: 100%;\r\n  max-width: 800px;\r\n  height: auto;\r\n}\r\n.btn-capture, .btn-cancel-camera {\r\n  margin-top: 1em;\r\n  padding: 12px 24px;\r\n  border-radius: 8px;\r\n  border: none;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n}\r\n.btn-capture { background-color: var(--primary-color); color: white; }\r\n.btn-cancel-camera { background-color: #e74c3c; color: white; margin-left: 1em; }\r\n.add-restaurant-prompt {\r\n  font-size: 0.9em;\r\n  margin-top: 0.8em;\r\n}\r\n.link-button {\r\n  background: none;\r\n  border: none;\r\n  color: var(--primary-color);\r\n  text-decoration: underline;\r\n  cursor: pointer;\r\n  padding: 0;\r\n  font-size: inherit;\r\n}\r\n.add-restaurant-form {\r\n  border: 1px solid #ddd;\r\n  border-radius: 8px;\r\n  padding: 1.5em;\r\n  margin-top: 1.5em;\r\n  margin-bottom: 1.5em;\r\n  background-color: #f9f9f9;\r\n}\r\n.add-restaurant-header {\r\n  margin-top: 0;\r\n  margin-bottom: 1em;\r\n  font-size: 1.2em;\r\n}\r\n.btn-save-restaurant {\r\n  background-color: #27ae60;\r\n  color: white;\r\n  border: none;\r\n  padding: 10px 15px;\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n}\r\n.tags-container {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 0.5em;\r\n  margin-bottom: 1em;\r\n}\r\n.tag-btn {\r\n  background-color: #ecf0f1;\r\n  color: var(--secondary-color);\r\n  border: 1px solid #bdc3c7;\r\n  padding: 6px 12px;\r\n  border-radius: 20px;\r\n  cursor: pointer;\r\n  transition: all 0.2s;\r\n  font-size: 0.9em;\r\n}\r\n.tag-btn.selected {\r\n  background-color: var(--primary-color);\r\n  color: white;\r\n  border-color: var(--primary-color);\r\n}\r\n.char-count {\r\n  font-size: 0.85em;\r\n  color: #777;\r\n  margin-top: 0.25em;\r\n  display: block;\r\n}\r\n.review-preview {\r\n  background: var(--card-background);\r\n  border: 2px solid var(--primary-color);\r\n  border-radius: 8px;\r\n  padding: 1.5em;\r\n  margin: 1.5em 0;\r\n}\r\n.review-preview h3 {\r\n  margin: 0 0 1em 0;\r\n  color: var(--primary-color);\r\n}\r\n.preview-content {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 0.75em;\r\n}\r\n.preview-restaurant {\r\n  font-weight: 600;\r\n  font-size: 1.1em;\r\n  color: var(--text-color);\r\n}\r\n.photo-preview {\r\n  margin-top: 0.5em;\r\n}\r\n.photo-preview img {\r\n  max-width: 100%;\r\n  max-height: 300px;\r\n  border-radius: 8px;\r\n}\r\n.form-actions {\r\n  display: flex;\r\n  gap: 1em;\r\n  align-items: center;\r\n  margin-top: 1em;\r\n}\r\n.btn-secondary {\r\n  background-color: #95a5a6;\r\n  color: white;\r\n  border: none;\r\n  padding: 10px 20px;\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n}\r\n.btn-secondary:hover {\r\n  background-color: #7f8c8d;\r\n}\r\n.new-tag-input {\r\n  display: flex;\r\n  gap: 0.5em;\r\n}\r\n.new-tag-input input {\r\n  flex-grow: 1;\r\n  width: 100%;\r\n  padding: 12px;\r\n  border-radius: 8px;\r\n  border: 1px solid #ddd;\r\n  box-sizing: border-box;\r\n}\r\n.new-tag-input button {\r\n  background-color: #2ecc71;\r\n  white-space: nowrap;\r\n}\r\n.new-tag-input button:disabled {\r\n  background-color: #bdc3c7;\r\n  cursor: not-allowed;\r\n}\r\n.error-message {\r\n  color: #e74c3c;\r\n  margin-top: 1em;\r\n}\r\nbutton {\r\n  background-color: var(--primary-color);\r\n  color: white;\r\n  border: none;\r\n  padding: 12px 24px;\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n  font-size: 1em;\r\n  transition: background-color 0.2s;\r\n}\r\nbutton:disabled {\r\n  background-color: #bdc3c7;\r\n  cursor: not-allowed;\r\n}\r\n</style>","import { render } from \"./Review.vue?vue&type=template&id=ba576472&scoped=true\"\nimport script from \"./Review.vue?vue&type=script&lang=js\"\nexport * from \"./Review.vue?vue&type=script&lang=js\"\n\nimport \"./Review.vue?vue&type=style&index=0&id=ba576472&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-ba576472\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"recommendations-page\">\r\n    <div class=\"page-header\">\r\n      <h2>Top 10 Recommendations</h2>\r\n      <p>Based on reviews in the last 6 months within 100 miles of your location.</p>\r\n    </div>\r\n    <div v-if=\"loading\" class=\"loading-indicator\">Loading recommendations...</div>\r\n    <div v-else>\r\n      <p v-if=\"restaurants.length === 0\" class=\"no-restaurants-message\">\r\n        No recommendations found.\r\n      </p>\r\n      <ul v-else class=\"restaurant-list\">\r\n        <li v-for=\"restaurant in restaurants\" :key=\"restaurant.id\" class=\"restaurant-item\">\r\n          <div class=\"restaurant-details\">\r\n            <span class=\"restaurant-name\">{{ restaurant.name }}</span>\r\n            <div class=\"restaurant-meta\">\r\n              <div v-if=\"restaurant.averageRating > 0\" class=\"rating\" :title=\"`${restaurant.averageRating.toFixed(2)} average rating`\">\r\n                <StarRating :rating=\"restaurant.averageRating\" />\r\n                <span class=\"rating-text\">{{ restaurant.averageRating.toFixed(1) }}</span>\r\n                <span class=\"rating-count\">({{ restaurant.reviewCount }} recent reviews)</span>\r\n              </div>\r\n              <span v-if=\"restaurant.distance !== null\" class=\"distance\">{{ restaurant.distance.toFixed(1) }} miles away</span>\r\n            </div>\r\n            <span class=\"restaurant-address\">{{ restaurant.address }}, {{ restaurant.city }}, {{ restaurant.state }} {{ restaurant.zip }}</span>\r\n          </div>\r\n          <div class=\"restaurant-actions\">\r\n            <button @click=\"toggleBucketList(restaurant)\" class=\"action-btn\" :class=\"{ 'in-bucket-list': isInBucketList(restaurant.id) }\" :title=\"isInBucketList(restaurant.id) ? 'Remove from Bucket List' : 'Add to Bucket List'\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M18 7h-2.06c-.33-3.2-2.46-5.8-5.94-5.8S4.39 3.8 4.06 7H2v12h16V7zM6.14 7c.2-1.92 1.6-3.48 3.86-3.8A4.002 4.002 0 0 1 14 7h-2.14c-.2-1.92-1.6-3.48-3.86-3.8zM16 17H4v-8h12v8z\"/></svg>\r\n            </button>\r\n            <a :href=\"getDirectionsUrl(restaurant)\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"action-btn\" title=\"Get Directions\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M22.43 10.59l-9.01-9.01c-.75-.75-2.07-.76-2.83 0l-9.01 9.01c-.76.75-.76 2.07 0 2.83l9.01 9.01c.75.75 2.07.75 2.83 0l9.01-9.01c.75-.76.75-2.08 0-2.83zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4z\"/></svg>\r\n            </a>\r\n            <a :href=\"getDetailsUrl(restaurant)\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"action-btn\" title=\"View Details on Google\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 5 1.41-1.41L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\"/></svg>\r\n            </a>\r\n            <button class=\"check-in-btn\" @click=\"$emit('review-at', restaurant.id)\">Review</button>\r\n          </div>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, onUnmounted } from 'vue';\r\nimport { db, auth } from '../firebase';\r\nimport { collection, getDocs, query, where, Timestamp, onSnapshot, addDoc, deleteDoc, serverTimestamp } from 'firebase/firestore';\r\nimport StarRating from './StarRating.vue';\r\nimport { getDistance } from '../utils/geolocation.js';\r\n\r\nexport default {\r\n  name: 'Recommendations',\r\n  components: { StarRating },\r\n  emits: ['review-at'],\r\n  setup() {\r\n    const restaurants = ref([]);\r\n    const loading = ref(true);\r\n    const userLocation = ref(null);\r\n    const bucketList = ref(new Set());\r\n    let bucketListUnsubscribe = () => {};\r\n\r\n    const fetchRecommendations = async () => {\r\n      if (!userLocation.value) {\r\n        console.error(\"User location not available.\");\r\n        loading.value = false;\r\n        restaurants.value = [];\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const allRestaurantsSnapshot = await getDocs(collection(db, 'restaurants'));\r\n        const allRestaurants = allRestaurantsSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n\r\n        const nearbyRestaurants = allRestaurants.filter(r => {\r\n          if (!r.location || typeof r.location.lat !== 'number' || typeof r.location.lng !== 'number') {\r\n            return false;\r\n          }\r\n          const distance = getDistance(userLocation.value.lat, userLocation.value.lng, r.location.lat, r.location.lng);\r\n          r.distance = distance;\r\n          return distance !== null && distance <= 100;\r\n        });\r\n\r\n        const sixMonthsAgo = new Date();\r\n        sixMonthsAgo.setMonth(sixMonthsAgo.getMonth() - 6);\r\n        const sixMonthsAgoTimestamp = Timestamp.fromDate(sixMonthsAgo);\r\n\r\n        const reviewsQuery = query(collection(db, 'reviews'), where('createdAt', '>=', sixMonthsAgoTimestamp));\r\n        const reviewsSnapshot = await getDocs(reviewsQuery);\r\n        const recentReviews = reviewsSnapshot.docs.map(doc => doc.data());\r\n\r\n        const recommendations = nearbyRestaurants.map(restaurant => {\r\n          const relevantReviews = recentReviews.filter(review => review.restaurantId === restaurant.id && typeof review.rating === 'number');\r\n          let averageRating = 0;\r\n          let reviewCount = 0;\r\n\r\n          if (relevantReviews.length > 0) {\r\n            const totalRating = relevantReviews.reduce((sum, review) => sum + review.rating, 0);\r\n            averageRating = totalRating / relevantReviews.length;\r\n            reviewCount = relevantReviews.length;\r\n          }\r\n\r\n          return { ...restaurant, averageRating, reviewCount };\r\n        }).filter(r => r.reviewCount > 0);\r\n\r\n        recommendations.sort((a, b) => b.averageRating - a.averageRating);\r\n        restaurants.value = recommendations.slice(0, 10);\r\n\r\n      } catch (error) {\r\n        console.error(\"Error fetching recommendations:\", error);\r\n      } finally {\r\n        loading.value = false;\r\n      }\r\n    };\r\n\r\n    onMounted(() => {\r\n      if (navigator.geolocation) {\r\n        navigator.geolocation.getCurrentPosition(position => {\r\n          userLocation.value = {\r\n            lat: position.coords.latitude,\r\n            lng: position.coords.longitude\r\n          };\r\n          fetchRecommendations();\r\n          subscribeToBucketList();\r\n        }, (error) => {\r\n          console.error(\"Geolocation failed. Using default location.\", error);\r\n          userLocation.value = { lat: 41.5, lng: -90.5 }; // Default to Quad Cities\r\n          fetchRecommendations();\r\n          subscribeToBucketList();\r\n        });\r\n      } else {\r\n        console.error(\"Geolocation is not supported by this browser.\");\r\n        userLocation.value = { lat: 41.5, lng: -90.5 }; // Default to Quad Cities\r\n        fetchRecommendations();\r\n        subscribeToBucketList();\r\n      }\r\n    });\r\n\r\n    onUnmounted(() => {\r\n      bucketListUnsubscribe();\r\n    });\r\n\r\n    const getDirectionsUrl = (restaurant) => {\r\n      const destination = encodeURIComponent(`${restaurant.name}, ${restaurant.address}`);\r\n      return `https://www.google.com/maps/dir/?api=1&destination=${destination}`;\r\n    };\r\n\r\n    const getDetailsUrl = (restaurant) => {\r\n      const query = encodeURIComponent(`${restaurant.name}, ${restaurant.address}`);\r\n      return `https://www.google.com/search?q=${query}`;\r\n    };\r\n\r\n    const subscribeToBucketList = () => {\r\n      const currentUser = auth.currentUser;\r\n      if (!currentUser) return;\r\n      const q = query(collection(db, 'bucketListItems'), where('userId', '==', currentUser.uid));\r\n      bucketListUnsubscribe = onSnapshot(q, (snapshot) => {\r\n        const newBucketList = new Set();\r\n        snapshot.forEach(doc => newBucketList.add(doc.data().restaurantId));\r\n        bucketList.value = newBucketList;\r\n      });\r\n    };\r\n\r\n    const isInBucketList = (restaurantId) => {\r\n      return bucketList.value.has(restaurantId);\r\n    };\r\n\r\n    const toggleBucketList = async (restaurant) => {\r\n      const currentUser = auth.currentUser;\r\n      if (!currentUser) return;\r\n\r\n      if (isInBucketList(restaurant.id)) {\r\n        const q = query(collection(db, 'bucketListItems'), where('userId', '==', currentUser.uid), where('restaurantId', '==', restaurant.id));\r\n        const snapshot = await getDocs(q);\r\n        snapshot.forEach(doc => deleteDoc(doc.ref));\r\n      } else {\r\n        await addDoc(collection(db, 'bucketListItems'), {\r\n          userId: currentUser.uid,\r\n          restaurantId: restaurant.id,\r\n          createdAt: serverTimestamp()\r\n        });\r\n      }\r\n    };\r\n\r\n    return {\r\n      restaurants,\r\n      loading,\r\n      getDirectionsUrl,\r\n      getDetailsUrl,\r\n      isInBucketList,\r\n      toggleBucketList\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.page-header {\r\n  text-align: center;\r\n  margin-bottom: 2em;\r\n}\r\n.page-header h2 {\r\n  margin-bottom: 0.25em;\r\n}\r\n.page-header p {\r\n  color: #777;\r\n  max-width: 500px;\r\n  margin: 0 auto;\r\n}\r\n.loading-indicator, .no-restaurants-message {\r\n  text-align: center;\r\n  color: #777;\r\n  padding: 3em;\r\n}\r\n.restaurant-list {\r\n  list-style: none;\r\n  padding: 0;\r\n  margin: 0;\r\n}\r\n.restaurant-item {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 1.5em;\r\n  background: var(--card-background);\r\n  border-radius: 12px;\r\n  box-shadow: 0 4px 15px var(--shadow-color);\r\n  margin-bottom: 1.5em;\r\n}\r\n.restaurant-details {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n.restaurant-name {\r\n  font-weight: 600;\r\n  font-size: 1.2em;\r\n  margin-bottom: 0.25em;\r\n  word-break: break-word;\r\n}\r\n.restaurant-meta {\r\n  display: flex;\r\n  align-items: center;\r\n  flex-wrap: wrap;\r\n  gap: 1em;\r\n  margin-bottom: 0.5em;\r\n  color: #555;\r\n  font-size: 0.9em;\r\n}\r\n.rating {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.25em;\r\n}\r\n.rating-text {\r\n  font-weight: bold;\r\n  margin-left: 0.25em;\r\n}\r\n.rating-count {\r\n  color: #777;\r\n}\r\n.distance {\r\n  font-style: italic;\r\n}\r\n.restaurant-address {\r\n  color: #777;\r\n  font-size: 0.9em;\r\n  word-break: break-word;\r\n}\r\n.restaurant-actions {\r\n  display: flex;\r\n  gap: 0.75em;\r\n}\r\n.action-btn, .check-in-btn {\r\n  background: none;\r\n  border: 1px solid #ccc;\r\n  border-radius: 8px;\r\n  padding: 8px;\r\n  cursor: pointer;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  transition: all 0.2s;\r\n  color: #555;\r\n}\r\n.action-btn:hover {\r\n  background-color: #f0f0f0;\r\n  border-color: #bbb;\r\n}\r\n.action-btn svg {\r\n  width: 20px;\r\n  height: 20px;\r\n}\r\n.check-in-btn {\r\n  background-color: var(--primary-color);\r\n  color: white;\r\n  border-color: var(--primary-color);\r\n  padding: 8px 16px;\r\n  font-weight: 600;\r\n}\r\n.check-in-btn:hover {\r\n  background-color: var(--primary-dark-color);\r\n}\r\n.in-bucket-list {\r\n  color: var(--primary-color) !important;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .restaurant-item {\r\n    flex-direction: column;\r\n    align-items: flex-start;\r\n    gap: 1em;\r\n  }\r\n  .restaurant-actions {\r\n    width: 100%;\r\n    flex-wrap: wrap;\r\n    gap: 0.5em;\r\n  }\r\n  .restaurant-actions .action-btn,\r\n  .restaurant-actions .check-in-btn {\r\n    flex-grow: 1;\r\n    justify-content: center;\r\n  }\r\n}\r\n</style>","import { render } from \"./Recommendations.vue?vue&type=template&id=7a582d05&scoped=true\"\nimport script from \"./Recommendations.vue?vue&type=script&lang=js\"\nexport * from \"./Recommendations.vue?vue&type=script&lang=js\"\n\nimport \"./Recommendations.vue?vue&type=style&index=0&id=7a582d05&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7a582d05\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"stats-page\">\r\n    <h2>Database Stats</h2>\r\n    <div class=\"stats-container\">\r\n      <div v-if=\"statsLoading\">Loading stats...</div>\r\n      <ul v-else-if=\"stats\" class=\"stats-grid\">\r\n        <li class=\"stat-card\">\r\n          <strong>Restaurants</strong>\r\n          <span>{{ stats.restaurants }}</span>\r\n        </li>\r\n        <li class=\"stat-card\">\r\n          <strong>Users</strong>\r\n          <span>{{ stats.users }}</span>\r\n        </li>\r\n        <li class=\"stat-card\">\r\n          <strong>Reviews</strong>\r\n          <span>{{ stats.reviews }}</span>\r\n        </li>\r\n        <li class=\"stat-card\">\r\n          <strong>Follows</strong>\r\n          <span>{{ stats.follows }}</span>\r\n        </li>\r\n      </ul>\r\n      <div v-else>Could not load stats.</div>\r\n      <div v-if=\"log.length > 0\" class=\"log-container\">\r\n        <h3>Log:</h3>\r\n        <pre>{{ log.join('\\n') }}</pre>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted } from 'vue';\r\nimport { db } from '../firebase';\r\nimport { collection, getCountFromServer } from 'firebase/firestore';\r\n\r\nexport default {\r\n  name: 'DatabaseStats',\r\n  setup() {\r\n    const stats = ref(null);\r\n    const statsLoading = ref(true);\r\n    const log = ref([]);\r\n\r\n    const fetchCollectionStats = async () => {\r\n      statsLoading.value = true;\r\n      try {\r\n        const collectionsToCount = ['restaurants', 'users', 'reviews', 'follows'];\r\n        const counts = {};\r\n        const promises = collectionsToCount.map(async (colName) => {\r\n          const coll = collection(db, colName);\r\n          const snapshot = await getCountFromServer(coll);\r\n          counts[colName] = snapshot.data().count;\r\n        });\r\n        await Promise.all(promises);\r\n        stats.value = counts;\r\n      } catch (error) {\r\n        log.value.push('Error fetching collection stats: ' + error.message);\r\n        console.error(\"Error fetching stats:\", error);\r\n      } finally {\r\n        statsLoading.value = false;\r\n      }\r\n    };\r\n\r\n    onMounted(fetchCollectionStats);\r\n\r\n    return { stats, statsLoading, log };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.stats-page {\r\n  max-width: 900px;\r\n  margin: 0 auto;\r\n}\r\n.stats-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\r\n  gap: 1.5em;\r\n  list-style: none;\r\n  padding: 0;\r\n}\r\n.stat-card {\r\n  background: var(--card-background);\r\n  padding: 1.5em;\r\n  border-radius: 12px;\r\n  box-shadow: 0 4px 15px var(--shadow-color);\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 0.5em;\r\n}\r\n.stat-card strong {\r\n  font-size: 1.1em;\r\n  color: var(--text-color);\r\n}\r\n.stat-card span {\r\n  font-size: 2.5em;\r\n  font-weight: 700;\r\n  color: var(--primary-color);\r\n}\r\n.log-container {\r\n  margin-top: 24px;\r\n  background: #fff;\r\n  padding: 16px;\r\n  border-radius: 8px;\r\n  border: 1px solid #eee;\r\n}\r\npre {\r\n    white-space: pre-wrap;\r\n    word-wrap: break-word;\r\n}\r\n</style>","import { render } from \"./DatabaseStats.vue?vue&type=template&id=7fa04ecf&scoped=true\"\nimport script from \"./DatabaseStats.vue?vue&type=script&lang=js\"\nexport * from \"./DatabaseStats.vue?vue&type=script&lang=js\"\n\nimport \"./DatabaseStats.vue?vue&type=style&index=0&id=7fa04ecf&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7fa04ecf\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"my-reviews-page\">\r\n    <div v-if=\"loading\" class=\"loading-indicator\">Loading your reviews...</div>\r\n    <div v-else-if=\"populatedReviews.length === 0\" class=\"no-reviews-message\">\r\n      <h3>You haven't posted any reviews yet.</h3>\r\n      <button @click=\"$emit('go-to-review')\" class=\"btn-primary\">Post your first review!</button>\r\n    </div>\r\n    <div v-else class=\"feed\">\r\n      <div v-for=\"review in populatedReviews\" :key=\"review.id\" class=\"post-card\">\r\n        <div class=\"post-header\">\r\n          <img :src=\"review.userPhoto || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" alt=\"User\" class=\"user-avatar\" referrerpolicy=\"no-referrer\" />\r\n          <div class=\"post-info\">\r\n            <div class=\"user-line\">\r\n              <span class=\"user-name\">{{ review.userName }}</span>\r\n              <span v-if=\"review.medal\" class=\"medal\">{{ review.medal }}</span>\r\n            </div>\r\n            <span class=\"post-date\">{{ formatDate(review.createdAt) }}</span>\r\n          </div>\r\n        </div>\r\n        <div class=\"post-content\">\r\n          <div class=\"post-title-line\">\r\n            <div class=\"restaurant-title-group\">\r\n              <h2 class=\"restaurant-name\">{{ review.restaurantName }}</h2>\r\n              <div v-if=\"editingReviewId !== review.id\" class=\"review-actions\">\r\n                <button @click=\"startEditing(review)\" class=\"action-btn\" title=\"Edit Review\">\r\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"20px\" viewBox=\"0 0 24 24\" width=\"20px\" fill=\"currentColor\">\r\n                    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\r\n                    <path d=\"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z\"/>\r\n                  </svg>\r\n                </button>\r\n                <button @click=\"deleteReview(review.id)\" class=\"action-btn delete\" title=\"Delete Review\">\r\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"20px\" viewBox=\"0 0 24 24\" width=\"20px\" fill=\"currentColor\">\r\n                    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\r\n                    <path d=\"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z\"/>\r\n                  </svg>\r\n                </button>\r\n              </div>\r\n            </div>\r\n            <div v-if=\"review.distance !== null\" class=\"distance\">\r\n              {{ review.distance.toFixed(1) }} miles away\r\n            </div>\r\n          </div>\r\n          <div v-if=\"review.restaurantCity || review.restaurantState\" class=\"restaurant-location\">\r\n            {{ review.restaurantCity }}<template v-if=\"review.restaurantCity && review.restaurantState\">, </template>{{ review.restaurantState }}\r\n          </div>\r\n          <div v-if=\"editingReviewId === review.id\" class=\"edit-review-form\">\r\n            <div class=\"form-group\">\r\n              <label>Rating</label>\r\n              <StarRating :rating=\"editingRating\" :editable=\"true\" @update:rating=\"editingRating = $event\" />\r\n            </div>\r\n            <div class=\"form-group\">\r\n              <label>Comment</label>\r\n              <textarea v-model=\"editingText\" class=\"edit-textarea\" rows=\"4\"></textarea>\r\n            </div>\r\n            <div class=\"edit-actions\">\r\n              <button @click=\"saveEdit\" class=\"btn-primary\">Save</button>\r\n              <button @click=\"cancelEdit\" class=\"btn-secondary\">Cancel</button>\r\n            </div>\r\n          </div>\r\n          <div v-else class=\"review-body\">\r\n            <StarRating :rating=\"review.rating\" />\r\n            <p v-if=\"review.text\" class=\"review-text\">\"{{ review.text }}\"</p>\r\n            <img v-if=\"review.photoURL\" :src=\"review.photoURL\" alt=\"Review photo\" class=\"review-photo\" loading=\"lazy\" />\r\n            <div v-if=\"review.tags && review.tags.length > 0\" class=\"tags-container\">\r\n              <span v-for=\"tag in review.tags\" :key=\"tag\" class=\"tag\">{{ tag }}</span>\r\n            </div>\r\n          </div>\r\n          <div class=\"post-actions\">\r\n            <button @click=\"toggleLike(review.id)\" class=\"like-btn\" :class=\"{ 'liked': review.isLiked }\" :disabled=\"!user\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"20px\" viewBox=\"0 0 24 24\" width=\"20px\" fill=\"currentColor\">\r\n                <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\r\n                <path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\"/>\r\n              </svg>\r\n              <span>{{ review.likeCount || 0 }}</span>\r\n            </button>\r\n            <button @click=\"shareReview(review.id)\" class=\"share-btn\" :title=\"'Share this review'\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"20px\" viewBox=\"0 0 24 24\" width=\"20px\" fill=\"currentColor\">\r\n                <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\r\n                <path d=\"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z\"/>\r\n              </svg>\r\n              <span>Share</span>\r\n            </button>\r\n          </div>\r\n          <Comments :post-id=\"review.id\"\r\n                    :user=\"user\"\r\n                    post-type=\"reviews\"\r\n                    :post-author-id=\"review.userId\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted, onUnmounted, watch } from 'vue';\r\nimport { db, auth } from '../firebase';\r\nimport { collection, query, where, orderBy, onSnapshot, doc, updateDoc, deleteDoc, getDocs, limit, addDoc, serverTimestamp, getDoc } from 'firebase/firestore';\r\nimport StarRating from './StarRating.vue';\r\nimport Comments from './Comments.vue';\r\nimport { getDistance } from '../utils/geolocation.js';\r\nimport { showToast } from '../utils/toast.js';\r\n\r\nconst props = defineProps({\r\n  user: {\r\n    type: Object,\r\n    default: null\r\n  }\r\n});\r\n\r\ndefineEmits(['go-to-review']);\r\n\r\nconst loading = ref(true);\r\nconst reviews = ref([]);\r\nconst restaurantsMap = ref(new Map());\r\nconst editingReviewId = ref(null);\r\nconst editingText = ref('');\r\nconst editingRating = ref(0);\r\nconst originalEditData = ref(null);\r\nconst userLocation = ref(null);\r\nconst leaderboardRanks = ref(new Map());\r\n\r\nconst getMedal = (index) => {\r\n  // Medals are assigned based on position (0-indexed)\r\n  // Position 1 (index 0): Gold medal \r\n  // Position 2 (index 1): Silver medal \r\n  // Position 3 (index 2): Bronze medal \r\n  // Positions 4-10 (index 3-9): Participation medal \r\n  if (typeof index !== 'number') return null;\r\n  if (index === 0) return '';\r\n  if (index === 1) return '';\r\n  if (index === 2) return '';\r\n  if (index >= 3 && index < 10) return '';\r\n  return null;\r\n};\r\n\r\nlet reviewsUnsubscribe = () => {};\r\nlet restaurantsUnsubscribe = () => {};\r\n\r\nconst setupListeners = (currentUser) => {\r\n  if (!currentUser) {\r\n    reviews.value = [];\r\n    loading.value = false;\r\n    if (reviewsUnsubscribe) reviewsUnsubscribe();\r\n    return;\r\n  }\r\n\r\n  loading.value = true;\r\n\r\n  // Real-time listener for the user's reviews\r\n  const reviewsQuery = query(\r\n    collection(db, \"reviews\"),\r\n    where(\"userId\", \"==\", currentUser.uid),\r\n    orderBy(\"createdAt\", \"desc\")\r\n  );\r\n\r\n  reviewsUnsubscribe = onSnapshot(reviewsQuery, (snapshot) => {\r\n    reviews.value = snapshot.docs.map(doc => ({ \r\n      id: doc.id, \r\n      ...doc.data(),\r\n      likeCount: 0,\r\n      isLiked: false\r\n    }));\r\n    loading.value = false;\r\n    \r\n    // Set up like listeners for each review\r\n    reviews.value.forEach(review => {\r\n      setupLikeListener(review.id);\r\n    });\r\n  }, (error) => {\r\n    console.error(\"Error fetching reviews:\", error);\r\n    loading.value = false;\r\n  });\r\n};\r\n\r\nconst setupLikeListener = (reviewId) => {\r\n  const currentUser = props.user;\r\n  const reviewRef = doc(db, 'reviews', reviewId);\r\n  const likesCollection = collection(reviewRef, 'likes');\r\n  const likesQuery = query(likesCollection);\r\n  \r\n  onSnapshot(likesQuery, (snapshot) => {\r\n    const review = reviews.value.find(r => r.id === reviewId);\r\n    if (review) {\r\n      review.likeCount = snapshot.size;\r\n      review.isLiked = currentUser ? snapshot.docs.some(doc => doc.data().userId === currentUser.uid) : false;\r\n    }\r\n  }, (error) => {\r\n    console.error('Error fetching likes:', error);\r\n  });\r\n};\r\n\r\nconst toggleLike = async (reviewId) => {\r\n  const currentUser = props.user;\r\n  if (!currentUser) return;\r\n  \r\n  const reviewRef = doc(db, 'reviews', reviewId);\r\n  const likesCollection = collection(reviewRef, 'likes');\r\n  const likeQuery = query(likesCollection, where('userId', '==', currentUser.uid));\r\n  const likeSnap = await getDocs(likeQuery);\r\n  \r\n  if (!likeSnap.empty) {\r\n    // Unlike - delete the like document\r\n    await deleteDoc(likeSnap.docs[0].ref);\r\n  } else {\r\n    // Like - create a like document\r\n    await addDoc(likesCollection, {\r\n      userId: currentUser.uid,\r\n      createdAt: serverTimestamp()\r\n    });\r\n  }\r\n};\r\n\r\nconst shareReview = async (reviewId) => {\r\n  const baseUrl = window.location.origin;\r\n  // Use clean URL format for better social media previews\r\n  // The Cloud Function will handle /review/{reviewId} format\r\n  const shareableLink = `${baseUrl}/review/${reviewId}`;\r\n  \r\n  // Try Web Share API first (mobile-friendly)\r\n  if (navigator.share) {\r\n    try {\r\n      await navigator.share({\r\n        title: 'Check out this review on PorkHub',\r\n        text: 'Check out this review on PorkHub',\r\n        url: shareableLink\r\n      });\r\n      return;\r\n    } catch (err) {\r\n      // User cancelled or error - fall through to copy\r\n      if (err.name !== 'AbortError') {\r\n        console.error('Error sharing:', err);\r\n      }\r\n    }\r\n  }\r\n  \r\n      // Fallback: Copy to clipboard\r\n      try {\r\n        await navigator.clipboard.writeText(shareableLink);\r\n        showToast('Link copied to clipboard!', 'success');\r\n      } catch (err) {\r\n        console.error('Failed to copy link:', err);\r\n        // Fallback: Show link in prompt\r\n        const copied = prompt('Copy this link:', shareableLink);\r\n        if (copied) {\r\n          showToast('Link copied!', 'success');\r\n        }\r\n      }\r\n};\r\n\r\nonMounted(() => {\r\n  // Get user location if available\r\n  if (navigator.geolocation) {\r\n    navigator.geolocation.getCurrentPosition(position => {\r\n      userLocation.value = {\r\n        lat: position.coords.latitude,\r\n        lng: position.coords.longitude\r\n      };\r\n    }, (error) => {\r\n      console.error(\"Error getting location\", error);\r\n    });\r\n  }\r\n\r\n  // Fetch leaderboard ranks\r\n  getDocs(query(collection(db, 'users'), orderBy('reviewCount', 'desc'), limit(30))).then(leaderboardSnap => {\r\n    const usersWithReviews = leaderboardSnap.docs\r\n      .map(doc => ({ id: doc.id, ...doc.data() }))\r\n      .filter(user => {\r\n        const count = Number(user.reviewCount) || 0;\r\n        return count > 0;\r\n      })\r\n      .sort((a, b) => {\r\n        const countA = Number(a.reviewCount) || 0;\r\n        const countB = Number(b.reviewCount) || 0;\r\n        return countB - countA;\r\n      })\r\n      .slice(0, 10);\r\n    \r\n    const ranks = new Map();\r\n    usersWithReviews.forEach((user, index) => {\r\n      ranks.set(user.id, index);\r\n    });\r\n    leaderboardRanks.value = ranks;\r\n  });\r\n\r\n  // Real-time listener for all restaurants to get their names\r\n  restaurantsUnsubscribe = onSnapshot(collection(db, 'restaurants'), (snapshot) => {\r\n    const newMap = new Map();\r\n    snapshot.forEach(doc => {\r\n      newMap.set(doc.id, doc.data());\r\n    });\r\n    restaurantsMap.value = newMap;\r\n  });\r\n\r\n  // Watch for user prop changes to set up or tear down listeners\r\n  watch(() => props.user, (newUser) => {\r\n    setupListeners(newUser);\r\n  }, { immediate: true });\r\n});\r\n\r\nonUnmounted(() => {\r\n  if (reviewsUnsubscribe) reviewsUnsubscribe();\r\n  if (restaurantsUnsubscribe) restaurantsUnsubscribe();\r\n});\r\n\r\nconst populatedReviews = computed(() => {\r\n  const currentUser = props.user;\r\n  return reviews.value.map(review => {\r\n    const restaurant = restaurantsMap.value.get(review.restaurantId);\r\n    const rank = leaderboardRanks.value.get(currentUser?.uid);\r\n    return {\r\n      ...review,\r\n      restaurantName: restaurant?.name || \"Unknown Restaurant\",\r\n      restaurantCity: restaurant?.city,\r\n      restaurantState: restaurant?.state,\r\n      userName: currentUser?.displayName || 'You',\r\n      userPhoto: currentUser?.photoURL || null,\r\n      distance: userLocation.value && restaurant?.location ? getDistance(userLocation.value.lat, userLocation.value.lng, restaurant.location.lat, restaurant.location.lng) : null,\r\n      medal: getMedal(rank)\r\n    };\r\n  });\r\n});\r\n\r\nconst formatDate = (timestamp) => {\r\n  return timestamp && timestamp.toDate ? timestamp.toDate().toLocaleString() : '';\r\n};\r\n\r\nconst startEditing = (review) => {\r\n  editingReviewId.value = review.id;\r\n  editingText.value = review.text || '';\r\n  editingRating.value = review.rating || 0;\r\n  originalEditData.value = {\r\n    text: review.text || '',\r\n    rating: review.rating || 0\r\n  };\r\n};\r\n\r\nconst cancelEdit = () => {\r\n  if (originalEditData.value && \r\n      (editingText.value !== originalEditData.value.text || \r\n       editingRating.value !== originalEditData.value.rating)) {\r\n    if (confirm('You have unsaved changes. Are you sure you want to cancel?')) {\r\n      editingReviewId.value = null;\r\n      editingText.value = '';\r\n      editingRating.value = 0;\r\n      originalEditData.value = null;\r\n    }\r\n  } else {\r\n    editingReviewId.value = null;\r\n    editingText.value = '';\r\n    editingRating.value = 0;\r\n    originalEditData.value = null;\r\n  }\r\n};\r\n\r\nconst saveEdit = async () => {\r\n  if (!editingReviewId.value) return;\r\n  \r\n  try {\r\n    const reviewRef = doc(db, 'reviews', editingReviewId.value);\r\n    await updateDoc(reviewRef, {\r\n      rating: editingRating.value,\r\n      text: editingText.value,\r\n      lastActivityAt: serverTimestamp() // Update lastActivityAt when editing\r\n    });\r\n    cancelEdit();\r\n    showToast('Review updated successfully!', 'success');\r\n  } catch (error) {\r\n    console.error('Error updating review:', error);\r\n    showToast('Failed to save review. Please try again.', 'error');\r\n  }\r\n};\r\n\r\nconst deleteReview = async (reviewId) => {\r\n  if (!confirm('Are you sure you want to delete this review?')) return;\r\n  \r\n  try {\r\n    await deleteDoc(doc(db, 'reviews', reviewId));\r\n    showToast('Review deleted successfully', 'success');\r\n  } catch (error) {\r\n    console.error('Error deleting review:', error);\r\n    showToast('Failed to delete review. Please try again.', 'error');\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.my-reviews-page {\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n}\r\n\r\n.loading-indicator, .no-reviews-message {\r\n  text-align: center;\r\n  color: #777;\r\n  padding: 3em;\r\n}\r\n\r\n.no-reviews-message h3 {\r\n  margin-bottom: 0.5em;\r\n}\r\n\r\n.btn-primary {\r\n  margin-top: 1em;\r\n  background-color: var(--primary-color);\r\n  color: white;\r\n  border: none;\r\n  padding: 10px 20px;\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n}\r\n\r\n.post-card {\r\n  background: var(--card-background);\r\n  border-radius: 12px;\r\n  box-shadow: 0 4px 15px var(--shadow-color);\r\n  margin-bottom: 2em;\r\n  overflow: hidden;\r\n}\r\n\r\n.post-header {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 1em;\r\n  padding: 1em 1.5em;\r\n  border-bottom: 1px solid #eee;\r\n}\r\n\r\n.user-avatar {\r\n  width: 45px;\r\n  height: 45px;\r\n  border-radius: 50%;\r\n}\r\n\r\n.post-info {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.user-line {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5em;\r\n}\r\n\r\n.user-name {\r\n  font-weight: 600;\r\n}\r\n\r\n.medal {\r\n  font-size: 1.1em;\r\n}\r\n\r\n.post-date {\r\n  color: #7f8c8d;\r\n  font-size: 0.85em;\r\n}\r\n\r\n.post-content {\r\n  padding: 0.5em 1.5em 1.5em;\r\n}\r\n\r\n.post-title-line {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: baseline;\r\n  margin-bottom: 0.25em;\r\n}\r\n\r\n.restaurant-title-group {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5em;\r\n}\r\n\r\n.restaurant-name {\r\n  font-size: 1.1em;\r\n  font-weight: 600;\r\n  margin: 0;\r\n}\r\n\r\n.review-actions {\r\n  display: flex;\r\n  gap: 0.25em;\r\n}\r\n\r\n.action-btn {\r\n  background: none;\r\n  border: none;\r\n  cursor: pointer;\r\n  padding: 0;\r\n  display: flex;\r\n  align-items: center;\r\n  color: #555;\r\n  transition: color 0.2s;\r\n}\r\n\r\n.action-btn:hover {\r\n  color: var(--primary-color);\r\n}\r\n\r\n.action-btn.delete:hover {\r\n  color: #e74c3c;\r\n}\r\n\r\n.distance {\r\n  font-size: 0.9em;\r\n  color: #777;\r\n  font-style: italic;\r\n}\r\n\r\n.restaurant-location {\r\n  font-size: 0.9em;\r\n  color: #777;\r\n  margin-bottom: 0.75em;\r\n}\r\n\r\n.review-body {\r\n  margin-bottom: 1em;\r\n}\r\n\r\n.review-text {\r\n  font-style: italic;\r\n  color: #333;\r\n  margin: 0.5em 0;\r\n}\r\n\r\n.review-photo {\r\n  max-width: 100%;\r\n  height: auto;\r\n  border-radius: 8px;\r\n  margin: 0.5em 0;\r\n}\r\n\r\n.tags-container {\r\n  margin-top: 0.75em;\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 0.5em;\r\n}\r\n\r\n.tag {\r\n  background-color: #eee;\r\n  padding: 0.25em 0.75em;\r\n  border-radius: 15px;\r\n  font-size: 0.8em;\r\n}\r\n\r\n.edit-review-form {\r\n  margin-top: 0.5em;\r\n  padding: 1em;\r\n  background-color: #f9f9f9;\r\n  border-radius: 8px;\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 1em;\r\n}\r\n\r\n.form-group label {\r\n  display: block;\r\n  margin-bottom: 0.5em;\r\n  font-weight: 600;\r\n}\r\n\r\n.edit-textarea {\r\n  width: 100%;\r\n  padding: 12px;\r\n  border-radius: 8px;\r\n  border: 1px solid #ddd;\r\n  box-sizing: border-box;\r\n  font-family: inherit;\r\n  font-size: 1em;\r\n  resize: vertical;\r\n}\r\n\r\n.edit-actions {\r\n  display: flex;\r\n  gap: 0.5em;\r\n  margin-top: 1em;\r\n}\r\n\r\n.btn-primary, .btn-secondary {\r\n  padding: 8px 16px;\r\n  border-radius: 8px;\r\n  border: none;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n}\r\n\r\n.btn-primary {\r\n  background-color: var(--primary-color);\r\n  color: white;\r\n}\r\n\r\n.btn-secondary {\r\n  background-color: #ecf0f1;\r\n  color: #555;\r\n}\r\n\r\n.btn-secondary:hover {\r\n  background-color: #dfe6e9;\r\n}\r\n\r\n.post-actions {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-top: 0.5em;\r\n  padding-top: 0.5em;\r\n  margin-bottom: 0;\r\n  padding-bottom: 0;\r\n  border-top: 1px solid #eee;\r\n}\r\n\r\n.like-btn {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5em;\r\n  background: none;\r\n  border: none;\r\n  cursor: pointer;\r\n  padding: 0.5em 0.75em;\r\n  border-radius: 8px;\r\n  color: #555;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.like-btn:hover:not(:disabled) {\r\n  background-color: #f0f0f0;\r\n}\r\n\r\n.like-btn:disabled {\r\n  cursor: not-allowed;\r\n  opacity: 0.6;\r\n}\r\n\r\n.like-btn.liked {\r\n  color: #e74c3c;\r\n}\r\n\r\n.like-btn svg {\r\n  width: 20px;\r\n  height: 20px;\r\n  fill: currentColor;\r\n}\r\n\r\n.share-btn {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5em;\r\n  background: none;\r\n  border: none;\r\n  cursor: pointer;\r\n  padding: 0.5em 0.75em;\r\n  border-radius: 8px;\r\n  color: #555;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.share-btn:hover {\r\n  background-color: #f0f0f0;\r\n}\r\n\r\n.share-btn svg {\r\n  width: 20px;\r\n  height: 20px;\r\n  fill: currentColor;\r\n}\r\n</style>","import script from \"./MyReviews.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./MyReviews.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./MyReviews.vue?vue&type=style&index=0&id=b164e22a&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-b164e22a\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"leaderboard-page\">\r\n    <div class=\"page-header\">\r\n      <h2>Leaderboard</h2>\r\n      <p>Top 10 reviewers</p>\r\n    </div>\r\n    <div v-if=\"loading\" class=\"loading-indicator\">Loading leaderboard...</div>\r\n    <div v-else-if=\"users.length === 0\" class=\"no-users-message\">\r\n      <p>No users to display on the leaderboard yet.</p>\r\n    </div>\r\n    <ol v-else class=\"leaderboard-list\">\r\n      <li v-for=\"(user, index) in users\" :key=\"user.uid\" class=\"leaderboard-item\" :class=\"getRankClass(index)\">\r\n        <div class=\"rank-container\">\r\n          <span class=\"rank\">{{ index + 1 }}</span>\r\n          <span v-if=\"getMedal(index)\" class=\"medal\">{{ getMedal(index) }}</span>\r\n        </div>\r\n        <img :src=\"user.photoURL || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" alt=\"User\" class=\"user-avatar\" referrerpolicy=\"no-referrer\" />\r\n        <div class=\"user-info\">\r\n          <span class=\"user-name\">{{ user.displayName }}</span>\r\n          <span class=\"review-count\">{{ user.reviewCount || 0 }} reviews</span>\r\n        </div>\r\n      </li>\r\n    </ol>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, onUnmounted } from 'vue';\r\nimport { db } from '../firebase';\r\nimport { collection, query, orderBy, limit, onSnapshot } from 'firebase/firestore';\r\n\r\nexport default {\r\n  name: 'Leaderboard',\r\n  setup() {\r\n    const loading = ref(true);\r\n    const users = ref([]);\r\n    let unsubscribe = () => {};\r\n\r\n    onMounted(() => {\r\n      try {\r\n        // Fetch more users initially (e.g., 30) to account for filtering out users with 0 reviews\r\n        // After filtering and sorting, we'll display the top 10 reviewers\r\n        const usersQuery = query(\r\n          collection(db, 'users'),\r\n          orderBy('reviewCount', 'desc'),\r\n          limit(30)\r\n        );\r\n        \r\n        unsubscribe = onSnapshot(usersQuery, (querySnapshot) => {\r\n          // Map documents to user data\r\n          const fetchedUsers = querySnapshot.docs.map(doc => doc.data());\r\n          \r\n          // Filter out users with 0 or undefined reviewCount\r\n          // Only show users who have actually made reviews (leaders should have reviews)\r\n          const usersWithReviews = fetchedUsers.filter(user => {\r\n            const count = Number(user.reviewCount) || 0;\r\n            return count > 0;\r\n          });\r\n          \r\n          // Sort by reviewCount numerically in descending order (highest first)\r\n          // This ensures proper sorting even if Firestore ordering has issues\r\n          // Convert reviewCount to number for reliable numerical comparison\r\n          const sortedUsers = usersWithReviews.sort((a, b) => {\r\n            const countA = Number(a.reviewCount) || 0;\r\n            const countB = Number(b.reviewCount) || 0;\r\n            return countB - countA; // Descending order (highest first)\r\n          });\r\n          \r\n          // Take only the top 10 users after filtering and sorting\r\n          users.value = sortedUsers.slice(0, 10);\r\n          \r\n          loading.value = false;\r\n        }, (error) => {\r\n          console.error(\"Error fetching leaderboard:\", error);\r\n          loading.value = false;\r\n        });\r\n\r\n      } catch (error) {\r\n        console.error(\"Error setting up leaderboard listener:\", error);\r\n        loading.value = false;\r\n      }\r\n    });\r\n\r\n    onUnmounted(() => {\r\n      unsubscribe();\r\n    });\r\n\r\n    const getMedal = (index) => {\r\n      // Medals are assigned based on position (0-indexed)\r\n      // Position 1 (index 0): Gold medal \r\n      // Position 2 (index 1): Silver medal \r\n      // Position 3 (index 2): Bronze medal \r\n      // Positions 4-10 (index 3-9): Participation medal \r\n      if (index === 0) return '';\r\n      if (index === 1) return '';\r\n      if (index === 2) return '';\r\n      if (index >= 3 && index < 10) return '';\r\n      return null;\r\n    };\r\n\r\n    const getRankClass = (index) => {\r\n      if (index === 0) return 'rank-gold';\r\n      if (index === 1) return 'rank-silver';\r\n      if (index === 2) return 'rank-bronze';\r\n      if (index >= 3 && index < 10) return 'rank-regular';\r\n      return '';\r\n    };\r\n\r\n    return {\r\n      loading,\r\n      users,\r\n      getMedal,\r\n      getRankClass\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.leaderboard-page { max-width: 800px; margin: 0 auto; }\r\n.page-header { text-align: center; margin-bottom: 2em; }\r\n.page-header h2 { margin-bottom: 0.2em; }\r\n.page-header p { color: #777; margin-top: 0; }\r\n.loading-indicator, .no-users-message { text-align: center; color: #777; padding: 3em; }\r\n.leaderboard-list { list-style: none; padding: 0; }\r\n.leaderboard-item {\r\n  display: flex;\r\n  align-items: center;\r\n  background: var(--card-background);\r\n  border-radius: 12px;\r\n  box-shadow: 0 4px 15px var(--shadow-color);\r\n  margin-bottom: 1em;\r\n  padding: 1em 1.5em;\r\n  transition: transform 0.2s, box-shadow 0.2s;\r\n}\r\n.leaderboard-item:hover {\r\n  transform: translateY(-3px);\r\n  box-shadow: 0 6px 20px rgba(0,0,0,0.12);\r\n}\r\n.rank-container {\r\n  display: flex;\r\n  align-items: center;\r\n  font-size: 1.5em;\r\n  font-weight: 700;\r\n  color: var(--secondary-color);\r\n  margin-right: 1.5em;\r\n  width: 60px;\r\n  justify-content: center;\r\n}\r\n.medal { font-size: 1.2em; margin-left: 0.3em; }\r\n.rank-gold { border-left: 5px solid #ffd700; }\r\n.rank-silver { border-left: 5px solid #c0c0c0; }\r\n.rank-bronze { border-left: 5px solid #cd7f32; }\r\n.user-avatar {\r\n  width: 50px;\r\n  height: 50px;\r\n  border-radius: 50%;\r\n  margin-right: 1em;\r\n  object-fit: cover;\r\n}\r\n.user-info {\r\n  display: flex;\r\n  flex-direction: column;\r\n  flex-grow: 1;\r\n}\r\n.user-name {\r\n  font-weight: 600;\r\n  font-size: 1.1em;\r\n}\r\n.review-count {\r\n  color: #777;\r\n  font-size: 0.9em;\r\n}\r\n</style>","import { render } from \"./Leaderboard.vue?vue&type=template&id=7088546b&scoped=true\"\nimport script from \"./Leaderboard.vue?vue&type=script&lang=js\"\nexport * from \"./Leaderboard.vue?vue&type=script&lang=js\"\n\nimport \"./Leaderboard.vue?vue&type=style&index=0&id=7088546b&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7088546b\"]])\n\nexport default __exports__","<template>\r\n  <UserReviewsModal v-if=\"isReviewsModalVisible\" :user=\"userForReviews\" @close=\"closeReviewsModal\" />\r\n  <div class=\"followers-page\">\r\n    <div v-if=\"loading\" class=\"loading-indicator\">Loading followers...</div>\r\n    <div v-else>\r\n      <div v-if=\"followers.length === 0\" class=\"no-followers-message\">\r\n        <h3>No followers yet</h3>\r\n        <p>Start sharing reviews to attract followers! The more you review, the more visible you'll be.</p>\r\n      </div>\r\n      <div v-for=\"user in followers\" :key=\"user.uid\" class=\"user-card\">\r\n        <div class=\"user-card-content\">\r\n          <div class=\"user-info\">\r\n            <img :src=\"user.photoURL || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" class=\"user-avatar\" alt=\"User\" referrerpolicy=\"no-referrer\" />\r\n            <div class=\"user-name-line\">\r\n              <span class=\"user-name\">{{ user.displayName }}</span>\r\n              <span v-if=\"user.medal\" class=\"medal\">{{ user.medal }}</span>\r\n            </div>\r\n          </div>\r\n          <div v-if=\"user.lastReview\" class=\"last-review\">\r\n            <div class=\"review-header\">\r\n              Latest review: <strong>{{ user.lastReview.restaurantName }}</strong>\r\n            </div>\r\n            <div class=\"review-body\">\r\n              <StarRating :rating=\"user.lastReview.rating\" />\r\n              <p v-if=\"user.lastReview.text\" class=\"review-text\">\"{{ user.lastReview.text }}\"</p>\r\n            </div>\r\n          </div>\r\n          <div v-else class=\"last-review no-review\">\r\n            No reviews yet.\r\n          </div>\r\n        </div>\r\n        <div class=\"user-actions\">\r\n          <button @click=\"openReviewsModal(user)\" class=\"action-btn\" title=\"View Reviews\">\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z\"/></svg>\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted } from 'vue';\r\nimport { db, auth } from '../firebase';\r\nimport { collection, query, where, getDocs, orderBy, limit } from 'firebase/firestore';\r\nimport UserReviewsModal from './UserReviewsModal.vue';\r\nimport StarRating from './StarRating.vue';\r\n\r\nconst getMedal = (index) => {\r\n  // Medals are assigned based on position (0-indexed)\r\n  // Position 1 (index 0): Gold medal \r\n  // Position 2 (index 1): Silver medal \r\n  // Position 3 (index 2): Bronze medal \r\n  // Positions 4-10 (index 3-9): Participation medal \r\n  if (typeof index !== 'number') return null;\r\n  if (index === 0) return '';\r\n  if (index === 1) return '';\r\n  if (index === 2) return '';\r\n  if (index >= 3 && index < 10) return '';\r\n  return null;\r\n};\r\n\r\nexport default {\r\n  name: 'Followers',\r\n  components: { UserReviewsModal, StarRating },\r\n  setup() {\r\n    const followers = ref([]);\r\n    const loading = ref(true);\r\n    const isReviewsModalVisible = ref(false);\r\n    const userForReviews = ref(null);\r\n    const leaderboardRanks = ref(new Map());\r\n\r\n    const fetchFollowers = async () => {\r\n      loading.value = true;\r\n      const currentUser = auth.currentUser;\r\n      if (!currentUser) {\r\n        loading.value = false;\r\n        return;\r\n      }\r\n\r\n      // Fetch leaderboard ranks\r\n      const leaderboardSnap = await getDocs(query(collection(db, 'users'), orderBy('reviewCount', 'desc'), limit(30)));\r\n      const usersWithReviews = leaderboardSnap.docs\r\n        .map(doc => ({ id: doc.id, ...doc.data() }))\r\n        .filter(user => {\r\n          const count = Number(user.reviewCount) || 0;\r\n          return count > 0;\r\n        })\r\n        .sort((a, b) => {\r\n          const countA = Number(a.reviewCount) || 0;\r\n          const countB = Number(b.reviewCount) || 0;\r\n          return countB - countA;\r\n        })\r\n        .slice(0, 10);\r\n      \r\n      const ranks = new Map();\r\n      usersWithReviews.forEach((user, index) => {\r\n        ranks.set(user.id, index);\r\n      });\r\n      leaderboardRanks.value = ranks;\r\n\r\n      const followsQuery = query(collection(db, 'follows'), where('followingId', '==', currentUser.uid));\r\n      const followsSnap = await getDocs(followsQuery);\r\n      const followerIds = followsSnap.docs.map(doc => doc.data().followerId);\r\n\r\n      if (followerIds.length === 0) {\r\n        followers.value = [];\r\n        loading.value = false;\r\n        return;\r\n      }\r\n      \r\n      const restaurantsSnap = await getDocs(collection(db, 'restaurants'));\r\n      const restaurantsMap = new Map();\r\n      restaurantsSnap.forEach(doc => {\r\n        restaurantsMap.set(doc.id, doc.data().name);\r\n      });\r\n\r\n      const usersData = [];\r\n      for (let i = 0; i < followerIds.length; i += 30) {\r\n        const batchIds = followerIds.slice(i, i + 30);\r\n        if (batchIds.length > 0) {\r\n            const usersQuery = query(collection(db, 'users'), where('uid', 'in', batchIds));\r\n            const usersSnap = await getDocs(usersQuery);\r\n            usersSnap.forEach(doc => {\r\n                usersData.push({ uid: doc.id, ...doc.data() });\r\n            });\r\n        }\r\n      }\r\n\r\n      const followersWithDetails = await Promise.all(\r\n        usersData.map(async user => {\r\n          const reviewQuery = query(\r\n            collection(db, 'reviews'),\r\n            where('userId', '==', user.uid),\r\n            orderBy('createdAt', 'desc'),\r\n            limit(1)\r\n          );\r\n          const reviewSnap = await getDocs(reviewQuery);\r\n          let lastReview = null;\r\n          if (!reviewSnap.empty) {\r\n            const reviewData = reviewSnap.docs[0].data();\r\n            lastReview = {\r\n              ...reviewData,\r\n              restaurantName: restaurantsMap.get(reviewData.restaurantId) || 'Unknown Restaurant'\r\n            };\r\n          }\r\n          const rank = leaderboardRanks.value.get(user.uid);\r\n          return { ...user, lastReview, medal: getMedal(rank) };\r\n        })\r\n      );\r\n\r\n      followers.value = followersWithDetails;\r\n      loading.value = false;\r\n    };\r\n\r\n    onMounted(fetchFollowers);\r\n\r\n    const openReviewsModal = (user) => {\r\n      userForReviews.value = user;\r\n      isReviewsModalVisible.value = true;\r\n    };\r\n\r\n    const closeReviewsModal = () => {\r\n      isReviewsModalVisible.value = false;\r\n      userForReviews.value = null;\r\n    };\r\n\r\n    return { followers, loading, isReviewsModalVisible, userForReviews, openReviewsModal, closeReviewsModal };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.followers-page { max-width: 800px; margin: 0 auto; }\r\n.loading-indicator, .no-followers-message { \r\n  text-align: center; \r\n  color: #777; \r\n  padding: 3em 2em;\r\n  background: var(--card-background);\r\n  border-radius: 12px;\r\n  box-shadow: 0 4px 15px var(--shadow-color);\r\n}\r\n\r\n.no-followers-message h3 {\r\n  margin: 0 0 0.5em 0;\r\n  color: var(--text-color);\r\n}\r\n\r\n.no-followers-message p {\r\n  margin: 0;\r\n  font-size: 0.95em;\r\n}\r\n.user-card { display: flex; align-items: center; justify-content: space-between; background: var(--card-background); padding: 1.5em; border-radius: 12px; box-shadow: 0 4px 15px var(--shadow-color); margin-bottom: 1.5em; gap: 1.5em; }\r\n.user-card-content { flex-grow: 1; }\r\n.user-info { display: flex; align-items: center; gap: 1em; }\r\n.user-avatar { width: 60px; height: 60px; border-radius: 50%; }\r\n.user-name-line {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5em;\r\n}\r\n.user-name { font-weight: 600; font-size: 1.1em; }\r\n.medal {\r\n  font-size: 1.1em;\r\n}\r\n.user-actions .action-btn { background: none; border: 1px solid #ccc; border-radius: 8px; padding: 8px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s; color: #555; }\r\n.user-actions .action-btn:hover { background-color: #f0f0f0; border-color: #bbb; }\r\n.last-review { margin-top: 1em; padding-top: 1em; border-top: 1px solid #eee; font-size: 0.9em; }\r\n.review-header { margin-bottom: 0.5em; color: #555; }\r\n.review-body .star-rating { margin-bottom: 0.5em; }\r\n.review-text {\r\n  margin: 0.5em 0 0;\r\n  font-style: italic;\r\n  color: #333;\r\n  word-break: break-word;\r\n}\r\n.no-review { color: #888; font-style: italic; }\r\n\r\n@media (max-width: 768px) {\r\n  .user-card {\r\n    flex-direction: column;\r\n    align-items: stretch;\r\n  }\r\n  .user-actions {\r\n    margin-top: 1em;\r\n    align-self: stretch;\r\n  }\r\n  .user-actions .action-btn {\r\n    width: 100%;\r\n  }\r\n}\r\n</style>","import { render } from \"./Followers.vue?vue&type=template&id=a8a6c8f6&scoped=true\"\nimport script from \"./Followers.vue?vue&type=script&lang=js\"\nexport * from \"./Followers.vue?vue&type=script&lang=js\"\n\nimport \"./Followers.vue?vue&type=style&index=0&id=a8a6c8f6&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-a8a6c8f6\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"bucket-list-page\">\r\n    <div class=\"page-header\">\r\n      <div class=\"view-toggle\">\r\n        <button @click=\"showCompleted = false\" :class=\"{ active: !showCompleted }\">To Try</button>\r\n        <button @click=\"showCompleted = true\" :class=\"{ active: showCompleted }\">Completed</button>\r\n      </div>\r\n      <div v-if=\"filteredItems.length > 0 && selectedItems.size > 0\" class=\"batch-actions\">\r\n        <span>{{ selectedItems.size }} item(s) selected</span>\r\n        <button @click=\"removeSelectedItems\" class=\"btn-delete-batch\">Remove Selected</button>\r\n        <button @click=\"selectedItems.clear()\" class=\"btn-cancel-selection\">Cancel</button>\r\n      </div>\r\n      <button v-else-if=\"filteredItems.length > 0\" @click=\"selectAll\" class=\"btn-select-all\">Select All</button>\r\n    </div>\r\n    <div v-if=\"!currentUser\" class=\"no-items-message\">\r\n      <p>Please log in to view your bucket list.</p>\r\n    </div>\r\n    <div v-else-if=\"loading\" class=\"loading-indicator\">Loading your bucket list...</div>\r\n    <div v-else-if=\"filteredItems.length === 0\" class=\"no-items-message\">\r\n      <p v-if=\"!showCompleted\">Your bucket list is empty. Add some restaurants to try!</p>\r\n      <p v-else>You haven't completed any bucket list items yet.</p>\r\n    </div>\r\n    <div v-else class=\"restaurant-list\">\r\n      <div v-for=\"item in filteredItems\" :key=\"item.id\" class=\"restaurant-item\" :class=\"{ 'selected': selectedItems.has(item.id) }\">\r\n        <div v-if=\"selectedItems.size > 0\" class=\"item-checkbox\">\r\n          <input type=\"checkbox\" :checked=\"selectedItems.has(item.id)\" @change=\"toggleItemSelection(item.id)\" />\r\n        </div>\r\n        <!-- Restaurant details, similar to Restaurants.vue -->\r\n        <div class=\"restaurant-details\">\r\n            <span class=\"restaurant-name\">{{ item.restaurant.name }}</span>\r\n            <div class=\"restaurant-meta\">\r\n              <div v-if=\"item.restaurant.averageRating > 0\" class=\"rating\" :title=\"`${item.restaurant.averageRating.toFixed(2)} average rating`\">\r\n                <StarRating :rating=\"item.restaurant.averageRating\" />\r\n                <span class=\"rating-text\">{{ item.restaurant.averageRating.toFixed(1) }}</span>\r\n                <span class=\"rating-count\">({{ item.restaurant.ratingCount }})</span>\r\n              </div>\r\n              <span v-if=\"item.restaurant.distance !== null\" class=\"distance\">{{ item.restaurant.distance.toFixed(1) }} miles away </span>\r\n            </div>\r\n            <span class=\"restaurant-address\">\r\n              {{ item.restaurant.address }}<template v-if=\"item.restaurant.city\">, {{ item.restaurant.city }}</template><template v-if=\"item.restaurant.state\">, {{ item.restaurant.state }}</template><template v-if=\"item.restaurant.zip\"> {{ item.restaurant.zip }}</template>\r\n            </span>\r\n        </div>\r\n        <div class=\"restaurant-actions\">\r\n            <!-- Actions -->\r\n            <button @click=\"removeFromBucketList(item.id)\" class=\"action-btn delete-btn\">Remove</button>\r\n            <button class=\"check-in-btn\" @click=\"$emit('review-at', item.restaurantId)\">Review</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, onUnmounted, computed } from 'vue';\r\nimport { db, auth } from '../firebase';\r\nimport { collection, query, where, getDocs, onSnapshot, doc, deleteDoc, documentId } from 'firebase/firestore';\r\nimport StarRating from './StarRating.vue';\r\nimport { getDistance } from '../utils/geolocation.js';\r\nimport { showToast } from '../utils/toast.js';\r\n\r\nexport default {\r\n  name: 'BucketList',\r\n  components: { StarRating },\r\n  emits: ['review-at'],\r\n  setup() {\r\n    const bucketListItems = ref([]);\r\n    const loading = ref(true);\r\n    const showCompleted = ref(false);\r\n    const userLocation = ref(null);\r\n    const currentUser = ref(auth.currentUser);\r\n    const selectedItems = ref(new Set());\r\n    let unsubscribe = () => {};\r\n\r\n    // Watch for auth state changes\r\n    auth.onAuthStateChanged((user) => {\r\n      currentUser.value = user;\r\n      if (!user) {\r\n        loading.value = false;\r\n        bucketListItems.value = [];\r\n        if (unsubscribe) unsubscribe();\r\n      } else {\r\n        fetchBucketList();\r\n      }\r\n    });\r\n\r\n    const fetchBucketList = () => {\r\n      const user = auth.currentUser;\r\n      if (!user) {\r\n        loading.value = false;\r\n        bucketListItems.value = [];\r\n        return;\r\n      }\r\n\r\n      const q = query(collection(db, 'bucketListItems'), where('userId', '==', user.uid));\r\n      \r\n      unsubscribe = onSnapshot(q, async (snapshot) => {\r\n        loading.value = true;\r\n        \r\n        try {\r\n          const items = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n          \r\n          if (items.length === 0) {\r\n            bucketListItems.value = [];\r\n            loading.value = false;\r\n            return;\r\n          }\r\n\r\n          const restaurantIds = [...new Set(items.map(item => item.restaurantId).filter(Boolean))];\r\n          const restaurantsMap = new Map();\r\n          \r\n          if (restaurantIds.length > 0) {\r\n              // Batch fetch restaurants\r\n              for (let i = 0; i < restaurantIds.length; i += 30) {\r\n                const batchIds = restaurantIds.slice(i, i + 30);\r\n                const restaurantsQuery = query(collection(db, 'restaurants'), where(documentId(), 'in', batchIds));\r\n                const restaurantsSnapshot = await getDocs(restaurantsQuery);\r\n                restaurantsSnapshot.forEach(doc => restaurantsMap.set(doc.id, { id: doc.id, ...doc.data() }));\r\n              }\r\n\r\n              // Batch fetch review counts and ratings\r\n              const reviewsQuery = query(collection(db, 'reviews'), where('restaurantId', 'in', restaurantIds));\r\n              const reviewsSnapshot = await getDocs(reviewsQuery);\r\n              const ratings = {};\r\n              reviewsSnapshot.forEach(doc => {\r\n                const review = doc.data();\r\n                if (review.restaurantId && typeof review.rating === 'number') {\r\n                  if (!ratings[review.restaurantId]) {\r\n                    ratings[review.restaurantId] = { total: 0, count: 0 };\r\n                  }\r\n                  ratings[review.restaurantId].total += review.rating;\r\n                  ratings[review.restaurantId].count++;\r\n                }\r\n              });\r\n\r\n              bucketListItems.value = items.map(item => {\r\n                const restaurant = restaurantsMap.get(item.restaurantId);\r\n                if (!restaurant) return null;\r\n\r\n                const ratingInfo = ratings[restaurant.id];\r\n                restaurant.averageRating = ratingInfo ? ratingInfo.total / ratingInfo.count : 0;\r\n                restaurant.ratingCount = ratingInfo ? ratingInfo.count : 0;\r\n                restaurant.distance = userLocation.value && restaurant.location ? getDistance(userLocation.value.lat, userLocation.value.lng, restaurant.location.lat, restaurant.location.lng) : null;\r\n\r\n                return { ...item, restaurant };\r\n              }).filter(Boolean);\r\n          } else {\r\n              // No valid restaurant IDs found in items\r\n              bucketListItems.value = [];\r\n          }\r\n        } catch (error) {\r\n          console.error('Error loading bucket list:', error);\r\n          bucketListItems.value = [];\r\n        } finally {\r\n          loading.value = false;\r\n        }\r\n      }, (error) => {\r\n        console.error('Error in bucket list snapshot:', error);\r\n        bucketListItems.value = [];\r\n        loading.value = false;\r\n      });\r\n    };\r\n\r\n    onMounted(() => {\r\n      // Get user location if available, but don't block on it\r\n      if (navigator.geolocation) {\r\n        navigator.geolocation.getCurrentPosition(position => {\r\n          userLocation.value = {\r\n            lat: position.coords.latitude,\r\n            lng: position.coords.longitude\r\n          };\r\n          // Location updated - refresh distances if bucket list is already loaded\r\n          if (bucketListItems.value.length > 0 && currentUser.value) {\r\n            fetchBucketList();\r\n          }\r\n        }, (error) => {\r\n          console.error(\"Error getting location for bucket list\", error);\r\n        });\r\n      }\r\n      \r\n      // Fetch bucket list if user is already logged in (onAuthStateChanged handles new logins)\r\n      if (currentUser.value) {\r\n        fetchBucketList();\r\n      } else {\r\n        loading.value = false;\r\n      }\r\n    });\r\n\r\n    onUnmounted(() => {\r\n      unsubscribe();\r\n    });\r\n\r\n    const filteredItems = computed(() => {\r\n      const filtered = bucketListItems.value.filter(item => {\r\n        return showCompleted.value ? !!item.completedAt : !item.completedAt;\r\n      });\r\n      return filtered.sort((a, b) => {\r\n        if (a.restaurant.distance === null) return 1;\r\n        if (b.restaurant.distance === null) return -1;\r\n        return a.restaurant.distance - b.restaurant.distance;\r\n      });\r\n    });\r\n\r\n    const removeFromBucketList = async (itemId) => {\r\n      if (confirm('Are you sure you want to remove this from your bucket list?')) {\r\n        try {\r\n          await deleteDoc(doc(db, 'bucketListItems', itemId));\r\n          showToast('Removed from bucket list', 'success');\r\n        } catch (error) {\r\n          console.error('Error removing from bucket list:', error);\r\n          showToast('Failed to remove item. Please try again.', 'error');\r\n        }\r\n      }\r\n    };\r\n\r\n    const toggleItemSelection = (itemId) => {\r\n      if (selectedItems.value.has(itemId)) {\r\n        selectedItems.value.delete(itemId);\r\n      } else {\r\n        selectedItems.value.add(itemId);\r\n      }\r\n    };\r\n\r\n    const selectAll = () => {\r\n      filteredItems.value.forEach(item => {\r\n        selectedItems.value.add(item.id);\r\n      });\r\n    };\r\n\r\n    const removeSelectedItems = async () => {\r\n      if (selectedItems.value.size === 0) return;\r\n      if (!confirm(`Are you sure you want to remove ${selectedItems.value.size} item(s) from your bucket list?`)) return;\r\n      \r\n      try {\r\n        const deletePromises = Array.from(selectedItems.value).map(itemId => \r\n          deleteDoc(doc(db, 'bucketListItems', itemId))\r\n        );\r\n        await Promise.all(deletePromises);\r\n        showToast(`Removed ${selectedItems.value.size} item(s) from bucket list`, 'success');\r\n        selectedItems.value.clear();\r\n      } catch (error) {\r\n        console.error('Error removing items:', error);\r\n        showToast('Failed to remove items. Please try again.', 'error');\r\n      }\r\n    };\r\n\r\n    const getDirectionsUrl = (restaurant) => {\r\n      const destination = encodeURIComponent(`${restaurant.name}, ${restaurant.address}`);\r\n      return `https://www.google.com/maps/dir/?api=1&destination=${destination}`;\r\n    };\r\n\r\n    const getDetailsUrl = (restaurant) => {\r\n      const query = encodeURIComponent(`${restaurant.name}, ${restaurant.address}`);\r\n      return `https://www.google.com/search?q=${query}`;\r\n    };\r\n\r\n    return {\r\n      loading,\r\n      showCompleted,\r\n      filteredItems,\r\n      selectedItems,\r\n      removeFromBucketList,\r\n      toggleItemSelection,\r\n      selectAll,\r\n      removeSelectedItems,\r\n      getDirectionsUrl,\r\n      getDetailsUrl,\r\n      currentUser\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* styles for BucketList.vue */\r\n.bucket-list-page {\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n}\r\n.page-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  flex-wrap: wrap;\r\n  gap: 1em;\r\n  margin-bottom: 2em;\r\n}\r\n\r\n.batch-actions {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 1em;\r\n}\r\n\r\n.btn-delete-batch,\r\n.btn-cancel-selection,\r\n.btn-select-all {\r\n  padding: 8px 16px;\r\n  border: none;\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n  font-size: 0.9em;\r\n}\r\n\r\n.btn-delete-batch {\r\n  background-color: #e74c3c;\r\n  color: white;\r\n}\r\n\r\n.btn-delete-batch:hover {\r\n  background-color: #c0392b;\r\n}\r\n\r\n.btn-cancel-selection,\r\n.btn-select-all {\r\n  background-color: #95a5a6;\r\n  color: white;\r\n}\r\n\r\n.btn-cancel-selection:hover,\r\n.btn-select-all:hover {\r\n  background-color: #7f8c8d;\r\n}\r\n.view-toggle button {\r\n  background: none;\r\n  border: 1px solid #ccc;\r\n  padding: 8px 16px;\r\n  cursor: pointer;\r\n}\r\n.view-toggle button.active {\r\n  background-color: var(--primary-color);\r\n  color: white;\r\n  border-color: var(--primary-color);\r\n}\r\n.view-toggle button:first-child {\r\n  border-top-left-radius: 8px;\r\n  border-bottom-left-radius: 8px;\r\n}\r\n.view-toggle button:last-child {\r\n  border-top-right-radius: 8px;\r\n  border-bottom-right-radius: 8px;\r\n  border-left: none;\r\n}\r\n.loading-indicator, .no-items-message {\r\n  text-align: center;\r\n  color: #777;\r\n  padding: 3em;\r\n}\r\n.restaurant-list {\r\n  list-style: none;\r\n  padding: 0;\r\n  margin: 0;\r\n}\r\n.restaurant-item {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 1.5em;\r\n  background: var(--card-background);\r\n  border-radius: 12px;\r\n  box-shadow: 0 4px 15px var(--shadow-color);\r\n  margin-bottom: 1.5em;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.restaurant-item.selected {\r\n  background: rgba(52, 152, 219, 0.1);\r\n  border: 2px solid #3498db;\r\n}\r\n\r\n.item-checkbox {\r\n  margin-right: 1em;\r\n}\r\n\r\n.item-checkbox input[type=\"checkbox\"] {\r\n  width: 20px;\r\n  height: 20px;\r\n  cursor: pointer;\r\n}\r\n.restaurant-details {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n.restaurant-name {\r\n  font-weight: 600;\r\n  font-size: 1.2em;\r\n  margin-bottom: 0.25em;\r\n}\r\n.restaurant-meta {\r\n  display: flex;\r\n  align-items: center;\r\n  flex-wrap: wrap;\r\n  gap: 1em;\r\n  margin-bottom: 0.5em;\r\n  color: #555;\r\n  font-size: 0.9em;\r\n}\r\n.rating {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.25em;\r\n}\r\n.rating-text {\r\n  font-weight: bold;\r\n  margin-left: 0.25em;\r\n}\r\n.rating-count {\r\n  color: #777;\r\n}\r\n.distance {\r\n  font-style: italic;\r\n}\r\n.restaurant-address {\r\n  color: #777;\r\n  font-size: 0.9em;\r\n}\r\n.restaurant-actions {\r\n  display: flex;\r\n  gap: 0.75em;\r\n}\r\n.action-btn, .check-in-btn {\r\n  background: none;\r\n  border: 1px solid #ccc;\r\n  border-radius: 8px;\r\n  padding: 8px;\r\n  cursor: pointer;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  transition: all 0.2s;\r\n  color: #555;\r\n}\r\n.action-btn:hover {\r\n  background-color: #f0f0f0;\r\n  border-color: #bbb;\r\n}\r\n.delete-btn {\r\n  color: #e74c3c;\r\n  border-color: #e74c3c;\r\n}\r\n.delete-btn:hover {\r\n  background-color: #e74c3c;\r\n  color: white;\r\n}\r\n.check-in-btn {\r\n  background-color: var(--primary-color);\r\n  color: white;\r\n  border-color: var(--primary-color);\r\n  padding: 8px 16px;\r\n  font-weight: 600;\r\n}\r\n.check-in-btn:hover {\r\n  background-color: var(--primary-dark-color);\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .restaurant-item {\r\n    flex-direction: column;\r\n    align-items: flex-start;\r\n    gap: 1em;\r\n  }\r\n  .restaurant-actions {\r\n    width: 100%;\r\n    flex-wrap: wrap;\r\n    gap: 0.5em;\r\n  }\r\n  .restaurant-actions .action-btn,\r\n  .restaurant-actions .check-in-btn {\r\n    flex-grow: 1;\r\n    text-align: center;\r\n  }\r\n}\r\n</style>","import { render } from \"./BucketList.vue?vue&type=template&id=11aea084&scoped=true\"\nimport script from \"./BucketList.vue?vue&type=script&lang=js\"\nexport * from \"./BucketList.vue?vue&type=script&lang=js\"\n\nimport \"./BucketList.vue?vue&type=style&index=0&id=11aea084&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-11aea084\"]])\n\nexport default __exports__","<template>\r\n  <UserReviewsModal v-if=\"isReviewsModalVisible\" :user=\"userForReviews\" @close=\"closeReviewsModal\" />\r\n  <div class=\"following-page\">\r\n    <div v-if=\"loading\" class=\"loading-indicator\">Loading users you follow...</div>\r\n    <div v-else>\r\n      <div v-if=\"following.length === 0\" class=\"no-users-message\">\r\n        <h3>Not following anyone yet</h3>\r\n        <p>Visit the \"Follow Users\" page to discover and follow other reviewers to see their posts in your feed.</p>\r\n      </div>\r\n      <div v-for=\"user in following\" :key=\"user.uid\" class=\"user-card\">\r\n        <div class=\"user-card-content\">\r\n          <div class=\"user-info\">\r\n            <img :src=\"user.photoURL || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" class=\"user-avatar\" alt=\"User\" referrerpolicy=\"no-referrer\" />\r\n            <div class=\"user-details\">\r\n              <div class=\"user-name-line\">\r\n                <span class=\"user-name\">{{ user.displayName }}</span>\r\n                <span v-if=\"user.medal\" class=\"medal\">{{ user.medal }}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div v-if=\"user.lastReview\" class=\"last-review\">\r\n            <div class=\"review-header\">\r\n              Latest review: <strong>{{ user.lastReview.restaurantName }}</strong>\r\n            </div>\r\n            <div class=\"review-body\">\r\n              <StarRating :rating=\"user.lastReview.rating\" />\r\n              <p v-if=\"user.lastReview.text\" class=\"review-text\">\"{{ user.lastReview.text }}\"</p>\r\n            </div>\r\n          </div>\r\n          <div v-else class=\"last-review no-review\">\r\n            No reviews yet.\r\n          </div>\r\n        </div>\r\n        <div class=\"user-actions\">\r\n          <button @click=\"openReviewsModal(user)\" class=\"action-btn\" title=\"View Reviews\">\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z\"/></svg>\r\n          </button>\r\n          <button @click=\"unfollowUser(user)\" class=\"unfollow-btn\">Unfollow</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, onUnmounted } from 'vue';\r\nimport { db, auth } from '../firebase';\r\nimport { collection, query, where, getDocs, doc, deleteDoc, orderBy, limit, onSnapshot } from 'firebase/firestore';\r\nimport StarRating from './StarRating.vue';\r\nimport UserReviewsModal from './UserReviewsModal.vue';\r\nimport { showToast } from '../utils/toast.js';\r\n\r\nconst getMedal = (index) => {\r\n  // Medals are assigned based on position (0-indexed)\r\n  // Position 1 (index 0): Gold medal \r\n  // Position 2 (index 1): Silver medal \r\n  // Position 3 (index 2): Bronze medal \r\n  // Positions 4-10 (index 3-9): Participation medal \r\n  if (typeof index !== 'number') return null;\r\n  if (index === 0) return '';\r\n  if (index === 1) return '';\r\n  if (index === 2) return '';\r\n  if (index >= 3 && index < 10) return '';\r\n  return null;\r\n};\r\n\r\nexport default {\r\n  name: 'Following',\r\n  components: { StarRating, UserReviewsModal },\r\n  setup() {\r\n    const following = ref([]);\r\n    const loading = ref(true);\r\n    const isReviewsModalVisible = ref(false);\r\n    const userForReviews = ref(null);\r\n    const leaderboardRanks = ref(new Map());\r\n    let unsubscribe = () => {};\r\n\r\n    const fetchFollowing = async () => {\r\n      loading.value = true;\r\n      const currentUser = auth.currentUser;\r\n      if (!currentUser) {\r\n        loading.value = false;\r\n        return;\r\n      }\r\n\r\n      // Fetch leaderboard ranks\r\n      const leaderboardSnap = await getDocs(query(collection(db, 'users'), orderBy('reviewCount', 'desc'), limit(30)));\r\n      const usersWithReviews = leaderboardSnap.docs\r\n        .map(doc => ({ id: doc.id, ...doc.data() }))\r\n        .filter(user => {\r\n          const count = Number(user.reviewCount) || 0;\r\n          return count > 0;\r\n        })\r\n        .sort((a, b) => {\r\n          const countA = Number(a.reviewCount) || 0;\r\n          const countB = Number(b.reviewCount) || 0;\r\n          return countB - countA;\r\n        })\r\n        .slice(0, 10);\r\n      \r\n      const ranks = new Map();\r\n      usersWithReviews.forEach((user, index) => {\r\n        ranks.set(user.id, index);\r\n      });\r\n      leaderboardRanks.value = ranks;\r\n\r\n      const followsQuery = query(collection(db, 'follows'), where('followerId', '==', currentUser.uid));      \r\n      unsubscribe = onSnapshot(followsQuery, async (followsSnap) => {\r\n        const followingIds = followsSnap.docs.map(doc => doc.data().followingId);\r\n\r\n      if (followingIds.length === 0) {\r\n        following.value = [];\r\n        loading.value = false;\r\n        return;\r\n      }\r\n\r\n      const restaurantsSnap = await getDocs(collection(db, 'restaurants'));\r\n      const restaurantsMap = new Map();\r\n      restaurantsSnap.forEach(doc => {\r\n        restaurantsMap.set(doc.id, doc.data().name);\r\n      });\r\n\r\n      const usersData = [];\r\n      // Firestore 'in' query supports a maximum of 30 elements in the array.\r\n      for (let i = 0; i < followingIds.length; i += 30) {\r\n        const batchIds = followingIds.slice(i, i + 30);\r\n        if (batchIds.length > 0) {\r\n            const usersQuery = query(collection(db, 'users'), where('uid', 'in', batchIds));\r\n            const usersSnap = await getDocs(usersQuery);\r\n            usersSnap.forEach(doc => {\r\n                usersData.push({ uid: doc.id, ...doc.data() });\r\n            });\r\n        }\r\n      }\r\n\r\n      const followingWithDetails = await Promise.all(\r\n        usersData.map(async user => {\r\n          const reviewQuery = query(\r\n            collection(db, 'reviews'),\r\n            where('userId', '==', user.uid),\r\n            orderBy('createdAt', 'desc'),\r\n            limit(1)\r\n          );\r\n          const reviewSnap = await getDocs(reviewQuery);\r\n          let lastReview = null;\r\n          if (!reviewSnap.empty) {\r\n            const reviewData = reviewSnap.docs[0].data();\r\n            lastReview = {\r\n              ...reviewData,\r\n              restaurantName: restaurantsMap.get(reviewData.restaurantId) || 'Unknown Restaurant'\r\n            };\r\n          }\r\n          const rank = leaderboardRanks.value.get(user.uid);\r\n          return { ...user, lastReview, medal: getMedal(rank) };\r\n        })\r\n      );\r\n\r\n      following.value = followingWithDetails;\r\n      loading.value = false;\r\n      });\r\n    };\r\n\r\n    onMounted(fetchFollowing);\r\n    onUnmounted(() => unsubscribe());\r\n\r\n    const unfollowUser = async (userToUnfollow) => {\r\n      const currentUser = auth.currentUser;\r\n      if (!currentUser || !window.confirm(`Are you sure you want to unfollow ${userToUnfollow.displayName}?`)) return;\r\n\r\n      try {\r\n        const q = query(collection(db, 'follows'), where('followerId', '==', currentUser.uid), where('followingId', '==', userToUnfollow.uid));\r\n        const querySnapshot = await getDocs(q);\r\n        if (!querySnapshot.empty) {\r\n          const docId = querySnapshot.docs[0].id;\r\n          await deleteDoc(doc(db, 'follows', docId));\r\n          showToast(`Unfollowed ${userToUnfollow.displayName}`, 'success');\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error unfollowing user:\", error);\r\n        showToast(\"Failed to unfollow user. Please try again.\", 'error');\r\n      }\r\n    };\r\n\r\n    const openReviewsModal = (user) => {\r\n      userForReviews.value = user;\r\n      isReviewsModalVisible.value = true;\r\n    };\r\n\r\n    const closeReviewsModal = () => {\r\n      isReviewsModalVisible.value = false;\r\n      userForReviews.value = null;\r\n    };\r\n\r\n    return { following, loading, unfollowUser, isReviewsModalVisible, userForReviews, openReviewsModal, closeReviewsModal };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.following-page { max-width: 800px; margin: 0 auto; }\r\n.loading-indicator, .no-users-message { text-align: center; color: #777; padding: 2em; }\r\n.user-card { display: flex; align-items: center; justify-content: space-between; background: var(--card-background); padding: 1.5em; border-radius: 12px; box-shadow: 0 4px 15px var(--shadow-color); margin-bottom: 1.5em; gap: 1.5em; }\r\n.user-card-content { flex-grow: 1; min-width: 0; }\r\n.user-info { display: flex; align-items: center; gap: 1em; min-width: 0; }\r\n.user-details { min-width: 0; }\r\n.user-avatar { width: 60px; height: 60px; border-radius: 50%; flex-shrink: 0; }\r\n.user-name-line {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5em;\r\n}\r\n.user-name { font-weight: 600; font-size: 1.1em; word-break: break-word; }\r\n.medal {\r\n  font-size: 1.1em;\r\n}\r\n.user-actions { display: flex; gap: 0.75em; }\r\n.user-actions .action-btn { background: none; border: 1px solid #ccc; border-radius: 8px; padding: 8px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s; color: #555; }\r\n.user-actions .action-btn:hover { background-color: #f0f0f0; border-color: #bbb; }\r\n.user-actions button.unfollow-btn { background-color: #e74c3c; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; transition: background-color 0.2s; }\r\n.user-actions button.unfollow-btn:hover { opacity: 0.9; }\r\n.last-review { margin-top: 1em; padding-top: 1em; border-top: 1px solid #eee; font-size: 0.9em; }\r\n.review-header { margin-bottom: 0.5em; color: #555; word-break: break-word; }\r\n.review-body .star-rating { margin-bottom: 0.5em; }\r\n.review-text {\r\n  margin: 0.5em 0 0;\r\n  font-style: italic;\r\n  color: #333;\r\n  word-break: break-word;\r\n}\r\n.no-review { color: #888; font-style: italic; }\r\n\r\n@media (max-width: 768px) {\r\n  .user-card { flex-direction: column; align-items: stretch; }\r\n  .user-actions { margin-top: 1em; }\r\n  .user-actions button { flex-grow: 1; justify-content: center; }\r\n}\r\n</style>","import { render } from \"./Following.vue?vue&type=template&id=614462e6&scoped=true\"\nimport script from \"./Following.vue?vue&type=script&lang=js\"\nexport * from \"./Following.vue?vue&type=script&lang=js\"\n\nimport \"./Following.vue?vue&type=style&index=0&id=614462e6&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-614462e6\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"modal-overlay\" @click.self=\"$emit('close')\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h2>Review</h2>\r\n        <button @click=\"$emit('close')\" class=\"close-btn\">&times;</button>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <div v-if=\"loading\" class=\"loading-indicator\">Loading review...</div>\r\n        <div v-else-if=\"error\" class=\"error-message\">{{ error }}</div>\r\n        <div v-else-if=\"review\" class=\"review-detail\">\r\n          <div class=\"post-header\">\r\n            <img :src=\"review.userPhoto || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" alt=\"User\" class=\"user-avatar\" referrerpolicy=\"no-referrer\" />\r\n            <div class=\"post-info\">\r\n              <div class=\"user-line\">\r\n                <span class=\"user-name\">{{ review.userName }}</span>\r\n                <span v-if=\"review.medal\" class=\"medal\">{{ review.medal }}</span>\r\n              </div>\r\n              <span class=\"post-date\">{{ formatDate(review.createdAt) }}</span>\r\n            </div>\r\n          </div>\r\n          <div class=\"post-content\">\r\n            <div class=\"post-title-line\">\r\n              <h2 class=\"restaurant-name\">{{ review.restaurantName }}</h2>\r\n              <div v-if=\"review.distance !== null\" class=\"distance\">\r\n                {{ review.distance.toFixed(1) }} miles away\r\n              </div>\r\n            </div>\r\n            <div v-if=\"review.restaurantCity || review.restaurantState\" class=\"restaurant-location\">\r\n              {{ review.restaurantCity }}<template v-if=\"review.restaurantCity && review.restaurantState\">, </template>{{ review.restaurantState }}\r\n            </div>\r\n            <div class=\"review-body\">\r\n              <StarRating :rating=\"review.rating\" />\r\n              <p v-if=\"review.text\" class=\"review-text\">\"{{ review.text }}\"</p>\r\n              <img v-if=\"review.photoURL\" :src=\"review.photoURL\" alt=\"Review photo\" class=\"review-photo\" />\r\n              <div v-if=\"review.tags && review.tags.length > 0\" class=\"tags-container\">\r\n                <span v-for=\"tag in review.tags\" :key=\"tag\" class=\"tag\">{{ tag }}</span>\r\n              </div>\r\n            </div>\r\n            <div class=\"post-actions\">\r\n              <button @click=\"toggleLike\" class=\"like-btn\" :class=\"{ 'liked': review.isLiked }\" :disabled=\"!user\">\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"20px\" viewBox=\"0 0 24 24\" width=\"20px\" fill=\"currentColor\">\r\n                  <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\r\n                  <path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\"/>\r\n                </svg>\r\n                <span>{{ review.likeCount || 0 }}</span>\r\n              </button>\r\n            </div>\r\n            <Comments :post-id=\"review.id\"\r\n                      :user=\"user\"\r\n                      post-type=\"reviews\"\r\n                      :post-author-id=\"review.userId\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, watch, onUnmounted } from 'vue';\r\nimport { db } from '../firebase';\r\nimport { doc, getDoc, collection, query, onSnapshot, addDoc, deleteDoc, getDocs, where, serverTimestamp, orderBy, limit } from 'firebase/firestore';\r\nimport StarRating from './StarRating.vue';\r\nimport Comments from './Comments.vue';\r\nimport { getDistance } from '../utils/geolocation.js';\r\nimport { updateMetaTags, resetMetaTags } from '../utils/meta.js';\r\n\r\nexport default {\r\n  name: 'ReviewDetailModal',\r\n  components: { StarRating, Comments },\r\n  props: {\r\n    reviewId: {\r\n      type: String,\r\n      required: true\r\n    },\r\n    user: {\r\n      type: Object,\r\n      default: null\r\n    }\r\n  },\r\n  emits: ['close'],\r\n  setup(props) {\r\n    const review = ref(null);\r\n    const loading = ref(true);\r\n    const error = ref('');\r\n    const restaurantsMap = ref(new Map());\r\n    const leaderboardRanks = ref(new Map());\r\n    const userLocation = ref(null);\r\n    let likeUnsubscribe = () => {};\r\n\r\n    const getMedal = (index) => {\r\n      if (typeof index !== 'number') return null;\r\n      if (index === 0) return '';\r\n      if (index === 1) return '';\r\n      if (index === 2) return '';\r\n      if (index >= 3 && index < 10) return '';\r\n      return null;\r\n    };\r\n\r\n    const formatDate = (timestamp) => {\r\n      if (!timestamp || !timestamp.toDate) return '';\r\n      return timestamp.toDate().toLocaleString();\r\n    };\r\n\r\n    const fetchReview = async () => {\r\n      loading.value = true;\r\n      error.value = '';\r\n      \r\n      try {\r\n        // Fetch restaurant data\r\n        const restaurantsSnap = await getDocs(collection(db, 'restaurants'));\r\n        restaurantsSnap.forEach(doc => {\r\n          restaurantsMap.value.set(doc.id, doc.data());\r\n        });\r\n\r\n        // Fetch leaderboard ranks\r\n        const leaderboardSnap = await getDocs(query(collection(db, 'users'), orderBy('reviewCount', 'desc'), limit(30)));\r\n        const usersWithReviews = leaderboardSnap.docs\r\n          .map(doc => ({ id: doc.id, ...doc.data() }))\r\n          .filter(user => {\r\n            const count = Number(user.reviewCount) || 0;\r\n            return count > 0;\r\n          })\r\n          .sort((a, b) => {\r\n            const countA = Number(a.reviewCount) || 0;\r\n            const countB = Number(b.reviewCount) || 0;\r\n            return countB - countA;\r\n          })\r\n          .slice(0, 10);\r\n        \r\n        const ranks = new Map();\r\n        usersWithReviews.forEach((user, index) => {\r\n          ranks.set(user.id, index);\r\n        });\r\n        leaderboardRanks.value = ranks;\r\n\r\n        // Get user location for distance calculation\r\n        if (navigator.geolocation) {\r\n          navigator.geolocation.getCurrentPosition(position => {\r\n            userLocation.value = {\r\n              lat: position.coords.latitude,\r\n              lng: position.coords.longitude\r\n            };\r\n            updateReviewDistance();\r\n          }, () => {\r\n            // Ignore location errors\r\n          });\r\n        }\r\n\r\n        // Fetch the review\r\n        const reviewRef = doc(db, 'reviews', props.reviewId);\r\n        const reviewSnap = await getDoc(reviewRef);\r\n        \r\n        if (!reviewSnap.exists()) {\r\n          error.value = 'Review not found.';\r\n          loading.value = false;\r\n          return;\r\n        }\r\n\r\n        const reviewData = { id: reviewSnap.id, ...reviewSnap.data() };\r\n        const restaurant = restaurantsMap.value.get(reviewData.restaurantId);\r\n        const rank = leaderboardRanks.value.get(reviewData.userId);\r\n\r\n        review.value = {\r\n          ...reviewData,\r\n          restaurantName: restaurant?.name || 'Unknown Restaurant',\r\n          restaurantCity: restaurant?.city,\r\n          restaurantState: restaurant?.state,\r\n          location: restaurant?.location || null,\r\n          distance: null, // Will be updated if location available\r\n          medal: getMedal(rank),\r\n          likeCount: 0,\r\n          isLiked: false\r\n        };\r\n\r\n        updateReviewDistance();\r\n\r\n        // Set up like listener\r\n        setupLikeListener();\r\n\r\n        // Update meta tags for social media sharing\r\n        // Use clean URL format for better social media previews\r\n        const shareUrl = `${window.location.origin}/review/${review.value.id}`;\r\n        const shareTitle = `${review.value.userName}'s Review of ${review.value.restaurantName}`;\r\n        const shareDescription = review.value.text \r\n          ? `\"${review.value.text.substring(0, 150)}${review.value.text.length > 150 ? '...' : ''}\"` \r\n          : `${review.value.userName} rated ${review.value.restaurantName} ${review.value.rating} stars`;\r\n        const shareImage = review.value.photoURL || '';\r\n\r\n        updateMetaTags({\r\n          title: shareTitle,\r\n          description: shareDescription,\r\n          image: shareImage,\r\n          url: shareUrl,\r\n          type: 'article'\r\n        });\r\n\r\n      } catch (err) {\r\n        console.error('Error fetching review:', err);\r\n        error.value = 'Failed to load review. Please try again.';\r\n      } finally {\r\n        loading.value = false;\r\n      }\r\n    };\r\n\r\n    const updateReviewDistance = () => {\r\n      if (review.value && userLocation.value && review.value.location) {\r\n        review.value.distance = getDistance(\r\n          userLocation.value.lat,\r\n          userLocation.value.lng,\r\n          review.value.location.lat,\r\n          review.value.location.lng\r\n        );\r\n      }\r\n    };\r\n\r\n    const setupLikeListener = () => {\r\n      if (!review.value) return;\r\n      \r\n      const reviewRef = doc(db, 'reviews', review.value.id);\r\n      const likesCollection = collection(reviewRef, 'likes');\r\n      const likesQuery = query(likesCollection);\r\n      \r\n      likeUnsubscribe = onSnapshot(likesQuery, (snapshot) => {\r\n        if (review.value) {\r\n          review.value.likeCount = snapshot.size;\r\n          review.value.isLiked = props.user ? snapshot.docs.some(doc => doc.data().userId === props.user.uid) : false;\r\n        }\r\n      }, (err) => {\r\n        console.error('Error fetching likes:', err);\r\n      });\r\n    };\r\n\r\n    const toggleLike = async () => {\r\n      if (!props.user || !review.value) return;\r\n      \r\n      const reviewRef = doc(db, 'reviews', review.value.id);\r\n      const likesCollection = collection(reviewRef, 'likes');\r\n      const likeQuery = query(likesCollection, where('userId', '==', props.user.uid));\r\n      const likeSnap = await getDocs(likeQuery);\r\n      \r\n      if (!likeSnap.empty) {\r\n        await deleteDoc(likeSnap.docs[0].ref);\r\n      } else {\r\n        await addDoc(likesCollection, {\r\n          userId: props.user.uid,\r\n          createdAt: serverTimestamp()\r\n        });\r\n      }\r\n    };\r\n\r\n    watch(() => props.reviewId, () => {\r\n      if (props.reviewId) {\r\n        if (likeUnsubscribe) likeUnsubscribe();\r\n        fetchReview();\r\n      } else {\r\n        resetMetaTags();\r\n      }\r\n    }, { immediate: true });\r\n\r\n    onMounted(() => {\r\n      if (props.reviewId) {\r\n        fetchReview();\r\n      }\r\n    });\r\n\r\n    onUnmounted(() => {\r\n      resetMetaTags();\r\n      if (likeUnsubscribe) {\r\n        likeUnsubscribe();\r\n      }\r\n    });\r\n\r\n    return {\r\n      review,\r\n      loading,\r\n      error,\r\n      formatDate,\r\n      toggleLike\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.modal-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: rgba(0, 0, 0, 0.6);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 1000;\r\n}\r\n\r\n.modal-content {\r\n  background: var(--card-background);\r\n  padding: 2em;\r\n  border-radius: 12px;\r\n  width: 90%;\r\n  max-width: 700px;\r\n  max-height: 90vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  box-shadow: 0 5px 20px rgba(0,0,0,0.3);\r\n}\r\n\r\n.modal-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  border-bottom: 1px solid #eee;\r\n  padding-bottom: 1em;\r\n  margin-bottom: 1em;\r\n}\r\n\r\n.modal-header h2 {\r\n  margin: 0;\r\n}\r\n\r\n.close-btn {\r\n  background: none;\r\n  border: none;\r\n  font-size: 2em;\r\n  cursor: pointer;\r\n  color: #777;\r\n}\r\n\r\n.modal-body {\r\n  overflow-y: auto;\r\n}\r\n\r\n.loading-indicator, .error-message {\r\n  text-align: center;\r\n  color: #777;\r\n  padding: 3em;\r\n}\r\n\r\n.error-message {\r\n  color: #e74c3c;\r\n}\r\n\r\n.review-detail {\r\n  max-width: 100%;\r\n}\r\n\r\n.post-header {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 1em;\r\n  padding: 1em 0;\r\n  border-bottom: 1px solid #eee;\r\n  margin-bottom: 1em;\r\n}\r\n\r\n.user-avatar {\r\n  width: 45px;\r\n  height: 45px;\r\n  border-radius: 50%;\r\n}\r\n\r\n.post-info {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.user-line {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5em;\r\n}\r\n\r\n.user-name {\r\n  font-weight: 600;\r\n}\r\n\r\n.medal {\r\n  font-size: 1.1em;\r\n}\r\n\r\n.post-date {\r\n  color: #7f8c8d;\r\n  font-size: 0.85em;\r\n}\r\n\r\n.post-content {\r\n  padding: 0.5em 0;\r\n}\r\n\r\n.post-title-line {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: baseline;\r\n  margin-bottom: 0.25em;\r\n}\r\n\r\n.restaurant-name {\r\n  font-size: 1.1em;\r\n  font-weight: 600;\r\n  margin: 0;\r\n}\r\n\r\n.distance {\r\n  font-size: 0.9em;\r\n  color: #777;\r\n  font-style: italic;\r\n}\r\n\r\n.restaurant-location {\r\n  font-size: 0.9em;\r\n  color: #777;\r\n  margin-bottom: 0.75em;\r\n}\r\n\r\n.review-body {\r\n  margin-bottom: 1em;\r\n}\r\n\r\n.review-text {\r\n  font-style: italic;\r\n  color: #333;\r\n  margin: 0.5em 0;\r\n}\r\n\r\n.review-photo {\r\n  max-width: 100%;\r\n  height: auto;\r\n  border-radius: 8px;\r\n  margin: 0.5em 0;\r\n}\r\n\r\n.tags-container {\r\n  margin-top: 0.75em;\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 0.5em;\r\n}\r\n\r\n.tag {\r\n  background-color: #eee;\r\n  padding: 0.25em 0.75em;\r\n  border-radius: 15px;\r\n  font-size: 0.8em;\r\n}\r\n\r\n.post-actions {\r\n  display: flex;\r\n  gap: 1em;\r\n  margin-top: 0.75em;\r\n  padding-top: 0.75em;\r\n  border-top: 1px solid #eee;\r\n}\r\n\r\n.like-btn {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5em;\r\n  background: none;\r\n  border: none;\r\n  cursor: pointer;\r\n  padding: 0.5em 0.75em;\r\n  border-radius: 8px;\r\n  color: #555;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.like-btn:hover:not(:disabled) {\r\n  background-color: #f0f0f0;\r\n}\r\n\r\n.like-btn:disabled {\r\n  cursor: not-allowed;\r\n  opacity: 0.6;\r\n}\r\n\r\n.like-btn.liked {\r\n  color: #e74c3c;\r\n}\r\n\r\n.like-btn svg {\r\n  width: 20px;\r\n  height: 20px;\r\n  fill: currentColor;\r\n}\r\n</style>\r\n","// Utility for managing Open Graph and meta tags for social media sharing\r\n\r\nexport const updateMetaTags = (options = {}) => {\r\n  const {\r\n    title = 'PorkHub',\r\n    description = 'Find, review, and share the best breaded pork tenderloin sandwiches.',\r\n    image = '',\r\n    url = window.location.href,\r\n    type = 'website'\r\n  } = options;\r\n\r\n  // Update or create meta tags\r\n  const setMetaTag = (property, content) => {\r\n    if (!content) return;\r\n    \r\n    let element = document.querySelector(`meta[property=\"${property}\"]`) || \r\n                  document.querySelector(`meta[name=\"${property}\"]`);\r\n    \r\n    if (!element) {\r\n      element = document.createElement('meta');\r\n      if (property.startsWith('og:')) {\r\n        element.setAttribute('property', property);\r\n      } else {\r\n        element.setAttribute('name', property);\r\n      }\r\n      document.head.appendChild(element);\r\n    }\r\n    \r\n    element.setAttribute('content', content);\r\n  };\r\n\r\n  // Basic meta tags\r\n  document.title = title;\r\n  setMetaTag('description', description);\r\n\r\n  // Open Graph tags\r\n  setMetaTag('og:title', title);\r\n  setMetaTag('og:description', description);\r\n  setMetaTag('og:image', image);\r\n  setMetaTag('og:url', url);\r\n  setMetaTag('og:type', type);\r\n  setMetaTag('og:site_name', 'PorkHub');\r\n\r\n  // Twitter Card tags\r\n  setMetaTag('twitter:card', 'summary_large_image');\r\n  setMetaTag('twitter:title', title);\r\n  setMetaTag('twitter:description', description);\r\n  setMetaTag('twitter:image', image);\r\n\r\n  // Update canonical URL\r\n  let canonical = document.querySelector('link[rel=\"canonical\"]');\r\n  if (!canonical) {\r\n    canonical = document.createElement('link');\r\n    canonical.setAttribute('rel', 'canonical');\r\n    document.head.appendChild(canonical);\r\n  }\r\n  canonical.setAttribute('href', url);\r\n};\r\n\r\nexport const resetMetaTags = () => {\r\n  updateMetaTags({\r\n    title: 'PorkHub',\r\n    description: 'Find, review, and share the best breaded pork tenderloin sandwiches. Join the PorkHub community to discover hidden gems and top-rated restaurants.',\r\n    image: '',\r\n    url: window.location.origin\r\n  });\r\n};\r\n","import { render } from \"./ReviewDetailModal.vue?vue&type=template&id=50183ae4&scoped=true\"\nimport script from \"./ReviewDetailModal.vue?vue&type=script&lang=js\"\nexport * from \"./ReviewDetailModal.vue?vue&type=script&lang=js\"\n\nimport \"./ReviewDetailModal.vue?vue&type=style&index=0&id=50183ae4&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-50183ae4\"]])\n\nexport default __exports__","<template>\r\n  <TransitionGroup name=\"toast\" tag=\"div\" class=\"toast-container\">\r\n    <div\r\n      v-for=\"toast in toasts\"\r\n      :key=\"toast.id\"\r\n      :class=\"['toast', `toast-${toast.type}`]\"\r\n      @click=\"removeToast(toast.id)\"\r\n    >\r\n      <span class=\"toast-message\">{{ toast.message }}</span>\r\n      <button class=\"toast-close\" @click.stop=\"removeToast(toast.id)\">&times;</button>\r\n    </div>\r\n  </TransitionGroup>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, onUnmounted } from 'vue';\r\nimport { subscribeToToasts } from '../utils/toast.js';\r\n\r\nexport default {\r\n  name: 'Toast',\r\n  setup() {\r\n    const toasts = ref([]);\r\n    let unsubscribe = null;\r\n    \r\n    const removeToast = (id) => {\r\n      const index = toasts.value.findIndex(t => t.id === id);\r\n      if (index > -1) {\r\n        toasts.value.splice(index, 1);\r\n      }\r\n    };\r\n    \r\n    onMounted(() => {\r\n      unsubscribe = subscribeToToasts((toast) => {\r\n        toasts.value.push(toast);\r\n        \r\n        if (toast.duration > 0) {\r\n          setTimeout(() => {\r\n            removeToast(toast.id);\r\n          }, toast.duration);\r\n        }\r\n      });\r\n    });\r\n    \r\n    onUnmounted(() => {\r\n      if (unsubscribe) {\r\n        unsubscribe();\r\n      }\r\n    });\r\n    \r\n    return {\r\n      toasts,\r\n      removeToast\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.toast-container {\r\n  position: fixed;\r\n  top: 20px;\r\n  right: 20px;\r\n  z-index: 10000;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 10px;\r\n  pointer-events: none;\r\n}\r\n\r\n.toast {\r\n  background: var(--card-background);\r\n  color: var(--text-color);\r\n  padding: 12px 16px;\r\n  border-radius: 8px;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  gap: 12px;\r\n  min-width: 250px;\r\n  max-width: 400px;\r\n  pointer-events: auto;\r\n  cursor: pointer;\r\n  border-left: 4px solid var(--primary-color);\r\n}\r\n\r\n.toast-success {\r\n  border-left-color: #27ae60;\r\n}\r\n\r\n.toast-error {\r\n  border-left-color: #e74c3c;\r\n}\r\n\r\n.toast-warning {\r\n  border-left-color: #f39c12;\r\n}\r\n\r\n.toast-info {\r\n  border-left-color: var(--primary-color);\r\n}\r\n\r\n.toast-message {\r\n  flex: 1;\r\n  font-size: 0.95em;\r\n}\r\n\r\n.toast-close {\r\n  background: none;\r\n  border: none;\r\n  color: #777;\r\n  font-size: 1.5em;\r\n  line-height: 1;\r\n  cursor: pointer;\r\n  padding: 0;\r\n  width: 20px;\r\n  height: 20px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.toast-close:hover {\r\n  color: #333;\r\n}\r\n\r\n.toast-enter-active,\r\n.toast-leave-active {\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.toast-enter-from {\r\n  opacity: 0;\r\n  transform: translateX(100%);\r\n}\r\n\r\n.toast-leave-to {\r\n  opacity: 0;\r\n  transform: translateX(100%);\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .toast-container {\r\n    top: 10px;\r\n    right: 10px;\r\n    left: 10px;\r\n  }\r\n  \r\n  .toast {\r\n    min-width: auto;\r\n    max-width: 100%;\r\n  }\r\n}\r\n</style>\r\n","import { render } from \"./Toast.vue?vue&type=template&id=285b30f8&scoped=true\"\nimport script from \"./Toast.vue?vue&type=script&lang=js\"\nexport * from \"./Toast.vue?vue&type=script&lang=js\"\n\nimport \"./Toast.vue?vue&type=style&index=0&id=285b30f8&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-285b30f8\"]])\n\nexport default __exports__","import { render } from \"./App.vue?vue&type=template&id=f5aa5576\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=f5aa5576&lang=css\"\n\nimport exportComponent from \"../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { createApp } from 'vue';\r\nimport App from './App.vue';\r\nimport { seedSampleData } from './sampleData';\r\n\r\n// --- How to seed your database ---\r\n// 1. Uncomment the line below.\r\n// 2. Run your app (e.g., 'npm run dev') and let the page load. An alert will pop up when it's done.\r\n// 3. Re-comment the line so it doesn't run again on the next app launch.\r\n// seedSampleData();\r\n\r\ncreateApp(App).mount('#app');","// We will use OpenStreetMap's Nominatim API for geocoding.\r\n// It's a free service and doesn't require an API key.\r\n// See usage policy: https://operations.osmfoundation.org/policies/nominatim/\r\n// It's recommended to provide a valid email in the request for contact purposes.\r\nconst YOUR_EMAIL_FOR_NOMINATIM = 'kennected.com@gmail.com';\r\n\r\n/**\r\n * Geocodes an address string into latitude and longitude using Nominatim.\r\n * @param {string} address The address to geocode.\r\n * @returns {Promise<{lat: number, lng: number}|null>} A promise that resolves to the location or null.\r\n */\r\nexport async function geocodeAddress(address) {\r\n  if (!address || !address.trim()) {\r\n    console.error('Geocoding error: Address is empty.');\r\n    return null;\r\n  }\r\n\r\n  const url = `https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(address)}&format=json&limit=1&email=${YOUR_EMAIL_FOR_NOMINATIM}`;\r\n\r\n  try {\r\n    const response = await fetch(url);\r\n    const data = await response.json();\r\n\r\n    if (data && data.length > 0) {\r\n      const { lat, lon } = data[0];\r\n      // Nominatim returns 'lon', but the app uses 'lng'.\r\n      return { lat: parseFloat(lat), lng: parseFloat(lon) };\r\n    }\r\n    return null;\r\n  } catch (error) {\r\n    console.error('Error during geocoding fetch:', error);\r\n    return null;\r\n  }\r\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t524: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkmy_vue_app\"] = self[\"webpackChunkmy_vue_app\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [504], () => (__webpack_require__(26)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["id","class","xmlns","height","viewBox","width","fill","src","alt","_createElementBlock","_hoisted_1","_createElementVNode","_normalizeClass","$setup","isSidebarCollapsed","_hoisted_2","_hoisted_3","onClick","_cache","args","toggleSidebar","title","_hoisted_5","_hoisted_4","d","user","_hoisted_6","photoURL","referrerpolicy","_hoisted_8","_toDisplayString","displayName","_hoisted_9","currentPage","goToHome","goToLeaderboard","goToRestaurants","goToRecommendations","goToReview","goToUserSearch","goToBucketList","goToMyReviews","goToFollowers","goToFollowing","cx","cy","r","_hoisted_10","isAdmin","goToDatabaseStats","logout","loginWithGoogle","_hoisted_11","appVersion","_hoisted_12","_createBlock","_KeepAlive","include","_resolveDynamicComponent","currentComponent","onReviewed","onCheckInAt","reviewAt","onReviewAt","onGoToReview","selectedRestaurantForReview","sharedReviewId","_component_ReviewDetailModal","onClose","closeReviewModal","_createVNode","_component_Toast","ref","locationPermission","requestLocationAccess","userLocation","$event","setSortOrder","active","sortOrder","loading","_hoisted_7","posts","length","$props","_Fragment","_renderList","post","key","userPhoto","_hoisted_13","_hoisted_14","_hoisted_15","userName","medal","_hoisted_16","_hoisted_17","createdAt","toDate","toLocaleString","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","restaurantName","toggleBucketList","isInBucketList","restaurantId","distance","_hoisted_23","toFixed","restaurantCity","restaurantState","_hoisted_24","_hoisted_25","_component_StarRating","rating","text","_hoisted_26","tags","_hoisted_28","tag","_hoisted_29","toggleLike","isLiked","disabled","likeCount","shareReview","_component_Comments","userId","_hoisted_32","loadingMore","_hoisted_33","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","app","initializeApp","auth","getAuth","provider","GoogleAuthProvider","db","getFirestore","storage","getStorage","comments","comment","formatDate","editingCommentId","canEdit","startEditing","canDelete","deleteComment","editingText","onKeyup","_withKeys","saveEdit","cancelEdit","newComment","placeholder","addComment","trim","toastListeners","toastId","showToast","message","type","duration","toast","forEach","listener","subscribeToToasts","callback","push","index","indexOf","splice","name","props","postId","String","required","postType","postAuthorId","Object","default","setup","unsubscribe","onMounted","parentDocRef","doc","commentsCollection","collection","commentsQuery","query","orderBy","onSnapshot","async","commentData","snapshot","docs","map","data","userIds","Set","c","usersMap","Map","i","batchIds","slice","usersQuery","where","documentId","usersSnapshot","getDocs","set","value","get","onUnmounted","currentUser","now","serverTimestamp","reviewDocRef","Promise","all","addDoc","uid","updateDoc","lastActivityAt","commentDoc","confirm","commentId","deleteDoc","error","console","timestamp","__exports__","editable","n","setRating","onMouseover","handleMouseover","onMouseleave","handleMouseleave","getStarPath","Number","Boolean","emits","emit","hoverRating","fullStarPath","halfStarPath","emptyStarPath","starIndex","displayRating","getDistance","lat1","lon1","lat2","lon2","R","dLat","Math","PI","dLon","a","sin","cos","atan2","sqrt","components","StarRating","Comments","loadMoreTrigger","allPosts","fullSortedPosts","pageSize","observer","unsubscribes","bucketList","leaderboardRanks","restaurantsMap","isSettingUpListeners","processAndSetPosts","rank","getMedal","sortedPosts","Array","from","values","sort","b","distanceA","Infinity","distanceB","timeA","timeB","seconds","unsub","disconnect","IntersectionObserver","entries","isIntersecting","loadMorePosts","checkLocationPermission","watch","newLocation","size","restaurant","location","lat","lng","newUser","oldUser","setupFeedListeners","newValue","oldValue","unobserve","observe","err","warn","clear","resolve","setTimeout","bucketListQuery","unsubBucketList","newBucketList","add","followsPromise","followsSnap","restaurantsSnap","usersSnap","leaderboardSnap","limit","usersWithReviews","filter","count","reviewCount","countA","countB","initialRanks","leaderboardQuery","unsubLeaderboard","newRanks","processSnapshot","docChanges","change","delete","docData","city","state","setupLikeListener","followingIds","followingId","includes","q","nearbyRestaurantIds","recentReviewsQuery","currentLength","nextPosts","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","timeout","permissions","permissionStatus","onchange","order","has","reviewId","reviewRef","likesCollection","likesQuery","some","likeQuery","likeSnap","empty","baseUrl","window","origin","shareableLink","share","url","clipboard","writeText","copied","prompt","isEditModalVisible","_component_EditRestaurantModal","restaurantToEdit","closeEditModal","onSave","saveRestaurantChanges","isAddReviewModalVisible","_component_AddReviewModal","restaurantIdForNewReview","closeAddReviewModal","onReviewAdded","handleReviewAdded","isReviewsModalVisible","_component_RestaurantReviewsModal","restaurantForReviews","closeReviewsModal","onReviewsUpdated","handleReviewOrUpdate","searchQuery","showAddForm","onSubmit","_withModifiers","addNewRestaurant","for","newRestaurant","address","zip","addError","isSaving","filteredRestaurants","averageRating","ratingCount","_hoisted_22","openReviewsModal","openEditModal","href","getDirectionsUrl","target","rel","getDetailsUrl","getValidUrl","openAddReviewModal","_hoisted_31","_ctx","$emit","editableRestaurant","newVal","JSON","parse","stringify","immediate","deep","isUploading","submitReview","review","onChange","handleFileChange","accept","photoPreview","uploadProgress","max","photoFile","event","file","files","startsWith","URL","createObjectURL","reader","FileReader","onload","e","img","Image","MAX_DIMENSION","canvas","document","createElement","ctx","getContext","drawImage","toBlob","blob","result","readAsDataURL","filePath","Date","fileRef","storageRef","uploadTask","uploadBytesResumable","reject","on","bytesTransferred","totalBytes","uploadError","getDownloadURL","reviewData","userRef","increment","countError","reviews","editingReview","deleteReview","toLocaleDateString","EditRestaurantModal","RestaurantReviewsModal","AddReviewModal","restaurants","rawReviews","bucketListUnsubscribe","restaurantsUnsubscribe","reviewsUnsubscribe","restaurantsWithRatings","computed","ratings","total","restaurantDoc","ratingInfo","sortedReviews","restaurantsQuery","reviewsQuery","subscribeToBucketList","restaurantsWithDistance","lowerCaseQuery","toLowerCase","destination","encodeURIComponent","updatedRestaurant","updatedData","original","dataToSave","nameChanged","name_lowercase","addressParts","addressChanged","part","address_lowercase","fullAddress","join","geocodeAddress","keys","restaurantRef","normalizedName","normalizedAddress","querySnapshot","userDisplayName","_component_UserReviewsModal","userForReviews","filteredUsers","lastReview","toggleFollow","isFollowing","fetchReviews","UserReviewsModal","users","following","followsUnsubscribe","fetchUsers","followsQuery","newFollowing","u","ranks","allUsers","usersWithDetails","reviewQuery","reviewSnap","pos","sorted","followsRef","docId","followerId","autoplay","playsinline","selectedRestaurant","selectedRestaurantId","showAddRestaurantForm","saveNewRestaurant","isSavingRestaurant","addRestaurantError","photoDataUrl","removePhoto","openCamera","triggerFileUpload","handleFileUpload","style","isCameraOpen","capturePhoto","closeCamera","star","_hoisted_27","selected","selectedTags","toggleTag","_hoisted_30","newTag","onKeydown","addNewTag","rows","_hoisted_34","showPreview","_hoisted_35","_hoisted_36","_hoisted_37","getRestaurantName","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_42","submitting","_hoisted_43","errorMessage","_hoisted_44","videoPlayer","stream","fileInput","fetchTags","tagsQuery","tagsSnapshot","getUserLocation","selectClosestRestaurant","closestRestaurant","minDistance","fetchInitialData","restaurantSnap","getDoc","exists","restaurantsSnapshot","find","tagName","t","newDocRef","newTagObject","localeCompare","addedRestaurant","nextTick","mediaDevices","getUserMedia","video","facingMode","srcObject","getTracks","track","stop","MAX_WIDTH","MAX_HEIGHT","videoWidth","videoHeight","context","toDataURL","click","photoRef","uploadResult","uploadString","bucketListSnapshot","bucketListItemDoc","completedAt","bucketError","fetchRecommendations","allRestaurantsSnapshot","allRestaurants","nearbyRestaurants","sixMonthsAgo","setMonth","getMonth","sixMonthsAgoTimestamp","Timestamp","fromDate","reviewsSnapshot","recentReviews","recommendations","relevantReviews","totalRating","reduce","sum","statsLoading","stats","follows","log","fetchCollectionStats","collectionsToCount","counts","promises","coll","colName","getCountFromServer","__props","editingReviewId","editingRating","originalEditData","setupListeners","then","newMap","populatedReviews","getRankClass","fetchedUsers","sortedUsers","followers","fetchFollowers","followerIds","usersData","followersWithDetails","showCompleted","filteredItems","selectedItems","removeSelectedItems","selectAll","item","checked","toggleItemSelection","removeFromBucketList","bucketListItems","onAuthStateChanged","fetchBucketList","items","restaurantIds","filtered","itemId","deletePromises","unfollowUser","fetchFollowing","followingWithDetails","userToUnfollow","updateMetaTags","options","description","image","setMetaTag","property","content","element","querySelector","setAttribute","head","appendChild","canonical","resetMetaTags","likeUnsubscribe","fetchReview","updateReviewDistance","shareUrl","shareTitle","shareDescription","substring","shareImage","_TransitionGroup","toasts","removeToast","findIndex","Home","Restaurants","BucketList","UserSearch","Review","Recommendations","DatabaseStats","MyReviews","Leaderboard","Followers","Following","ReviewDetailModal","Toast","innerWidth","process","email","protectedPages","componentMap","addEventListener","userSnap","setDoc","signInWithPopup","alert","signOut","handleDeepLink","pathMatch","pathname","match","history","replaceState","hash","reviewMatch","removeEventListener","render","createApp","App","mount","YOUR_EMAIL_FOR_NOMINATIM","response","fetch","json","lon","parseFloat","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","deferred","O","chunkIds","fn","priority","notFulfilled","fulfilled","j","every","definition","o","defineProperty","enumerable","g","globalThis","this","Function","obj","prop","prototype","hasOwnProperty","call","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","bind","__webpack_exports__"],"sourceRoot":""}