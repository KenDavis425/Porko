(()=>{"use strict";var e={729:(e,t,a)=>{var s=a(751),r=a(641),n=a(33);const l={id:"app"},o={class:"sidebar"},i={class:"sidebar-top"},u={key:0,xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},c={key:1,src:"/logo.svg",class:"sidebar-toggle-logo",alt:"Expand menu"},d={key:0,class:"sidebar-header"},v=["src"],p={class:"sidebar-user"},w={class:"sidebar-nav"},g={class:"sidebar-bottom"},m={class:"app-version"},h={class:"main-content"},k={key:0,class:"component-wrapper"},L={key:1,class:"component-wrapper empty-state"};function y(e,t,a,s,y,f){const C=(0,r.g2)("ReviewDetailModal"),b=(0,r.g2)("Toast");return(0,r.uX)(),(0,r.CE)("div",l,[(0,r.Lk)("div",{class:(0,n.C4)(["main-layout",{"sidebar-collapsed":s.isSidebarCollapsed}])},[(0,r.Lk)("aside",o,[(0,r.Lk)("div",i,[(0,r.Lk)("button",{class:"sidebar-toggle",onClick:t[0]||(t[0]=(...e)=>s.toggleSidebar&&s.toggleSidebar(...e)),title:"Toggle Sidebar"},[s.isSidebarCollapsed?((0,r.uX)(),(0,r.CE)("img",c)):((0,r.uX)(),(0,r.CE)("svg",u,t[14]||(t[14]=[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"},null,-1),(0,r.Lk)("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"},null,-1)])))]),t[25]||(t[25]=(0,r.Lk)("div",{class:"sidebar-branding"},[(0,r.Lk)("img",{src:"/logo.svg",alt:"PorkHub Logo",class:"sidebar-logo"}),(0,r.Lk)("h1",{class:"sidebar-title"},"PorkHub")],-1)),s.user?((0,r.uX)(),(0,r.CE)("div",d,[(0,r.Lk)("img",{src:s.user.photoURL||"https://cdn-icons-png.flaticon.com/512/149/149071.png",class:"sidebar-avatar",alt:"User Avatar",referrerpolicy:"no-referrer"},null,8,v),(0,r.Lk)("div",p,(0,n.v_)(s.user.displayName),1)])):(0,r.Q3)("",!0),(0,r.Lk)("nav",w,[(0,r.Lk)("button",{class:(0,n.C4)(["sidebar-link",{active:"home"===s.currentPage}]),onClick:t[1]||(t[1]=(...e)=>s.goToHome&&s.goToHome(...e)),title:"Home"},t[15]||(t[15]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8h5z"})],-1),(0,r.Lk)("span",null,"Home",-1)]),2),(0,r.Lk)("button",{class:(0,n.C4)(["sidebar-link",{active:"leaderboard"===s.currentPage}]),onClick:t[2]||(t[2]=(...e)=>s.goToLeaderboard&&s.goToLeaderboard(...e)),title:"Leaderboard"},t[16]||(t[16]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M16 11V3H8v6H2v12h20V11h-6zm-6-6h4v14h-4V5zm-6 6h4v8H4v-8zm16 8h-4v-8h4v8z"})],-1),(0,r.Lk)("span",null,"Leaderboard",-1)]),2),(0,r.Lk)("button",{class:(0,n.C4)(["sidebar-link",{active:"restaurants"===s.currentPage}]),onClick:t[3]||(t[3]=(...e)=>s.goToRestaurants&&s.goToRestaurants(...e)),title:"Restaurants"},t[17]||(t[17]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M16 6v8h3v8h-3v-2h-2v2h-2v-2h-2v2H8v-2H6v2H3v-8h3V6c0-3.31 2.69-6 6-6s6 2.69 6 6zm-2 0c0-2.21-1.79-4-4-4s-4 1.79-4 4v8h8V6zm-5 3h2v2h-2z"})],-1),(0,r.Lk)("span",null,"Restaurants",-1)]),2),(0,r.Lk)("button",{class:(0,n.C4)(["sidebar-link",{active:"recommendations"===s.currentPage}]),onClick:t[4]||(t[4]=(...e)=>s.goToRecommendations&&s.goToRecommendations(...e)),title:"Recommendations"},t[18]||(t[18]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27z"})],-1),(0,r.Lk)("span",null,"Recommendations",-1)]),2),s.user?((0,r.uX)(),(0,r.CE)("button",{key:0,class:(0,n.C4)(["sidebar-link",{active:"review"===s.currentPage}]),onClick:t[5]||(t[5]=(...e)=>s.goToReview&&s.goToReview(...e)),title:"Write a Review"},t[19]||(t[19]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M12 2C8.14 2 5 5.14 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.86-3.14-7-7-7zm-1.5 9h-2v-2h2v2zm5 0h-2v-2h2v2zm-2.5-4h-2V5h2v2z"})],-1),(0,r.Lk)("span",null,"Write a Review",-1)]),2)):(0,r.Q3)("",!0),s.user?((0,r.uX)(),(0,r.CE)("button",{key:1,class:(0,n.C4)(["sidebar-link",{active:"user-search"===s.currentPage}]),onClick:t[6]||(t[6]=(...e)=>s.goToUserSearch&&s.goToUserSearch(...e)),title:"Follow Users"},t[20]||(t[20]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 5 1.41-1.41L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM12 10V7H8v3H5v2h3v3h2v-3h3v-2h-3z"})],-1),(0,r.Lk)("span",null,"Follow Users",-1)]),2)):(0,r.Q3)("",!0),s.user?((0,r.uX)(),(0,r.CE)("button",{key:2,class:(0,n.C4)(["sidebar-link",{active:"bucket-list"===s.currentPage}]),onClick:t[7]||(t[7]=(...e)=>s.goToBucketList&&s.goToBucketList(...e)),title:"My Bucket List"},t[21]||(t[21]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M18 7h-2.06c-.33-3.2-2.46-5.8-5.94-5.8S4.39 3.8 4.06 7H2v12h16V7zM6.14 7c.2-1.92 1.6-3.48 3.86-3.8A4.002 4.002 0 0 1 14 7h-2.14c-.2-1.92-1.6-3.48-3.86-3.8zM16 17H4v-8h12v8z"})],-1),(0,r.Lk)("span",null,"My Bucket List",-1)]),2)):(0,r.Q3)("",!0),s.user?((0,r.uX)(),(0,r.CE)("button",{key:3,class:(0,n.C4)(["sidebar-link",{active:"my-reviews"===s.currentPage}]),onClick:t[8]||(t[8]=(...e)=>s.goToMyReviews&&s.goToMyReviews(...e)),title:"My Reviews"},t[22]||(t[22]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"})],-1),(0,r.Lk)("span",null,"My Reviews",-1)]),2)):(0,r.Q3)("",!0),s.user?((0,r.uX)(),(0,r.CE)("button",{key:4,class:(0,n.C4)(["sidebar-link",{active:"followers"===s.currentPage}]),onClick:t[9]||(t[9]=(...e)=>s.goToFollowers&&s.goToFollowers(...e)),title:"My Followers"},t[23]||(t[23]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5s-3 1.34-3 3 1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"})],-1),(0,r.Lk)("span",null,"My Followers",-1)]),2)):(0,r.Q3)("",!0),s.user?((0,r.uX)(),(0,r.CE)("button",{key:5,class:(0,n.C4)(["sidebar-link",{active:"following"===s.currentPage}]),onClick:t[10]||(t[10]=(...e)=>s.goToFollowing&&s.goToFollowing(...e)),title:"Following"},t[24]||(t[24]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("circle",{cx:"6.18",cy:"17.82",r:"2.18"}),(0,r.Lk)("path",{d:"M4 4.44v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9zM4 10.1v2.83c2.39 0 4.33 1.94 4.33 4.33h2.83c0-3.98-3.23-7.16-7.16-7.16z"})],-1),(0,r.Lk)("span",null,"Following",-1)]),2)):(0,r.Q3)("",!0)])]),(0,r.Lk)("div",g,[s.isAdmin?((0,r.uX)(),(0,r.CE)("button",{key:0,class:(0,n.C4)(["sidebar-link",{active:"database-stats"===s.currentPage}]),onClick:t[11]||(t[11]=(...e)=>s.goToDatabaseStats&&s.goToDatabaseStats(...e)),title:"Database Stats"},t[26]||(t[26]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M5 9.2h3V19H5zM10.6 5h2.8v14h-2.8zm5.6 8H19v6h-2.8z"})],-1),(0,r.Lk)("span",null,"Database Stats",-1)]),2)):(0,r.Q3)("",!0),s.user?((0,r.uX)(),(0,r.CE)("button",{key:1,class:"sidebar-link",onClick:t[12]||(t[12]=(...e)=>s.logout&&s.logout(...e)),title:"Logout"},t[27]||(t[27]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5-5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"})],-1),(0,r.Lk)("span",null,"Logout",-1)]))):((0,r.uX)(),(0,r.CE)("button",{key:2,class:"login-btn-sidebar",onClick:t[13]||(t[13]=(...e)=>s.loginWithGoogle&&s.loginWithGoogle(...e)),title:"Login with Google"},t[28]||(t[28]=[(0,r.Fv)('<span>Login with</span><svg viewBox="0 0 48 48" width="22px" height="22px"><path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"></path><path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"></path><path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"></path><path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"></path><path fill="none" d="M0 0h48v48H0z"></path></svg>',2)]))),(0,r.Lk)("div",m,"v"+(0,n.v_)(s.appVersion),1)])]),(0,r.Lk)("main",h,[s.sharedReviewId?((0,r.uX)(),(0,r.CE)("div",L)):((0,r.uX)(),(0,r.CE)("div",k,[((0,r.uX)(),(0,r.Wv)(r.PR,{include:"Home"},[((0,r.uX)(),(0,r.Wv)((0,r.$y)(s.currentComponent),{user:s.user,onReviewed:s.goToHome,onCheckInAt:s.reviewAt,onReviewAt:s.reviewAt,onGoToReview:s.goToReview,"selected-restaurant-id":s.selectedRestaurantForReview},null,40,["user","onReviewed","onCheckInAt","onReviewAt","onGoToReview","selected-restaurant-id"]))],1024))]))]),s.sharedReviewId?((0,r.uX)(),(0,r.Wv)(C,{key:0,"review-id":s.sharedReviewId,user:s.user,onClose:s.closeReviewModal},null,8,["review-id","user","onClose"])):(0,r.Q3)("",!0),(0,r.bF)(b)],2)])}const f={class:"home-page"},C={key:0,class:"location-prompt-banner"},b={key:1,class:"location-prompt-banner warning"},R={key:2,class:"sort-toggle"},E={class:"feed"},M={key:0,class:"loading-indicator"},x={key:1},I={key:0,class:"no-posts-message"},X={key:0},_={key:1},z={class:"post-header"},A=["src"],P={class:"post-info"},S={class:"user-line"},F={class:"user-name"},U={key:0,class:"medal"},K={class:"post-date"},H={class:"post-content"},V={class:"post-title-line"},Q={class:"restaurant-title-group"},N={class:"restaurant-name"},B=["onClick","title"],J={key:0,class:"distance"},G={key:0,class:"restaurant-location"},T={class:"review-body"},D={key:0,class:"review-text"},$=["src"],W={key:2,class:"tags-container"},O={class:"post-actions"},q=["onClick","disabled","aria-label","aria-pressed"],j=["onClick"],Z={ref:"loadMoreTrigger"},Y={key:1,class:"loading-indicator"};function ee(e,t,a,s,l,o){const i=(0,r.g2)("StarRating"),u=(0,r.g2)("Comments");return(0,r.uX)(),(0,r.CE)("div",f,["prompt"===s.locationPermission?((0,r.uX)(),(0,r.CE)("div",C,[t[3]||(t[3]=(0,r.Lk)("div",{class:"banner-content"},[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.86-3.14-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})]),(0,r.Lk)("p",null,"Share your location to see posts and restaurants near you!")],-1)),(0,r.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>s.requestLocationAccess&&s.requestLocationAccess(...e)),class:"btn-primary"},"Share Location")])):(0,r.Q3)("",!0),"denied"===s.locationPermission?((0,r.uX)(),(0,r.CE)("div",b,t[4]||(t[4]=[(0,r.Lk)("div",{class:"banner-content"},[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"})]),(0,r.Lk)("p",null,"Location access is denied. To see local content, please enable location services for this site in your browser settings.")],-1)]))):(0,r.Q3)("",!0),s.userLocation?((0,r.uX)(),(0,r.CE)("div",R,[(0,r.Lk)("button",{onClick:t[1]||(t[1]=e=>s.setSortOrder("time")),class:(0,n.C4)({active:"time"===s.sortOrder})},"Most Recent",2),(0,r.Lk)("button",{onClick:t[2]||(t[2]=e=>s.setSortOrder("distance")),class:(0,n.C4)({active:"distance"===s.sortOrder})},"Nearby",2)])):(0,r.Q3)("",!0),(0,r.Lk)("div",E,[s.loading?((0,r.uX)(),(0,r.CE)("div",M,"Loading feed...")):((0,r.uX)(),(0,r.CE)("div",x,[0===s.posts.length?((0,r.uX)(),(0,r.CE)("div",I,[a.user?((0,r.uX)(),(0,r.CE)("div",X,t[5]||(t[5]=[(0,r.Lk)("h3",null,"Your Feed is Empty",-1),(0,r.Lk)("p",null,"Follow some users to see their reviews here, or check out the Restaurants page to find new places.",-1)]))):((0,r.uX)(),(0,r.CE)("div",_,t[6]||(t[6]=[(0,r.Lk)("h3",null,"Welcome to PorkHub!",-1),(0,r.Lk)("p",null,"There are no reviews to show right now. Check out the Restaurants page to discover new places!",-1)])))])):(0,r.Q3)("",!0),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.posts,e=>((0,r.uX)(),(0,r.CE)("div",{key:e.id,class:"post-card"},[(0,r.Lk)("div",z,[(0,r.Lk)("img",{src:e.userPhoto||"https://cdn-icons-png.flaticon.com/512/149/149071.png",alt:"User",class:"user-avatar",referrerpolicy:"no-referrer"},null,8,A),(0,r.Lk)("div",P,[(0,r.Lk)("div",S,[(0,r.Lk)("span",F,(0,n.v_)(e.userName),1),e.medal?((0,r.uX)(),(0,r.CE)("span",U,(0,n.v_)(e.medal),1)):(0,r.Q3)("",!0)]),(0,r.Lk)("span",K,(0,n.v_)(e.createdAt.toDate().toLocaleString()),1)])]),(0,r.Lk)("div",H,[(0,r.Lk)("div",V,[(0,r.Lk)("div",Q,[(0,r.Lk)("h2",N,(0,n.v_)(e.restaurantName),1),a.user?((0,r.uX)(),(0,r.CE)("button",{key:0,onClick:t=>s.toggleBucketList(e),class:(0,n.C4)(["action-btn bucket-list-btn",{"in-bucket-list":s.isInBucketList(e.restaurantId)}]),title:s.isInBucketList(e.restaurantId)?"In Bucket List":"Add to Bucket List"},t[7]||(t[7]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20px",viewBox:"0 0 24 24",width:"20px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M18 7h-2.06c-.33-3.2-2.46-5.8-5.94-5.8S4.39 3.8 4.06 7H2v12h16V7zM6.14 7c.2-1.92 1.6-3.48 3.86-3.8A4.002 4.002 0 0 1 14 7h-2.14c-.2-1.92-1.6-3.48-3.86-3.8zM16 17H4v-8h12v8z"})],-1)]),10,B)):(0,r.Q3)("",!0)]),null!==e.distance?((0,r.uX)(),(0,r.CE)("div",J,(0,n.v_)(e.distance.toFixed(1))+" miles away ",1)):(0,r.Q3)("",!0)]),e.restaurantCity||e.restaurantState?((0,r.uX)(),(0,r.CE)("div",G,[(0,r.eW)((0,n.v_)(e.restaurantCity),1),e.restaurantCity&&e.restaurantState?((0,r.uX)(),(0,r.CE)(r.FK,{key:0},[(0,r.eW)(", ")],64)):(0,r.Q3)("",!0),(0,r.eW)((0,n.v_)(e.restaurantState),1)])):(0,r.Q3)("",!0),(0,r.Lk)("div",T,[(0,r.bF)(i,{rating:e.rating},null,8,["rating"]),e.text?((0,r.uX)(),(0,r.CE)("p",D,'"'+(0,n.v_)(e.text)+'"',1)):(0,r.Q3)("",!0),e.photoURL?((0,r.uX)(),(0,r.CE)("img",{key:1,src:e.photoURL,alt:"Review photo",class:"review-photo",loading:"lazy"},null,8,$)):(0,r.Q3)("",!0),e.tags&&e.tags.length>0?((0,r.uX)(),(0,r.CE)("div",W,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.tags,e=>((0,r.uX)(),(0,r.CE)("span",{key:e,class:"tag"},(0,n.v_)(e),1))),128))])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",O,[(0,r.Lk)("button",{onClick:t=>s.toggleLike(e.id),class:(0,n.C4)(["like-btn",{liked:e.isLiked}]),disabled:!a.user,"aria-label":e.isLiked?"Unlike this review":"Like this review","aria-pressed":e.isLiked},[t[8]||(t[8]=(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20px",viewBox:"0 0 24 24",width:"20px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})],-1)),(0,r.Lk)("span",null,(0,n.v_)(e.likeCount||0),1)],10,q),(0,r.Lk)("button",{onClick:t=>s.shareReview(e.id),class:"share-btn",title:"Share this review","aria-label":"Share this review"},t[9]||(t[9]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20px",viewBox:"0 0 24 24",width:"20px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"})],-1),(0,r.Lk)("span",null,"Share",-1)]),8,j)]),(0,r.bF)(u,{"post-id":e.id,user:a.user,"post-type":"reviews","post-author-id":e.userId},null,8,["post-id","user","post-author-id"])])]))),128)),(0,r.Lk)("div",Z,null,512),s.loadingMore?((0,r.uX)(),(0,r.CE)("div",Y,"Loading more...")):(0,r.Q3)("",!0)]))])])}var te=a(953),ae=a(223),se=a(962),re=a(185),ne=a(993);const le={apiKey:"AIzaSyDxzi70xuS1KxemDBF1logZ6zyHxINFfp4",authDomain:"porko-c0f87.firebaseapp.com",projectId:"porko-c0f87",storageBucket:"porko-c0f87.firebasestorage.app",messagingSenderId:"1050714930836",appId:"1:1050714930836:web:5b4c9bdf93e95748a23e81",measurementId:"G-3LCKP815FM"},oe=(0,ae.Wp)(le),ie=(0,se.xI)(oe),ue=new se.HF,ce=(0,re.aU)(oe),de=(0,ne.c7)(oe),ve={class:"comments-section"},pe={class:"comment-list"},we=["src","alt"],ge={class:"comment-content"},me={class:"comment-header"},he={class:"comment-user-name"},ke={class:"comment-date"},Le={key:0},ye={class:"comment-text"},fe={class:"comment-actions"},Ce=["onClick"],be=["onClick"],Re={key:1,class:"edit-comment"},Ee={class:"edit-actions"},Me={key:0,class:"add-comment"},xe=["disabled"],Ie={key:1,class:"add-comment-login-prompt"};function Xe(e,t,a,l,o,i){return(0,r.uX)(),(0,r.CE)("div",ve,[(0,r.Lk)("div",pe,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.comments,e=>((0,r.uX)(),(0,r.CE)("div",{key:e.id,class:"comment"},[(0,r.Lk)("img",{src:e.userPhoto||"https://cdn-icons-png.flaticon.com/512/149/149071.png",alt:e.userName,class:"comment-user-photo",referrerpolicy:"no-referrer"},null,8,we),(0,r.Lk)("div",ge,[(0,r.Lk)("div",me,[(0,r.Lk)("span",he,(0,n.v_)(e.userName),1),(0,r.Lk)("span",ke,(0,n.v_)(l.formatDate(e.createdAt)),1)]),l.editingCommentId!==e.id?((0,r.uX)(),(0,r.CE)("div",Le,[(0,r.Lk)("p",ye,(0,n.v_)(e.text),1),(0,r.Lk)("div",fe,[l.canEdit(e)?((0,r.uX)(),(0,r.CE)("button",{key:0,onClick:t=>l.startEditing(e),class:"action-btn"},"Edit",8,Ce)):(0,r.Q3)("",!0),l.canDelete(e)?((0,r.uX)(),(0,r.CE)("button",{key:1,onClick:t=>l.deleteComment(e.id),class:"action-btn delete"},"Delete",8,be)):(0,r.Q3)("",!0)])])):((0,r.uX)(),(0,r.CE)("div",Re,[(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>l.editingText=e),onKeyup:t[1]||(t[1]=(0,s.jR)((...e)=>l.saveEdit&&l.saveEdit(...e),["enter"])),class:"edit-input"},null,544),[[s.Jo,l.editingText]]),(0,r.Lk)("div",Ee,[(0,r.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>l.saveEdit&&l.saveEdit(...e)),class:"btn-primary"},"Save"),(0,r.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>l.cancelEdit&&l.cancelEdit(...e)),class:"btn-secondary"},"Cancel")])]))])]))),128))]),a.user?((0,r.uX)(),(0,r.CE)("div",Me,[(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>l.newComment=e),placeholder:"Add a comment...",onKeyup:t[5]||(t[5]=(0,s.jR)((...e)=>l.addComment&&l.addComment(...e),["enter"]))},null,544),[[s.Jo,l.newComment]]),(0,r.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>l.addComment&&l.addComment(...e)),disabled:!l.newComment.trim()},"Post",8,xe)])):((0,r.uX)(),(0,r.CE)("div",Ie,t[7]||(t[7]=[(0,r.Lk)("p",null,"Please log in to comment.",-1)])))])}const _e=[];let ze=0;const Ae=(e,t="info",a=3e3)=>{const s=ze++,r={id:s,message:e,type:t,duration:a};return _e.forEach(e=>e(r)),s},Pe=e=>(_e.push(e),()=>{const t=_e.indexOf(e);t>-1&&_e.splice(t,1)}),Se={name:"Comments",props:{postId:{type:String,required:!0},postType:{type:String,required:!0},postAuthorId:{type:String,required:!0},user:{type:Object,default:null}},setup(e){const t=(0,te.KR)([]),a=(0,te.KR)(""),s=(0,te.KR)(null),n=(0,te.KR)("");let l=()=>{};(0,r.sV)(()=>{const a=(0,re.H9)(ce,e.postType,e.postId),s=(0,re.rJ)(a,"comments"),r=(0,re.P)(s,(0,re.My)("createdAt","asc"));l=(0,re.aQ)(r,async e=>{const a=e.docs.map(e=>({id:e.id,...e.data()})),s=[...new Set(a.map(e=>e.userId))];if(s.length>0){const e=new Map;for(let t=0;t<s.length;t+=30){const a=s.slice(t,t+30),r=(0,re.P)((0,re.rJ)(ce,"users"),(0,re._M)((0,re.Fs)(),"in",a)),n=await(0,re.GG)(r);n.forEach(t=>e.set(t.id,t.data()))}t.value=a.map(t=>{const a=e.get(t.userId);return{...t,userName:a?.displayName||t.userName||"Unknown User",userPhoto:a?.photoURL||t.userPhoto||null}})}else t.value=[]})}),(0,r.hi)(()=>{l()});const o=async()=>{if(""===a.value.trim())return;const t=e.user;if(!t)return;const s=(0,re.O5)(),r=(0,re.H9)(ce,e.postType,e.postId),n=(0,re.rJ)(r,"comments"),l=(0,re.H9)(ce,"reviews",e.postId);await Promise.all([(0,re.gS)(n,{userId:t.uid,text:a.value,createdAt:s}),(0,re.mZ)(l,{lastActivityAt:s})]),a.value=""},i=t=>{const a=e.user;return a&&a.uid===t.userId},u=t=>{const a=e.user;return a&&(a.uid===t.userId||a.uid===e.postAuthorId)},c=e=>{s.value=e.id,n.value=e.text},d=()=>{s.value=null,n.value=""},v=async()=>{if(""===n.value.trim()||!s.value)return;const t=(0,re.H9)(ce,e.postType,e.postId),a=(0,re.rJ)(t,"comments"),r=(0,re.H9)(a,s.value),l=(0,re.H9)(ce,"reviews",e.postId);await Promise.all([(0,re.mZ)(r,{text:n.value}),(0,re.mZ)(l,{lastActivityAt:(0,re.O5)()})]),d()},p=async t=>{if(confirm("Are you sure you want to delete this comment?"))try{const a=(0,re.H9)(ce,e.postType,e.postId),s=(0,re.rJ)(a,"comments"),r=(0,re.H9)(s,t),n=(0,re.H9)(ce,"reviews",e.postId);await Promise.all([(0,re.kd)(r),(0,re.mZ)(n,{lastActivityAt:(0,re.O5)()})]),Ae("Comment deleted successfully","success")}catch(a){console.error("Error deleting comment:",a),Ae("Failed to delete comment. Please try again.","error")}},w=e=>e&&e.toDate?e.toDate().toLocaleString():"";return{comments:t,newComment:a,addComment:o,canEdit:i,canDelete:u,startEditing:c,cancelEdit:d,saveEdit:v,deleteComment:p,editingCommentId:s,editingText:n,formatDate:w}}};var Fe=a(262);const Ue=(0,Fe.A)(Se,[["render",Xe],["__scopeId","data-v-ba2e816a"]]),Ke=Ue,He=["onClick","onMouseover"],Ve={height:"16px",width:"16px",viewBox:"0 0 24 24",fill:"currentColor"},Qe=["d"];function Ne(e,t,a,s,l,o){return(0,r.uX)(),(0,r.CE)("div",{class:(0,n.C4)(["star-rating",{"is-editable":a.editable}])},[((0,r.uX)(),(0,r.CE)(r.FK,null,(0,r.pI)(5,e=>(0,r.Lk)("span",{key:e,onClick:t=>s.setRating(e),onMouseover:t=>s.handleMouseover(e),onMouseleave:t[0]||(t[0]=(...e)=>s.handleMouseleave&&s.handleMouseleave(...e)),class:"star"},[((0,r.uX)(),(0,r.CE)("svg",Ve,[t[1]||(t[1]=(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"},null,-1)),(0,r.Lk)("path",{d:s.getStarPath(e)},null,8,Qe)]))],40,He)),64))],2)}const Be={name:"StarRating",props:{rating:{type:Number,required:!0,default:0},editable:{type:Boolean,default:!1}},emits:["update:rating"],setup(e,{emit:t}){const a=(0,te.KR)(0),s="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27z",r="M22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27V6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L18.18 21l-1.64-7.03L22 9.24zM12 15.4z",n="M22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.64-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z",l=t=>{const l=a.value||e.rating;return l>=t?s:!a.value&&e.rating>=t-.5?r:n},o=a=>{e.editable&&t("update:rating",a)},i=t=>{e.editable&&(a.value=t)},u=()=>{e.editable&&(a.value=0)};return{getStarPath:l,setRating:o,handleMouseover:i,handleMouseleave:u}}},Je=(0,Fe.A)(Be,[["render",Ne],["__scopeId","data-v-32f96f7e"]]),Ge=Je;function Te(e,t,a,s){if(null===e||null===t||null===a||null===s)return null;if(e===a&&t===s)return 0;const r=3959,n=(a-e)*Math.PI/180,l=(s-t)*Math.PI/180,o=Math.sin(n/2)*Math.sin(n/2)+Math.cos(e*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin(l/2)*Math.sin(l/2),i=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o));return r*i}const De={name:"Home",components:{StarRating:Ge,Comments:Ke},props:{user:{type:Object,default:null}},setup(e){const t=(0,te.KR)([]),a=(0,te.KR)(!0),s=(0,te.KR)(null),n=(0,te.KR)(""),l=(0,te.KR)(null),o=(0,te.KR)(!1),i=new Map,u=(0,te.KR)([]),c=10;let d=null;const v=[],p=(0,te.KR)(new Set),w=(0,te.KR)(new Map),g=(0,te.KR)(new Map),m=(0,te.KR)("time");let h=!1;const k=()=>{i.forEach(e=>{const t=w.value.get(e.userId);e.medal=R(t)});const e=Array.from(i.values()).sort((e,t)=>{if("distance"===m.value&&s.value){const a=e.distance??1/0,s=t.distance??1/0;if(a!==s)return a-s;const r=e.lastActivityAt||e.createdAt,n=t.lastActivityAt||t.createdAt;return n.seconds-r.seconds}const a=e.lastActivityAt||e.createdAt,r=t.lastActivityAt||t.createdAt;return r.seconds-a.seconds});u.value=e,t.value=u.value.slice(0,t.value.length||c)};(0,r.hi)(()=>{v.forEach(e=>e()),d&&d.disconnect()}),(0,r.sV)(()=>{d=new IntersectionObserver(e=>{e[0].isIntersecting&&y()}),C()}),(0,r.wB)(s,e=>{e&&i.size>0&&(i.forEach(t=>{const a=g.value.get(t.restaurantId);t.distance=a?.location?Te(e.lat,e.lng,a.location.lat,a.location.lng):null}),k())}),(0,r.wB)(()=>e.user,(e,t)=>{e?.uid===t?.uid||h||L()}),(0,r.wB)(l,(e,t)=>{t&&d.unobserve(t),e&&d.observe(e)});const L=async()=>{if(!h){h=!0,a.value=!0;try{v.forEach(e=>{try{e()}catch(t){console.warn("Error unsubscribing listener:",t)}}),v.length=0,i.clear(),await new Promise(e=>setTimeout(e,100));const t=e.user;if(t){const e=(0,re.P)((0,re.rJ)(ce,"bucketListItems"),(0,re._M)("userId","==",t.uid)),a=(0,re.aQ)(e,e=>{const t=new Set;e.forEach(e=>t.add(e.data().restaurantId)),p.value=t},e=>{console.error("Error in bucket list listener:",e)});v.push(a)}else p.value.clear();const r=t?(0,re.GG)((0,re.P)((0,re.rJ)(ce,"follows"),(0,re._M)("followerId","==",t.uid))):Promise.resolve({docs:[]}),[n,l,o,u]=await Promise.all([r,(0,re.GG)((0,re.rJ)(ce,"restaurants")),(0,re.GG)((0,re.rJ)(ce,"users")),(0,re.GG)((0,re.P)((0,re.rJ)(ce,"users"),(0,re.My)("reviewCount","desc"),(0,re.AB)(30)))]),c=u.docs.map(e=>({id:e.id,...e.data()})).filter(e=>{const t=Number(e.reviewCount)||0;return t>0}).sort((e,t)=>{const a=Number(e.reviewCount)||0,s=Number(t.reviewCount)||0;return s-a}).slice(0,10),d=new Map;c.forEach((e,t)=>{d.set(e.id,t)}),w.value=d,g.value.clear(),l.forEach(e=>{g.value.set(e.id,e.data())});const m=new Map;o.forEach(e=>{m.set(e.id,e.data())});const h=(0,re.P)((0,re.rJ)(ce,"users"),(0,re.My)("reviewCount","desc"),(0,re.AB)(30)),L=(0,re.aQ)(h,e=>{const t=e.docs.map(e=>({id:e.id,...e.data()})).filter(e=>{const t=Number(e.reviewCount)||0;return t>0}).sort((e,t)=>{const a=Number(e.reviewCount)||0,s=Number(t.reviewCount)||0;return s-a}).slice(0,10),a=new Map;t.forEach((e,t)=>{a.set(e.id,t)}),w.value=a,k()},e=>{console.error("Error in leaderboard listener:",e)});v.push(L);const y=e=>{e.docChanges().forEach(e=>{if("removed"===e.type)i.delete(e.doc.id);else{const t=e.doc.data(),a=g.value.get(t.restaurantId),r=m.get(t.userId),n=w.value.get(t.userId),l={...t,id:e.doc.id,restaurantName:a?.name||"Unknown Restaurant",restaurantCity:a?.city,restaurantState:a?.state,location:a?.location||null,distance:s.value&&a?.location?Te(s.value.lat,s.value.lng,a.location.lat,a.location.lng):null,userName:r?.displayName||"Unknown User",userPhoto:r?.photoURL||null,medal:R(n),likeCount:0,isLiked:!1};i.set(l.id,l),x(l.id)}}),k(),a.value=!1};if(t){const e=n.docs.map(e=>e.data().followingId);if(e.includes(t.uid)||e.push(t.uid),e.length>0)for(let t=0;t<e.length;t+=30){const a=e.slice(t,t+30),s=(0,re.P)((0,re.rJ)(ce,"reviews"),(0,re._M)("userId","in",a),(0,re.My)("lastActivityAt","desc")),r=(0,re.aQ)(s,y,e=>console.error("Feed error (followed):",e));v.push(r)}if(s.value){const e=[];if(l.forEach(t=>{const a=t.data();if(a.location){const r=Te(s.value.lat,s.value.lng,a.location.lat,a.location.lng);null!==r&&r<=100&&e.push(t.id)}}),e.length>0)for(let t=0;t<e.length;t+=30){const a=e.slice(t,t+30),s=(0,re.P)((0,re.rJ)(ce,"reviews"),(0,re._M)("restaurantId","in",a),(0,re.My)("lastActivityAt","desc")),r=(0,re.aQ)(s,y,e=>console.error("Feed error (nearby):",e));v.push(r)}}}else{const e=(0,re.P)((0,re.rJ)(ce,"reviews"),(0,re.My)("lastActivityAt","desc"),(0,re.AB)(50)),t=(0,re.aQ)(e,y,e=>console.error("Feed error (recent for guests):",e));v.push(t)}0===v.length&&(a.value=!1)}catch(t){console.error("Error setting up feed listeners:",t),a.value=!1,v.forEach(e=>{try{e()}catch(t){}}),v.length=0}finally{h=!1}}},y=()=>{o.value||t.value.length>=u.value.length||(o.value=!0,setTimeout(()=>{const e=t.value.length,a=u.value.slice(e,e+c);t.value.push(...a),o.value=!1},300))},f=()=>{navigator.geolocation.getCurrentPosition(e=>{n.value="granted",s.value={lat:e.coords.latitude,lng:e.coords.longitude}},()=>{n.value="denied"},{timeout:1e4})},C=async()=>{if(navigator.permissions)try{const e=await navigator.permissions.query({name:"geolocation"});n.value=e.state,e.onchange=()=>{n.value=e.state,"granted"===e.state&&f()},"granted"===e.state&&f()}catch(e){console.error("Error checking location permission:",e),f()}finally{L()}else f()},b=e=>{m.value!==e&&(m.value=e,k())},R=e=>"number"!==typeof e?null:0===e?"ðŸ¥‡":1===e?"ðŸ¥ˆ":2===e?"ðŸ¥‰":e>=3&&e<10?"ðŸ…":null,E=e=>p.value.has(e),M=async t=>{const a=e.user;if(a)if(E(t.restaurantId)){const e=(0,re.P)((0,re.rJ)(ce,"bucketListItems"),(0,re._M)("userId","==",a.uid),(0,re._M)("restaurantId","==",t.restaurantId)),s=await(0,re.GG)(e);s.forEach(e=>(0,re.kd)(e.ref))}else await(0,re.gS)((0,re.rJ)(ce,"bucketListItems"),{userId:a.uid,restaurantId:t.restaurantId,createdAt:(0,re.O5)()})},x=t=>{const a=e.user,s=(0,re.H9)(ce,"reviews",t),r=(0,re.rJ)(s,"likes"),n=(0,re.P)(r),l=(0,re.aQ)(n,e=>{const s=i.get(t);s&&(s.likeCount=e.size,s.isLiked=!!a&&e.docs.some(e=>e.data().userId===a.uid),i.set(t,s),k())},e=>{console.error("Error fetching likes:",e)});v.push(l)},I=async t=>{const a=e.user;if(!a)return;const s=(0,re.H9)(ce,"reviews",t),r=(0,re.rJ)(s,"likes"),n=(0,re.P)(r,(0,re._M)("userId","==",a.uid)),l=await(0,re.GG)(n);l.empty?await(0,re.gS)(r,{userId:a.uid,createdAt:(0,re.O5)()}):await(0,re.kd)(l.docs[0].ref)},X=async e=>{const t=window.location.origin,a=`${t}/review/${e}`;if(navigator.share)try{return void await navigator.share({title:"Check out this review on PorkHub",text:"Check out this review on PorkHub",url:a})}catch(s){"AbortError"!==s.name&&console.error("Error sharing:",s)}try{await navigator.clipboard.writeText(a),Ae("Link copied to clipboard!","success")}catch(s){console.error("Failed to copy link:",s);const e=prompt("Copy this link:",a);e&&Ae("Link copied!","success")}};return{posts:t,loading:a,locationPermission:n,requestLocationAccess:f,loadMoreTrigger:l,loadingMore:o,isInBucketList:E,toggleBucketList:M,userLocation:s,sortOrder:m,setSortOrder:b,toggleLike:I,shareReview:X}}},$e=(0,Fe.A)(De,[["render",ee],["__scopeId","data-v-2fec4a57"]]),We=$e,Oe={class:"restaurants-page"},qe={class:"search-box"},je={key:3,class:"add-restaurant-container"},Ze={class:"form-group"},Ye={class:"form-group"},et={class:"form-group-row"},tt={class:"form-group"},at={class:"form-group"},st={class:"form-group"},rt={class:"form-group"},nt={key:0,class:"error-message"},lt=["disabled"],ot={key:4,class:"loading-indicator"},it={key:5,class:"restaurant-list-container"},ut={key:0,class:"restaurant-list"},ct={class:"restaurant-details"},dt={class:"restaurant-name"},vt={class:"restaurant-meta"},pt=["title"],wt={class:"rating-text"},gt={class:"rating-count"},mt={key:1,class:"distance"},ht={class:"restaurant-address"},kt={class:"restaurant-actions"},Lt=["onClick","title"],yt=["onClick"],ft=["onClick"],Ct=["href"],bt=["href"],Rt=["href"],Et=["onClick"],Mt={key:1,class:"no-restaurants-message"};function xt(e,t,a,l,o,i){const u=(0,r.g2)("EditRestaurantModal"),c=(0,r.g2)("AddReviewModal"),d=(0,r.g2)("RestaurantReviewsModal"),v=(0,r.g2)("StarRating");return(0,r.uX)(),(0,r.CE)("div",Oe,[l.isEditModalVisible?((0,r.uX)(),(0,r.Wv)(u,{key:0,restaurant:l.restaurantToEdit,onClose:l.closeEditModal,onSave:l.saveRestaurantChanges},null,8,["restaurant","onClose","onSave"])):(0,r.Q3)("",!0),l.isAddReviewModalVisible?((0,r.uX)(),(0,r.Wv)(c,{key:1,"restaurant-id":l.restaurantIdForNewReview,user:l.user,onClose:l.closeAddReviewModal,onReviewAdded:l.handleReviewAdded},null,8,["restaurant-id","user","onClose","onReviewAdded"])):(0,r.Q3)("",!0),l.isReviewsModalVisible?((0,r.uX)(),(0,r.Wv)(d,{key:2,restaurant:l.restaurantForReviews,user:l.user,onClose:l.closeReviewsModal,onReviewsUpdated:l.handleReviewOrUpdate},null,8,["restaurant","user","onClose","onReviewsUpdated"])):(0,r.Q3)("",!0),(0,r.Lk)("div",qe,[(0,r.bo)((0,r.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>l.searchQuery=e),placeholder:"Search by name, address, city, state, or zip...",class:"search-input","aria-label":"Search restaurants"},null,512),[[s.Jo,l.searchQuery]])]),l.user?((0,r.uX)(),(0,r.CE)("div",je,[(0,r.Lk)("button",{onClick:t[1]||(t[1]=e=>l.showAddForm=!l.showAddForm),class:"btn-toggle-add"},(0,n.v_)(l.showAddForm?"Cancel":"Add New Restaurant"),1),l.showAddForm?((0,r.uX)(),(0,r.CE)("form",{key:0,onSubmit:t[8]||(t[8]=(0,s.D$)((...e)=>l.addNewRestaurant&&l.addNewRestaurant(...e),["prevent"])),class:"add-restaurant-form"},[t[15]||(t[15]=(0,r.Lk)("h3",null,"Add a New Restaurant",-1)),(0,r.Lk)("div",Ze,[t[9]||(t[9]=(0,r.Lk)("label",{for:"new-name"},"Name",-1)),(0,r.bo)((0,r.Lk)("input",{id:"new-name",type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>l.newRestaurant.name=e),required:""},null,512),[[s.Jo,l.newRestaurant.name]])]),(0,r.Lk)("div",Ye,[t[10]||(t[10]=(0,r.Lk)("label",{for:"new-address"},"Address",-1)),(0,r.bo)((0,r.Lk)("input",{id:"new-address",type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>l.newRestaurant.address=e),required:""},null,512),[[s.Jo,l.newRestaurant.address]])]),(0,r.Lk)("div",et,[(0,r.Lk)("div",tt,[t[11]||(t[11]=(0,r.Lk)("label",{for:"new-city"},"City",-1)),(0,r.bo)((0,r.Lk)("input",{id:"new-city",type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>l.newRestaurant.city=e)},null,512),[[s.Jo,l.newRestaurant.city]])]),(0,r.Lk)("div",at,[t[12]||(t[12]=(0,r.Lk)("label",{for:"new-state"},"State",-1)),(0,r.bo)((0,r.Lk)("input",{id:"new-state",type:"text","onUpdate:modelValue":t[5]||(t[5]=e=>l.newRestaurant.state=e)},null,512),[[s.Jo,l.newRestaurant.state]])]),(0,r.Lk)("div",st,[t[13]||(t[13]=(0,r.Lk)("label",{for:"new-zip"},"Zip",-1)),(0,r.bo)((0,r.Lk)("input",{id:"new-zip",type:"text","onUpdate:modelValue":t[6]||(t[6]=e=>l.newRestaurant.zip=e)},null,512),[[s.Jo,l.newRestaurant.zip]])])]),(0,r.Lk)("div",rt,[t[14]||(t[14]=(0,r.Lk)("label",{for:"new-url"},"Website URL",-1)),(0,r.bo)((0,r.Lk)("input",{id:"new-url",type:"url","onUpdate:modelValue":t[7]||(t[7]=e=>l.newRestaurant.url=e),placeholder:"https://example.com"},null,512),[[s.Jo,l.newRestaurant.url]])]),l.addError?((0,r.uX)(),(0,r.CE)("p",nt,(0,n.v_)(l.addError),1)):(0,r.Q3)("",!0),(0,r.Lk)("button",{type:"submit",disabled:l.isSaving,class:"btn-save"},(0,n.v_)(l.isSaving?"Saving...":"Save Restaurant"),9,lt)],32)):(0,r.Q3)("",!0)])):(0,r.Q3)("",!0),l.loading?((0,r.uX)(),(0,r.CE)("div",ot,"Loading restaurants...")):((0,r.uX)(),(0,r.CE)("div",it,[l.filteredRestaurants.length>0?((0,r.uX)(),(0,r.CE)("ul",ut,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.filteredRestaurants,e=>((0,r.uX)(),(0,r.CE)("li",{key:e.id,class:"restaurant-item"},[(0,r.Lk)("div",ct,[(0,r.Lk)("span",dt,(0,n.v_)(e.name),1),(0,r.Lk)("div",vt,[e.averageRating>0?((0,r.uX)(),(0,r.CE)("div",{key:0,class:"rating",title:`${e.averageRating.toFixed(2)} average rating`},[(0,r.bF)(v,{rating:e.averageRating},null,8,["rating"]),(0,r.Lk)("span",wt,(0,n.v_)(e.averageRating.toFixed(1)),1),(0,r.Lk)("span",gt,"("+(0,n.v_)(e.ratingCount)+")",1)],8,pt)):(0,r.Q3)("",!0),null!==e.distance?((0,r.uX)(),(0,r.CE)("span",mt,(0,n.v_)(e.distance.toFixed(1))+" miles away ",1)):(0,r.Q3)("",!0)]),(0,r.Lk)("span",ht,[(0,r.eW)((0,n.v_)(e.address),1),e.city?((0,r.uX)(),(0,r.CE)(r.FK,{key:0},[(0,r.eW)(", "+(0,n.v_)(e.city),1)],64)):(0,r.Q3)("",!0),e.state?((0,r.uX)(),(0,r.CE)(r.FK,{key:1},[(0,r.eW)(", "+(0,n.v_)(e.state),1)],64)):(0,r.Q3)("",!0),e.zip?((0,r.uX)(),(0,r.CE)(r.FK,{key:2},[(0,r.eW)((0,n.v_)(e.zip),1)],64)):(0,r.Q3)("",!0)])]),(0,r.Lk)("div",kt,[l.user?((0,r.uX)(),(0,r.CE)("button",{key:0,onClick:t=>l.toggleBucketList(e),class:(0,n.C4)(["action-btn",{"in-bucket-list":l.isInBucketList(e.id)}]),title:l.isInBucketList(e.id)?"Remove from Bucket List":"Add to Bucket List"},t[16]||(t[16]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M18 7h-2.06c-.33-3.2-2.46-5.8-5.94-5.8S4.39 3.8 4.06 7H2v12h16V7zM6.14 7c.2-1.92 1.6-3.48 3.86-3.8A4.002 4.002 0 0 1 14 7h-2.14c-.2-1.92-1.6-3.48-3.86-3.8zM16 17H4v-8h12v8z"})],-1)]),10,Lt)):(0,r.Q3)("",!0),(0,r.Lk)("button",{onClick:t=>l.openReviewsModal(e),class:"action-btn",title:"View Reviews"},t[17]||(t[17]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"})],-1)]),8,yt),l.user?((0,r.uX)(),(0,r.CE)("button",{key:1,onClick:t=>l.openEditModal(e),class:"action-btn",title:"Edit Restaurant"},t[18]||(t[18]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})],-1)]),8,ft)):(0,r.Q3)("",!0),(0,r.Lk)("a",{href:l.getDirectionsUrl(e),target:"_blank",rel:"noopener noreferrer",class:"action-btn",title:"Get Directions"},t[19]||(t[19]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M22.43 10.59l-9.01-9.01c-.75-.75-2.07-.76-2.83 0l-9.01 9.01c-.76.75-.76 2.07 0 2.83l9.01 9.01c.75.75 2.07.75 2.83 0l9.01-9.01c.75-.76.75-2.08 0-2.83zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4z"})],-1)]),8,Ct),(0,r.Lk)("a",{href:l.getDetailsUrl(e),target:"_blank",rel:"noopener noreferrer",class:"action-btn",title:"View Details on Google"},t[20]||(t[20]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 5 1.41-1.41L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})],-1)]),8,bt),e.url?((0,r.uX)(),(0,r.CE)("a",{key:2,href:l.getValidUrl(e.url),target:"_blank",rel:"noopener noreferrer",class:"action-btn",title:"Visit Website"},t[21]||(t[21]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"})],-1)]),8,Rt)):(0,r.Q3)("",!0),l.user?((0,r.uX)(),(0,r.CE)("button",{key:3,class:"check-in-btn",onClick:t=>l.openAddReviewModal(e.id)},"Review",8,Et)):(0,r.Q3)("",!0)])]))),128))])):((0,r.uX)(),(0,r.CE)("p",Mt,"No restaurants found matching your search."))]))])}const It={class:"modal-content"},Xt={class:"form-group"},_t={class:"form-group"},zt={class:"form-group"},At={class:"form-group"},Pt={class:"form-group"},St={class:"form-group"},Ft={class:"modal-actions"};function Ut(e,t,a,n,l,o){return(0,r.uX)(),(0,r.CE)("div",{class:"modal-overlay",onClick:t[8]||(t[8]=(0,s.D$)(t=>e.$emit("close"),["self"]))},[(0,r.Lk)("div",It,[t[16]||(t[16]=(0,r.Lk)("h2",null,"Edit Restaurant",-1)),n.editableRestaurant?((0,r.uX)(),(0,r.CE)("form",{key:0,onSubmit:t[7]||(t[7]=(0,s.D$)((...e)=>n.onSave&&n.onSave(...e),["prevent"]))},[(0,r.Lk)("div",Xt,[t[9]||(t[9]=(0,r.Lk)("label",{for:"name"},"Name",-1)),(0,r.bo)((0,r.Lk)("input",{id:"name","onUpdate:modelValue":t[0]||(t[0]=e=>n.editableRestaurant.name=e),type:"text",required:""},null,512),[[s.Jo,n.editableRestaurant.name]])]),(0,r.Lk)("div",_t,[t[10]||(t[10]=(0,r.Lk)("label",{for:"address"},"Address",-1)),(0,r.bo)((0,r.Lk)("input",{id:"address","onUpdate:modelValue":t[1]||(t[1]=e=>n.editableRestaurant.address=e),type:"text"},null,512),[[s.Jo,n.editableRestaurant.address]])]),(0,r.Lk)("div",zt,[t[11]||(t[11]=(0,r.Lk)("label",{for:"city"},"City",-1)),(0,r.bo)((0,r.Lk)("input",{id:"city","onUpdate:modelValue":t[2]||(t[2]=e=>n.editableRestaurant.city=e),type:"text"},null,512),[[s.Jo,n.editableRestaurant.city]])]),(0,r.Lk)("div",At,[t[12]||(t[12]=(0,r.Lk)("label",{for:"state"},"State",-1)),(0,r.bo)((0,r.Lk)("input",{id:"state","onUpdate:modelValue":t[3]||(t[3]=e=>n.editableRestaurant.state=e),type:"text"},null,512),[[s.Jo,n.editableRestaurant.state]])]),(0,r.Lk)("div",Pt,[t[13]||(t[13]=(0,r.Lk)("label",{for:"zip"},"Zip Code",-1)),(0,r.bo)((0,r.Lk)("input",{id:"zip","onUpdate:modelValue":t[4]||(t[4]=e=>n.editableRestaurant.zip=e),type:"text"},null,512),[[s.Jo,n.editableRestaurant.zip]])]),(0,r.Lk)("div",St,[t[14]||(t[14]=(0,r.Lk)("label",{for:"url"},"Website URL",-1)),(0,r.bo)((0,r.Lk)("input",{id:"url","onUpdate:modelValue":t[5]||(t[5]=e=>n.editableRestaurant.url=e),type:"url",placeholder:"https://example.com"},null,512),[[s.Jo,n.editableRestaurant.url]])]),(0,r.Lk)("div",Ft,[(0,r.Lk)("button",{type:"button",class:"btn-cancel",onClick:t[6]||(t[6]=t=>e.$emit("close"))},"Cancel"),t[15]||(t[15]=(0,r.Lk)("button",{type:"submit",class:"btn-save"},"Save Changes",-1))])],32)):(0,r.Q3)("",!0)])])}const Kt={name:"EditRestaurantModal",props:{restaurant:{type:Object,required:!0}},emits:["close","save"],setup(e,{emit:t}){const a=(0,te.KR)(null);(0,r.wB)(()=>e.restaurant,e=>{e&&(a.value=JSON.parse(JSON.stringify(e)))},{immediate:!0,deep:!0});const s=()=>{t("save",a.value)};return{editableRestaurant:a,onSave:s}}},Ht=(0,Fe.A)(Kt,[["render",Ut],["__scopeId","data-v-2288406c"]]),Vt=Ht,Qt={class:"modal-content"},Nt={class:"modal-header"},Bt=["disabled"],Jt={class:"modal-body"},Gt={class:"form-group"},Tt={class:"form-group"},Dt={class:"form-group"},$t={key:0,class:"photo-preview-container"},Wt=["src"],Ot={key:0,class:"upload-progress"},qt=["value"],jt={key:1,class:"error-message"},Zt={class:"form-actions"},Yt=["disabled"];function ea(e,t,a,l,o,i){const u=(0,r.g2)("StarRating");return(0,r.uX)(),(0,r.CE)("div",{class:"modal-overlay",onClick:t[5]||(t[5]=(0,s.D$)(t=>e.$emit("close"),["self"]))},[(0,r.Lk)("div",Qt,[(0,r.Lk)("div",Nt,[t[6]||(t[6]=(0,r.Lk)("h2",null,"Add Your Review",-1)),(0,r.Lk)("button",{onClick:t[0]||(t[0]=t=>e.$emit("close")),class:"close-btn",disabled:l.isUploading},"Ã—",8,Bt)]),(0,r.Lk)("div",Jt,[(0,r.Lk)("form",{onSubmit:t[4]||(t[4]=(0,s.D$)((...e)=>l.submitReview&&l.submitReview(...e),["prevent"]))},[(0,r.Lk)("div",Gt,[t[7]||(t[7]=(0,r.Lk)("label",null,"Your Rating",-1)),(0,r.bF)(u,{rating:l.review.rating,editable:!0,"onUpdate:rating":t[1]||(t[1]=e=>l.review.rating=e)},null,8,["rating"])]),(0,r.Lk)("div",Tt,[t[8]||(t[8]=(0,r.Lk)("label",{for:"review-text"},"Your Review",-1)),(0,r.bo)((0,r.Lk)("textarea",{id:"review-text","onUpdate:modelValue":t[2]||(t[2]=e=>l.review.text=e),placeholder:"What did you think?"},null,512),[[s.Jo,l.review.text]])]),(0,r.Lk)("div",Dt,[t[9]||(t[9]=(0,r.Lk)("label",{for:"review-photo"},"Add a Photo",-1)),(0,r.Lk)("input",{type:"file",id:"review-photo",onChange:t[3]||(t[3]=(...e)=>l.handleFileChange&&l.handleFileChange(...e)),accept:"image/*"},null,32),l.photoPreview?((0,r.uX)(),(0,r.CE)("div",$t,[(0,r.Lk)("img",{src:l.photoPreview,alt:"Photo preview",class:"photo-preview"},null,8,Wt)])):(0,r.Q3)("",!0)]),l.isUploading?((0,r.uX)(),(0,r.CE)("div",Ot,[(0,r.Lk)("p",null,"Uploading... "+(0,n.v_)(l.uploadProgress.toFixed(0))+"%",1),(0,r.Lk)("progress",{value:l.uploadProgress,max:"100"},null,8,qt)])):(0,r.Q3)("",!0),l.error?((0,r.uX)(),(0,r.CE)("div",jt,(0,n.v_)(l.error),1)):(0,r.Q3)("",!0),(0,r.Lk)("div",Zt,[(0,r.Lk)("button",{type:"submit",class:"btn-primary",disabled:l.isUploading||0===l.review.rating},(0,n.v_)(l.isUploading?"Submitting...":"Submit Review"),9,Yt)])],32)])])])}const ta={name:"AddReviewModal",components:{StarRating:Ge},props:{restaurantId:{type:String,required:!0},user:{type:Object,required:!0}},emits:["close","review-added"],setup(e,{emit:t}){const a=(0,te.KR)({rating:0,text:""}),s=(0,te.KR)(null),r=(0,te.KR)(null),n=(0,te.KR)(!1),l=(0,te.KR)(0),o=(0,te.KR)(""),i=e=>{const t=e.target.files[0];if(!t)return s.value=null,void(r.value=null);if(!t.type.startsWith("image/"))return void(o.value="Please select an image file.");r.value=URL.createObjectURL(t);const a=new FileReader;a.onload=e=>{const a=new Image;a.onload=()=>{const e=1024;let{width:r,height:n}=a;r>n?r>e&&(n*=e/r,r=e):n>e&&(r*=e/n,n=e);const l=document.createElement("canvas");l.width=r,l.height=n;const o=l.getContext("2d");o.drawImage(a,0,0,r,n),l.toBlob(e=>{s.value=e},t.type,.9)},a.src=e.target.result},a.readAsDataURL(t)},u=async()=>{if(0!==a.value.rating){n.value=!0,o.value="";try{let i=null;if(s.value){const t=`reviews/${e.restaurantId}/${Date.now()}_${e.user.uid}`,a=(0,ne.KR)(de,t),r=(0,ne.bp)(a,s.value);await new Promise((e,t)=>{r.on("state_changed",e=>{l.value=e.bytesTransferred/e.totalBytes*100},e=>{console.error("Upload failed:",e),o.value="Image upload failed. Please try again.",n.value=!1,t(e)},async()=>{i=await(0,ne.qk)(r.snapshot.ref),e()})})}const u=(0,re.O5)(),c={userId:e.user.uid,userName:e.user.displayName||"Anonymous",userPhoto:e.user.photoURL,restaurantId:e.restaurantId,rating:a.value.rating,text:a.value.text,photoURL:i,tags:[],createdAt:u,lastActivityAt:u};await(0,re.gS)((0,re.rJ)(ce,"reviews"),c);const d=(0,re.H9)(ce,"users",e.user.uid);try{await(0,re.mZ)(d,{reviewCount:(0,re.GV)(1)})}catch(r){console.warn("Failed to update reviewCount (non-critical):",r)}Ae("Review added successfully!","success",2e3),t("review-added",e.restaurantId)}catch(i){o.value||(console.error("Error submitting review:",i),o.value="Failed to submit review. Please try again.",Ae("Failed to submit review. Please try again.","error")),n.value=!1}}else o.value="Please provide a star rating."};return{review:a,photoPreview:r,isUploading:n,uploadProgress:l,error:o,handleFileChange:i,submitReview:u}}},aa=(0,Fe.A)(ta,[["render",ea],["__scopeId","data-v-b8084282"]]),sa=aa,ra={class:"modal-content"},na={class:"modal-header"},la={class:"modal-body"},oa={key:0,class:"no-reviews-message"},ia={key:1,class:"reviews-list"},ua={key:0},ca={class:"edit-review-form"},da={class:"edit-actions"},va={key:1},pa={class:"review-header"},wa=["src"],ga={class:"user-info"},ma={class:"user-name"},ha={class:"review-date"},ka={key:0,class:"review-actions"},La=["onClick"],ya=["onClick"],fa={class:"review-body"},Ca={key:0,class:"review-text"},ba={key:1,class:"review-photo-container"},Ra=["src"],Ea={key:2,class:"tags-container"};function Ma(e,t,a,l,o,i){const u=(0,r.g2)("StarRating");return(0,r.uX)(),(0,r.CE)("div",{class:"modal-overlay",onClick:t[5]||(t[5]=(0,s.D$)(t=>e.$emit("close"),["self"]))},[(0,r.Lk)("div",ra,[(0,r.Lk)("div",na,[(0,r.Lk)("h2",null,"Reviews for "+(0,n.v_)(a.restaurant.name),1),(0,r.Lk)("button",{onClick:t[0]||(t[0]=t=>e.$emit("close")),class:"close-btn"},"Ã—")]),(0,r.Lk)("div",la,[a.restaurant.reviews&&0===a.restaurant.reviews.length?((0,r.uX)(),(0,r.CE)("div",oa," No reviews yet for this restaurant. ")):((0,r.uX)(),(0,r.CE)("ul",ia,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.restaurant.reviews,e=>((0,r.uX)(),(0,r.CE)("li",{key:e.id,class:"review-item"},[l.editingReview&&l.editingReview.id===e.id?((0,r.uX)(),(0,r.CE)("div",ua,[(0,r.Lk)("div",ca,[(0,r.bF)(u,{rating:l.editingReview.rating,editable:!0,"onUpdate:rating":t[1]||(t[1]=e=>l.editingReview.rating=e)},null,8,["rating"]),(0,r.bo)((0,r.Lk)("textarea",{"onUpdate:modelValue":t[2]||(t[2]=e=>l.editingReview.text=e),class:"edit-textarea"},null,512),[[s.Jo,l.editingReview.text]]),(0,r.Lk)("div",da,[(0,r.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>l.saveEdit&&l.saveEdit(...e)),class:"btn-primary"},"Save"),(0,r.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>l.cancelEdit&&l.cancelEdit(...e)),class:"btn-secondary"},"Cancel")])])])):((0,r.uX)(),(0,r.CE)("div",va,[(0,r.Lk)("div",pa,[(0,r.Lk)("img",{src:e.userPhoto||"https://cdn-icons-png.flaticon.com/512/149/149071.png",alt:"User",class:"user-avatar"},null,8,wa),(0,r.Lk)("div",ga,[(0,r.Lk)("span",ma,(0,n.v_)(e.userName),1),(0,r.Lk)("span",ha,(0,n.v_)(l.formatDate(e.createdAt)),1)]),a.user&&a.user.uid===e.userId?((0,r.uX)(),(0,r.CE)("div",ka,[(0,r.Lk)("button",{onClick:t=>l.startEditing(e),class:"action-btn",title:"Edit Review"},t[6]||(t[6]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"18px",viewBox:"0 0 24 24",width:"18px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})],-1)]),8,La),(0,r.Lk)("button",{onClick:t=>l.deleteReview(e.id),class:"action-btn",title:"Delete Review"},t[7]||(t[7]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"18px",viewBox:"0 0 24 24",width:"18px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})],-1)]),8,ya)])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",fa,[(0,r.bF)(u,{rating:e.rating},null,8,["rating"]),e.text?((0,r.uX)(),(0,r.CE)("p",Ca,'"'+(0,n.v_)(e.text)+'"',1)):(0,r.Q3)("",!0),e.photoURL?((0,r.uX)(),(0,r.CE)("div",ba,[(0,r.Lk)("img",{src:e.photoURL,alt:"Review photo",class:"review-photo",loading:"lazy"},null,8,Ra)])):(0,r.Q3)("",!0),e.tags&&e.tags.length>0?((0,r.uX)(),(0,r.CE)("div",Ea,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.tags,e=>((0,r.uX)(),(0,r.CE)("span",{key:e,class:"tag"},(0,n.v_)(e),1))),128))])):(0,r.Q3)("",!0)])]))]))),128))]))])])])}const xa={name:"RestaurantReviewsModal",components:{StarRating:Ge},props:{restaurant:{type:Object,required:!0},user:{type:Object,default:null}},emits:["close","reviews-updated"],setup(e,{emit:t}){const a=(0,te.KR)(null),s=e=>e&&e.toDate?e.toDate().toLocaleDateString():"",r=e=>{a.value=JSON.parse(JSON.stringify(e))},n=()=>{a.value=null},l=async()=>{if(!a.value)return;const e=(0,re.H9)(ce,"reviews",a.value.id);try{await(0,re.mZ)(e,{rating:a.value.rating,text:a.value.text}),t("reviews-updated"),n(),Ae("Review updated successfully!","success")}catch(s){console.error("Error updating review:",s),Ae("Failed to save review. Please try again.","error")}},o=async e=>{if(confirm("Are you sure you want to delete this review?"))try{await(0,re.kd)((0,re.H9)(ce,"reviews",e)),t("reviews-updated"),Ae("Review deleted successfully","success")}catch(a){console.error("Error deleting review:",a),Ae("Failed to delete review. Please try again.","error")}};return{formatDate:s,editingReview:a,startEditing:r,cancelEdit:n,saveEdit:l,deleteReview:o}}},Ia=(0,Fe.A)(xa,[["render",Ma],["__scopeId","data-v-6bcdd790"]]),Xa=Ia,_a={name:"Restaurants",components:{EditRestaurantModal:Vt,StarRating:Ge,RestaurantReviewsModal:Xa,AddReviewModal:sa},props:{user:{type:Object,default:null}},setup(e){const t=(0,te.KR)([]),s=(0,te.KR)([]),n=(0,te.KR)(!0),l=(0,te.KR)(""),o=(0,te.KR)(!1),i=(0,te.KR)(!1),u=(0,te.KR)(!1),c=(0,te.KR)(null),d=(0,te.KR)(null),v=(0,te.KR)(null),p=(0,te.KR)(null),w=(0,te.KR)(new Set),g=(0,te.KR)(!1),m=(0,te.KR)({name:"",address:"",city:"",state:"",zip:"",url:""}),h=(0,te.KR)(""),k=(0,te.KR)(!1);let L=()=>{},y=()=>{},f=()=>{};const C=(0,r.EW)(()=>{const e={};return s.value.forEach(t=>{t.restaurantId&&"number"===typeof t.rating&&(e[t.restaurantId]||(e[t.restaurantId]={total:0,count:0,reviews:[]}),e[t.restaurantId].total+=t.rating,e[t.restaurantId].count++,e[t.restaurantId].reviews.push(t))}),t.value.map(t=>{const a=e[t.id],s=a?a.reviews.sort((e,t)=>(t.createdAt?.seconds??0)-(e.createdAt?.seconds??0)):[];return{...t,averageRating:a?a.total/a.count:0,ratingCount:a?a.count:0,reviews:s}})});(0,r.sV)(()=>{n.value=!0;const e=(0,re.rJ)(ce,"restaurants");y=(0,re.aQ)(e,e=>{t.value=e.docs.map(e=>({id:e.id,...e.data()})),s.value.length>0&&(n.value=!1)},e=>{console.error("Error fetching restaurants:",e),n.value=!1});const a=(0,re.rJ)(ce,"reviews");f=(0,re.aQ)(a,e=>{s.value=e.docs.map(e=>({id:e.id,...e.data()})),n.value=!1},e=>{console.error("Error fetching reviews:",e),n.value=!1}),navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{p.value={lat:e.coords.latitude,lng:e.coords.longitude}},e=>{console.error("Error getting location",e)}):console.error("Geolocation is not supported by this browser.")}),(0,r.hi)(()=>{L(),y(),f()});const b=e=>{L();const t=(0,re.P)((0,re.rJ)(ce,"bucketListItems"),(0,re._M)("userId","==",e));L=(0,re.aQ)(t,e=>{const t=new Set;e.forEach(e=>t.add(e.data().restaurantId)),w.value=t})};(0,r.wB)(()=>e.user,e=>{e?b(e.uid):(L(),w.value.clear())},{immediate:!0});const R=(0,r.EW)(()=>C.value.map(e=>{const t=p.value&&e.location?Te(p.value.lat,p.value.lng,e.location.lat,e.location.lng):null;return{...e,distance:t}}).sort((e,t)=>null===e.distance?1:null===t.distance?-1:e.distance-t.distance)),E=(0,r.EW)(()=>{if(!l.value.trim())return R.value;const e=l.value.toLowerCase();return R.value.filter(t=>t.name&&t.name.toLowerCase().includes(e)||t.address&&t.address.toLowerCase().includes(e)||t.city&&t.city.toLowerCase().includes(e)||t.state&&t.state.toLowerCase().includes(e)||t.zip&&t.zip.toLowerCase().includes(e))}),M=e=>{const t=encodeURIComponent(`${e.name}, ${e.address}`);return`https://www.google.com/maps/dir/?api=1&destination=${t}`},x=e=>{const t=encodeURIComponent(`${e.name}, ${e.address}`);return`https://www.google.com/search?q=${t}`},I=e=>e?e.startsWith("http://")||e.startsWith("https://")?e:`https://${e}`:"#",X=e=>{c.value=e,o.value=!0},_=()=>{o.value=!1,c.value=null},z=e=>{v.value=e,u.value=!0},A=()=>{u.value=!1,v.value=null},P=e=>{d.value=e,i.value=!0},S=()=>{i.value=!1,d.value=null},F=async e=>{S()},U=async()=>{},K=async e=>{const t={...e};if(!t||!t.id)return;const s=c.value,r={},n=s.name!==t.name;n&&(r.name=t.name,r.name_lowercase=t.name.trim().toLowerCase());const l=["address","city","state","zip"],o=l.some(e=>s[e]!==t[e]);if(o){r.address=t.address,r.city=t.city,r.state=t.state,r.zip=t.zip,r.address_lowercase=(t.address||"").trim().toLowerCase();const e=[t.address,t.city,t.state,t.zip].filter(Boolean).join(", "),{geocodeAddress:s}=await Promise.resolve().then(a.bind(a,914)),n=await s(e);n?r.location=n:(Ae("Could not find a location for the provided address. The restaurant will be saved without a location.","warning",5e3),r.location=null)}if(s.url!==t.url&&(r.url=t.url),0===Object.keys(r).length)return void _();const i=(0,re.H9)(ce,"restaurants",t.id);try{await(0,re.mZ)(i,r),_()}catch(u){console.error("Error updating restaurant: ",u),Ae("Failed to save changes. Please try again.","error")}},H=async()=>{if(!e.user)return void(h.value="You must be logged in to add a restaurant.");if(!m.value.name.trim()||!m.value.address.trim())return void(h.value="Restaurant name and address are required.");k.value=!0,h.value="";const t=m.value.name.trim().toLowerCase(),s=m.value.address.trim().toLowerCase();try{const r=(0,re.P)((0,re.rJ)(ce,"restaurants"),(0,re._M)("name_lowercase","==",t),(0,re._M)("address_lowercase","==",s)),n=await(0,re.GG)(r);if(!n.empty)return h.value="This restaurant already exists.",void(k.value=!1);const l=[m.value.address,m.value.city,m.value.state,m.value.zip].filter(Boolean).join(", "),{geocodeAddress:o}=await Promise.resolve().then(a.bind(a,914)),i=await o(l);if(!i)return h.value="Could not find a location for the provided address. Please check the address and try again.",void(k.value=!1);const u={name:m.value.name.trim(),address:m.value.address.trim(),city:m.value.city.trim(),state:m.value.state.trim(),zip:m.value.zip.trim(),url:m.value.url.trim(),name_lowercase:t,address_lowercase:s,location:i,createdAt:(0,re.O5)(),userId:e.user.uid,userDisplayName:e.user.displayName||"Anonymous"};await(0,re.gS)((0,re.rJ)(ce,"restaurants"),u);g.value=!1,m.value={name:"",address:"",city:"",state:"",zip:"",url:""}}catch(r){console.error("Error adding new restaurant:",r),h.value="Failed to add restaurant. Please try again."}finally{k.value=!1}},V=e=>w.value.has(e),Q=async t=>{const a=e.user;if(a)if(V(t.id)){const e=(0,re.P)((0,re.rJ)(ce,"bucketListItems"),(0,re._M)("userId","==",a.uid),(0,re._M)("restaurantId","==",t.id)),s=await(0,re.GG)(e);s.forEach(e=>(0,re.kd)(e.ref))}else await(0,re.gS)((0,re.rJ)(ce,"bucketListItems"),{userId:a.uid,restaurantId:t.id,createdAt:(0,re.O5)()})};return{user:e.user,loading:n,searchQuery:l,filteredRestaurants:E,getDirectionsUrl:M,getDetailsUrl:x,getValidUrl:I,isEditModalVisible:o,restaurantToEdit:c,isReviewsModalVisible:u,restaurantForReviews:v,openEditModal:X,closeEditModal:_,saveRestaurantChanges:K,openReviewsModal:z,closeReviewsModal:A,handleReviewOrUpdate:U,isInBucketList:V,toggleBucketList:Q,showAddForm:g,newRestaurant:m,addNewRestaurant:H,addError:h,isSaving:k,isAddReviewModalVisible:i,restaurantIdForNewReview:d,openAddReviewModal:P,closeAddReviewModal:S,handleReviewAdded:F}}},za=(0,Fe.A)(_a,[["render",xt],["__scopeId","data-v-14b51ebe"]]),Aa=za,Pa={class:"user-search-page"},Sa={class:"search-box"},Fa={key:0},Ua={key:1},Ka={key:0,class:"no-users-message"},Ha={key:0},Va={key:1},Qa={class:"user-card-content"},Na={class:"user-info"},Ba=["src"],Ja={class:"user-details"},Ga={class:"user-name-line"},Ta={class:"user-name"},Da={key:0,class:"medal"},$a={key:0,class:"user-distance"},Wa={key:0,class:"last-review"},Oa={class:"review-header"},qa={class:"review-body"},ja={key:0,class:"review-text"},Za={key:1,class:"last-review no-review"},Ya={class:"user-actions"},es=["onClick"],ts=["onClick"];function as(e,t,a,l,o,i){const u=(0,r.g2)("UserReviewsModal"),c=(0,r.g2)("StarRating");return(0,r.uX)(),(0,r.CE)(r.FK,null,[l.isReviewsModalVisible?((0,r.uX)(),(0,r.Wv)(u,{key:0,user:l.userForReviews,onClose:l.closeReviewsModal},null,8,["user","onClose"])):(0,r.Q3)("",!0),(0,r.Lk)("div",Pa,[(0,r.Lk)("div",Sa,[(0,r.bo)((0,r.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>l.searchQuery=e),placeholder:"Search for users by name...",class:"search-input"},null,512),[[s.Jo,l.searchQuery]])]),l.loading?((0,r.uX)(),(0,r.CE)("div",Fa,"Loading users...")):((0,r.uX)(),(0,r.CE)("div",Ua,[0===l.filteredUsers.length?((0,r.uX)(),(0,r.CE)("div",Ka,[l.searchQuery?((0,r.uX)(),(0,r.CE)("div",Ha,t[1]||(t[1]=[(0,r.Lk)("h3",null,"No users found",-1),(0,r.Lk)("p",null,"Try adjusting your search terms or check out the Leaderboard to find active reviewers.",-1)]))):((0,r.uX)(),(0,r.CE)("div",Va,t[2]||(t[2]=[(0,r.Lk)("h3",null,"No other users yet",-1),(0,r.Lk)("p",null,"Be the first to share reviews! Create your first review and invite others to join.",-1)])))])):(0,r.Q3)("",!0),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.filteredUsers,e=>((0,r.uX)(),(0,r.CE)("div",{key:e.uid,class:"user-card"},[(0,r.Lk)("div",Qa,[(0,r.Lk)("div",Na,[(0,r.Lk)("img",{src:e.photoURL||"https://cdn-icons-png.flaticon.com/512/149/149071.png",class:"user-avatar",alt:"User"},null,8,Ba),(0,r.Lk)("div",Ja,[(0,r.Lk)("div",Ga,[(0,r.Lk)("span",Ta,(0,n.v_)(e.displayName),1),e.medal?((0,r.uX)(),(0,r.CE)("span",Da,(0,n.v_)(e.medal),1)):(0,r.Q3)("",!0)]),null!==e.distance?((0,r.uX)(),(0,r.CE)("div",$a,(0,n.v_)(e.distance.toFixed(1))+" miles away",1)):(0,r.Q3)("",!0)])]),e.lastReview?((0,r.uX)(),(0,r.CE)("div",Wa,[(0,r.Lk)("div",Oa,[t[3]||(t[3]=(0,r.eW)(" Latest review: ",-1)),(0,r.Lk)("strong",null,(0,n.v_)(e.lastReview.restaurantName),1)]),(0,r.Lk)("div",qa,[(0,r.bF)(c,{rating:e.lastReview.rating},null,8,["rating"]),e.lastReview.text?((0,r.uX)(),(0,r.CE)("p",ja,'"'+(0,n.v_)(e.lastReview.text)+'"',1)):(0,r.Q3)("",!0)])])):((0,r.uX)(),(0,r.CE)("div",Za," No reviews yet. "))]),(0,r.Lk)("div",Ya,[(0,r.Lk)("button",{onClick:t=>l.openReviewsModal(e),class:"action-btn",title:"View Reviews"},t[4]||(t[4]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"})],-1)]),8,es),(0,r.Lk)("button",{onClick:t=>l.toggleFollow(e),class:(0,n.C4)(["follow-btn",{"unfollow-btn":e.isFollowing}])},(0,n.v_)(e.isFollowing?"Unfollow":"Follow"),11,ts)])]))),128))]))])],64)}const ss={class:"modal-content"},rs={class:"modal-header"},ns={class:"modal-body"},ls={key:0,class:"loading-indicator"},os={key:1,class:"no-reviews-message"},is={key:2,class:"reviews-list"},us={class:"review-header"},cs={class:"restaurant-name"},ds={class:"review-date"},vs={class:"review-body"},ps={key:0,class:"review-text"},ws=["src"],gs={key:2,class:"tags-container"};function ms(e,t,a,l,o,i){const u=(0,r.g2)("StarRating");return(0,r.uX)(),(0,r.CE)("div",{class:"modal-overlay",onClick:t[1]||(t[1]=(0,s.D$)(t=>e.$emit("close"),["self"]))},[(0,r.Lk)("div",ss,[(0,r.Lk)("div",rs,[(0,r.Lk)("h2",null,"Reviews by "+(0,n.v_)(a.user.displayName),1),(0,r.Lk)("button",{onClick:t[0]||(t[0]=t=>e.$emit("close")),class:"close-btn"},"Ã—")]),(0,r.Lk)("div",ns,[l.loading?((0,r.uX)(),(0,r.CE)("div",ls,"Loading reviews...")):0===l.reviews.length?((0,r.uX)(),(0,r.CE)("p",os," This user hasn't posted any reviews yet. ")):((0,r.uX)(),(0,r.CE)("ul",is,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.reviews,e=>((0,r.uX)(),(0,r.CE)("li",{key:e.id,class:"review-item"},[(0,r.Lk)("div",us,[(0,r.Lk)("span",cs,(0,n.v_)(e.restaurantName),1),(0,r.Lk)("span",ds,(0,n.v_)(l.formatDate(e.createdAt)),1)]),(0,r.Lk)("div",vs,[(0,r.bF)(u,{rating:e.rating},null,8,["rating"]),e.text?((0,r.uX)(),(0,r.CE)("p",ps,'"'+(0,n.v_)(e.text)+'"',1)):(0,r.Q3)("",!0),e.photoURL?((0,r.uX)(),(0,r.CE)("img",{key:1,src:e.photoURL,alt:"Review photo",class:"review-photo"},null,8,ws)):(0,r.Q3)("",!0),e.tags&&e.tags.length>0?((0,r.uX)(),(0,r.CE)("div",gs,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.tags,e=>((0,r.uX)(),(0,r.CE)("span",{key:e,class:"tag"},(0,n.v_)(e),1))),128))])):(0,r.Q3)("",!0)])]))),128))]))])])])}const hs={name:"UserReviewsModal",components:{StarRating:Ge},props:{user:{type:Object,required:!0}},emits:["close"],setup(e){const t=(0,te.KR)([]),a=(0,te.KR)(!0),s=async()=>{if(!e.user?.uid)return t.value=[],void(a.value=!1);a.value=!0,t.value=[];try{const a=await(0,re.GG)((0,re.rJ)(ce,"restaurants")),s=new Map;a.forEach(e=>{s.set(e.id,e.data().name)});const r=(0,re.P)((0,re.rJ)(ce,"reviews"),(0,re._M)("userId","==",e.user.uid),(0,re.My)("createdAt","desc")),n=await(0,re.GG)(r);t.value=n.docs.map(e=>{const t=e.data();return{id:e.id,...t,restaurantName:s.get(t.restaurantId)||"Unknown Restaurant"}})}catch(s){console.error("Error fetching user reviews:",s)}finally{a.value=!1}};(0,r.wB)(()=>e.user,e=>{e&&s()},{immediate:!0});const n=e=>e&&e.toDate?e.toDate().toLocaleDateString():"";return{reviews:t,loading:a,formatDate:n}}},ks=(0,Fe.A)(hs,[["render",ms],["__scopeId","data-v-4e60c4e2"]]),Ls=ks,ys={name:"UserSearch",components:{StarRating:Ge,UserReviewsModal:Ls},setup(){const e=(0,te.KR)([]),t=(0,te.KR)(!0),a=(0,te.KR)(null),s=(0,te.KR)([]),n=(0,te.KR)(""),l=(0,te.KR)(!1),o=(0,te.KR)(null),i=(0,te.KR)(new Map);let u=()=>{};const c=e=>"number"!==typeof e?null:0===e?"ðŸ¥‡":1===e?"ðŸ¥ˆ":2===e?"ðŸ¥‰":e>=3&&e<10?"ðŸ…":null,d=async()=>{t.value=!0;const r=ie.currentUser;if(!r)return;const n=(0,re.P)((0,re.rJ)(ce,"follows"),(0,re._M)("followerId","==",r.uid));u=(0,re.aQ)(n,t=>{const a=t.docs.map(e=>e.data().followingId);s.value=a,e.value=e.value.map(e=>({...e,isFollowing:a.includes(e.uid)}))});const l=await(0,re.GG)((0,re.P)((0,re.rJ)(ce,"users"),(0,re.My)("reviewCount","desc"),(0,re.AB)(30))),o=l.docs.map(e=>({id:e.id,...e.data()})).filter(e=>{const t=Number(e.reviewCount)||0;return t>0}).sort((e,t)=>{const a=Number(e.reviewCount)||0,s=Number(t.reviewCount)||0;return s-a}).slice(0,10),d=new Map;o.forEach((e,t)=>{d.set(e.id,t)}),i.value=d;const v=await(0,re.GG)((0,re.rJ)(ce,"restaurants")),p=new Map;v.forEach(e=>{p.set(e.id,e.data())});const w=(0,re.P)((0,re.rJ)(ce,"users"),(0,re._M)("uid","!=",r.uid)),g=await(0,re.GG)(w),m=g.docs.map(e=>({uid:e.id,...e.data()})),h=await Promise.all(m.map(async e=>{const t=(0,re.P)((0,re.rJ)(ce,"reviews"),(0,re._M)("userId","==",e.uid),(0,re.My)("createdAt","desc"),(0,re.AB)(1)),r=await(0,re.GG)(t);let n=null,l=null;if(!r.empty){const e=r.docs[0].data(),t=p.get(e.restaurantId);n={...e,restaurantName:t?.name||"Unknown Restaurant"},a.value&&t?.location&&(l=Te(a.value.lat,a.value.lng,t.location.lat,t.location.lng))}const o=i.value.get(e.uid);return{...e,isFollowing:s.value.includes(e.uid),lastReview:n,distance:l,medal:c(o)}}));e.value=h,t.value=!1};(0,r.sV)(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{a.value={lat:e.coords.latitude,lng:e.coords.longitude},d()},e=>{console.error("Error getting location",e),d()}):(console.error("Geolocation is not supported by this browser."),d())}),(0,r.hi)(()=>{u()});const v=(0,r.EW)(()=>{const t=[...e.value].sort((e,t)=>null===e.distance&&null!==t.distance?1:null!==e.distance&&null===t.distance?-1:null===e.distance&&null===t.distance?0:e.distance-t.distance);if(!n.value.trim())return t;const a=n.value.toLowerCase();return t.filter(e=>e.displayName.toLowerCase().includes(a))}),p=async e=>{const t=ie.currentUser;if(!t)return;const a=(0,re.rJ)(ce,"follows");if(e.isFollowing){const s=(0,re.P)(a,(0,re._M)("followerId","==",t.uid),(0,re._M)("followingId","==",e.uid)),r=await(0,re.GG)(s);if(!r.empty){const e=r.docs[0].id;await(0,re.kd)((0,re.H9)(ce,"follows",e))}}else await(0,re.gS)(a,{followerId:t.uid,followingId:e.uid})},w=e=>{o.value=e,l.value=!0},g=()=>{l.value=!1,o.value=null};return{filteredUsers:v,loading:t,toggleFollow:p,searchQuery:n,isReviewsModalVisible:l,userForReviews:o,openReviewsModal:w,closeReviewsModal:g}}},fs=(0,Fe.A)(ys,[["render",as],["__scopeId","data-v-51cdc354"]]),Cs=fs,bs={class:"review-page"},Rs={class:"review-card"},Es={class:"form-group"},Ms=["disabled"],xs=["value"],Is={key:0,class:"add-restaurant-prompt"},Xs={key:0,class:"add-restaurant-form"},_s={class:"form-group"},zs={class:"form-group"},As={class:"form-group"},Ps={class:"form-group"},Ss={class:"form-group"},Fs={class:"form-group"},Us=["disabled"],Ks={key:0,class:"error-message"},Hs={class:"form-group"},Vs={key:0,class:"photo-actions"},Qs={key:1,class:"photo-preview"},Ns=["src"],Bs={key:1,class:"camera-modal"},Js={ref:"videoPlayer",class:"camera-video",autoplay:"",playsinline:""},Gs={class:"form-group"},Ts={class:"star-rating-input"},Ds=["onMouseover","onClick","title"],$s={height:"28px",width:"28px",viewBox:"0 0 24 24",fill:"currentColor"},Ws=["d"],Os={class:"form-group"},qs={class:"tags-container"},js=["onClick"],Zs={class:"form-group"},Ys={class:"new-tag-input"},er=["disabled"],tr={class:"form-group"},ar={key:0,class:"char-count"},sr={key:2,class:"review-preview"},rr={class:"preview-content"},nr={class:"preview-restaurant"},lr={key:0},or={key:1,class:"tags-container"},ir={key:2,class:"photo-preview"},ur=["src"],cr={class:"form-actions"},dr=["disabled"],vr={key:3,class:"error-message"};function pr(e,t,a,l,o,i){const u=(0,r.g2)("StarRating");return(0,r.uX)(),(0,r.CE)("div",bs,[(0,r.Lk)("div",Rs,[(0,r.Lk)("form",{onSubmit:t[21]||(t[21]=(0,s.D$)((...e)=>l.submitReview&&l.submitReview(...e),["prevent"]))},[(0,r.Lk)("div",Es,[t[24]||(t[24]=(0,r.Lk)("label",{for:"restaurant"},"Restaurant",-1)),(0,r.bo)((0,r.Lk)("select",{id:"restaurant","onUpdate:modelValue":t[0]||(t[0]=e=>l.selectedRestaurant=e),disabled:!!a.selectedRestaurantId,required:""},[t[22]||(t[22]=(0,r.Lk)("option",{disabled:"",value:""},"Please select a restaurant",-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.restaurants,e=>((0,r.uX)(),(0,r.CE)("option",{key:e.id,value:e.id},(0,n.v_)(e.name),9,xs))),128))],8,Ms),[[s.u1,l.selectedRestaurant]]),a.selectedRestaurantId?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("div",Is,[t[23]||(t[23]=(0,r.eW)(" Can't find the restaurant? ",-1)),(0,r.Lk)("button",{type:"button",class:"link-button",onClick:t[1]||(t[1]=e=>l.showAddRestaurantForm=!l.showAddRestaurantForm)},(0,n.v_)(l.showAddRestaurantForm?"Cancel":"Add a new one"),1)]))]),l.showAddRestaurantForm?((0,r.uX)(),(0,r.CE)("div",Xs,[t[31]||(t[31]=(0,r.Lk)("h3",{class:"add-restaurant-header"},"Add New Restaurant",-1)),(0,r.Lk)("div",_s,[t[25]||(t[25]=(0,r.Lk)("label",{for:"new-rest-name"},"Name",-1)),(0,r.bo)((0,r.Lk)("input",{id:"new-rest-name","onUpdate:modelValue":t[2]||(t[2]=e=>l.newRestaurant.name=e),type:"text",required:""},null,512),[[s.Jo,l.newRestaurant.name]])]),(0,r.Lk)("div",zs,[t[26]||(t[26]=(0,r.Lk)("label",{for:"new-rest-address"},"Address",-1)),(0,r.bo)((0,r.Lk)("input",{id:"new-rest-address","onUpdate:modelValue":t[3]||(t[3]=e=>l.newRestaurant.address=e),type:"text",required:""},null,512),[[s.Jo,l.newRestaurant.address]])]),(0,r.Lk)("div",As,[t[27]||(t[27]=(0,r.Lk)("label",{for:"new-rest-city"},"City",-1)),(0,r.bo)((0,r.Lk)("input",{id:"new-rest-city","onUpdate:modelValue":t[4]||(t[4]=e=>l.newRestaurant.city=e),type:"text"},null,512),[[s.Jo,l.newRestaurant.city]])]),(0,r.Lk)("div",Ps,[t[28]||(t[28]=(0,r.Lk)("label",{for:"new-rest-state"},"State",-1)),(0,r.bo)((0,r.Lk)("input",{id:"new-rest-state","onUpdate:modelValue":t[5]||(t[5]=e=>l.newRestaurant.state=e),type:"text"},null,512),[[s.Jo,l.newRestaurant.state]])]),(0,r.Lk)("div",Ss,[t[29]||(t[29]=(0,r.Lk)("label",{for:"new-rest-zip"},"Zip Code",-1)),(0,r.bo)((0,r.Lk)("input",{id:"new-rest-zip","onUpdate:modelValue":t[6]||(t[6]=e=>l.newRestaurant.zip=e),type:"text"},null,512),[[s.Jo,l.newRestaurant.zip]])]),(0,r.Lk)("div",Fs,[t[30]||(t[30]=(0,r.Lk)("label",{for:"url"},"Website URL",-1)),(0,r.bo)((0,r.Lk)("input",{id:"url","onUpdate:modelValue":t[7]||(t[7]=e=>l.newRestaurant.url=e),type:"url",placeholder:"https://example.com"},null,512),[[s.Jo,l.newRestaurant.url]])]),(0,r.Lk)("button",{type:"button",class:"btn-save-restaurant",onClick:t[8]||(t[8]=(...e)=>l.saveNewRestaurant&&l.saveNewRestaurant(...e)),disabled:l.isSavingRestaurant},(0,n.v_)(l.isSavingRestaurant?"Saving...":"Save Restaurant"),9,Us),l.addRestaurantError?((0,r.uX)(),(0,r.CE)("p",Ks,(0,n.v_)(l.addRestaurantError),1)):(0,r.Q3)("",!0)])):(0,r.Q3)("",!0),(0,r.Lk)("div",Hs,[t[34]||(t[34]=(0,r.Lk)("label",null,"Photo",-1)),l.photoDataUrl?((0,r.uX)(),(0,r.CE)("div",Qs,[(0,r.Lk)("img",{src:l.photoDataUrl,alt:"Review photo preview"},null,8,Ns),(0,r.Lk)("button",{type:"button",onClick:t[12]||(t[12]=(...e)=>l.removePhoto&&l.removePhoto(...e)),class:"btn-remove-photo",title:"Remove Photo"},"Ã—")])):((0,r.uX)(),(0,r.CE)("div",Vs,[(0,r.Lk)("button",{type:"button",onClick:t[9]||(t[9]=(...e)=>l.openCamera&&l.openCamera(...e)),class:"btn-secondary"},t[32]||(t[32]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("circle",{cx:"12",cy:"12",r:"3.2"}),(0,r.Lk)("path",{d:"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"})],-1),(0,r.eW)(" Take a Picture ",-1)])),(0,r.Lk)("button",{type:"button",onClick:t[10]||(t[10]=(...e)=>l.triggerFileUpload&&l.triggerFileUpload(...e)),class:"btn-secondary"},t[33]||(t[33]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M9 16h6v-6h4l-7-7-7 7h4v6zm3-10.17L14.17 8H13v6h-2V8H9.83L12 5.83zM5 18h14v2H5v-2z"})],-1),(0,r.eW)(" Upload Photo ",-1)])),(0,r.Lk)("input",{type:"file",ref:"fileInput",onChange:t[11]||(t[11]=(...e)=>l.handleFileUpload&&l.handleFileUpload(...e)),accept:"image/*",style:{display:"none"}},null,544)]))]),l.isCameraOpen?((0,r.uX)(),(0,r.CE)("div",Bs,[(0,r.Lk)("video",Js,null,512),(0,r.Lk)("button",{type:"button",onClick:t[13]||(t[13]=(...e)=>l.capturePhoto&&l.capturePhoto(...e)),class:"btn-capture"},"Capture"),(0,r.Lk)("button",{type:"button",onClick:t[14]||(t[14]=(...e)=>l.closeCamera&&l.closeCamera(...e)),class:"btn-cancel-camera"},"Cancel")])):(0,r.Q3)("",!0),(0,r.Lk)("div",Gs,[t[36]||(t[36]=(0,r.Lk)("label",null,"Rating",-1)),(0,r.Lk)("div",Ts,[((0,r.uX)(),(0,r.CE)(r.FK,null,(0,r.pI)(5,e=>(0,r.Lk)("span",{key:e,class:"star",onMouseover:t=>l.hoverRating=e,onMouseleave:t[15]||(t[15]=e=>l.hoverRating=0),onClick:t=>l.rating=e,title:`${e} star${e>1?"s":""}`},[((0,r.uX)(),(0,r.CE)("svg",$s,[t[35]||(t[35]=(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"},null,-1)),(0,r.Lk)("path",{d:l.getStarPath(e)},null,8,Ws)]))],40,Ds)),64))])]),(0,r.Lk)("div",Os,[t[37]||(t[37]=(0,r.Lk)("label",null,"Tags",-1)),(0,r.Lk)("div",qs,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.tags,e=>((0,r.uX)(),(0,r.CE)("button",{key:e.id,type:"button",class:(0,n.C4)(["tag-btn",{selected:l.selectedTags.includes(e.name)}]),onClick:t=>l.toggleTag(e.name)},(0,n.v_)(e.name),11,js))),128))])]),(0,r.Lk)("div",Zs,[t[38]||(t[38]=(0,r.Lk)("label",{for:"new-tag"},"Add a new tag",-1)),(0,r.Lk)("div",Ys,[(0,r.bo)((0,r.Lk)("input",{id:"new-tag","onUpdate:modelValue":t[16]||(t[16]=e=>l.newTag=e),onKeydown:t[17]||(t[17]=(0,s.jR)((0,s.D$)((...e)=>l.addNewTag&&l.addNewTag(...e),["prevent"]),["enter"])),placeholder:"e.g., crispy, peppery, huge"},null,544),[[s.Jo,l.newTag,void 0,{trim:!0}]]),(0,r.Lk)("button",{type:"button",onClick:t[18]||(t[18]=(...e)=>l.addNewTag&&l.addNewTag(...e)),disabled:!l.newTag.trim()},"Add Tag",8,er)])]),(0,r.Lk)("div",tr,[t[39]||(t[39]=(0,r.Lk)("label",{for:"comment"},"Comment",-1)),(0,r.bo)((0,r.Lk)("textarea",{id:"comment","onUpdate:modelValue":t[19]||(t[19]=e=>l.comment=e),rows:"4",placeholder:"How was the tenderloin?"},null,512),[[s.Jo,l.comment]]),l.comment.length>0?((0,r.uX)(),(0,r.CE)("span",ar,(0,n.v_)(l.comment.length)+" characters",1)):(0,r.Q3)("",!0)]),l.showPreview&&l.selectedRestaurant&&l.rating?((0,r.uX)(),(0,r.CE)("div",sr,[t[40]||(t[40]=(0,r.Lk)("h3",null,"Preview",-1)),(0,r.Lk)("div",rr,[(0,r.Lk)("div",nr,(0,n.v_)(l.getRestaurantName(l.selectedRestaurant)),1),(0,r.bF)(u,{rating:l.rating},null,8,["rating"]),l.comment?((0,r.uX)(),(0,r.CE)("p",lr,(0,n.v_)(l.comment),1)):(0,r.Q3)("",!0),l.selectedTags.length>0?((0,r.uX)(),(0,r.CE)("div",or,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.selectedTags,e=>((0,r.uX)(),(0,r.CE)("span",{key:e,class:"tag"},(0,n.v_)(e),1))),128))])):(0,r.Q3)("",!0),l.photoDataUrl?((0,r.uX)(),(0,r.CE)("div",ir,[(0,r.Lk)("img",{src:l.photoDataUrl,alt:"Review photo preview"},null,8,ur)])):(0,r.Q3)("",!0)])])):(0,r.Q3)("",!0),(0,r.Lk)("div",cr,[l.selectedRestaurant&&l.rating?((0,r.uX)(),(0,r.CE)("button",{key:0,type:"button",onClick:t[20]||(t[20]=e=>l.showPreview=!l.showPreview),class:"btn-secondary"},(0,n.v_)(l.showPreview?"Hide Preview":"Preview Review"),1)):(0,r.Q3)("",!0),(0,r.Lk)("button",{type:"submit",disabled:l.submitting||!l.selectedRestaurant||!l.rating},(0,n.v_)(l.submitting?"Submitting...":"Submit Review"),9,dr)]),l.errorMessage?((0,r.uX)(),(0,r.CE)("p",vr,(0,n.v_)(l.errorMessage),1)):(0,r.Q3)("",!0)],32)])])}var wr=a(914);const gr={name:"Review",props:{selectedRestaurantId:{type:String,default:null}},emits:["reviewed"],setup(e,{emit:t}){const a=(0,te.KR)([]),s=(0,te.KR)(e.selectedRestaurantId||null),n=(0,te.KR)(null),l=(0,te.KR)(0),o=(0,te.KR)(""),i=(0,te.KR)(!1),u=(0,te.KR)(""),c=(0,te.KR)([]),d=(0,te.KR)([]),v=(0,te.KR)(""),p=(0,te.KR)(!1),w=(0,te.KR)({name:"",address:"",city:"",state:"",zip:"",url:""}),g=(0,te.KR)(!1),m=(0,te.KR)(""),h=(0,te.KR)(!1),k=(0,te.KR)(null),L=(0,te.KR)(null),y=(0,te.KR)(null),f=(0,te.KR)(null),C=(0,te.KR)(null),b=(0,te.KR)(!1),R="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27z",E="M22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.64-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z",M=async()=>{const e=(0,re.P)((0,re.rJ)(ce,"tags"),(0,re.My)("name")),t=await(0,re.GG)(e);c.value=t.docs.map(e=>({id:e.id,...e.data()}))},x=()=>new Promise(t=>{navigator.geolocation&&!e.selectedRestaurantId?navigator.geolocation.getCurrentPosition(e=>{C.value={lat:e.coords.latitude,lng:e.coords.longitude},t()},()=>t(),{timeout:5e3}):t()}),I=()=>{if(!C.value||0===a.value.length)return;let e=null,t=1/0;a.value.forEach(a=>{if(a.location){const s=Te(C.value.lat,C.value.lng,a.location.lat,a.location.lng);null!==s&&s<t&&(t=s,e=a)}}),e&&(s.value=e.id)},X=async()=>{if(e.selectedRestaurantId){const t=(0,re.H9)(ce,"restaurants",e.selectedRestaurantId),s=await(0,re.x7)(t);s.exists()&&(a.value=[{id:s.id,...s.data()}])}else{const e=(0,re.P)((0,re.rJ)(ce,"restaurants"),(0,re.My)("name")),t=await(0,re.GG)(e);a.value=t.docs.map(e=>({id:e.id,...e.data()})),await x(),I()}};(0,r.sV)(async()=>{await Promise.all([M(),X()])});const _=e=>{const t=l.value||n.value;return t>=e?R:E},z=e=>{const t=a.value.find(t=>t.id===e);return t?.name||"Selected Restaurant"},A=e=>{const t=d.value.indexOf(e);t>-1?d.value.splice(t,1):d.value.push(e)},P=async()=>{const e=v.value.toLowerCase();if(e&&!c.value.some(t=>t.name===e))try{const t=await(0,re.gS)((0,re.rJ)(ce,"tags"),{name:e,createdAt:(0,re.O5)()}),a={id:t.id,name:e};c.value.push(a),c.value.sort((e,t)=>e.name.localeCompare(t.name)),d.value.push(e),v.value=""}catch(t){u.value="Failed to add new tag.",console.error("Error adding new tag: ",t)}else v.value=""},S=async()=>{const e=w.value.name.trim(),t=w.value.address.trim();if(e&&t){g.value=!0,m.value="";try{const r=(0,re.P)((0,re.rJ)(ce,"restaurants"),(0,re._M)("name","==",e),(0,re._M)("address","==",t)),n=await(0,re.GG)(r);if(!n.empty)return m.value="This restaurant already exists in the database.",void(g.value=!1);const l=[w.value.address,w.value.city,w.value.state,w.value.zip].filter(Boolean).join(", "),o=await(0,wr.geocodeAddress)(l);if(!o)return m.value="Could not find a location for the provided address. Please check the address and try again.",void(g.value=!1);const i={...w.value,name:e,address:t,location:o,createdAt:(0,re.O5)()},u=await(0,re.gS)((0,re.rJ)(ce,"restaurants"),i),c={id:u.id,...i};a.value.push(c),a.value.sort((e,t)=>e.name.localeCompare(t.name)),s.value=u.id,p.value=!1,w.value={name:"",address:"",city:"",state:"",zip:"",url:""}}catch(r){console.error("Error saving new restaurant:",r),m.value="Failed to save restaurant. Please try again."}finally{g.value=!1}}else m.value="Restaurant name and address are required."},F=async()=>{h.value=!0,await(0,r.dY)();try{y.value=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}),L.value&&(L.value.srcObject=y.value)}catch(e){console.error("Error accessing camera: ",e),u.value="Could not access the camera. Please check permissions.",h.value=!1}},U=()=>{y.value&&y.value.getTracks().forEach(e=>e.stop()),h.value=!1},K=()=>{const e=document.createElement("canvas"),t=L.value,a=1280,s=1280;let r=t.videoWidth,n=t.videoHeight;r>n?r>a&&(n*=a/r,r=a):n>s&&(r*=s/n,n=s),e.width=r,e.height=n;const l=e.getContext("2d");l.drawImage(t,0,0,r,n),k.value=e.toDataURL("image/jpeg",.8),U()},H=()=>{k.value=null},V=()=>{f.value.click()},Q=e=>{const t=e.target.files[0];if(t){const e=new FileReader;e.onload=e=>{k.value=e.target.result},e.readAsDataURL(t)}},N=async()=>{const e=ie.currentUser;if(e&&s.value&&n.value){i.value=!0,u.value="";try{let l=null;if(k.value){const t=(0,ne.c7)(),a=`reviews/${e.uid}/${Date.now()}.jpg`,s=(0,ne.KR)(t,a),r=await(0,ne.ls)(s,k.value,"data_url");l=await(0,ne.qk)(r.ref)}const i=(0,re.O5)();await(0,re.gS)((0,re.rJ)(ce,"reviews"),{userId:e.uid,userName:e.displayName||"Anonymous",userPhoto:e.photoURL||null,restaurantId:s.value,photoURL:l,rating:n.value,text:o.value,tags:d.value,createdAt:i,lastActivityAt:i});try{const t=(0,re.H9)(ce,"users",e.uid);await(0,re.mZ)(t,{reviewCount:(0,re.GV)(1)})}catch(a){console.warn("Failed to update reviewCount (non-critical):",a)}try{const t=(0,re.P)((0,re.rJ)(ce,"bucketListItems"),(0,re._M)("userId","==",e.uid),(0,re._M)("restaurantId","==",s.value)),a=await(0,re.GG)(t);if(!a.empty){const e=a.docs[0];await(0,re.mZ)(e.ref,{completedAt:i})}}catch(r){console.warn("Failed to update bucket list (non-critical):",r)}Ae("Review submitted successfully!","success",2e3),await new Promise(e=>setTimeout(e,500)),t("reviewed")}catch(l){console.error("Error submitting check-in: ",l),u.value="Failed to submit check-in. Please try again.",Ae("Failed to submit check-in. Please try again.","error")}finally{i.value=!1}}else u.value="Please select a restaurant and provide a rating."};return{restaurants:a,selectedRestaurant:s,rating:n,hoverRating:l,comment:o,submitting:i,errorMessage:u,getStarPath:_,submitReview:N,tags:c,selectedTags:d,newTag:v,toggleTag:A,addNewTag:P,showAddRestaurantForm:p,newRestaurant:w,isSavingRestaurant:g,addRestaurantError:m,saveNewRestaurant:S,isCameraOpen:h,photoDataUrl:k,videoPlayer:L,openCamera:F,closeCamera:U,capturePhoto:K,removePhoto:H,fileInput:f,triggerFileUpload:V,handleFileUpload:Q,showPreview:b,getRestaurantName:z}}},mr=(0,Fe.A)(gr,[["render",pr],["__scopeId","data-v-ba576472"]]),hr=mr,kr={class:"recommendations-page"},Lr={key:0,class:"loading-indicator"},yr={key:1},fr={key:0,class:"no-restaurants-message"},Cr={key:1,class:"restaurant-list"},br={class:"restaurant-details"},Rr={class:"restaurant-name"},Er={class:"restaurant-meta"},Mr=["title"],xr={class:"rating-text"},Ir={class:"rating-count"},Xr={key:1,class:"distance"},_r={class:"restaurant-address"},zr={class:"restaurant-actions"},Ar=["onClick","title"],Pr=["href"],Sr=["href"],Fr=["onClick"];function Ur(e,t,a,s,l,o){const i=(0,r.g2)("StarRating");return(0,r.uX)(),(0,r.CE)("div",kr,[t[3]||(t[3]=(0,r.Lk)("div",{class:"page-header"},[(0,r.Lk)("h2",null,"Top 10 Recommendations"),(0,r.Lk)("p",null,"Based on reviews in the last 6 months within 100 miles of your location.")],-1)),s.loading?((0,r.uX)(),(0,r.CE)("div",Lr,"Loading recommendations...")):((0,r.uX)(),(0,r.CE)("div",yr,[0===s.restaurants.length?((0,r.uX)(),(0,r.CE)("p",fr," No recommendations found. ")):((0,r.uX)(),(0,r.CE)("ul",Cr,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.restaurants,a=>((0,r.uX)(),(0,r.CE)("li",{key:a.id,class:"restaurant-item"},[(0,r.Lk)("div",br,[(0,r.Lk)("span",Rr,(0,n.v_)(a.name),1),(0,r.Lk)("div",Er,[a.averageRating>0?((0,r.uX)(),(0,r.CE)("div",{key:0,class:"rating",title:`${a.averageRating.toFixed(2)} average rating`},[(0,r.bF)(i,{rating:a.averageRating},null,8,["rating"]),(0,r.Lk)("span",xr,(0,n.v_)(a.averageRating.toFixed(1)),1),(0,r.Lk)("span",Ir,"("+(0,n.v_)(a.reviewCount)+" recent reviews)",1)],8,Mr)):(0,r.Q3)("",!0),null!==a.distance?((0,r.uX)(),(0,r.CE)("span",Xr,(0,n.v_)(a.distance.toFixed(1))+" miles away",1)):(0,r.Q3)("",!0)]),(0,r.Lk)("span",_r,(0,n.v_)(a.address)+", "+(0,n.v_)(a.city)+", "+(0,n.v_)(a.state)+" "+(0,n.v_)(a.zip),1)]),(0,r.Lk)("div",zr,[(0,r.Lk)("button",{onClick:e=>s.toggleBucketList(a),class:(0,n.C4)(["action-btn",{"in-bucket-list":s.isInBucketList(a.id)}]),title:s.isInBucketList(a.id)?"Remove from Bucket List":"Add to Bucket List"},t[0]||(t[0]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M18 7h-2.06c-.33-3.2-2.46-5.8-5.94-5.8S4.39 3.8 4.06 7H2v12h16V7zM6.14 7c.2-1.92 1.6-3.48 3.86-3.8A4.002 4.002 0 0 1 14 7h-2.14c-.2-1.92-1.6-3.48-3.86-3.8zM16 17H4v-8h12v8z"})],-1)]),10,Ar),(0,r.Lk)("a",{href:s.getDirectionsUrl(a),target:"_blank",rel:"noopener noreferrer",class:"action-btn",title:"Get Directions"},t[1]||(t[1]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M22.43 10.59l-9.01-9.01c-.75-.75-2.07-.76-2.83 0l-9.01 9.01c-.76.75-.76 2.07 0 2.83l9.01 9.01c.75.75 2.07.75 2.83 0l9.01-9.01c.75-.76.75-2.08 0-2.83zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4z"})],-1)]),8,Pr),(0,r.Lk)("a",{href:s.getDetailsUrl(a),target:"_blank",rel:"noopener noreferrer",class:"action-btn",title:"View Details on Google"},t[2]||(t[2]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 5 1.41-1.41L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})],-1)]),8,Sr),(0,r.Lk)("button",{class:"check-in-btn",onClick:t=>e.$emit("review-at",a.id)},"Review",8,Fr)])]))),128))]))]))])}const Kr={name:"Recommendations",components:{StarRating:Ge},emits:["review-at"],setup(){const e=(0,te.KR)([]),t=(0,te.KR)(!0),a=(0,te.KR)(null),s=(0,te.KR)(new Set);let n=()=>{};const l=async()=>{if(!a.value)return console.error("User location not available."),t.value=!1,void(e.value=[]);try{const t=await(0,re.GG)((0,re.rJ)(ce,"restaurants")),s=t.docs.map(e=>({id:e.id,...e.data()})),r=s.filter(e=>{if(!e.location||"number"!==typeof e.location.lat||"number"!==typeof e.location.lng)return!1;const t=Te(a.value.lat,a.value.lng,e.location.lat,e.location.lng);return e.distance=t,null!==t&&t<=100}),n=new Date;n.setMonth(n.getMonth()-6);const l=re.Dc.fromDate(n),o=(0,re.P)((0,re.rJ)(ce,"reviews"),(0,re._M)("createdAt",">=",l)),i=await(0,re.GG)(o),u=i.docs.map(e=>e.data()),c=r.map(e=>{const t=u.filter(t=>t.restaurantId===e.id&&"number"===typeof t.rating);let a=0,s=0;if(t.length>0){const e=t.reduce((e,t)=>e+t.rating,0);a=e/t.length,s=t.length}return{...e,averageRating:a,reviewCount:s}}).filter(e=>e.reviewCount>0);c.sort((e,t)=>t.averageRating-e.averageRating),e.value=c.slice(0,10)}catch(s){console.error("Error fetching recommendations:",s)}finally{t.value=!1}};(0,r.sV)(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{a.value={lat:e.coords.latitude,lng:e.coords.longitude},l(),u()},e=>{console.error("Geolocation failed. Using default location.",e),a.value={lat:41.5,lng:-90.5},l(),u()}):(console.error("Geolocation is not supported by this browser."),a.value={lat:41.5,lng:-90.5},l(),u())}),(0,r.hi)(()=>{n()});const o=e=>{const t=encodeURIComponent(`${e.name}, ${e.address}`);return`https://www.google.com/maps/dir/?api=1&destination=${t}`},i=e=>{const t=encodeURIComponent(`${e.name}, ${e.address}`);return`https://www.google.com/search?q=${t}`},u=()=>{const e=ie.currentUser;if(!e)return;const t=(0,re.P)((0,re.rJ)(ce,"bucketListItems"),(0,re._M)("userId","==",e.uid));n=(0,re.aQ)(t,e=>{const t=new Set;e.forEach(e=>t.add(e.data().restaurantId)),s.value=t})},c=e=>s.value.has(e),d=async e=>{const t=ie.currentUser;if(t)if(c(e.id)){const a=(0,re.P)((0,re.rJ)(ce,"bucketListItems"),(0,re._M)("userId","==",t.uid),(0,re._M)("restaurantId","==",e.id)),s=await(0,re.GG)(a);s.forEach(e=>(0,re.kd)(e.ref))}else await(0,re.gS)((0,re.rJ)(ce,"bucketListItems"),{userId:t.uid,restaurantId:e.id,createdAt:(0,re.O5)()})};return{restaurants:e,loading:t,getDirectionsUrl:o,getDetailsUrl:i,isInBucketList:c,toggleBucketList:d}}},Hr=(0,Fe.A)(Kr,[["render",Ur],["__scopeId","data-v-7a582d05"]]),Vr=Hr,Qr={class:"stats-page"},Nr={class:"stats-container"},Br={key:0},Jr={key:1,class:"stats-grid"},Gr={class:"stat-card"},Tr={class:"stat-card"},Dr={class:"stat-card"},$r={class:"stat-card"},Wr={key:2},Or={key:3,class:"log-container"};function qr(e,t,a,s,l,o){return(0,r.uX)(),(0,r.CE)("div",Qr,[t[5]||(t[5]=(0,r.Lk)("h2",null,"Database Stats",-1)),(0,r.Lk)("div",Nr,[s.statsLoading?((0,r.uX)(),(0,r.CE)("div",Br,"Loading stats...")):s.stats?((0,r.uX)(),(0,r.CE)("ul",Jr,[(0,r.Lk)("li",Gr,[t[0]||(t[0]=(0,r.Lk)("strong",null,"Restaurants",-1)),(0,r.Lk)("span",null,(0,n.v_)(s.stats.restaurants),1)]),(0,r.Lk)("li",Tr,[t[1]||(t[1]=(0,r.Lk)("strong",null,"Users",-1)),(0,r.Lk)("span",null,(0,n.v_)(s.stats.users),1)]),(0,r.Lk)("li",Dr,[t[2]||(t[2]=(0,r.Lk)("strong",null,"Reviews",-1)),(0,r.Lk)("span",null,(0,n.v_)(s.stats.reviews),1)]),(0,r.Lk)("li",$r,[t[3]||(t[3]=(0,r.Lk)("strong",null,"Follows",-1)),(0,r.Lk)("span",null,(0,n.v_)(s.stats.follows),1)])])):((0,r.uX)(),(0,r.CE)("div",Wr,"Could not load stats.")),s.log.length>0?((0,r.uX)(),(0,r.CE)("div",Or,[t[4]||(t[4]=(0,r.Lk)("h3",null,"Log:",-1)),(0,r.Lk)("pre",null,(0,n.v_)(s.log.join("\n")),1)])):(0,r.Q3)("",!0)])])}const jr={name:"DatabaseStats",setup(){const e=(0,te.KR)(null),t=(0,te.KR)(!0),a=(0,te.KR)([]),s=async()=>{t.value=!0;try{const t=["restaurants","users","reviews","follows"],a={},s=t.map(async e=>{const t=(0,re.rJ)(ce,e),s=await(0,re.d_)(t);a[e]=s.data().count});await Promise.all(s),e.value=a}catch(s){a.value.push("Error fetching collection stats: "+s.message),console.error("Error fetching stats:",s)}finally{t.value=!1}};return(0,r.sV)(s),{stats:e,statsLoading:t,log:a}}},Zr=(0,Fe.A)(jr,[["render",qr],["__scopeId","data-v-7fa04ecf"]]),Yr=Zr,en={class:"my-reviews-page"},tn={key:0,class:"loading-indicator"},an={key:1,class:"no-reviews-message"},sn={key:2,class:"feed"},rn={class:"post-header"},nn=["src"],ln={class:"post-info"},on={class:"user-line"},un={class:"user-name"},cn={key:0,class:"medal"},dn={class:"post-date"},vn={class:"post-content"},pn={class:"post-title-line"},wn={class:"restaurant-title-group"},gn={class:"restaurant-name"},mn={key:0,class:"review-actions"},hn=["onClick"],kn=["onClick"],Ln={key:0,class:"distance"},yn={key:0,class:"restaurant-location"},fn={key:1,class:"edit-review-form"},Cn={class:"form-group"},bn={class:"form-group"},Rn={key:2,class:"review-body"},En={key:0,class:"review-text"},Mn=["src"],xn={key:2,class:"tags-container"},In={class:"post-actions"},Xn=["onClick","disabled"],_n=["onClick"],zn={__name:"MyReviews",props:{user:{type:Object,default:null}},emits:["go-to-review"],setup(e){const t=e,a=(0,te.KR)(!0),l=(0,te.KR)([]),o=(0,te.KR)(new Map),i=(0,te.KR)(null),u=(0,te.KR)(""),c=(0,te.KR)(0),d=(0,te.KR)(null),v=(0,te.KR)(null),p=(0,te.KR)(new Map),w=e=>"number"!==typeof e?null:0===e?"ðŸ¥‡":1===e?"ðŸ¥ˆ":2===e?"ðŸ¥‰":e>=3&&e<10?"ðŸ…":null;let g=()=>{},m=()=>{};const h=e=>{if(!e)return l.value=[],a.value=!1,void(g&&g());a.value=!0;const t=(0,re.P)((0,re.rJ)(ce,"reviews"),(0,re._M)("userId","==",e.uid),(0,re.My)("createdAt","desc"));g=(0,re.aQ)(t,e=>{l.value=e.docs.map(e=>({id:e.id,...e.data(),likeCount:0,isLiked:!1})),a.value=!1,l.value.forEach(e=>{k(e.id)})},e=>{console.error("Error fetching reviews:",e),a.value=!1})},k=e=>{const a=t.user,s=(0,re.H9)(ce,"reviews",e),r=(0,re.rJ)(s,"likes"),n=(0,re.P)(r);(0,re.aQ)(n,t=>{const s=l.value.find(t=>t.id===e);s&&(s.likeCount=t.size,s.isLiked=!!a&&t.docs.some(e=>e.data().userId===a.uid))},e=>{console.error("Error fetching likes:",e)})},L=async e=>{const a=t.user;if(!a)return;const s=(0,re.H9)(ce,"reviews",e),r=(0,re.rJ)(s,"likes"),n=(0,re.P)(r,(0,re._M)("userId","==",a.uid)),l=await(0,re.GG)(n);l.empty?await(0,re.gS)(r,{userId:a.uid,createdAt:(0,re.O5)()}):await(0,re.kd)(l.docs[0].ref)},y=async e=>{const t=window.location.origin,a=`${t}/?review=${e}`;if(navigator.share)try{return void await navigator.share({title:"Check out this review on PorkHub",text:"Check out this review on PorkHub",url:a})}catch(s){"AbortError"!==s.name&&console.error("Error sharing:",s)}try{await navigator.clipboard.writeText(a),Ae("Link copied to clipboard!","success")}catch(s){console.error("Failed to copy link:",s);const e=prompt("Copy this link:",a);e&&Ae("Link copied!","success")}};(0,r.sV)(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{v.value={lat:e.coords.latitude,lng:e.coords.longitude}},e=>{console.error("Error getting location",e)}),(0,re.GG)((0,re.P)((0,re.rJ)(ce,"users"),(0,re.My)("reviewCount","desc"),(0,re.AB)(30))).then(e=>{const t=e.docs.map(e=>({id:e.id,...e.data()})).filter(e=>{const t=Number(e.reviewCount)||0;return t>0}).sort((e,t)=>{const a=Number(e.reviewCount)||0,s=Number(t.reviewCount)||0;return s-a}).slice(0,10),a=new Map;t.forEach((e,t)=>{a.set(e.id,t)}),p.value=a}),m=(0,re.aQ)((0,re.rJ)(ce,"restaurants"),e=>{const t=new Map;e.forEach(e=>{t.set(e.id,e.data())}),o.value=t}),(0,r.wB)(()=>t.user,e=>{h(e)},{immediate:!0})}),(0,r.hi)(()=>{g&&g(),m&&m()});const f=(0,r.EW)(()=>{const e=t.user;return l.value.map(t=>{const a=o.value.get(t.restaurantId),s=p.value.get(e?.uid);return{...t,restaurantName:a?.name||"Unknown Restaurant",restaurantCity:a?.city,restaurantState:a?.state,userName:e?.displayName||"You",userPhoto:e?.photoURL||null,distance:v.value&&a?.location?Te(v.value.lat,v.value.lng,a.location.lat,a.location.lng):null,medal:w(s)}})}),C=e=>e&&e.toDate?e.toDate().toLocaleString():"",b=e=>{i.value=e.id,u.value=e.text||"",c.value=e.rating||0,d.value={text:e.text||"",rating:e.rating||0}},R=()=>{(!d.value||u.value===d.value.text&&c.value===d.value.rating||confirm("You have unsaved changes. Are you sure you want to cancel?"))&&(i.value=null,u.value="",c.value=0,d.value=null)},E=async()=>{if(i.value)try{const e=(0,re.H9)(ce,"reviews",i.value);await(0,re.mZ)(e,{rating:c.value,text:u.value,lastActivityAt:(0,re.O5)()}),R(),Ae("Review updated successfully!","success")}catch(e){console.error("Error updating review:",e),Ae("Failed to save review. Please try again.","error")}},M=async e=>{if(confirm("Are you sure you want to delete this review?"))try{await(0,re.kd)((0,re.H9)(ce,"reviews",e)),Ae("Review deleted successfully","success")}catch(t){console.error("Error deleting review:",t),Ae("Failed to delete review. Please try again.","error")}};return(t,l)=>((0,r.uX)(),(0,r.CE)("div",en,[a.value?((0,r.uX)(),(0,r.CE)("div",tn,"Loading your reviews...")):0===f.value.length?((0,r.uX)(),(0,r.CE)("div",an,[l[3]||(l[3]=(0,r.Lk)("h3",null,"You haven't posted any reviews yet.",-1)),(0,r.Lk)("button",{onClick:l[0]||(l[0]=e=>t.$emit("go-to-review")),class:"btn-primary"},"Post your first review!")])):((0,r.uX)(),(0,r.CE)("div",sn,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(f.value,t=>((0,r.uX)(),(0,r.CE)("div",{key:t.id,class:"post-card"},[(0,r.Lk)("div",rn,[(0,r.Lk)("img",{src:t.userPhoto||"https://cdn-icons-png.flaticon.com/512/149/149071.png",alt:"User",class:"user-avatar",referrerpolicy:"no-referrer"},null,8,nn),(0,r.Lk)("div",ln,[(0,r.Lk)("div",on,[(0,r.Lk)("span",un,(0,n.v_)(t.userName),1),t.medal?((0,r.uX)(),(0,r.CE)("span",cn,(0,n.v_)(t.medal),1)):(0,r.Q3)("",!0)]),(0,r.Lk)("span",dn,(0,n.v_)(C(t.createdAt)),1)])]),(0,r.Lk)("div",vn,[(0,r.Lk)("div",pn,[(0,r.Lk)("div",wn,[(0,r.Lk)("h2",gn,(0,n.v_)(t.restaurantName),1),i.value!==t.id?((0,r.uX)(),(0,r.CE)("div",mn,[(0,r.Lk)("button",{onClick:e=>b(t),class:"action-btn",title:"Edit Review"},l[4]||(l[4]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20px",viewBox:"0 0 24 24",width:"20px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})],-1)]),8,hn),(0,r.Lk)("button",{onClick:e=>M(t.id),class:"action-btn delete",title:"Delete Review"},l[5]||(l[5]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20px",viewBox:"0 0 24 24",width:"20px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})],-1)]),8,kn)])):(0,r.Q3)("",!0)]),null!==t.distance?((0,r.uX)(),(0,r.CE)("div",Ln,(0,n.v_)(t.distance.toFixed(1))+" miles away ",1)):(0,r.Q3)("",!0)]),t.restaurantCity||t.restaurantState?((0,r.uX)(),(0,r.CE)("div",yn,[(0,r.eW)((0,n.v_)(t.restaurantCity),1),t.restaurantCity&&t.restaurantState?((0,r.uX)(),(0,r.CE)(r.FK,{key:0},[(0,r.eW)(", ")],64)):(0,r.Q3)("",!0),(0,r.eW)((0,n.v_)(t.restaurantState),1)])):(0,r.Q3)("",!0),i.value===t.id?((0,r.uX)(),(0,r.CE)("div",fn,[(0,r.Lk)("div",Cn,[l[6]||(l[6]=(0,r.Lk)("label",null,"Rating",-1)),(0,r.bF)(Ge,{rating:c.value,editable:!0,"onUpdate:rating":l[1]||(l[1]=e=>c.value=e)},null,8,["rating"])]),(0,r.Lk)("div",bn,[l[7]||(l[7]=(0,r.Lk)("label",null,"Comment",-1)),(0,r.bo)((0,r.Lk)("textarea",{"onUpdate:modelValue":l[2]||(l[2]=e=>u.value=e),class:"edit-textarea",rows:"4"},null,512),[[s.Jo,u.value]])]),(0,r.Lk)("div",{class:"edit-actions"},[(0,r.Lk)("button",{onClick:E,class:"btn-primary"},"Save"),(0,r.Lk)("button",{onClick:R,class:"btn-secondary"},"Cancel")])])):((0,r.uX)(),(0,r.CE)("div",Rn,[(0,r.bF)(Ge,{rating:t.rating},null,8,["rating"]),t.text?((0,r.uX)(),(0,r.CE)("p",En,'"'+(0,n.v_)(t.text)+'"',1)):(0,r.Q3)("",!0),t.photoURL?((0,r.uX)(),(0,r.CE)("img",{key:1,src:t.photoURL,alt:"Review photo",class:"review-photo",loading:"lazy"},null,8,Mn)):(0,r.Q3)("",!0),t.tags&&t.tags.length>0?((0,r.uX)(),(0,r.CE)("div",xn,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(t.tags,e=>((0,r.uX)(),(0,r.CE)("span",{key:e,class:"tag"},(0,n.v_)(e),1))),128))])):(0,r.Q3)("",!0)])),(0,r.Lk)("div",In,[(0,r.Lk)("button",{onClick:e=>L(t.id),class:(0,n.C4)(["like-btn",{liked:t.isLiked}]),disabled:!e.user},[l[8]||(l[8]=(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20px",viewBox:"0 0 24 24",width:"20px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})],-1)),(0,r.Lk)("span",null,(0,n.v_)(t.likeCount||0),1)],10,Xn),(0,r.Lk)("button",{onClick:e=>y(t.id),class:"share-btn",title:"Share this review"},l[9]||(l[9]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20px",viewBox:"0 0 24 24",width:"20px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"})],-1),(0,r.Lk)("span",null,"Share",-1)]),8,_n)]),(0,r.bF)(Ke,{"post-id":t.id,user:e.user,"post-type":"reviews","post-author-id":t.userId},null,8,["post-id","user","post-author-id"])])]))),128))]))]))}},An=(0,Fe.A)(zn,[["__scopeId","data-v-0bcf4dba"]]),Pn=An,Sn={class:"leaderboard-page"},Fn={key:0,class:"loading-indicator"},Un={key:1,class:"no-users-message"},Kn={key:2,class:"leaderboard-list"},Hn={class:"rank-container"},Vn={class:"rank"},Qn={key:0,class:"medal"},Nn=["src"],Bn={class:"user-info"},Jn={class:"user-name"},Gn={class:"review-count"};function Tn(e,t,a,s,l,o){return(0,r.uX)(),(0,r.CE)("div",Sn,[t[1]||(t[1]=(0,r.Lk)("div",{class:"page-header"},[(0,r.Lk)("h2",null,"Leaderboard"),(0,r.Lk)("p",null,"Top 10 reviewers")],-1)),s.loading?((0,r.uX)(),(0,r.CE)("div",Fn,"Loading leaderboard...")):0===s.users.length?((0,r.uX)(),(0,r.CE)("div",Un,t[0]||(t[0]=[(0,r.Lk)("p",null,"No users to display on the leaderboard yet.",-1)]))):((0,r.uX)(),(0,r.CE)("ol",Kn,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.users,(e,t)=>((0,r.uX)(),(0,r.CE)("li",{key:e.uid,class:(0,n.C4)(["leaderboard-item",s.getRankClass(t)])},[(0,r.Lk)("div",Hn,[(0,r.Lk)("span",Vn,(0,n.v_)(t+1),1),s.getMedal(t)?((0,r.uX)(),(0,r.CE)("span",Qn,(0,n.v_)(s.getMedal(t)),1)):(0,r.Q3)("",!0)]),(0,r.Lk)("img",{src:e.photoURL||"https://cdn-icons-png.flaticon.com/512/149/149071.png",alt:"User",class:"user-avatar",referrerpolicy:"no-referrer"},null,8,Nn),(0,r.Lk)("div",Bn,[(0,r.Lk)("span",Jn,(0,n.v_)(e.displayName),1),(0,r.Lk)("span",Gn,(0,n.v_)(e.reviewCount||0)+" reviews",1)])],2))),128))]))])}const Dn={name:"Leaderboard",setup(){const e=(0,te.KR)(!0),t=(0,te.KR)([]);let a=()=>{};(0,r.sV)(()=>{try{const s=(0,re.P)((0,re.rJ)(ce,"users"),(0,re.My)("reviewCount","desc"),(0,re.AB)(30));a=(0,re.aQ)(s,a=>{const s=a.docs.map(e=>e.data()),r=s.filter(e=>{const t=Number(e.reviewCount)||0;return t>0}),n=r.sort((e,t)=>{const a=Number(e.reviewCount)||0,s=Number(t.reviewCount)||0;return s-a});t.value=n.slice(0,10),e.value=!1},t=>{console.error("Error fetching leaderboard:",t),e.value=!1})}catch(s){console.error("Error setting up leaderboard listener:",s),e.value=!1}}),(0,r.hi)(()=>{a()});const s=e=>0===e?"ðŸ¥‡":1===e?"ðŸ¥ˆ":2===e?"ðŸ¥‰":e>=3&&e<10?"ðŸ…":null,n=e=>0===e?"rank-gold":1===e?"rank-silver":2===e?"rank-bronze":e>=3&&e<10?"rank-regular":"";return{loading:e,users:t,getMedal:s,getRankClass:n}}},$n=(0,Fe.A)(Dn,[["render",Tn],["__scopeId","data-v-7088546b"]]),Wn=$n,On={class:"followers-page"},qn={key:0,class:"loading-indicator"},jn={key:1},Zn={key:0,class:"no-followers-message"},Yn={class:"user-card-content"},el={class:"user-info"},tl=["src"],al={class:"user-name-line"},sl={class:"user-name"},rl={key:0,class:"medal"},nl={key:0,class:"last-review"},ll={class:"review-header"},ol={class:"review-body"},il={key:0,class:"review-text"},ul={key:1,class:"last-review no-review"},cl={class:"user-actions"},dl=["onClick"];function vl(e,t,a,s,l,o){const i=(0,r.g2)("UserReviewsModal"),u=(0,r.g2)("StarRating");return(0,r.uX)(),(0,r.CE)(r.FK,null,[s.isReviewsModalVisible?((0,r.uX)(),(0,r.Wv)(i,{key:0,user:s.userForReviews,onClose:s.closeReviewsModal},null,8,["user","onClose"])):(0,r.Q3)("",!0),(0,r.Lk)("div",On,[s.loading?((0,r.uX)(),(0,r.CE)("div",qn,"Loading followers...")):((0,r.uX)(),(0,r.CE)("div",jn,[0===s.followers.length?((0,r.uX)(),(0,r.CE)("div",Zn,t[0]||(t[0]=[(0,r.Lk)("h3",null,"No followers yet",-1),(0,r.Lk)("p",null,"Start sharing reviews to attract followers! The more you review, the more visible you'll be.",-1)]))):(0,r.Q3)("",!0),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.followers,e=>((0,r.uX)(),(0,r.CE)("div",{key:e.uid,class:"user-card"},[(0,r.Lk)("div",Yn,[(0,r.Lk)("div",el,[(0,r.Lk)("img",{src:e.photoURL||"https://cdn-icons-png.flaticon.com/512/149/149071.png",class:"user-avatar",alt:"User",referrerpolicy:"no-referrer"},null,8,tl),(0,r.Lk)("div",al,[(0,r.Lk)("span",sl,(0,n.v_)(e.displayName),1),e.medal?((0,r.uX)(),(0,r.CE)("span",rl,(0,n.v_)(e.medal),1)):(0,r.Q3)("",!0)])]),e.lastReview?((0,r.uX)(),(0,r.CE)("div",nl,[(0,r.Lk)("div",ll,[t[1]||(t[1]=(0,r.eW)(" Latest review: ",-1)),(0,r.Lk)("strong",null,(0,n.v_)(e.lastReview.restaurantName),1)]),(0,r.Lk)("div",ol,[(0,r.bF)(u,{rating:e.lastReview.rating},null,8,["rating"]),e.lastReview.text?((0,r.uX)(),(0,r.CE)("p",il,'"'+(0,n.v_)(e.lastReview.text)+'"',1)):(0,r.Q3)("",!0)])])):((0,r.uX)(),(0,r.CE)("div",ul," No reviews yet. "))]),(0,r.Lk)("div",cl,[(0,r.Lk)("button",{onClick:t=>s.openReviewsModal(e),class:"action-btn",title:"View Reviews"},t[2]||(t[2]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"})],-1)]),8,dl)])]))),128))]))])],64)}const pl=e=>"number"!==typeof e?null:0===e?"ðŸ¥‡":1===e?"ðŸ¥ˆ":2===e?"ðŸ¥‰":e>=3&&e<10?"ðŸ…":null,wl={name:"Followers",components:{UserReviewsModal:Ls,StarRating:Ge},setup(){const e=(0,te.KR)([]),t=(0,te.KR)(!0),a=(0,te.KR)(!1),s=(0,te.KR)(null),n=(0,te.KR)(new Map),l=async()=>{t.value=!0;const a=ie.currentUser;if(!a)return void(t.value=!1);const s=await(0,re.GG)((0,re.P)((0,re.rJ)(ce,"users"),(0,re.My)("reviewCount","desc"),(0,re.AB)(30))),r=s.docs.map(e=>({id:e.id,...e.data()})).filter(e=>{const t=Number(e.reviewCount)||0;return t>0}).sort((e,t)=>{const a=Number(e.reviewCount)||0,s=Number(t.reviewCount)||0;return s-a}).slice(0,10),l=new Map;r.forEach((e,t)=>{l.set(e.id,t)}),n.value=l;const o=(0,re.P)((0,re.rJ)(ce,"follows"),(0,re._M)("followingId","==",a.uid)),i=await(0,re.GG)(o),u=i.docs.map(e=>e.data().followerId);if(0===u.length)return e.value=[],void(t.value=!1);const c=await(0,re.GG)((0,re.rJ)(ce,"restaurants")),d=new Map;c.forEach(e=>{d.set(e.id,e.data().name)});const v=[];for(let e=0;e<u.length;e+=30){const t=u.slice(e,e+30);if(t.length>0){const e=(0,re.P)((0,re.rJ)(ce,"users"),(0,re._M)("uid","in",t)),a=await(0,re.GG)(e);a.forEach(e=>{v.push({uid:e.id,...e.data()})})}}const p=await Promise.all(v.map(async e=>{const t=(0,re.P)((0,re.rJ)(ce,"reviews"),(0,re._M)("userId","==",e.uid),(0,re.My)("createdAt","desc"),(0,re.AB)(1)),a=await(0,re.GG)(t);let s=null;if(!a.empty){const e=a.docs[0].data();s={...e,restaurantName:d.get(e.restaurantId)||"Unknown Restaurant"}}const r=n.value.get(e.uid);return{...e,lastReview:s,medal:pl(r)}}));e.value=p,t.value=!1};(0,r.sV)(l);const o=e=>{s.value=e,a.value=!0},i=()=>{a.value=!1,s.value=null};return{followers:e,loading:t,isReviewsModalVisible:a,userForReviews:s,openReviewsModal:o,closeReviewsModal:i}}},gl=(0,Fe.A)(wl,[["render",vl],["__scopeId","data-v-a8a6c8f6"]]),ml=gl,hl={class:"bucket-list-page"},kl={class:"page-header"},Ll={class:"view-toggle"},yl={key:0,class:"batch-actions"},fl={key:0,class:"no-items-message"},Cl={key:1,class:"loading-indicator"},bl={key:2,class:"no-items-message"},Rl={key:0},El={key:1},Ml={key:3,class:"restaurant-list"},xl={key:0,class:"item-checkbox"},Il=["checked","onChange"],Xl={class:"restaurant-details"},_l={class:"restaurant-name"},zl={class:"restaurant-meta"},Al=["title"],Pl={class:"rating-text"},Sl={class:"rating-count"},Fl={key:1,class:"distance"},Ul={class:"restaurant-address"},Kl={class:"restaurant-actions"},Hl=["onClick"],Vl=["onClick"];function Ql(e,t,a,s,l,o){const i=(0,r.g2)("StarRating");return(0,r.uX)(),(0,r.CE)("div",hl,[(0,r.Lk)("div",kl,[(0,r.Lk)("div",Ll,[(0,r.Lk)("button",{onClick:t[0]||(t[0]=e=>s.showCompleted=!1),class:(0,n.C4)({active:!s.showCompleted})},"To Try",2),(0,r.Lk)("button",{onClick:t[1]||(t[1]=e=>s.showCompleted=!0),class:(0,n.C4)({active:s.showCompleted})},"Completed",2)]),s.filteredItems.length>0&&s.selectedItems.size>0?((0,r.uX)(),(0,r.CE)("div",yl,[(0,r.Lk)("span",null,(0,n.v_)(s.selectedItems.size)+" item(s) selected",1),(0,r.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>s.removeSelectedItems&&s.removeSelectedItems(...e)),class:"btn-delete-batch"},"Remove Selected"),(0,r.Lk)("button",{onClick:t[3]||(t[3]=e=>s.selectedItems.clear()),class:"btn-cancel-selection"},"Cancel")])):s.filteredItems.length>0?((0,r.uX)(),(0,r.CE)("button",{key:1,onClick:t[4]||(t[4]=(...e)=>s.selectAll&&s.selectAll(...e)),class:"btn-select-all"},"Select All")):(0,r.Q3)("",!0)]),s.currentUser?s.loading?((0,r.uX)(),(0,r.CE)("div",Cl,"Loading your bucket list...")):0===s.filteredItems.length?((0,r.uX)(),(0,r.CE)("div",bl,[s.showCompleted?((0,r.uX)(),(0,r.CE)("p",El,"You haven't completed any bucket list items yet.")):((0,r.uX)(),(0,r.CE)("p",Rl,"Your bucket list is empty. Add some restaurants to try!"))])):((0,r.uX)(),(0,r.CE)("div",Ml,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.filteredItems,t=>((0,r.uX)(),(0,r.CE)("div",{key:t.id,class:(0,n.C4)(["restaurant-item",{selected:s.selectedItems.has(t.id)}])},[s.selectedItems.size>0?((0,r.uX)(),(0,r.CE)("div",xl,[(0,r.Lk)("input",{type:"checkbox",checked:s.selectedItems.has(t.id),onChange:e=>s.toggleItemSelection(t.id)},null,40,Il)])):(0,r.Q3)("",!0),(0,r.Lk)("div",Xl,[(0,r.Lk)("span",_l,(0,n.v_)(t.restaurant.name),1),(0,r.Lk)("div",zl,[t.restaurant.averageRating>0?((0,r.uX)(),(0,r.CE)("div",{key:0,class:"rating",title:`${t.restaurant.averageRating.toFixed(2)} average rating`},[(0,r.bF)(i,{rating:t.restaurant.averageRating},null,8,["rating"]),(0,r.Lk)("span",Pl,(0,n.v_)(t.restaurant.averageRating.toFixed(1)),1),(0,r.Lk)("span",Sl,"("+(0,n.v_)(t.restaurant.ratingCount)+")",1)],8,Al)):(0,r.Q3)("",!0),null!==t.restaurant.distance?((0,r.uX)(),(0,r.CE)("span",Fl,(0,n.v_)(t.restaurant.distance.toFixed(1))+" miles away ",1)):(0,r.Q3)("",!0)]),(0,r.Lk)("span",Ul,[(0,r.eW)((0,n.v_)(t.restaurant.address),1),t.restaurant.city?((0,r.uX)(),(0,r.CE)(r.FK,{key:0},[(0,r.eW)(", "+(0,n.v_)(t.restaurant.city),1)],64)):(0,r.Q3)("",!0),t.restaurant.state?((0,r.uX)(),(0,r.CE)(r.FK,{key:1},[(0,r.eW)(", "+(0,n.v_)(t.restaurant.state),1)],64)):(0,r.Q3)("",!0),t.restaurant.zip?((0,r.uX)(),(0,r.CE)(r.FK,{key:2},[(0,r.eW)((0,n.v_)(t.restaurant.zip),1)],64)):(0,r.Q3)("",!0)])]),(0,r.Lk)("div",Kl,[(0,r.Lk)("button",{onClick:e=>s.removeFromBucketList(t.id),class:"action-btn delete-btn"},"Remove",8,Hl),(0,r.Lk)("button",{class:"check-in-btn",onClick:a=>e.$emit("review-at",t.restaurantId)},"Review",8,Vl)])],2))),128))])):((0,r.uX)(),(0,r.CE)("div",fl,t[5]||(t[5]=[(0,r.Lk)("p",null,"Please log in to view your bucket list.",-1)])))])}const Nl={name:"BucketList",components:{StarRating:Ge},emits:["review-at"],setup(){const e=(0,te.KR)([]),t=(0,te.KR)(!0),a=(0,te.KR)(!1),s=(0,te.KR)(null),n=(0,te.KR)(ie.currentUser),l=(0,te.KR)(new Set);let o=()=>{};ie.onAuthStateChanged(a=>{n.value=a,a?i():(t.value=!1,e.value=[],o&&o())});const i=()=>{const a=ie.currentUser;if(!a)return t.value=!1,void(e.value=[]);const r=(0,re.P)((0,re.rJ)(ce,"bucketListItems"),(0,re._M)("userId","==",a.uid));o=(0,re.aQ)(r,async a=>{t.value=!0;try{const r=a.docs.map(e=>({id:e.id,...e.data()}));if(0===r.length)return e.value=[],void(t.value=!1);const n=[...new Set(r.map(e=>e.restaurantId).filter(Boolean))],l=new Map;if(n.length>0){for(let e=0;e<n.length;e+=30){const t=n.slice(e,e+30),a=(0,re.P)((0,re.rJ)(ce,"restaurants"),(0,re._M)((0,re.Fs)(),"in",t)),s=await(0,re.GG)(a);s.forEach(e=>l.set(e.id,{id:e.id,...e.data()}))}const t=(0,re.P)((0,re.rJ)(ce,"reviews"),(0,re._M)("restaurantId","in",n)),a=await(0,re.GG)(t),o={};a.forEach(e=>{const t=e.data();t.restaurantId&&"number"===typeof t.rating&&(o[t.restaurantId]||(o[t.restaurantId]={total:0,count:0}),o[t.restaurantId].total+=t.rating,o[t.restaurantId].count++)}),e.value=r.map(e=>{const t=l.get(e.restaurantId);if(!t)return null;const a=o[t.id];return t.averageRating=a?a.total/a.count:0,t.ratingCount=a?a.count:0,t.distance=s.value&&t.location?Te(s.value.lat,s.value.lng,t.location.lat,t.location.lng):null,{...e,restaurant:t}}).filter(Boolean)}else e.value=[]}catch(r){console.error("Error loading bucket list:",r),e.value=[]}finally{t.value=!1}},a=>{console.error("Error in bucket list snapshot:",a),e.value=[],t.value=!1})};(0,r.sV)(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(t=>{s.value={lat:t.coords.latitude,lng:t.coords.longitude},e.value.length>0&&n.value&&i()},e=>{console.error("Error getting location for bucket list",e)}),n.value?i():t.value=!1}),(0,r.hi)(()=>{o()});const u=(0,r.EW)(()=>{const t=e.value.filter(e=>a.value?!!e.completedAt:!e.completedAt);return t.sort((e,t)=>null===e.restaurant.distance?1:null===t.restaurant.distance?-1:e.restaurant.distance-t.restaurant.distance)}),c=async e=>{if(confirm("Are you sure you want to remove this from your bucket list?"))try{await(0,re.kd)((0,re.H9)(ce,"bucketListItems",e)),Ae("Removed from bucket list","success")}catch(t){console.error("Error removing from bucket list:",t),Ae("Failed to remove item. Please try again.","error")}},d=e=>{l.value.has(e)?l.value.delete(e):l.value.add(e)},v=()=>{u.value.forEach(e=>{l.value.add(e.id)})},p=async()=>{if(0!==l.value.size&&confirm(`Are you sure you want to remove ${l.value.size} item(s) from your bucket list?`))try{const e=Array.from(l.value).map(e=>(0,re.kd)((0,re.H9)(ce,"bucketListItems",e)));await Promise.all(e),Ae(`Removed ${l.value.size} item(s) from bucket list`,"success"),l.value.clear()}catch(e){console.error("Error removing items:",e),Ae("Failed to remove items. Please try again.","error")}},w=e=>{const t=encodeURIComponent(`${e.name}, ${e.address}`);return`https://www.google.com/maps/dir/?api=1&destination=${t}`},g=e=>{const t=encodeURIComponent(`${e.name}, ${e.address}`);return`https://www.google.com/search?q=${t}`};return{loading:t,showCompleted:a,filteredItems:u,selectedItems:l,removeFromBucketList:c,toggleItemSelection:d,selectAll:v,removeSelectedItems:p,getDirectionsUrl:w,getDetailsUrl:g,currentUser:n}}},Bl=(0,Fe.A)(Nl,[["render",Ql],["__scopeId","data-v-11aea084"]]),Jl=Bl,Gl={class:"following-page"},Tl={key:0,class:"loading-indicator"},Dl={key:1},$l={key:0,class:"no-users-message"},Wl={class:"user-card-content"},Ol={class:"user-info"},ql=["src"],jl={class:"user-details"},Zl={class:"user-name-line"},Yl={class:"user-name"},eo={key:0,class:"medal"},to={key:0,class:"last-review"},ao={class:"review-header"},so={class:"review-body"},ro={key:0,class:"review-text"},no={key:1,class:"last-review no-review"},lo={class:"user-actions"},oo=["onClick"],io=["onClick"];function uo(e,t,a,s,l,o){const i=(0,r.g2)("UserReviewsModal"),u=(0,r.g2)("StarRating");return(0,r.uX)(),(0,r.CE)(r.FK,null,[s.isReviewsModalVisible?((0,r.uX)(),(0,r.Wv)(i,{key:0,user:s.userForReviews,onClose:s.closeReviewsModal},null,8,["user","onClose"])):(0,r.Q3)("",!0),(0,r.Lk)("div",Gl,[s.loading?((0,r.uX)(),(0,r.CE)("div",Tl,"Loading users you follow...")):((0,r.uX)(),(0,r.CE)("div",Dl,[0===s.following.length?((0,r.uX)(),(0,r.CE)("div",$l,t[0]||(t[0]=[(0,r.Lk)("h3",null,"Not following anyone yet",-1),(0,r.Lk)("p",null,'Visit the "Follow Users" page to discover and follow other reviewers to see their posts in your feed.',-1)]))):(0,r.Q3)("",!0),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.following,e=>((0,r.uX)(),(0,r.CE)("div",{key:e.uid,class:"user-card"},[(0,r.Lk)("div",Wl,[(0,r.Lk)("div",Ol,[(0,r.Lk)("img",{src:e.photoURL||"https://cdn-icons-png.flaticon.com/512/149/149071.png",class:"user-avatar",alt:"User",referrerpolicy:"no-referrer"},null,8,ql),(0,r.Lk)("div",jl,[(0,r.Lk)("div",Zl,[(0,r.Lk)("span",Yl,(0,n.v_)(e.displayName),1),e.medal?((0,r.uX)(),(0,r.CE)("span",eo,(0,n.v_)(e.medal),1)):(0,r.Q3)("",!0)])])]),e.lastReview?((0,r.uX)(),(0,r.CE)("div",to,[(0,r.Lk)("div",ao,[t[1]||(t[1]=(0,r.eW)(" Latest review: ",-1)),(0,r.Lk)("strong",null,(0,n.v_)(e.lastReview.restaurantName),1)]),(0,r.Lk)("div",so,[(0,r.bF)(u,{rating:e.lastReview.rating},null,8,["rating"]),e.lastReview.text?((0,r.uX)(),(0,r.CE)("p",ro,'"'+(0,n.v_)(e.lastReview.text)+'"',1)):(0,r.Q3)("",!0)])])):((0,r.uX)(),(0,r.CE)("div",no," No reviews yet. "))]),(0,r.Lk)("div",lo,[(0,r.Lk)("button",{onClick:t=>s.openReviewsModal(e),class:"action-btn",title:"View Reviews"},t[2]||(t[2]=[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"})],-1)]),8,oo),(0,r.Lk)("button",{onClick:t=>s.unfollowUser(e),class:"unfollow-btn"},"Unfollow",8,io)])]))),128))]))])],64)}const co=e=>"number"!==typeof e?null:0===e?"ðŸ¥‡":1===e?"ðŸ¥ˆ":2===e?"ðŸ¥‰":e>=3&&e<10?"ðŸ…":null,vo={name:"Following",components:{StarRating:Ge,UserReviewsModal:Ls},setup(){const e=(0,te.KR)([]),t=(0,te.KR)(!0),a=(0,te.KR)(!1),s=(0,te.KR)(null),n=(0,te.KR)(new Map);let l=()=>{};const o=async()=>{t.value=!0;const a=ie.currentUser;if(!a)return void(t.value=!1);const s=await(0,re.GG)((0,re.P)((0,re.rJ)(ce,"users"),(0,re.My)("reviewCount","desc"),(0,re.AB)(30))),r=s.docs.map(e=>({id:e.id,...e.data()})).filter(e=>{const t=Number(e.reviewCount)||0;return t>0}).sort((e,t)=>{const a=Number(e.reviewCount)||0,s=Number(t.reviewCount)||0;return s-a}).slice(0,10),o=new Map;r.forEach((e,t)=>{o.set(e.id,t)}),n.value=o;const i=(0,re.P)((0,re.rJ)(ce,"follows"),(0,re._M)("followerId","==",a.uid));l=(0,re.aQ)(i,async a=>{const s=a.docs.map(e=>e.data().followingId);if(0===s.length)return e.value=[],void(t.value=!1);const r=await(0,re.GG)((0,re.rJ)(ce,"restaurants")),l=new Map;r.forEach(e=>{l.set(e.id,e.data().name)});const o=[];for(let e=0;e<s.length;e+=30){const t=s.slice(e,e+30);if(t.length>0){const e=(0,re.P)((0,re.rJ)(ce,"users"),(0,re._M)("uid","in",t)),a=await(0,re.GG)(e);a.forEach(e=>{o.push({uid:e.id,...e.data()})})}}const i=await Promise.all(o.map(async e=>{const t=(0,re.P)((0,re.rJ)(ce,"reviews"),(0,re._M)("userId","==",e.uid),(0,re.My)("createdAt","desc"),(0,re.AB)(1)),a=await(0,re.GG)(t);let s=null;if(!a.empty){const e=a.docs[0].data();s={...e,restaurantName:l.get(e.restaurantId)||"Unknown Restaurant"}}const r=n.value.get(e.uid);return{...e,lastReview:s,medal:co(r)}}));e.value=i,t.value=!1})};(0,r.sV)(o),(0,r.hi)(()=>l());const i=async e=>{const t=ie.currentUser;if(t&&window.confirm(`Are you sure you want to unfollow ${e.displayName}?`))try{const a=(0,re.P)((0,re.rJ)(ce,"follows"),(0,re._M)("followerId","==",t.uid),(0,re._M)("followingId","==",e.uid)),s=await(0,re.GG)(a);if(!s.empty){const t=s.docs[0].id;await(0,re.kd)((0,re.H9)(ce,"follows",t)),Ae(`Unfollowed ${e.displayName}`,"success")}}catch(a){console.error("Error unfollowing user:",a),Ae("Failed to unfollow user. Please try again.","error")}},u=e=>{s.value=e,a.value=!0},c=()=>{a.value=!1,s.value=null};return{following:e,loading:t,unfollowUser:i,isReviewsModalVisible:a,userForReviews:s,openReviewsModal:u,closeReviewsModal:c}}},po=(0,Fe.A)(vo,[["render",uo],["__scopeId","data-v-614462e6"]]),wo=po,go={class:"modal-content"},mo={class:"modal-header"},ho={class:"modal-body"},ko={key:0,class:"loading-indicator"},Lo={key:1,class:"error-message"},yo={key:2,class:"review-detail"},fo={class:"post-header"},Co=["src"],bo={class:"post-info"},Ro={class:"user-line"},Eo={class:"user-name"},Mo={key:0,class:"medal"},xo={class:"post-date"},Io={class:"post-content"},Xo={class:"post-title-line"},_o={class:"restaurant-name"},zo={key:0,class:"distance"},Ao={key:0,class:"restaurant-location"},Po={class:"review-body"},So={key:0,class:"review-text"},Fo=["src"],Uo={key:2,class:"tags-container"},Ko={class:"post-actions"},Ho=["disabled"];function Vo(e,t,a,l,o,i){const u=(0,r.g2)("StarRating"),c=(0,r.g2)("Comments");return(0,r.uX)(),(0,r.CE)("div",{class:"modal-overlay",onClick:t[2]||(t[2]=(0,s.D$)(t=>e.$emit("close"),["self"]))},[(0,r.Lk)("div",go,[(0,r.Lk)("div",mo,[t[3]||(t[3]=(0,r.Lk)("h2",null,"Review",-1)),(0,r.Lk)("button",{onClick:t[0]||(t[0]=t=>e.$emit("close")),class:"close-btn"},"Ã—")]),(0,r.Lk)("div",ho,[l.loading?((0,r.uX)(),(0,r.CE)("div",ko,"Loading review...")):l.error?((0,r.uX)(),(0,r.CE)("div",Lo,(0,n.v_)(l.error),1)):l.review?((0,r.uX)(),(0,r.CE)("div",yo,[(0,r.Lk)("div",fo,[(0,r.Lk)("img",{src:l.review.userPhoto||"https://cdn-icons-png.flaticon.com/512/149/149071.png",alt:"User",class:"user-avatar",referrerpolicy:"no-referrer"},null,8,Co),(0,r.Lk)("div",bo,[(0,r.Lk)("div",Ro,[(0,r.Lk)("span",Eo,(0,n.v_)(l.review.userName),1),l.review.medal?((0,r.uX)(),(0,r.CE)("span",Mo,(0,n.v_)(l.review.medal),1)):(0,r.Q3)("",!0)]),(0,r.Lk)("span",xo,(0,n.v_)(l.formatDate(l.review.createdAt)),1)])]),(0,r.Lk)("div",Io,[(0,r.Lk)("div",Xo,[(0,r.Lk)("h2",_o,(0,n.v_)(l.review.restaurantName),1),null!==l.review.distance?((0,r.uX)(),(0,r.CE)("div",zo,(0,n.v_)(l.review.distance.toFixed(1))+" miles away ",1)):(0,r.Q3)("",!0)]),l.review.restaurantCity||l.review.restaurantState?((0,r.uX)(),(0,r.CE)("div",Ao,[(0,r.eW)((0,n.v_)(l.review.restaurantCity),1),l.review.restaurantCity&&l.review.restaurantState?((0,r.uX)(),(0,r.CE)(r.FK,{key:0},[(0,r.eW)(", ")],64)):(0,r.Q3)("",!0),(0,r.eW)((0,n.v_)(l.review.restaurantState),1)])):(0,r.Q3)("",!0),(0,r.Lk)("div",Po,[(0,r.bF)(u,{rating:l.review.rating},null,8,["rating"]),l.review.text?((0,r.uX)(),(0,r.CE)("p",So,'"'+(0,n.v_)(l.review.text)+'"',1)):(0,r.Q3)("",!0),l.review.photoURL?((0,r.uX)(),(0,r.CE)("img",{key:1,src:l.review.photoURL,alt:"Review photo",class:"review-photo"},null,8,Fo)):(0,r.Q3)("",!0),l.review.tags&&l.review.tags.length>0?((0,r.uX)(),(0,r.CE)("div",Uo,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.review.tags,e=>((0,r.uX)(),(0,r.CE)("span",{key:e,class:"tag"},(0,n.v_)(e),1))),128))])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",Ko,[(0,r.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>l.toggleLike&&l.toggleLike(...e)),class:(0,n.C4)(["like-btn",{liked:l.review.isLiked}]),disabled:!a.user},[t[4]||(t[4]=(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20px",viewBox:"0 0 24 24",width:"20px",fill:"currentColor"},[(0,r.Lk)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Lk)("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})],-1)),(0,r.Lk)("span",null,(0,n.v_)(l.review.likeCount||0),1)],10,Ho)]),(0,r.bF)(c,{"post-id":l.review.id,user:a.user,"post-type":"reviews","post-author-id":l.review.userId},null,8,["post-id","user","post-author-id"])])])):(0,r.Q3)("",!0)])])])}const Qo=(e={})=>{const{title:t="PorkHub",description:a="Find, review, and share the best breaded pork tenderloin sandwiches.",image:s="",url:r=window.location.href,type:n="website"}=e,l=(e,t)=>{if(!t)return;let a=document.querySelector(`meta[property="${e}"]`)||document.querySelector(`meta[name="${e}"]`);a||(a=document.createElement("meta"),e.startsWith("og:")?a.setAttribute("property",e):a.setAttribute("name",e),document.head.appendChild(a)),a.setAttribute("content",t)};document.title=t,l("description",a),l("og:title",t),l("og:description",a),l("og:image",s),l("og:url",r),l("og:type",n),l("og:site_name","PorkHub"),l("twitter:card","summary_large_image"),l("twitter:title",t),l("twitter:description",a),l("twitter:image",s);let o=document.querySelector('link[rel="canonical"]');o||(o=document.createElement("link"),o.setAttribute("rel","canonical"),document.head.appendChild(o)),o.setAttribute("href",r)},No=()=>{Qo({title:"PorkHub",description:"Find, review, and share the best breaded pork tenderloin sandwiches. Join the PorkHub community to discover hidden gems and top-rated restaurants.",image:"",url:window.location.origin})},Bo={name:"ReviewDetailModal",components:{StarRating:Ge,Comments:Ke},props:{reviewId:{type:String,required:!0},user:{type:Object,default:null}},emits:["close"],setup(e){const t=(0,te.KR)(null),a=(0,te.KR)(!0),s=(0,te.KR)(""),n=(0,te.KR)(new Map),l=(0,te.KR)(new Map),o=(0,te.KR)(null);let i=()=>{};const u=e=>"number"!==typeof e?null:0===e?"ðŸ¥‡":1===e?"ðŸ¥ˆ":2===e?"ðŸ¥‰":e>=3&&e<10?"ðŸ…":null,c=e=>e&&e.toDate?e.toDate().toLocaleString():"",d=async()=>{a.value=!0,s.value="";try{const r=await(0,re.GG)((0,re.rJ)(ce,"restaurants"));r.forEach(e=>{n.value.set(e.id,e.data())});const i=await(0,re.GG)((0,re.P)((0,re.rJ)(ce,"users"),(0,re.My)("reviewCount","desc"),(0,re.AB)(30))),c=i.docs.map(e=>({id:e.id,...e.data()})).filter(e=>{const t=Number(e.reviewCount)||0;return t>0}).sort((e,t)=>{const a=Number(e.reviewCount)||0,s=Number(t.reviewCount)||0;return s-a}).slice(0,10),d=new Map;c.forEach((e,t)=>{d.set(e.id,t)}),l.value=d,navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{o.value={lat:e.coords.latitude,lng:e.coords.longitude},v()},()=>{});const w=(0,re.H9)(ce,"reviews",e.reviewId),g=await(0,re.x7)(w);if(!g.exists())return s.value="Review not found.",void(a.value=!1);const m={id:g.id,...g.data()},h=n.value.get(m.restaurantId),k=l.value.get(m.userId);t.value={...m,restaurantName:h?.name||"Unknown Restaurant",restaurantCity:h?.city,restaurantState:h?.state,location:h?.location||null,distance:null,medal:u(k),likeCount:0,isLiked:!1},v(),p();const L=`${window.location.origin}/?review=${t.value.id}`,y=`${t.value.userName}'s Review of ${t.value.restaurantName}`,f=t.value.text?`"${t.value.text.substring(0,150)}${t.value.text.length>150?"...":""}"`:`${t.value.userName} rated ${t.value.restaurantName} ${t.value.rating} stars`,C=t.value.photoURL||"";Qo({title:y,description:f,image:C,url:L,type:"article"})}catch(r){console.error("Error fetching review:",r),s.value="Failed to load review. Please try again."}finally{a.value=!1}},v=()=>{t.value&&o.value&&t.value.location&&(t.value.distance=Te(o.value.lat,o.value.lng,t.value.location.lat,t.value.location.lng))},p=()=>{if(!t.value)return;const a=(0,re.H9)(ce,"reviews",t.value.id),s=(0,re.rJ)(a,"likes"),r=(0,re.P)(s);i=(0,re.aQ)(r,a=>{t.value&&(t.value.likeCount=a.size,t.value.isLiked=!!e.user&&a.docs.some(t=>t.data().userId===e.user.uid))},e=>{console.error("Error fetching likes:",e)})},w=async()=>{if(!e.user||!t.value)return;const a=(0,re.H9)(ce,"reviews",t.value.id),s=(0,re.rJ)(a,"likes"),r=(0,re.P)(s,(0,re._M)("userId","==",e.user.uid)),n=await(0,re.GG)(r);n.empty?await(0,re.gS)(s,{userId:e.user.uid,createdAt:(0,re.O5)()}):await(0,re.kd)(n.docs[0].ref)};return(0,r.wB)(()=>e.reviewId,()=>{e.reviewId?(i&&i(),d()):No()},{immediate:!0}),(0,r.sV)(()=>{e.reviewId&&d()}),(0,r.hi)(()=>{No(),i&&i()}),{review:t,loading:a,error:s,formatDate:c,toggleLike:w}}},Jo=(0,Fe.A)(Bo,[["render",Vo],["__scopeId","data-v-a904abd6"]]),Go=Jo,To=["onClick"],Do={class:"toast-message"},$o=["onClick"];function Wo(e,t,a,l,o,i){return(0,r.uX)(),(0,r.Wv)(s.F,{name:"toast",tag:"div",class:"toast-container"},{default:(0,r.k6)(()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.toasts,e=>((0,r.uX)(),(0,r.CE)("div",{key:e.id,class:(0,n.C4)(["toast",`toast-${e.type}`]),onClick:t=>l.removeToast(e.id)},[(0,r.Lk)("span",Do,(0,n.v_)(e.message),1),(0,r.Lk)("button",{class:"toast-close",onClick:(0,s.D$)(t=>l.removeToast(e.id),["stop"])},"Ã—",8,$o)],10,To))),128))]),_:1})}const Oo={name:"Toast",setup(){const e=(0,te.KR)([]);let t=null;const a=t=>{const a=e.value.findIndex(e=>e.id===t);a>-1&&e.value.splice(a,1)};return(0,r.sV)(()=>{t=Pe(t=>{e.value.push(t),t.duration>0&&setTimeout(()=>{a(t.id)},t.duration)})}),(0,r.hi)(()=>{t&&t()}),{toasts:e,removeToast:a}}},qo=(0,Fe.A)(Oo,[["render",Wo],["__scopeId","data-v-285b30f8"]]),jo=qo,Zo={name:"App",components:{Home:We,Restaurants:Aa,BucketList:Jl,UserSearch:Cs,Review:hr,Recommendations:Vr,DatabaseStats:Yr,MyReviews:Pn,Leaderboard:Wn,Followers:ml,Following:wo,ReviewDetailModal:Go,Toast:jo},setup(){const e=(0,te.KR)(null),t=(0,te.KR)("home"),a=(0,te.KR)(null),s=(0,te.KR)(window.innerWidth<768),n=(0,te.KR)("26.01.16.162517"),l=(0,te.KR)(null),o=(0,r.EW)(()=>e.value&&"kennected.com@gmail.com"===e.value.email),i=new Set(["review","user-search","bucket-list","my-reviews","followers","following","database-stats"]),u={home:"Home",restaurants:"Restaurants","bucket-list":"BucketList","user-search":"UserSearch",review:"Review","my-reviews":"MyReviews",recommendations:"Recommendations",leaderboard:"Leaderboard","database-stats":"DatabaseStats",followers:"Followers",following:"Following"},c=(0,r.EW)(()=>u[t.value]||"Home"),d=()=>{s.value=!s.value};window.addEventListener("resize",()=>{s.value=window.innerWidth<768}),(0,se.hg)(ie,async a=>{if(e.value=a,a)try{const e=(0,re.H9)(ce,"users",a.uid),t=await(0,re.x7)(e);t.exists()||await(0,re.BN)(e,{uid:a.uid,displayName:a.displayName,email:a.email,photoURL:a.photoURL,createdAt:new Date,reviewCount:0})}catch(s){console.error("Error checking/creating user document:",s)}else i.has(t.value)&&(t.value="home")});const v=async()=>{try{await(0,se.df)(ie,ue)}catch(e){alert("Login failed: "+e.message)}},p=async()=>{await(0,se.CI)(ie)},w=()=>{t.value="home"},g=()=>{t.value="restaurants"},m=()=>{t.value="user-search"},h=()=>{t.value="review"},k=()=>{t.value="my-reviews"},L=()=>{t.value="recommendations"},y=()=>{t.value="leaderboard"},f=()=>{t.value="database-stats"},C=()=>{t.value="followers"},b=()=>{t.value="following"},R=()=>{t.value="bucket-list"},E=e=>{a.value=e,t.value="review"},M=()=>{const e=window.location.pathname.match(/\/review\/([^\/\?]+)/);if(e&&e[1]){const t=e[1];return console.log("Deep link detected in path with review ID:",t),console.log("Setting sharedReviewId..."),l.value=t,void console.log("sharedReviewId is now:",l.value)}const t=new URLSearchParams(window.location.search),a=t.get("review");if(a)return console.log("Deep link detected with query param review ID:",a),console.log("Setting sharedReviewId..."),l.value=a,void console.log("sharedReviewId is now:",l.value);const s=window.location.hash;if(s){const e=s.match(/#review\/([^/\?]+)/);if(e&&e[1]){const t=e[1];return console.log("Deep link detected with hash review ID:",t),void(l.value=t)}}},x=()=>{l.value=null,No(),window.history.replaceState(null,"","/")};return(0,r.sV)(()=>{console.log("App mounted, checking for deep links..."),console.log("Current URL:",window.location.href),console.log("Current search params:",window.location.search),M(),window.addEventListener("hashchange",M),window.addEventListener("popstate",M)}),(0,r.hi)(()=>{window.removeEventListener("hashchange",M),window.removeEventListener("popstate",M)}),{user:e,loginWithGoogle:v,logout:p,currentPage:t,goToHome:w,goToRestaurants:g,goToUserSearch:m,goToReview:h,goToMyReviews:k,goToRecommendations:L,goToLeaderboard:y,goToDatabaseStats:f,goToFollowers:C,goToFollowing:b,goToBucketList:R,reviewAt:E,selectedRestaurantForReview:a,isSidebarCollapsed:s,toggleSidebar:d,isAdmin:o,currentComponent:c,appVersion:n,sharedReviewId:l,closeReviewModal:x}}},Yo=(0,Fe.A)(Zo,[["render",y]]),ei=Yo;(0,s.Ef)(ei).mount("#app")},914:(e,t,a)=>{a.d(t,{geocodeAddress:()=>r});const s="kennected.com@gmail.com";async function r(e){if(!e||!e.trim())return console.error("Geocoding error: Address is empty."),null;const t=`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(e)}&format=json&limit=1&email=${s}`;try{const e=await fetch(t),a=await e.json();if(a&&a.length>0){const{lat:e,lon:t}=a[0];return{lat:parseFloat(e),lng:parseFloat(t)}}return null}catch(a){return console.error("Error during geocoding fetch:",a),null}}}},t={};function a(s){var r=t[s];if(void 0!==r)return r.exports;var n=t[s]={exports:{}};return e[s](n,n.exports,a),n.exports}a.m=e,(()=>{var e=[];a.O=(t,s,r,n)=>{if(!s){var l=1/0;for(c=0;c<e.length;c++){for(var[s,r,n]=e[c],o=!0,i=0;i<s.length;i++)(!1&n||l>=n)&&Object.keys(a.O).every(e=>a.O[e](s[i]))?s.splice(i--,1):(o=!1,n<l&&(l=n));if(o){e.splice(c--,1);var u=r();void 0!==u&&(t=u)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[s,r,n]}})(),(()=>{a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}})(),(()=>{a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={524:0};a.O.j=t=>0===e[t];var t=(t,s)=>{var r,n,[l,o,i]=s,u=0;if(l.some(t=>0!==e[t])){for(r in o)a.o(o,r)&&(a.m[r]=o[r]);if(i)var c=i(a)}for(t&&t(s);u<l.length;u++)n=l[u],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(c)},s=self["webpackChunkmy_vue_app"]=self["webpackChunkmy_vue_app"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var s=a.O(void 0,[504],()=>a(729));s=a.O(s)})();
//# sourceMappingURL=app.0d059f12.js.map