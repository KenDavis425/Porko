{"version":3,"file":"js/app.23a83b82.js","mappings":"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","sources":["webpack://my-vue-app/./src/App.vue","webpack://my-vue-app/./src/components/Home.vue","webpack://my-vue-app/./src/firebase.js","webpack://my-vue-app/./src/components/Comments.vue","webpack://my-vue-app/./src/utils/toast.js","webpack://my-vue-app/./src/components/Comments.vue?bff9","webpack://my-vue-app/./src/components/StarRating.vue","webpack://my-vue-app/./src/components/StarRating.vue?3b7a","webpack://my-vue-app/./src/components/ActivityFeed.vue","webpack://my-vue-app/./src/utils/badges.js","webpack://my-vue-app/./src/components/ActivityFeed.vue?b52d","webpack://my-vue-app/./src/components/TrendingRestaurants.vue","webpack://my-vue-app/./src/components/TrendingRestaurants.vue?b43f","webpack://my-vue-app/./src/components/FollowRecommendations.vue","webpack://my-vue-app/./src/components/FollowRecommendations.vue?69ae","webpack://my-vue-app/./src/utils/geolocation.js","webpack://my-vue-app/./src/components/Home.vue?08c6","webpack://my-vue-app/./src/components/Restaurants.vue","webpack://my-vue-app/./src/components/EditRestaurantModal.vue","webpack://my-vue-app/./src/components/EditRestaurantModal.vue?95b0","webpack://my-vue-app/./src/components/AddReviewModal.vue","webpack://my-vue-app/./src/components/AddReviewModal.vue?122a","webpack://my-vue-app/./src/components/RestaurantReviewsModal.vue","webpack://my-vue-app/./src/components/RestaurantReviewsModal.vue?292d","webpack://my-vue-app/./src/components/Restaurants.vue?77bd","webpack://my-vue-app/./src/components/UserSearch.vue","webpack://my-vue-app/./src/components/UserReviewsModal.vue","webpack://my-vue-app/./src/components/UserReviewsModal.vue?7212","webpack://my-vue-app/./src/components/UserSearch.vue?3330","webpack://my-vue-app/./src/components/Review.vue","webpack://my-vue-app/./src/components/Review.vue?483a","webpack://my-vue-app/./src/components/Recommendations.vue","webpack://my-vue-app/./src/components/Recommendations.vue?77a3","webpack://my-vue-app/./src/components/DatabaseStats.vue","webpack://my-vue-app/./src/components/DatabaseStats.vue?5e68","webpack://my-vue-app/./src/components/MyReviews.vue","webpack://my-vue-app/./src/components/MyReviews.vue?9029","webpack://my-vue-app/./src/components/Leaderboard.vue","webpack://my-vue-app/./src/components/Leaderboard.vue?23d5","webpack://my-vue-app/./src/components/Followers.vue","webpack://my-vue-app/./src/components/Followers.vue?990e","webpack://my-vue-app/./src/components/BucketList.vue","webpack://my-vue-app/./src/components/BucketList.vue?ed3b","webpack://my-vue-app/./src/components/Following.vue","webpack://my-vue-app/./src/components/Following.vue?4786","webpack://my-vue-app/./src/components/Help.vue","webpack://my-vue-app/./src/components/Help.vue?a5ec","webpack://my-vue-app/./src/components/Profile.vue","webpack://my-vue-app/./src/components/UserStatsPanel.vue","webpack://my-vue-app/./src/components/BadgeDisplay.vue","webpack://my-vue-app/./src/components/BadgeDisplay.vue?778b","webpack://my-vue-app/./src/components/UserStatsPanel.vue?dae2","webpack://my-vue-app/./src/components/Profile.vue?2c99","webpack://my-vue-app/./src/components/ReviewDetailModal.vue","webpack://my-vue-app/./src/utils/meta.js","webpack://my-vue-app/./src/components/ReviewDetailModal.vue?261b","webpack://my-vue-app/./src/components/Toast.vue","webpack://my-vue-app/./src/components/Toast.vue?44c7","webpack://my-vue-app/./src/App.vue?7ccd","webpack://my-vue-app/./src/main.js","webpack://my-vue-app/./src/utils/geocoding.js","webpack://my-vue-app/webpack/bootstrap","webpack://my-vue-app/webpack/runtime/chunk loaded","webpack://my-vue-app/webpack/runtime/define property getters","webpack://my-vue-app/webpack/runtime/global","webpack://my-vue-app/webpack/runtime/hasOwnProperty shorthand","webpack://my-vue-app/webpack/runtime/jsonp chunk loading","webpack://my-vue-app/webpack/startup"],"sourcesContent":["<template>\n  <div id=\"app\">\n    <div class=\"main-layout\" :class=\"{ 'sidebar-collapsed': isSidebarCollapsed }\">\n      <aside class=\"sidebar\">\n        <div class=\"sidebar-top\">\n          <button class=\"sidebar-toggle\" @click=\"toggleSidebar\" title=\"Toggle Sidebar\">\n            <svg v-if=\"!isSidebarCollapsed\" xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z\"/></svg>\n            <img v-else src=\"/logo.svg\" class=\"sidebar-toggle-logo\" alt=\"Expand menu\" />\n          </button>\n          <div class=\"sidebar-branding\">\n            <img src=\"/logo.svg\" alt=\"PorkHub Logo\" class=\"sidebar-logo\" />\n            <h1 class=\"sidebar-title\">PorkHub</h1>\n          </div>\n          <div v-if=\"user\" class=\"sidebar-header\">\n            <img :src=\"user.photoURL || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" class=\"sidebar-avatar\" alt=\"User Avatar\" referrerpolicy=\"no-referrer\" @click=\"goToProfile\" style=\"cursor: pointer;\" title=\"View Your Profile\" />\n            <div class=\"sidebar-user\">{{ user.displayName }}</div>\n          </div>\n          <nav class=\"sidebar-nav\">\n            <button class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'home' }\" @click=\"goToHome\" title=\"Home\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8h5z\"/></svg>\n              <span>Home</span>\n            </button>\n            <button class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'leaderboard' }\" @click=\"goToLeaderboard\" title=\"Leaderboard\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M16 11V3H8v6H2v12h20V11h-6zm-6-6h4v14h-4V5zm-6 6h4v8H4v-8zm16 8h-4v-8h4v8z\"/></svg>\n              <span>Leaderboard</span>\n            </button>\n            <button class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'restaurants' }\" @click=\"goToRestaurants\" title=\"Restaurants\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M16 6v8h3v8h-3v-2h-2v2h-2v-2h-2v2H8v-2H6v2H3v-8h3V6c0-3.31 2.69-6 6-6s6 2.69 6 6zm-2 0c0-2.21-1.79-4-4-4s-4 1.79-4 4v8h8V6zm-5 3h2v2h-2z\"/></svg>\n              <span>Restaurants</span>\n            </button>\n            <button class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'recommendations' }\" @click=\"goToRecommendations\" title=\"Recommendations\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27z\"/></svg>\n              <span>Recommendations</span>\n            </button>\n            <!-- Protected Links -->\n            <button v-if=\"user\" class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'review' }\" @click=\"goToReview\" title=\"Write a Review\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M12 2C8.14 2 5 5.14 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.86-3.14-7-7-7zm-1.5 9h-2v-2h2v2zm5 0h-2v-2h2v2zm-2.5-4h-2V5h2v2z\"/></svg>\n              <span>Write a Review</span>\n            </button>\n            <button v-if=\"user\" class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'user-search' }\" @click=\"goToUserSearch\" title=\"Follow Users\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 5 1.41-1.41L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM12 10V7H8v3H5v2h3v3h2v-3h3v-2h-3z\"/></svg>\n              <span>Follow Users</span>\n            </button>\n            <button v-if=\"user\" class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'bucket-list' }\" @click=\"goToBucketList\" title=\"My Bucket List\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M18 7h-2.06c-.33-3.2-2.46-5.8-5.94-5.8S4.39 3.8 4.06 7H2v12h16V7zM6.14 7c.2-1.92 1.6-3.48 3.86-3.8A4.002 4.002 0 0 1 14 7h-2.14c-.2-1.92-1.6-3.48-3.86-3.8zM16 17H4v-8h12v8z\"/></svg>\n              <span>My Bucket List</span>\n            </button>\n            <button v-if=\"user\" class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'my-reviews' }\" @click=\"goToMyReviews\" title=\"My Reviews\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z\"/></svg>\n              <span>My Reviews</span>\n            </button>\n            <button v-if=\"user\" class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'followers' }\" @click=\"goToFollowers\" title=\"My Followers\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5s-3 1.34-3 3 1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z\"/></svg>\n              <span>My Followers</span>\n            </button>\n            <button v-if=\"user\" class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'following' }\" @click=\"goToFollowing\" title=\"Following\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><circle cx=\"6.18\" cy=\"17.82\" r=\"2.18\"/><path d=\"M4 4.44v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9zM4 10.1v2.83c2.39 0 4.33 1.94 4.33 4.33h2.83c0-3.98-3.23-7.16-7.16-7.16z\"/></svg>\n              <span>Following</span>\n            </button>\n          </nav>\n        </div>\n        <div class=\"sidebar-bottom\">\n            <button class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'help' }\" @click=\"goToHelp\" title=\"Help & User Guide\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z\"/></svg>\n              <span>Help</span>\n            </button>\n            <button v-if=\"isAdmin\" class=\"sidebar-link\" :class=\"{ 'active': currentPage === 'database-stats' }\" @click=\"goToDatabaseStats\" title=\"Database Stats\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M5 9.2h3V19H5zM10.6 5h2.8v14h-2.8zm5.6 8H19v6h-2.8z\"/></svg>\n              <span>Database Stats</span>\n            </button>\n            <button v-if=\"user\" class=\"sidebar-link\" @click=\"logout\" title=\"Logout\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5-5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z\"/></svg>\n              <span>Logout</span>\n            </button>\n            <button v-else class=\"login-btn-sidebar\" @click=\"loginWithGoogle\" title=\"Login with Google\">\n              <span>Login with</span>\n              <svg viewBox=\"0 0 48 48\" width=\"22px\" height=\"22px\">\n                <path fill=\"#EA4335\" d=\"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z\"></path>\n                <path fill=\"#4285F4\" d=\"M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z\"></path>\n                <path fill=\"#FBBC05\" d=\"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z\"></path>\n                <path fill=\"#34A853\" d=\"M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z\"></path>\n                <path fill=\"none\" d=\"M0 0h48v48H0z\"></path>\n              </svg>\n            </button>\n            <div class=\"app-version\">v{{ appVersion }}</div>\n        </div>\n      </aside>\n  <main class=\"main-content\">\n        <div v-if=\"!sharedReviewId\" class=\"component-wrapper\">\n          <keep-alive include=\"Home\">\n            <component \n              :is=\"currentComponent\" \n              :user=\"user\"\n              @reviewed=\"goToHome\"\n              @check-in-at=\"reviewAt\"\n              @review-at=\"reviewAt\"\n              @go-to-review=\"goToReview\"\n              :selected-restaurant-id=\"selectedRestaurantForReview\"\n            />\n          </keep-alive>\n        </div>\n        <div v-else class=\"component-wrapper empty-state\">\n          <!-- Empty state while modal is shown -->\n        </div>\n      </main>\n      <ReviewDetailModal \n        v-if=\"sharedReviewId\"\n        :review-id=\"sharedReviewId\"\n        :user=\"user\"\n        @close=\"closeReviewModal\"\n      />\n      <Toast />\n    </div>\n  </div>\n</template>\n\n<script>\nimport Home from './components/Home.vue';\nimport Restaurants from './components/Restaurants.vue';\nimport UserSearch from './components/UserSearch.vue';\nimport Review from './components/Review.vue';\nimport Recommendations from './components/Recommendations.vue';\nimport DatabaseStats from './components/DatabaseStats.vue';\nimport MyReviews from './components/MyReviews.vue';\nimport Leaderboard from './components/Leaderboard.vue';\nimport Followers from './components/Followers.vue';\nimport BucketList from './components/BucketList.vue';\nimport Following from './components/Following.vue';\nimport Help from './components/Help.vue';\nimport Profile from './components/Profile.vue';\nimport ReviewDetailModal from './components/ReviewDetailModal.vue';\nimport Toast from './components/Toast.vue';\nimport { resetMetaTags } from './utils/meta.js';\nimport { ref, computed, onMounted, onUnmounted } from 'vue';\nimport { onAuthStateChanged } from \"firebase/auth\";\nimport { auth, provider, signInWithPopup, signOut, db } from './firebase';\nimport { collection, query, where, getDocs, doc, setDoc, getDoc, writeBatch } from 'firebase/firestore';\n\nexport default {\n  name: 'App',\n  components: {\n    Home,\n    Restaurants,\n    BucketList,\n    UserSearch,\n    Review,\n    Recommendations,\n    DatabaseStats,\n    MyReviews,\n    Leaderboard,\n    Followers,\n    Profile,\n    Following,\n    Help,\n    ReviewDetailModal,\n    Toast\n  },\n  setup() {\n    const user = ref(null);\n    const currentPage = ref('home');\n    const selectedRestaurantForReview = ref(null);\n    const isSidebarCollapsed = ref(window.innerWidth < 768);\n    const appVersion = ref(process.env.VUE_APP_VERSION || 'dev');\n    const sharedReviewId = ref(null);\n\n    const isAdmin = computed(() => {\n      return user.value && user.value.email === 'kennected.com@gmail.com';\n    });\n\n    const protectedPages = new Set([\n      'review', 'user-search', 'bucket-list', 'my-reviews', \n      'followers', 'following', 'database-stats', 'profile'\n    ]);\n\n    const componentMap = {\n      'home': 'Home',\n      'restaurants': 'Restaurants',\n      'bucket-list': 'BucketList',\n      'user-search': 'UserSearch',\n      'review': 'Review',\n      'my-reviews': 'MyReviews',\n      'recommendations': 'Recommendations',\n      'leaderboard': 'Leaderboard',\n      'database-stats': 'DatabaseStats',\n      'followers': 'Followers',\n      'following': 'Following',\n      'help': 'Help',\n      'profile': 'Profile'\n    };\n    const currentComponent = computed(() => componentMap[currentPage.value] || 'Home');\n\n    const toggleSidebar = () => {\n      isSidebarCollapsed.value = !isSidebarCollapsed.value;\n    };\n\n    window.addEventListener('resize', () => {\n      isSidebarCollapsed.value = window.innerWidth < 768;\n    });\n\n    onAuthStateChanged(auth, async (u) => {\n      user.value = u;\n      if (u) { // User is logged in\n        try {\n          const userRef = doc(db, 'users', u.uid);\n          const userSnap = await getDoc(userRef);\n          if (!userSnap.exists()) {\n            await setDoc(userRef, {\n              uid: u.uid,\n              displayName: u.displayName,\n              email: u.email,\n              photoURL: u.photoURL,\n              createdAt: new Date(),\n              reviewCount: 0\n            });\n          }\n        } catch (error) {\n          console.error('Error checking/creating user document:', error);\n        }\n      } else { // User is logged out or a guest\n        // If they were on a protected page, redirect to home\n        if (protectedPages.has(currentPage.value)) {\n          currentPage.value = 'home';\n        }\n      }\n    });\n\n    const loginWithGoogle = async () => {\n      try {\n        await signInWithPopup(auth, provider);\n      } catch (error) {\n        alert('Login failed: ' + error.message);\n      }\n    };\n\n    const logout = async () => {\n      await signOut(auth);\n    };\n\n    const goToHome = () => {\n      currentPage.value = 'home';\n    };\n\n    const goToRestaurants = () => {\n      currentPage.value = 'restaurants';\n    };\n\n    const goToUserSearch = () => {\n      currentPage.value = 'user-search';\n    };\n\n    const goToReview = () => {      \n      currentPage.value = 'review';\n    };\n\n    const goToMyReviews = () => {\n      currentPage.value = 'my-reviews';\n    };\n\n    const goToRecommendations = () => {\n      currentPage.value = 'recommendations';\n    };\n\n    const goToLeaderboard = () => {\n      currentPage.value = 'leaderboard';\n    };\n\n    const goToDatabaseStats = () => {\n      currentPage.value = 'database-stats';\n    };\n\n    const goToFollowers = () => {\n      currentPage.value = 'followers';\n    };\n\n    const goToFollowing = () => {\n      currentPage.value = 'following';\n    };\n\n    const goToBucketList = () => {\n      currentPage.value = 'bucket-list';\n    };\n\n    const goToHelp = () => {\n      currentPage.value = 'help';\n    };\n\n    const goToProfile = () => {\n      currentPage.value = 'profile';\n    };\n\n    const reviewAt = (restaurantId) => {\n      selectedRestaurantForReview.value = restaurantId;\n      currentPage.value = 'review';\n    };\n\n    const handleDeepLink = () => {\n      // Check for path-based format: /review/{reviewId}\n      const pathMatch = window.location.pathname.match(/\\/review\\/([^\\/\\?]+)/);\n      if (pathMatch && pathMatch[1]) {\n        const reviewId = pathMatch[1];\n        console.log('Deep link detected in path with review ID:', reviewId);\n        console.log('Setting sharedReviewId...');\n        sharedReviewId.value = reviewId;\n        console.log('sharedReviewId is now:', sharedReviewId.value);\n        return;\n      }\n      \n      // Check for query parameter format: ?review={reviewId}\n      const urlParams = new URLSearchParams(window.location.search);\n      const reviewId = urlParams.get('review');\n      if (reviewId) {\n        console.log('Deep link detected with query param review ID:', reviewId);\n        console.log('Setting sharedReviewId...');\n        sharedReviewId.value = reviewId;\n        console.log('sharedReviewId is now:', sharedReviewId.value);\n        return;\n      }\n      \n      // Also check for hash format: #review/{reviewId}\n      // For backward compatibility with old share links\n      const hash = window.location.hash;\n      if (hash) {\n        const reviewMatch = hash.match(/#review\\/([^/\\?]+)/);\n        if (reviewMatch && reviewMatch[1]) {\n          const hashReviewId = reviewMatch[1];\n          console.log('Deep link detected with hash review ID:', hashReviewId);\n          sharedReviewId.value = hashReviewId;\n          return;\n        }\n      }\n    };\n\n    const closeReviewModal = () => {\n      sharedReviewId.value = null;\n      resetMetaTags();\n      // Clean up URL after modal closes\n      window.history.replaceState(null, '', '/');\n    };\n\n    onMounted(() => {\n      console.log('App mounted, checking for deep links...');\n      console.log('Current URL:', window.location.href);\n      console.log('Current search params:', window.location.search);\n      \n      // Check for deep links immediately\n      handleDeepLink();\n      \n      // Listen for hash changes (in case user navigates with back/forward)\n      window.addEventListener('hashchange', handleDeepLink);\n      \n      // Also listen for popstate (back/forward navigation)\n      window.addEventListener('popstate', handleDeepLink);\n    });\n\n    onUnmounted(() => {\n      window.removeEventListener('hashchange', handleDeepLink);\n      window.removeEventListener('popstate', handleDeepLink);\n    });\n\n    return { user, loginWithGoogle, logout, currentPage, goToHome, goToRestaurants, goToUserSearch, goToReview, goToMyReviews, goToRecommendations, goToLeaderboard, goToDatabaseStats, goToFollowers, goToFollowing, goToBucketList, goToHelp, goToProfile, reviewAt, selectedRestaurantForReview, isSidebarCollapsed, toggleSidebar, isAdmin, currentComponent, appVersion, sharedReviewId, closeReviewModal };\n  }\n}; \n</script>\n\n<style>\n:root {\n  --primary-color: #3498db;\n  --secondary-color: #2c3e50;\n  --background-color: #ecf0f1;\n  --sidebar-background: #ffffff;\n  --text-color: #34495e;\n  --card-background: #ffffff;\n  --shadow-color: rgba(0, 0, 0, 0.1);\n}\n\nbody {\n  font-family: 'Roboto', sans-serif;\n  background-color: var(--background-color);\n  color: var(--text-color);\n  margin: 0;\n}\n\n#app {\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  touch-action: manipulation;\n}\n\n.main-layout {\n  display: flex;\n  height: 100vh;\n}\n\n.sidebar {\n  width: 200px;\n  background: var(--sidebar-background);\n  padding: 2em 1em 0.5em;\n  box-shadow: 2px 0 5px var(--shadow-color);\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  transition: width 0.3s;\n}\n\n.sidebar-top {\n  position: relative;\n}\n\n.main-layout.sidebar-collapsed .sidebar {\n  width: 70px;\n  padding: 2em 0;\n}\n\n.main-layout.sidebar-collapsed .sidebar-link span,\n.main-layout.sidebar-collapsed .sidebar-user {\n  display: none;\n}\n\n.main-layout.sidebar-collapsed .sidebar-link,\n.main-layout.sidebar-collapsed .sidebar-nav button {\n  justify-content: center;\n}\n\n.main-layout.sidebar-collapsed .sidebar-header {\n  display: none;\n}\n\n.main-layout.sidebar-collapsed .sidebar-branding {\n  display: none;\n}\n\n.sidebar-bottom {\n    display: flex;\n    flex-direction: column;\n    gap: 0.2em;\n}\n\n.sidebar-header {\n  text-align: center;\n  margin-bottom: 1em;\n}\n\n.sidebar-branding {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.5em;\n  margin-bottom: 1em;\n}\n\n.sidebar-logo {\n  width: 40px;\n  height: 40px;\n}\n\n.sidebar-title {\n  font-family: 'Arial Black', Gadget, sans-serif;\n  font-size: 1.5em;\n  font-weight: 900;\n  margin: 0;\n  color: var(--secondary-color);\n  letter-spacing: -1.5px;\n}\n\n.sidebar-avatar {\n  width: 60px;\n  height: 60px;\n  border-radius: 50%;\n  margin-bottom: 0.75em;\n}\n\n.sidebar-user {\n  font-weight: 600;\n  font-size: 1.1em;\n}\n\n.sidebar-nav {\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  gap: 0.2em;\n}\n\n.sidebar-link, .sidebar-nav button {\n  background: none;\n  border: none;\n  color: var(--text-color);\n  padding: 0.5em 1em;\n  text-align: left;\n  font-size: 1em;\n  border-radius: 8px;\n  cursor: pointer;\n  transition: background-color 0.2s, color 0.2s;\n  display: flex;\n  align-items: center;\n  gap: 0.8em;\n  width: 100%;\n}\n\n.sidebar-link:hover, .sidebar-nav button:hover, .sidebar-toggle:hover {\n  background-color: var(--primary-color);\n  color: white;\n}\n\n.sidebar-link.active {\n  background-color: var(--primary-color);\n  color: white;\n}\n\n.sidebar-link svg {\n  flex-shrink: 0;\n}\n\n.main-content {\n  flex: 1;\n  padding: 2em;\n  overflow-y: auto;\n  position: relative;\n}\n\n@media (max-width: 768px) {\n  .main-content {\n    padding: 1em;\n  }\n}\n\n.sidebar-toggle {\n  position: absolute;\n  top: -1em;\n  right: -0.5em;\n  background: none;\n  border: none;\n  padding: 0.5em;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 50%;\n  color: var(--text-color);\n  transition: background-color 0.2s, color 0.2s;\n}\n\n.sidebar-toggle-logo {\n  width: 40px;\n  height: 40px;\n}\n\n.main-layout.sidebar-collapsed .sidebar-toggle {\n  position: static;\n  margin: -1em auto 1em;\n  background-color: transparent;\n  padding: 0;\n}\n\n.main-layout.sidebar-collapsed .sidebar-toggle:hover {\n  background-color: transparent;\n}\n\n.app-version {\n  font-size: 0.8em;\n  color: #7f8c8d;\n  text-align: center;\n  margin-top: 0;\n  padding: 0 0.5em;\n}\n\n.main-layout.sidebar-collapsed .app-version {\n  display: none;\n}\n\n.login-btn-sidebar {\n  background-color: var(--primary-color);\n  color: white;\n  border: none;\n  border-radius: 8px;\n  padding: 12px 20px;\n  font-size: 1em;\n  font-weight: 600;\n  cursor: pointer;\n  transition: background-color 0.3s;\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.5em;\n}\n\n.login-btn-sidebar:hover {\n  background-color: #2980b9;\n}\n</style>","<template>\n  <div class=\"home-page\">\n    <div v-if=\"locationPermission === 'prompt'\" class=\"location-prompt-banner\">\n      <div class=\"banner-content\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.86-3.14-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z\"/></svg>\n        <p>Share your location to see posts and restaurants near you!</p>\n      </div>\n      <button @click=\"requestLocationAccess\" class=\"btn-primary\">Share Location</button>\n    </div>\n    <div v-if=\"locationPermission === 'denied'\" class=\"location-prompt-banner warning\">\n      <div class=\"banner-content\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z\"/></svg>\n        <p>Location access is denied. To see local content, please enable location services for this site in your browser settings.</p>\n      </div>\n    </div>\n\n    <div class=\"sort-toggle\" v-if=\"userLocation\">\n      <button @click=\"setSortOrder('time')\" :class=\"{ active: sortOrder === 'time' }\">Most Recent</button>\n      <button @click=\"setSortOrder('distance')\" :class=\"{ active: sortOrder === 'distance' }\">Nearby</button>\n    </div>\n\n    <div class=\"feed\">\n      <div v-if=\"loading\" class=\"loading-indicator\">Loading feed...</div>\n      <div v-else>\n        <div v-if=\"posts.length === 0\" class=\"no-posts-message\">\n          <div v-if=\"user\">\n            <h3>Your Feed is Empty</h3>\n            <p>Follow some users to see their reviews here, or check out the Restaurants page to find new places.</p>\n          </div>\n          <div v-else>\n            <h3>Welcome to PorkHub!</h3>\n            <p>There are no reviews to show right now. Check out the Restaurants page to discover new places!</p>\n          </div>\n        </div>\n        <div v-for=\"post in posts\" :key=\"post.id\" class=\"post-card\">\n          <div class=\"post-header\">\n            <img :src=\"post.userPhoto || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" alt=\"User\" class=\"user-avatar\" referrerpolicy=\"no-referrer\" />\n            <div class=\"post-info\">\n              <div class=\"user-line\">\n                <span class=\"user-name\">{{ post.userName }}</span>\n                <span v-if=\"post.medal\" class=\"medal\">{{ post.medal }}</span>\n              </div>\n              <span class=\"post-date\">{{ post.createdAt.toDate().toLocaleString() }}</span>\n            </div>\n          </div>\n          <div class=\"post-content\">\n            <div class=\"post-title-line\">\n              <div class=\"restaurant-title-group\">\n                <h2 class=\"restaurant-name\">{{ post.restaurantName }}</h2>\n              <button v-if=\"user\" @click=\"toggleBucketList(post)\" class=\"action-btn bucket-list-btn\" :class=\"{ 'in-bucket-list': isInBucketList(post.restaurantId) }\" :title=\"isInBucketList(post.restaurantId) ? 'In Bucket List' : 'Add to Bucket List'\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"20px\" viewBox=\"0 0 24 24\" width=\"20px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M18 7h-2.06c-.33-3.2-2.46-5.8-5.94-5.8S4.39 3.8 4.06 7H2v12h16V7zM6.14 7c.2-1.92 1.6-3.48 3.86-3.8A4.002 4.002 0 0 1 14 7h-2.14c-.2-1.92-1.6-3.48-3.86-3.8zM16 17H4v-8h12v8z\"/></svg>\n              </button>\n              </div>\n              <div v-if=\"post.distance !== null\" class=\"distance\">\n                {{ post.distance.toFixed(1) }} miles away\n              </div>\n            </div>\n            <div v-if=\"post.restaurantCity || post.restaurantState\" class=\"restaurant-location\">\n              {{ post.restaurantCity }}<template v-if=\"post.restaurantCity && post.restaurantState\">, </template>{{ post.restaurantState }}\n            </div>\n            <div class=\"review-body\">\n              <StarRating :rating=\"post.rating\" />\n              <p v-if=\"post.text\" class=\"review-text\">\"{{ post.text }}\"</p>\n              <img v-if=\"post.photoURL\" :src=\"post.photoURL\" alt=\"Review photo\" class=\"review-photo\" loading=\"lazy\" />\n              <div v-if=\"post.tags && post.tags.length > 0\" class=\"tags-container\">\n                <span v-for=\"tag in post.tags\" :key=\"tag\" class=\"tag\">{{ tag }}</span>\n              </div>\n            </div>\n            <div class=\"post-actions\">\n              <button @click=\"toggleLike(post.id)\" class=\"like-btn\" :class=\"{ 'liked': post.isLiked }\" :disabled=\"!user\" :aria-label=\"post.isLiked ? 'Unlike this review' : 'Like this review'\" :aria-pressed=\"post.isLiked\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"20px\" viewBox=\"0 0 24 24\" width=\"20px\" fill=\"currentColor\">\n                  <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n                  <path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\"/>\n                </svg>\n                <span>{{ post.likeCount || 0 }}</span>\n              </button>\n              <button @click=\"shareReview(post.id)\" class=\"share-btn\" title=\"Share this review\" aria-label=\"Share this review\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"20px\" viewBox=\"0 0 24 24\" width=\"20px\" fill=\"currentColor\">\n                  <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n                  <path d=\"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z\"/>\n                </svg>\n                <span>Share</span>\n              </button>\n            </div>\n            <Comments :post-id=\"post.id\"\n                      :user=\"user\"\n                      post-type=\"reviews\"\n                      :post-author-id=\"post.userId\" />\n          </div>\n        </div>\n        <div ref=\"loadMoreTrigger\"></div>\n        <div v-if=\"loadingMore\" class=\"loading-indicator\">Loading more...</div>\n      </div>\n    </div>\n\n    <!-- Gamification Features Section -->\n    <div v-if=\"user\" class=\"gamification-features\">\n      <div class=\"features-container\">\n        <!-- Trending Restaurants -->\n        <div class=\"feature-column\">\n          <TrendingRestaurants @restaurant-selected=\"handleRestaurantSelected\" />\n        </div>\n\n        <!-- Activity Feed -->\n        <div class=\"feature-column\">\n          <ActivityFeed :user=\"user\" :following=\"userFollowing\" @restaurant-selected=\"handleRestaurantSelected\" />\n        </div>\n\n        <!-- Follow Recommendations -->\n        <div class=\"feature-column\">\n          <FollowRecommendations :user=\"user\" :following=\"userFollowing\" @follow-user=\"handleFollowUser\" />\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted, onUnmounted, watch, computed } from 'vue';\nimport { db } from '../firebase';\nimport { collection, query, where, getDocs, onSnapshot, orderBy, limit, addDoc, deleteDoc, serverTimestamp, doc, getDoc } from 'firebase/firestore';\nimport Comments from './Comments.vue';\nimport StarRating from './StarRating.vue';\nimport ActivityFeed from './ActivityFeed.vue';\nimport TrendingRestaurants from './TrendingRestaurants.vue';\nimport FollowRecommendations from './FollowRecommendations.vue';\nimport { getDistance } from '../utils/geolocation.js';\nimport { showToast } from '../utils/toast.js';\n\nexport default {\n  name: 'Home',\n  components: {\n    StarRating,\n    Comments,\n    ActivityFeed,\n    TrendingRestaurants,\n    FollowRecommendations\n  },\n  props: {\n    user: {\n      type: Object,\n      default: null\n    }\n  },\n  setup(props) {\n    const posts = ref([]);\n    const loading = ref(true);\n    const userLocation = ref(null);\n    const locationPermission = ref(''); // 'prompt', 'granted', 'denied'\n    const loadMoreTrigger = ref(null);\n    const loadingMore = ref(false);\n    const allPosts = new Map();\n    const fullSortedPosts = ref([]);\n    const pageSize = 10;\n    let observer = null;\n    const unsubscribes = [];\n    const bucketList = ref(new Set());\n    const leaderboardRanks = ref(new Map());\n    const restaurantsMap = ref(new Map());\n    const sortOrder = ref('time'); // 'time' or 'distance'\n    const userFollowing = ref([]); // For gamification features\n    let isSettingUpListeners = false; // Guard to prevent concurrent setup\n\n    const processAndSetPosts = () => {\n      // Always re-calculate medals before sorting and displaying\n      allPosts.forEach(post => {\n        const rank = leaderboardRanks.value.get(post.userId);\n        post.medal = getMedal(rank);\n      });\n\n      const sortedPosts = Array.from(allPosts.values()).sort((a, b) => {\n          if (sortOrder.value === 'distance' && userLocation.value) {\n            const distanceA = a.distance ?? Infinity;\n            const distanceB = b.distance ?? Infinity;\n\n            if (distanceA !== distanceB) {\n              return distanceA - distanceB;\n            }\n            // If distances are equal (e.g. same restaurant), sub-sort by time\n            const timeA = a.lastActivityAt || a.createdAt;\n            const timeB = b.lastActivityAt || b.createdAt;\n            return timeB.seconds - timeA.seconds;\n          }\n\n          // Default sort by time\n          const timeA = a.lastActivityAt || a.createdAt;\n          const timeB = b.lastActivityAt || b.createdAt;\n          return timeB.seconds - timeA.seconds;\n      });\n      fullSortedPosts.value = sortedPosts;\n      // Update the displayed posts, preserving the current scroll length\n      posts.value = fullSortedPosts.value.slice(0, posts.value.length || pageSize);\n    };\n\n    onUnmounted(() => {\n      unsubscribes.forEach(unsub => unsub());\n      if (observer) {\n        observer.disconnect();\n      }\n    });\n\n    onMounted(() => {\n      observer = new IntersectionObserver((entries) => {\n        if (entries[0].isIntersecting) {\n          loadMorePosts();\n        }\n      });\n      checkLocationPermission(); // Now called once on mount.\n      loadUserFollowing(); // Load user's following list for gamification\n    });\n\n    watch(userLocation, (newLocation) => {\n      if (newLocation && allPosts.size > 0) {\n        // Location has been granted/updated after posts were already loaded.\n        // We need to update distances on existing posts.\n        allPosts.forEach(post => {\n          const restaurant = restaurantsMap.value.get(post.restaurantId);\n          if (restaurant?.location) {\n            post.distance = getDistance(newLocation.lat, newLocation.lng, restaurant.location.lat, restaurant.location.lng);\n          } else {\n            post.distance = null;\n          }\n        });\n        processAndSetPosts(); // Re-sort and update the view\n      }\n    });\n\n    watch(() => props.user, (newUser, oldUser) => {\n      // Re-fetch the feed if the user logs in or out.\n      // The check ensures this doesn't run unnecessarily on initial load\n      // if the user was already logged in.\n      if (newUser?.uid !== oldUser?.uid && !isSettingUpListeners) {\n        setupFeedListeners();\n      }\n    });\n\n    watch(loadMoreTrigger, (newValue, oldValue) => {\n      if (oldValue) observer.unobserve(oldValue);\n      if (newValue) observer.observe(newValue);\n    });\n\n    const setupFeedListeners = async () => {\n      // Prevent concurrent calls\n      if (isSettingUpListeners) {\n        return;\n      }\n      \n      isSettingUpListeners = true;\n      loading.value = true;\n      \n      try {\n        // Clear existing listeners and posts\n        // Unsubscribe from all existing listeners first\n        unsubscribes.forEach(unsub => {\n          try {\n            unsub();\n          } catch (err) {\n            console.warn('Error unsubscribing listener:', err);\n          }\n        });\n        unsubscribes.length = 0;\n        allPosts.clear();\n        \n        // Give Firestore a moment to clean up before setting up new listeners\n        await new Promise(resolve => setTimeout(resolve, 100));\n\n        const currentUser = props.user;\n        if (!currentUser) {\n          bucketList.value.clear();\n        } else {\n          const bucketListQuery = query(collection(db, 'bucketListItems'), where('userId', '==', currentUser.uid));\n          const unsubBucketList = onSnapshot(\n            bucketListQuery, \n            (snapshot) => {\n              const newBucketList = new Set();\n              snapshot.forEach(doc => newBucketList.add(doc.data().restaurantId));\n              bucketList.value = newBucketList;\n            },\n            (error) => {\n              console.error('Error in bucket list listener:', error);\n            }\n          );\n          unsubscribes.push(unsubBucketList);\n        }\n\n        // Fetch initial data including the leaderboard to avoid race conditions\n        const followsPromise = currentUser ? getDocs(query(collection(db, 'follows'), where('followerId', '==', currentUser.uid))) : Promise.resolve({ docs: [] });\n        const [followsSnap, restaurantsSnap, usersSnap, leaderboardSnap] = await Promise.all([\n          followsPromise,\n          getDocs(collection(db, 'restaurants')),\n          getDocs(collection(db, 'users')),\n          getDocs(query(collection(db, 'users'), orderBy('reviewCount', 'desc'), limit(30)))\n        ]);\n\n        // Filter out users with 0 or undefined reviewCount, then sort and assign ranks\n        const usersWithReviews = leaderboardSnap.docs\n          .map(doc => ({ id: doc.id, ...doc.data() }))\n          .filter(user => {\n            const count = Number(user.reviewCount) || 0;\n            return count > 0;\n          })\n          .sort((a, b) => {\n            const countA = Number(a.reviewCount) || 0;\n            const countB = Number(b.reviewCount) || 0;\n            return countB - countA;\n          })\n          .slice(0, 10); // Take only top 10\n        \n        const initialRanks = new Map();\n        usersWithReviews.forEach((user, index) => {\n          initialRanks.set(user.id, index);\n        });\n        leaderboardRanks.value = initialRanks;\n\n        restaurantsMap.value.clear();\n        restaurantsSnap.forEach(doc => {\n          restaurantsMap.value.set(doc.id, doc.data());\n        });\n        \n        const usersMap = new Map();\n        usersSnap.forEach(doc => {\n          usersMap.set(doc.id, doc.data());\n        });\n\n        const leaderboardQuery = query(collection(db, 'users'), orderBy('reviewCount', 'desc'), limit(30));\n        const unsubLeaderboard = onSnapshot(\n          leaderboardQuery, \n          (leaderboardSnap) => {\n            // Filter out users with 0 or undefined reviewCount, then sort and assign ranks\n            const usersWithReviews = leaderboardSnap.docs\n              .map(doc => ({ id: doc.id, ...doc.data() }))\n              .filter(user => {\n                const count = Number(user.reviewCount) || 0;\n                return count > 0;\n              })\n              .sort((a, b) => {\n                const countA = Number(a.reviewCount) || 0;\n                const countB = Number(b.reviewCount) || 0;\n                return countB - countA;\n              })\n              .slice(0, 10); // Take only top 10\n            \n            const newRanks = new Map();\n            usersWithReviews.forEach((user, index) => {\n              newRanks.set(user.id, index);\n            });\n            leaderboardRanks.value = newRanks;\n            processAndSetPosts();\n          },\n          (error) => {\n            console.error('Error in leaderboard listener:', error);\n          }\n        );\n        unsubscribes.push(unsubLeaderboard);\n\n        const processSnapshot = (snapshot) => {\n          snapshot.docChanges().forEach(change => {\n            if (change.type === 'removed') {\n              allPosts.delete(change.doc.id);\n            } else {\n              const docData = change.doc.data();\n              const restaurant = restaurantsMap.value.get(docData.restaurantId);\n              const user = usersMap.get(docData.userId);\n              const rank = leaderboardRanks.value.get(docData.userId); // Now guaranteed to have initial ranks\n              const post = {\n                ...docData,\n                id: change.doc.id,\n                restaurantName: restaurant?.name || 'Unknown Restaurant',\n                restaurantCity: restaurant?.city,\n                restaurantState: restaurant?.state,\n                location: restaurant?.location || null,\n                distance: userLocation.value && restaurant?.location ? getDistance(userLocation.value.lat, userLocation.value.lng, restaurant.location.lat, restaurant.location.lng) : null,\n                userName: user?.displayName || 'Unknown User',\n                userPhoto: user?.photoURL || null,\n                medal: getMedal(rank),\n                likeCount: 0,\n                isLiked: false\n              };\n              allPosts.set(post.id, post);\n              \n              // Set up like listener for this post\n              setupLikeListener(post.id);\n            }\n          });\n          processAndSetPosts();\n          loading.value = false;\n        };\n\n        if (currentUser) {\n          // --- LOGGED-IN USER LOGIC ---\n          const followingIds = followsSnap.docs.map(doc => doc.data().followingId);\n          // Add current user's ID to see their own posts\n          if (!followingIds.includes(currentUser.uid)) {\n            followingIds.push(currentUser.uid);\n          }\n          if (followingIds.length > 0) {\n            // Firestore 'in' query is limited to 30 elements, so we batch\n            for (let i = 0; i < followingIds.length; i += 30) {\n                const batchIds = followingIds.slice(i, i + 30);\n                const q = query(collection(db, 'reviews'), where('userId', 'in', batchIds), orderBy('lastActivityAt', 'desc'));\n                const unsub = onSnapshot(q, processSnapshot, (error) => console.error(\"Feed error (followed):\", error));\n                unsubscribes.push(unsub);\n            }\n          }\n\n          if (userLocation.value) {\n            const nearbyRestaurantIds = [];\n            restaurantsSnap.forEach(doc => {\n              const restaurant = doc.data();\n              if (restaurant.location) {\n                const distance = getDistance(userLocation.value.lat, userLocation.value.lng, restaurant.location.lat, restaurant.location.lng);\n                if (distance !== null && distance <= 100) {\n                  nearbyRestaurantIds.push(doc.id);\n                }\n              }\n            });\n            if (nearbyRestaurantIds.length > 0) {\n                for (let i = 0; i < nearbyRestaurantIds.length; i += 30) {\n                    const batchIds = nearbyRestaurantIds.slice(i, i + 30);\n                    const q = query(collection(db, 'reviews'), where('restaurantId', 'in', batchIds), orderBy('lastActivityAt', 'desc'));\n                    const unsub = onSnapshot(q, processSnapshot, (error) => console.error(\"Feed error (nearby):\", error));\n                    unsubscribes.push(unsub);\n                }\n            }\n          }\n        } else {\n          // --- GUEST USER LOGIC ---\n          // Fetch a pool of the 50 most recent reviews globally.\n          // The sorting function will then correctly order them by distance if location is available,\n          // or by time if not.\n          const recentReviewsQuery = query(collection(db, 'reviews'), orderBy('lastActivityAt', 'desc'), limit(50));\n          const unsub = onSnapshot(recentReviewsQuery, processSnapshot, (error) => console.error(\"Feed error (recent for guests):\", error));\n          unsubscribes.push(unsub);\n        }\n\n        if (unsubscribes.length === 0) {\n          loading.value = false;\n        }\n      } catch (error) {\n        console.error('Error setting up feed listeners:', error);\n        loading.value = false;\n        // Make sure to clean up any listeners that might have been set up\n        unsubscribes.forEach(unsub => {\n          try {\n            unsub();\n          } catch (err) {\n            // Ignore cleanup errors\n          }\n        });\n        unsubscribes.length = 0;\n      } finally {\n        isSettingUpListeners = false;\n      }\n    };\n\n    const loadMorePosts = () => {\n      if (loadingMore.value || posts.value.length >= fullSortedPosts.value.length) {\n        return;\n      }\n      loadingMore.value = true;\n\n      setTimeout(() => {\n        const currentLength = posts.value.length;\n        const nextPosts = fullSortedPosts.value.slice(currentLength, currentLength + pageSize);\n        posts.value.push(...nextPosts);\n        loadingMore.value = false;\n      }, 300);\n    };\n\n    const requestLocationAccess = () => {\n      navigator.geolocation.getCurrentPosition(\n        position => {\n          locationPermission.value = 'granted';\n          userLocation.value = {\n            lat: position.coords.latitude,\n            lng: position.coords.longitude\n          };\n        },\n        () => {\n          locationPermission.value = 'denied';\n        },\n        { timeout: 10000 }\n      );\n    };\n\n    const checkLocationPermission = async () => {\n      if (!navigator.permissions) {\n        requestLocationAccess(); // Fallback for older browsers\n        return;\n      }\n\n      try {\n        const permissionStatus = await navigator.permissions.query({ name: 'geolocation' });\n        locationPermission.value = permissionStatus.state;\n\n        permissionStatus.onchange = () => {\n          locationPermission.value = permissionStatus.state;\n          if (permissionStatus.state === 'granted') {\n            requestLocationAccess();\n          }\n        };\n\n        if (permissionStatus.state === 'granted') {\n          // Asynchronously request location. Don't wait for it.\n          requestLocationAccess();\n        }\n      } catch (error) {\n        console.error(\"Error checking location permission:\", error);\n        // If permission query fails (e.g. in Firefox private mode), fallback to just asking.\n        requestLocationAccess();\n      } finally {\n        // ALWAYS set up the feed listeners after checking permission.\n        setupFeedListeners();\n      }\n    };\n\n    const setSortOrder = (order) => {\n      if (sortOrder.value === order) return;\n      sortOrder.value = order;\n      processAndSetPosts();\n    };\n\n    const getMedal = (index) => {\n      // Medals are assigned based on position (0-indexed)\n      // Position 1 (index 0): Gold medal \n      // Position 2 (index 1): Silver medal \n      // Position 3 (index 2): Bronze medal \n      // Positions 4-10 (index 3-9): Participation medal \n      if (typeof index !== 'number') return null;\n      if (index === 0) return '';\n      if (index === 1) return '';\n      if (index === 2) return '';\n      if (index >= 3 && index < 10) return '';\n      return null;\n    };\n\n    const isInBucketList = (restaurantId) => {\n      return bucketList.value.has(restaurantId);\n    };\n\n    const toggleBucketList = async (post) => {\n      const currentUser = props.user;\n      if (!currentUser) return;\n\n      if (isInBucketList(post.restaurantId)) {\n        const q = query(collection(db, 'bucketListItems'), where('userId', '==', currentUser.uid), where('restaurantId', '==', post.restaurantId));\n        const snapshot = await getDocs(q);\n        snapshot.forEach(doc => deleteDoc(doc.ref));\n      } else {\n        await addDoc(collection(db, 'bucketListItems'), {\n          userId: currentUser.uid,\n          restaurantId: post.restaurantId,\n          createdAt: serverTimestamp()\n        });\n      }\n    };\n\n    const setupLikeListener = (reviewId) => {\n      const currentUser = props.user;\n      const reviewRef = doc(db, 'reviews', reviewId);\n      const likesCollection = collection(reviewRef, 'likes');\n      const likesQuery = query(likesCollection);\n      \n      const unsub = onSnapshot(likesQuery, (snapshot) => {\n        const post = allPosts.get(reviewId);\n        if (post) {\n          post.likeCount = snapshot.size;\n          post.isLiked = currentUser ? snapshot.docs.some(doc => doc.data().userId === currentUser.uid) : false;\n          // Update the post in the map\n          allPosts.set(reviewId, post);\n          // Trigger re-render by updating posts\n          processAndSetPosts();\n        }\n      }, (error) => {\n        console.error('Error fetching likes:', error);\n      });\n      \n      unsubscribes.push(unsub);\n    };\n\n    const toggleLike = async (reviewId) => {\n      const currentUser = props.user;\n      if (!currentUser) return;\n      \n      const reviewRef = doc(db, 'reviews', reviewId);\n      const likesCollection = collection(reviewRef, 'likes');\n      const likeQuery = query(likesCollection, where('userId', '==', currentUser.uid));\n      const likeSnap = await getDocs(likeQuery);\n      \n      if (!likeSnap.empty) {\n        // Unlike - delete the like document\n        await deleteDoc(likeSnap.docs[0].ref);\n      } else {\n        // Like - create a like document\n        await addDoc(likesCollection, {\n          userId: currentUser.uid,\n          createdAt: serverTimestamp()\n        });\n      }\n    };\n\n    const shareReview = async (reviewId) => {\n      const baseUrl = window.location.origin;\n      // Use clean URL format for better social media previews\n      // The Cloud Function will handle /review/{reviewId} format\n      const shareableLink = `${baseUrl}/review/${reviewId}`;\n      \n      // Try Web Share API first (mobile-friendly)\n      if (navigator.share) {\n        try {\n          await navigator.share({\n            title: 'Check out this review on PorkHub',\n            text: 'Check out this review on PorkHub',\n            url: shareableLink\n          });\n          return;\n        } catch (err) {\n          // User cancelled or error - fall through to copy\n          if (err.name !== 'AbortError') {\n            console.error('Error sharing:', err);\n          }\n        }\n      }\n      \n      // Fallback: Copy to clipboard\n      try {\n        await navigator.clipboard.writeText(shareableLink);\n        showToast('Link copied to clipboard!', 'success');\n      } catch (err) {\n        console.error('Failed to copy link:', err);\n        // Fallback: Show link in prompt\n        const copied = prompt('Copy this link:', shareableLink);\n        if (copied) {\n          showToast('Link copied!', 'success');\n        }\n      }\n    };\n\n    // Gamification event handlers\n    const handleRestaurantSelected = (restaurantId) => {\n      // Could navigate to restaurant details or emit event\n      console.log('Selected restaurant:', restaurantId);\n    };\n\n    const handleFollowUser = ({ userId, isFollowing: nowFollowing }) => {\n      // Update userFollowing list\n      if (nowFollowing) {\n        if (!userFollowing.value.includes(userId)) {\n          userFollowing.value.push(userId);\n        }\n      } else {\n        const index = userFollowing.value.indexOf(userId);\n        if (index > -1) {\n          userFollowing.value.splice(index, 1);\n        }\n      }\n    };\n\n    // Load user's following list on mount\n    const loadUserFollowing = async () => {\n      if (!props.user) return;\n      \n      try {\n        const followsSnap = await getDocs(\n          query(collection(db, 'follows'), where('followerId', '==', props.user.uid))\n        );\n        userFollowing.value = followsSnap.docs.map(doc => doc.data().followingId);\n      } catch (error) {\n        console.error('Error loading following list:', error);\n      }\n    };\n\n    return {\n      posts,\n      loading,\n      locationPermission,\n      requestLocationAccess,\n      loadMoreTrigger,\n      loadingMore,\n      isInBucketList,\n      toggleBucketList,\n      userLocation,\n      sortOrder,\n      setSortOrder,\n      toggleLike,\n      shareReview,\n      userFollowing,\n      handleRestaurantSelected,\n      handleFollowUser,\n      loadUserFollowing\n    };\n  }\n};\n</script>\n\n<style scoped>\n.home-page {\n  max-width: 800px;\n  margin: 0 auto;\n}\n\n.location-prompt-banner {\n  background-color: #eaf5ff;\n  border: 1px solid var(--primary-color);\n  border-radius: 8px;\n  padding: 1em 1.5em;\n  margin-bottom: 2em;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 1em;\n}\n\n.location-prompt-banner.warning {\n  background-color: #fff4e5;\n  border-color: #ff9800;\n}\n\n.banner-content {\n  display: flex;\n  align-items: center;\n  gap: 1em;\n}\n\n.banner-content p {\n  margin: 0;\n  color: var(--secondary-color);\n}\n\n.location-prompt-banner .btn-primary {\n  background-color: var(--primary-color);\n  color: white;\n  border: none;\n  padding: 0.6em 1.2em;\n  border-radius: 8px;\n  cursor: pointer;\n  font-weight: 600;\n  white-space: nowrap;\n}\n\n.sort-toggle {\n  display: flex;\n  justify-content: center;\n  margin-bottom: 1.5em;\n  background-color: #e9ecef;\n  border-radius: 8px;\n  padding: 4px;\n  width: fit-content;\n  margin-left: auto;\n  margin-right: auto;\n}\n\n.sort-toggle button {\n  background: none;\n  border: none;\n  padding: 8px 16px;\n  cursor: pointer;\n  border-radius: 6px;\n  font-weight: 500;\n  color: var(--secondary-color);\n  transition: background-color 0.2s, color 0.2s;\n}\n\n.sort-toggle button.active {\n  background-color: white;\n  color: var(--primary-color);\n  box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n}\n\n.loading-indicator, .no-posts-message {\n  text-align: center;\n  color: #777;\n  padding: 3em;\n}\n\n.no-posts-message h3 {\n  margin-bottom: 0.5em;\n}\n\n.post-card {\n  background: var(--card-background);\n  border-radius: 12px;\n  box-shadow: 0 4px 15px var(--shadow-color);\n  margin-bottom: 2em;\n  overflow: hidden;\n}\n\n.post-header {\n  display: flex;\n  align-items: center;\n  gap: 1em;\n  padding: 1em 1.5em;\n  border-bottom: 1px solid #eee;\n}\n\n.user-avatar {\n  width: 45px;\n  height: 45px;\n  border-radius: 50%;\n}\n\n.post-info {\n  display: flex;\n  flex-direction: column;\n}\n\n.user-line {\n  display: flex;\n  align-items: center;\n  gap: 0.5em;\n}\n\n.action-btn {\n    background: none;\n    border: none;\n    cursor: pointer;\n    padding: 0;\n    display: flex;\n    align-items: center;\n}\n\n.bucket-list-btn {\n  color: #ccc;\n}\n.bucket-list-btn.in-bucket-list, .bucket-list-btn:hover {\n  color: var(--primary-color);\n}\n\n.post-actions {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-top: 0.5em;\n  padding-top: 0.5em;\n  margin-bottom: 0;\n  padding-bottom: 0;\n  border-top: 1px solid #eee;\n}\n\n.share-btn {\n  display: flex;\n  align-items: center;\n  gap: 0.5em;\n  background: none;\n  border: none;\n  cursor: pointer;\n  padding: 0.5em 0.75em;\n  border-radius: 8px;\n  color: #555;\n  transition: all 0.2s;\n}\n\n.share-btn:hover {\n  background-color: #f0f0f0;\n}\n\n.share-btn svg {\n  width: 20px;\n  height: 20px;\n  fill: currentColor;\n}\n\n.like-btn {\n  display: flex;\n  align-items: center;\n  gap: 0.5em;\n  background: none;\n  border: none;\n  cursor: pointer;\n  padding: 0.5em 0.75em;\n  border-radius: 8px;\n  color: #555;\n  transition: all 0.2s;\n}\n\n.like-btn:hover:not(:disabled) {\n  background-color: #f0f0f0;\n}\n\n.like-btn:disabled {\n  cursor: not-allowed;\n  opacity: 0.6;\n}\n\n.like-btn.liked {\n  color: #e74c3c;\n}\n\n.like-btn svg {\n  width: 20px;\n  height: 20px;\n  fill: currentColor;\n}\n\n.medal {\n  font-size: 1.1em;\n}\n\n.user-name {\n  font-weight: 600;\n}\n\n.post-date {\n  color: #7f8c8d;\n  font-size: 0.85em;\n}\n\n.post-content {\n  padding: 0.5em 1.5em 1.5em;\n}\n\n.post-title-line {\n  display: flex;\n  justify-content: space-between;\n  align-items: baseline;\n  margin-bottom: 0.25em;\n}\n\n.restaurant-name {\n  font-size: 1.1em;\n  font-weight: 600;\n  margin: 0;\n}\n\n.restaurant-location {\n  font-size: 0.9em;\n  color: #777;\n  margin-bottom: 0.75em;\n}\n\n.restaurant-title-group {\n  display: flex;\n  align-items: center;\n  gap: 0.5em;\n}\n\n.review-photo {\n  max-width: 100%;\n  border-radius: 8px;\n  margin-top: 1em;\n}\n\n.review-text {\n  font-style: italic;\n  color: #333;\n  margin: 0.5em 0;\n}\n\n.tags-container {\n  margin-top: 1em;\n}\n\n.tag {\n  background-color: var(--primary-color);\n  color: white;\n  padding: 0.3em 0.8em;\n  border-radius: 15px;\n  font-size: 0.8em;\n  margin-right: 0.5em;\n  display: inline-block;\n}\n\n.distance {\n  font-size: 0.9em;\n  color: #777;\n  flex-shrink: 0;\n  padding-left: 1em;\n}\n\n/* Gamification Section Styles */\n.gamification-section {\n  margin-bottom: 2rem;\n}\n\n.gamification-features {\n  margin-top: 2rem;\n  padding-top: 2rem;\n  border-top: 2px solid var(--background-color);\n}\n\n.features-container {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));\n  gap: 2rem;\n}\n\n.feature-column {\n  background: var(--card-background);\n  border-radius: 8px;\n  padding: 1.5rem;\n  box-shadow: 0 2px 8px var(--shadow-color);\n}\n\n@media (max-width: 768px) {\n  .features-container {\n    grid-template-columns: 1fr;\n    gap: 1.5rem;\n  }\n\n  .feature-column {\n    padding: 1rem;\n  }\n}\n\n</style>","// Firebase configuration and initialization\nimport { initializeApp } from \"firebase/app\";\nimport { getAuth, GoogleAuthProvider, signInWithPopup, signOut, OAuthProvider } from \"firebase/auth\";\nimport { getFirestore } from \"firebase/firestore\";\nimport { getStorage } from \"firebase/storage\";\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyDxzi70xuS1KxemDBF1logZ6zyHxINFfp4\",\n  authDomain: \"porko-c0f87.firebaseapp.com\",\n  projectId: \"porko-c0f87\",\n  storageBucket: \"porko-c0f87.firebasestorage.app\",\n  messagingSenderId: \"1050714930836\",\n  appId: \"1:1050714930836:web:5b4c9bdf93e95748a23e81\",\n  measurementId: \"G-3LCKP815FM\"\n};\n\nconst app = initializeApp(firebaseConfig);\nconst auth = getAuth(app);\nconst provider = new GoogleAuthProvider();\nconst db = getFirestore(app);\nconst storage = getStorage(app);\n\n// Example Firestore data models\n// users: { uid, displayName, photoURL, bio }\n// restaurants: { id, name, address, location: { lat, lng }, description }\n// reviews: { id, restaurantId, userId, rating, text, photoURL, createdAt }\n// checkins: { id, restaurantId, userId, comment, photoURL, createdAt }\n// follows: { followerId, followingId }\n\nexport { auth, provider, signInWithPopup, signOut, db, storage };\n","<template>\n  <div class=\"comments-section\">\n    <div class=\"comment-list\">\n      <div v-for=\"comment in comments\" :key=\"comment.id\" class=\"comment\">\n        <img :src=\"comment.userPhoto || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" :alt=\"comment.userName\" class=\"comment-user-photo\" referrerpolicy=\"no-referrer\" />\n        <div class=\"comment-content\">\n          <div class=\"comment-header\">\n            <span class=\"comment-user-name\">{{ comment.userName }}</span>\n            <span class=\"comment-date\">{{ formatDate(comment.createdAt) }}</span>\n          </div>\n          <div v-if=\"editingCommentId !== comment.id\">\n            <p class=\"comment-text\">{{ comment.text }}</p>\n            <div class=\"comment-actions\">\n              <button v-if=\"canEdit(comment)\" @click=\"startEditing(comment)\" class=\"action-btn\">Edit</button>\n              <button v-if=\"canDelete(comment)\" @click=\"deleteComment(comment.id)\" class=\"action-btn delete\">Delete</button>\n            </div>\n          </div>\n          <div v-else class=\"edit-comment\">\n            <input v-model=\"editingText\" @keyup.enter=\"saveEdit\" class=\"edit-input\" />\n            <div class=\"edit-actions\">\n              <button @click=\"saveEdit\" class=\"btn-primary\">Save</button>\n              <button @click=\"cancelEdit\" class=\"btn-secondary\">Cancel</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div v-if=\"user\" class=\"add-comment\">\n      <input v-model=\"newComment\" placeholder=\"Add a comment...\" @keyup.enter=\"addComment\" />\n      <button @click=\"addComment\" :disabled=\"!newComment.trim()\">Post</button>\n    </div>\n    <div v-else class=\"add-comment-login-prompt\">\n      <p>Please log in to comment.</p>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted, onUnmounted } from 'vue';\nimport { db } from '../firebase';\nimport { collection, query, where, getDocs, orderBy, onSnapshot, addDoc, serverTimestamp, doc, updateDoc, deleteDoc, documentId } from 'firebase/firestore';\nimport { showToast } from '../utils/toast.js';\n\nexport default {\n  name: 'Comments',\n  props: {\n    postId: { type: String, required: true },\n    postType: { type: String, required: true },\n    postAuthorId: { type: String, required: true },\n    user: {\n      type: Object,\n      default: null\n    }\n  },\n  setup(props) {\n    const comments = ref([]);\n    const newComment = ref('');\n    const editingCommentId = ref(null);\n    const editingText = ref('');\n    let unsubscribe = () => {};\n\n    onMounted(() => {\n      // Use a DocumentReference for the parent, then get the subcollection correctly.\n      const parentDocRef = doc(db, props.postType, props.postId);\n      const commentsCollection = collection(parentDocRef, 'comments');\n      const commentsQuery = query(commentsCollection, orderBy('createdAt', 'asc'));\n      unsubscribe = onSnapshot(commentsQuery, async (snapshot) => {\n        const commentData = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n        \n        const userIds = [...new Set(commentData.map(c => c.userId))];\n        \n        if (userIds.length > 0) {\n          const usersMap = new Map();\n          // Firestore 'in' query is limited to 30 elements\n          for (let i = 0; i < userIds.length; i += 30) {\n            const batchIds = userIds.slice(i, i + 30);\n            const usersQuery = query(collection(db, 'users'), where(documentId(), 'in', batchIds));\n            const usersSnapshot = await getDocs(usersQuery);\n            usersSnapshot.forEach(doc => usersMap.set(doc.id, doc.data()));\n          }\n          \n          comments.value = commentData.map(comment => {\n            const user = usersMap.get(comment.userId);\n            return {\n              ...comment,\n              userName: user?.displayName || comment.userName || 'Unknown User',\n              userPhoto: user?.photoURL || comment.userPhoto || null\n            };\n          });\n        } else {\n          comments.value = [];\n        }\n      });\n    });\n\n    onUnmounted(() => {\n      unsubscribe();\n    });\n\n    const addComment = async () => {\n      if (newComment.value.trim() === '') return;\n      const currentUser = props.user;\n      if (!currentUser) return;\n\n      const now = serverTimestamp();\n      const parentDocRef = doc(db, props.postType, props.postId);\n      const commentsCollection = collection(parentDocRef, 'comments');\n      const reviewDocRef = doc(db, 'reviews', props.postId);\n\n      await Promise.all([\n        addDoc(commentsCollection, {\n          userId: currentUser.uid,\n          text: newComment.value,\n          createdAt: now,\n        }),\n        updateDoc(reviewDocRef, { lastActivityAt: now })\n      ]);\n      newComment.value = '';\n    };\n\n    const canEdit = (comment) => {\n      const currentUser = props.user;\n      return currentUser && currentUser.uid === comment.userId;\n    };\n\n    const canDelete = (comment) => {\n      const currentUser = props.user;\n      return currentUser && (currentUser.uid === comment.userId || currentUser.uid === props.postAuthorId);\n    };\n\n    const startEditing = (comment) => {\n      editingCommentId.value = comment.id;\n      editingText.value = comment.text;\n    };\n\n    const cancelEdit = () => {\n      editingCommentId.value = null;\n      editingText.value = '';\n    };\n\n    const saveEdit = async () => {\n      if (editingText.value.trim() === '' || !editingCommentId.value) return;\n      const parentDocRef = doc(db, props.postType, props.postId);\n      const commentsCollection = collection(parentDocRef, 'comments');\n      const commentDoc = doc(commentsCollection, editingCommentId.value);\n      const reviewDocRef = doc(db, 'reviews', props.postId);\n      await Promise.all([\n        updateDoc(commentDoc, { text: editingText.value }),\n        updateDoc(reviewDocRef, { lastActivityAt: serverTimestamp() })\n      ]);\n      cancelEdit();\n    };\n\n    const deleteComment = async (commentId) => {\n      if (confirm('Are you sure you want to delete this comment?')) {\n        try {\n          const parentDocRef = doc(db, props.postType, props.postId);\n          const commentsCollection = collection(parentDocRef, 'comments');\n          const commentDoc = doc(commentsCollection, commentId);\n          const reviewDocRef = doc(db, 'reviews', props.postId);\n          await Promise.all([\n            deleteDoc(commentDoc),\n            updateDoc(reviewDocRef, { lastActivityAt: serverTimestamp() })\n          ]);\n          showToast('Comment deleted successfully', 'success');\n        } catch (error) {\n          console.error('Error deleting comment:', error);\n          showToast('Failed to delete comment. Please try again.', 'error');\n        }\n      }\n    };\n\n    const formatDate = (timestamp) => {\n      if (!timestamp || !timestamp.toDate) return '';\n      return timestamp.toDate().toLocaleString();\n    };\n\n    return {\n      comments, newComment, addComment, canEdit, canDelete, startEditing,\n      cancelEdit, saveEdit, deleteComment, editingCommentId, editingText, formatDate\n    };\n  },\n};\n</script>\n\n<style scoped>\n.comments-section {\n  margin-top: 0.5em;\n  padding-top: 0.75em;\n  border-top: 1px solid #eee;\n}\n.comment-list { margin-bottom: 1em; }\n.comment { display: flex; gap: 0.75em; margin-bottom: 1em; }\n.comment-user-photo { width: 32px; height: 32px; border-radius: 50%; }\n.comment-content { flex-grow: 1; }\n.comment-header { display: flex; align-items: center; gap: 0.5em; margin-bottom: 0.25em; }\n.comment-info { display: flex; align-items: baseline; gap: 0.5em; }\n.comment-user-name { font-weight: 600; font-size: 0.9em; }\n.comment-date { font-size: 0.75em; color: #777; }\n.comment-text { margin: 0 0 0.5em; font-size: 0.95em; line-height: 1.4; }\n.comment-actions { font-size: 0.8em; }\n.action-btn { background: none; border: none; color: #777; cursor: pointer; padding: 0 5px 0 0; }\n.action-btn.delete { color: #e74c3c; }\n.edit-comment { display: flex; flex-direction: column; gap: 0.5em; }\n.edit-input { width: 100%; padding: 0.5em; border-radius: 4px; border: 1px solid #ccc; }\n.edit-actions { display: flex; gap: 0.5em; justify-content: flex-end; }\n.add-comment { display: flex; gap: 0.5em; margin-top: 1em; }\n.add-comment input { flex-grow: 1; border: 1px solid #ddd; border-radius: 15px; padding: 0.5em 1em; }\n.add-comment button { background-color: var(--primary-color); color: white; border: none; border-radius: 15px; padding: 0.5em 1em; cursor: pointer; }\n.add-comment button:disabled { background-color: #bdc3c7; cursor: not-allowed; }\n.btn-primary { background-color: var(--primary-color); color: white; border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer; }\n.btn-secondary { background-color: #ecf0f1; color: var(--secondary-color); border: 1px solid #bdc3c7; padding: 4px 8px; border-radius: 4px; cursor: pointer; }\n.add-comment-login-prompt {\n  text-align: center;\n  color: #777;\n  font-size: 0.9em;\n}\n</style>","// Toast notification utility\r\nconst toastListeners = [];\r\nlet toastId = 0;\r\n\r\nexport const showToast = (message, type = 'info', duration = 3000) => {\r\n  const id = toastId++;\r\n  const toast = { id, message, type, duration };\r\n  \r\n  // Notify all listeners\r\n  toastListeners.forEach(listener => listener(toast));\r\n  \r\n  return id;\r\n};\r\n\r\nexport const subscribeToToasts = (callback) => {\r\n  toastListeners.push(callback);\r\n  // Return unsubscribe function\r\n  return () => {\r\n    const index = toastListeners.indexOf(callback);\r\n    if (index > -1) {\r\n      toastListeners.splice(index, 1);\r\n    }\r\n  };\r\n};\r\n","import { render } from \"./Comments.vue?vue&type=template&id=ba2e816a&scoped=true\"\nimport script from \"./Comments.vue?vue&type=script&lang=js\"\nexport * from \"./Comments.vue?vue&type=script&lang=js\"\n\nimport \"./Comments.vue?vue&type=style&index=0&id=ba2e816a&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-ba2e816a\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"star-rating\" :class=\"{ 'is-editable': editable }\">\r\n    <span\r\n      v-for=\"n in 5\"\r\n      :key=\"n\"\r\n      @click=\"setRating(n)\"\r\n      @mouseover=\"handleMouseover(n)\"\r\n      @mouseleave=\"handleMouseleave\"\r\n      class=\"star\"\r\n    >\r\n      <svg height=\"16px\" width=\"16px\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n        <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\r\n        <path :d=\"getStarPath(n)\" />\r\n      </svg>\r\n    </span>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref } from 'vue';\r\n\r\nexport default {\r\n  name: 'StarRating',\r\n  props: {\r\n    rating: {\r\n      type: Number,\r\n      required: true,\r\n      default: 0\r\n    },\r\n    editable: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n  emits: ['update:rating'],\r\n  setup(props, { emit }) {\r\n    const hoverRating = ref(0);\r\n\r\n    const fullStarPath = \"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27z\";\r\n    const halfStarPath = \"M22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27V6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L18.18 21l-1.64-7.03L22 9.24zM12 15.4z\";\r\n    const emptyStarPath = \"M22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.64-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z\";\r\n\r\n    const getStarPath = (starIndex) => {\r\n      const displayRating = hoverRating.value || props.rating;\r\n      if (displayRating >= starIndex) {\r\n        return fullStarPath;\r\n      }\r\n      if (!hoverRating.value && props.rating >= starIndex - 0.5) {\r\n        return halfStarPath;\r\n      }\r\n      return emptyStarPath;\r\n    };\r\n\r\n    const setRating = (n) => {\r\n      if (props.editable) {\r\n        emit('update:rating', n);\r\n      }\r\n    };\r\n\r\n    const handleMouseover = (n) => {\r\n      if (props.editable) {\r\n        hoverRating.value = n;\r\n      }\r\n    };\r\n\r\n    const handleMouseleave = () => {\r\n      if (props.editable) {\r\n        hoverRating.value = 0;\r\n      }\r\n    };\r\n\r\n    return { getStarPath, setRating, handleMouseover, handleMouseleave };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.star-rating {\r\n  display: inline-flex;\r\n  color: #f39c12;\r\n  gap: 2px;\r\n}\r\n.star-rating.is-editable .star {\r\n  cursor: pointer;\r\n}\r\n</style>","import { render } from \"./StarRating.vue?vue&type=template&id=32f96f7e&scoped=true\"\nimport script from \"./StarRating.vue?vue&type=script&lang=js\"\nexport * from \"./StarRating.vue?vue&type=script&lang=js\"\n\nimport \"./StarRating.vue?vue&type=style&index=0&id=32f96f7e&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-32f96f7e\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"activity-feed\">\r\n    <h2>Activity Feed</h2>\r\n    <p class=\"feed-description\">See what your followers are up to</p>\r\n\r\n    <div v-if=\"loading\" class=\"loading-indicator\">Loading activity...</div>\r\n    <div v-else-if=\"activities.length === 0\" class=\"empty-state\">\r\n      <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"48px\" viewBox=\"0 0 24 24\" width=\"48px\" fill=\"var(--primary-color)\" opacity=\"0.3\">\r\n        <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z\"/>\r\n      </svg>\r\n      <h3>No Activity Yet</h3>\r\n      <p>Follow some users to see their recent reviews here!</p>\r\n    </div>\r\n\r\n    <div v-else class=\"activities-list\">\r\n      <div v-for=\"activity in activities\" :key=\"activity.id\" class=\"activity-item\">\r\n        <div class=\"activity-header\">\r\n          <img :src=\"activity.userPhoto || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" alt=\"User\" class=\"activity-avatar\" referrerpolicy=\"no-referrer\" />\r\n          <div class=\"activity-info\">\r\n            <div class=\"activity-action\">\r\n              <span class=\"user-name\">{{ activity.userName }}</span>\r\n              <span v-if=\"activity.badgesEarned && activity.badgesEarned.length > 0\" class=\"badge-indicator\">\r\n                 earned badges!\r\n              </span>\r\n              <span v-else>reviewed</span>\r\n            </div>\r\n            <span class=\"activity-time\">{{ formatTime(activity.timestamp) }}</span>\r\n          </div>\r\n        </div>\r\n\r\n        <div v-if=\"activity.badgesEarned && activity.badgesEarned.length > 0\" class=\"badges-earned\">\r\n          <div class=\"earned-title\">New Achievements!</div>\r\n          <div class=\"earned-badges\">\r\n            <span v-for=\"badgeId in activity.badgesEarned\" :key=\"badgeId\" class=\"earned-badge\" :title=\"getBadgeName(badgeId)\">\r\n              {{ getBadgeEmoji(badgeId) }}\r\n            </span>\r\n          </div>\r\n        </div>\r\n\r\n        <div v-if=\"activity.reviewRestaurant\" class=\"activity-content\">\r\n          <div class=\"restaurant-info\">\r\n            <h4 class=\"restaurant-name\">{{ activity.reviewRestaurant }}</h4>\r\n            <div class=\"review-details\">\r\n              <div class=\"rating\">\r\n                <span v-for=\"star in 5\" :key=\"star\" class=\"star\" :class=\"{ filled: star <= activity.rating }\"></span>\r\n                <span class=\"rating-value\">{{ activity.rating }}/5</span>\r\n              </div>\r\n              <div v-if=\"activity.reviewTitle\" class=\"review-title\">\"{{ activity.reviewTitle }}\"</div>\r\n            </div>\r\n          </div>\r\n          <button @click=\"viewRestaurant(activity.restaurantId)\" class=\"btn-view\" title=\"View restaurant\">\r\n            View Restaurant\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted } from 'vue';\r\nimport { db } from '../firebase';\r\nimport { collection, query, where, getDocs, orderBy, limit, Timestamp } from 'firebase/firestore';\r\nimport { getBadgeById } from '../utils/badges';\r\n\r\nexport default {\r\n  name: 'ActivityFeed',\r\n  props: {\r\n    user: {\r\n      type: Object,\r\n      required: true\r\n    },\r\n    following: {\r\n      type: Array,\r\n      default: () => []\r\n    }\r\n  },\r\n  emits: ['restaurant-selected'],\r\n  setup(props, { emit }) {\r\n    const activities = ref([]);\r\n    const loading = ref(true);\r\n\r\n    const loadActivityFeed = async () => {\r\n      loading.value = true;\r\n      try {\r\n        if (!props.user || !props.following || props.following.length === 0) {\r\n          activities.value = [];\r\n          loading.value = false;\r\n          return;\r\n        }\r\n\r\n        // Get recent reviews from people you follow\r\n        const reviewsQuery = query(\r\n          collection(db, 'reviews'),\r\n          where('userId', 'in', props.following),\r\n          orderBy('createdAt', 'desc'),\r\n          limit(50)\r\n        );\r\n\r\n        const reviewsSnap = await getDocs(reviewsQuery);\r\n        const reviewsMap = new Map();\r\n\r\n        // Get user info and badges for all reviewers\r\n        const usersSnap = await getDocs(\r\n          query(collection(db, 'users'), where('uid', 'in', props.following))\r\n        );\r\n        const usersMap = new Map();\r\n        usersSnap.docs.forEach(doc => {\r\n          usersMap.set(doc.id, doc.data());\r\n        });\r\n\r\n        // Get restaurant info for all reviewed restaurants\r\n        const restaurantIds = new Set();\r\n        reviewsSnap.docs.forEach(doc => {\r\n          const review = doc.data();\r\n          if (review.restaurantId) {\r\n            restaurantIds.add(review.restaurantId);\r\n          }\r\n        });\r\n\r\n        const restaurantsMap = new Map();\r\n        if (restaurantIds.size > 0) {\r\n          const restaurantsSnap = await getDocs(\r\n            query(collection(db, 'restaurants'), where('__name__', 'in', Array.from(restaurantIds)))\r\n          );\r\n          restaurantsSnap.docs.forEach(doc => {\r\n            restaurantsMap.set(doc.id, doc.data());\r\n          });\r\n        }\r\n\r\n        // Build activity items\r\n        const activityList = [];\r\n        reviewsSnap.docs.forEach(doc => {\r\n          const review = doc.data();\r\n          const user = usersMap.get(review.userId);\r\n          const restaurant = restaurantsMap.get(review.restaurantId);\r\n\r\n          if (user && restaurant) {\r\n            activityList.push({\r\n              id: doc.id,\r\n              userId: review.userId,\r\n              userName: user.displayName || 'Unknown User',\r\n              userPhoto: user.photoURL,\r\n              timestamp: review.createdAt,\r\n              reviewRestaurant: restaurant.name,\r\n              restaurantId: review.restaurantId,\r\n              rating: review.rating,\r\n              reviewTitle: review.title,\r\n              badgesEarned: [] // Could be populated from user data\r\n            });\r\n          }\r\n        });\r\n\r\n        activities.value = activityList.slice(0, 15); // Limit to 15 most recent\r\n      } catch (error) {\r\n        console.error('Error loading activity feed:', error);\r\n        activities.value = [];\r\n      } finally {\r\n        loading.value = false;\r\n      }\r\n    };\r\n\r\n    const formatTime = (timestamp) => {\r\n      if (!timestamp) return '';\r\n      const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);\r\n      const now = new Date();\r\n      const diffMs = now - date;\r\n      const diffMins = Math.floor(diffMs / 60000);\r\n      const diffHours = Math.floor(diffMs / 3600000);\r\n      const diffDays = Math.floor(diffMs / 86400000);\r\n\r\n      if (diffMins < 1) return 'just now';\r\n      if (diffMins < 60) return `${diffMins}m ago`;\r\n      if (diffHours < 24) return `${diffHours}h ago`;\r\n      if (diffDays < 7) return `${diffDays}d ago`;\r\n      return date.toLocaleDateString();\r\n    };\r\n\r\n    const getBadgeName = (badgeId) => {\r\n      const badge = getBadgeById(badgeId);\r\n      return badge ? badge.name : 'Achievement';\r\n    };\r\n\r\n    const getBadgeEmoji = (badgeId) => {\r\n      const badge = getBadgeById(badgeId);\r\n      return badge ? badge.emoji : '';\r\n    };\r\n\r\n    const viewRestaurant = (restaurantId) => {\r\n      emit('restaurant-selected', restaurantId);\r\n    };\r\n\r\n    onMounted(() => {\r\n      loadActivityFeed();\r\n    });\r\n\r\n    return {\r\n      activities,\r\n      loading,\r\n      formatTime,\r\n      getBadgeName,\r\n      getBadgeEmoji,\r\n      viewRestaurant\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.activity-feed {\r\n  width: 100%;\r\n}\r\n\r\n.activity-feed h2 {\r\n  color: var(--primary-color);\r\n  font-size: 1.5rem;\r\n  margin: 0 0 0.5rem 0;\r\n}\r\n\r\n.feed-description {\r\n  color: var(--text-color);\r\n  margin: 0 0 1.5rem 0;\r\n  font-size: 0.95rem;\r\n  opacity: 0.8;\r\n}\r\n\r\n.loading-indicator {\r\n  text-align: center;\r\n  padding: 2rem;\r\n  color: var(--text-color);\r\n}\r\n\r\n.empty-state {\r\n  text-align: center;\r\n  padding: 2rem;\r\n  background: var(--background-color);\r\n  border-radius: 8px;\r\n  color: var(--text-color);\r\n}\r\n\r\n.empty-state svg {\r\n  display: block;\r\n  margin: 0 auto 1rem;\r\n}\r\n\r\n.empty-state h3 {\r\n  margin: 0.5rem 0;\r\n  color: var(--secondary-color);\r\n}\r\n\r\n.empty-state p {\r\n  margin: 0.5rem 0 0;\r\n  font-size: 0.95rem;\r\n}\r\n\r\n.activities-list {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 1rem;\r\n}\r\n\r\n.activity-item {\r\n  background: var(--card-background);\r\n  border: 1px solid #e0e0e0;\r\n  border-radius: 8px;\r\n  padding: 1rem;\r\n  box-shadow: 0 1px 3px var(--shadow-color);\r\n  transition: box-shadow 0.2s;\r\n}\r\n\r\n.activity-item:hover {\r\n  box-shadow: 0 2px 8px var(--shadow-color);\r\n}\r\n\r\n.activity-header {\r\n  display: flex;\r\n  gap: 0.75rem;\r\n  margin-bottom: 0.75rem;\r\n}\r\n\r\n.activity-avatar {\r\n  width: 40px;\r\n  height: 40px;\r\n  border-radius: 50%;\r\n  object-fit: cover;\r\n}\r\n\r\n.activity-info {\r\n  flex: 1;\r\n}\r\n\r\n.activity-action {\r\n  display: flex;\r\n  gap: 0.5rem;\r\n  align-items: center;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.user-name {\r\n  font-weight: 600;\r\n  color: var(--secondary-color);\r\n}\r\n\r\n.badge-indicator {\r\n  color: var(--primary-color);\r\n  font-weight: 500;\r\n}\r\n\r\n.activity-time {\r\n  display: block;\r\n  font-size: 0.85rem;\r\n  color: var(--text-color);\r\n  opacity: 0.7;\r\n  margin-top: 0.25rem;\r\n}\r\n\r\n.badges-earned {\r\n  background: linear-gradient(135deg, #fff9e6 0%, #fff 100%);\r\n  border-left: 4px solid #ffc107;\r\n  padding: 0.75rem;\r\n  border-radius: 4px;\r\n  margin-bottom: 0.75rem;\r\n}\r\n\r\n.earned-title {\r\n  font-size: 0.85rem;\r\n  font-weight: 600;\r\n  color: #f57f17;\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n.earned-badges {\r\n  display: flex;\r\n  gap: 0.5rem;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.earned-badge {\r\n  font-size: 1.5rem;\r\n  cursor: help;\r\n}\r\n\r\n.activity-content {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: flex-start;\r\n  gap: 1rem;\r\n}\r\n\r\n.restaurant-info {\r\n  flex: 1;\r\n}\r\n\r\n.restaurant-name {\r\n  margin: 0 0 0.5rem 0;\r\n  color: var(--secondary-color);\r\n  font-size: 1.1rem;\r\n}\r\n\r\n.review-details {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 0.5rem;\r\n}\r\n\r\n.rating {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n  font-size: 0.9rem;\r\n}\r\n\r\n.star {\r\n  color: #ddd;\r\n  font-size: 1rem;\r\n}\r\n\r\n.star.filled {\r\n  color: #ffc107;\r\n}\r\n\r\n.rating-value {\r\n  color: var(--text-color);\r\n  font-weight: 600;\r\n}\r\n\r\n.review-title {\r\n  color: var(--text-color);\r\n  font-style: italic;\r\n  font-size: 0.95rem;\r\n}\r\n\r\n.btn-view {\r\n  background: var(--primary-color);\r\n  color: white;\r\n  border: none;\r\n  padding: 0.5rem 1rem;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-size: 0.9rem;\r\n  transition: background 0.2s;\r\n}\r\n\r\n.btn-view:hover {\r\n  background: #2980b9;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .activity-content {\r\n    flex-direction: column;\r\n  }\r\n\r\n  .btn-view {\r\n    width: 100%;\r\n  }\r\n\r\n  .activity-action {\r\n    flex-direction: column;\r\n    gap: 0.25rem;\r\n  }\r\n}\r\n</style>\r\n","/**\r\n * Badge System for PorkHub\r\n * Defines all available badges and badge calculation logic\r\n */\r\n\r\nexport const BADGES = {\r\n  // Review Count Milestones\r\n  REVIEWER_10: {\r\n    id: 'reviewer-10',\r\n    name: '10 Reviews',\r\n    description: 'Written 10 reviews',\r\n    emoji: '',\r\n    requirement: (stats) => stats.reviewCount >= 10,\r\n    category: 'milestone'\r\n  },\r\n  REVIEWER_25: {\r\n    id: 'reviewer-25',\r\n    name: '25 Reviews',\r\n    description: 'Written 25 reviews',\r\n    emoji: '',\r\n    requirement: (stats) => stats.reviewCount >= 25,\r\n    category: 'milestone'\r\n  },\r\n  REVIEWER_50: {\r\n    id: 'reviewer-50',\r\n    name: '50 Reviews',\r\n    description: 'Written 50 reviews',\r\n    emoji: '',\r\n    requirement: (stats) => stats.reviewCount >= 50,\r\n    category: 'milestone'\r\n  },\r\n  REVIEWER_100: {\r\n    id: 'reviewer-100',\r\n    name: '100 Reviews',\r\n    description: 'Written 100 reviews',\r\n    emoji: '',\r\n    requirement: (stats) => stats.reviewCount >= 100,\r\n    category: 'milestone'\r\n  },\r\n\r\n  // Photo Master\r\n  PHOTO_MASTER: {\r\n    id: 'photo-master',\r\n    name: 'Photo Master',\r\n    description: 'Written 10+ reviews with photos',\r\n    emoji: '',\r\n    requirement: (stats) => stats.photoReviewCount >= 10,\r\n    category: 'engagement'\r\n  },\r\n\r\n  // Geographic\r\n  ALL_50_STATES: {\r\n    id: 'all-50-states',\r\n    name: 'All 50 States',\r\n    description: 'Reviewed restaurants in all 50 US states',\r\n    emoji: '',\r\n    requirement: (stats) => stats.statesVisited && stats.statesVisited.size === 50,\r\n    category: 'geographic'\r\n  }\r\n};\r\n\r\n/**\r\n * Calculate which badges a user has earned\r\n * @param {Object} userStats - User statistics object\r\n * @returns {Array} Array of badge IDs earned\r\n */\r\nexport function calculateEarnedBadges(userStats) {\r\n  const earned = [];\r\n  \r\n  Object.values(BADGES).forEach(badge => {\r\n    if (badge.requirement(userStats)) {\r\n      earned.push(badge.id);\r\n    }\r\n  });\r\n  \r\n  return earned;\r\n}\r\n\r\n/**\r\n * Get badge details by ID\r\n * @param {string} badgeId - Badge ID\r\n * @returns {Object} Badge object\r\n */\r\nexport function getBadgeById(badgeId) {\r\n  return Object.values(BADGES).find(badge => badge.id === badgeId) || null;\r\n}\r\n\r\n/**\r\n * Get all badges\r\n * @returns {Array} Array of all badge objects\r\n */\r\nexport function getAllBadges() {\r\n  return Object.values(BADGES);\r\n}\r\n\r\n/**\r\n * Get badges by category\r\n * @param {string} category - Category name\r\n * @returns {Array} Array of badges in that category\r\n */\r\nexport function getBadgesByCategory(category) {\r\n  return Object.values(BADGES).filter(badge => badge.category === category);\r\n}\r\n\r\n/**\r\n * Format user stats for badge calculation\r\n * Used when calculating from Firestore user documents\r\n * @param {Object} userDoc - Firestore user document\r\n * @param {Array} userReviews - Array of user's review documents\r\n * @returns {Object} Formatted stats object\r\n */\r\nexport function formatUserStats(userDoc, userReviews = []) {\r\n  const stats = {\r\n    reviewCount: userDoc.reviewCount || 0,\r\n    photoReviewCount: 0,\r\n    statesVisited: new Set()\r\n  };\r\n\r\n  // Count photo reviews and collect states\r\n  if (userReviews && userReviews.length > 0) {\r\n    userReviews.forEach(review => {\r\n      if (review.photoURL) {\r\n        stats.photoReviewCount++;\r\n      }\r\n      if (review.restaurantState) {\r\n        stats.statesVisited.add(review.restaurantState.toUpperCase());\r\n      }\r\n    });\r\n  }\r\n\r\n  return stats;\r\n}\r\n","import { render } from \"./ActivityFeed.vue?vue&type=template&id=6a3d5ec8&scoped=true\"\nimport script from \"./ActivityFeed.vue?vue&type=script&lang=js\"\nexport * from \"./ActivityFeed.vue?vue&type=script&lang=js\"\n\nimport \"./ActivityFeed.vue?vue&type=style&index=0&id=6a3d5ec8&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-6a3d5ec8\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"trending-section\">\r\n    <h2>Trending This Week</h2>\r\n    \r\n    <div class=\"trend-tabs\">\r\n      <button \r\n        @click=\"trendType = 'most-reviewed'\" \r\n        :class=\"{ active: trendType === 'most-reviewed' }\"\r\n        class=\"trend-tab\"\r\n      >\r\n         Most Reviewed\r\n      </button>\r\n      <button \r\n        @click=\"trendType = 'highest-rated'\" \r\n        :class=\"{ active: trendType === 'highest-rated' }\"\r\n        class=\"trend-tab\"\r\n      >\r\n         Highest Rated\r\n      </button>\r\n    </div>\r\n\r\n    <div v-if=\"loading\" class=\"loading-indicator\">Loading trending...</div>\r\n    <div v-else-if=\"trendingList.length === 0\" class=\"empty-state\">\r\n      <p>No data available yet</p>\r\n    </div>\r\n\r\n    <div v-else class=\"trending-list\">\r\n      <div v-for=\"(item, index) in trendingList\" :key=\"item.id\" class=\"trending-item\">\r\n        <div class=\"ranking\">\r\n          <span class=\"rank-number\">#{{ index + 1 }}</span>\r\n          <span v-if=\"index === 0\" class=\"rank-badge\"></span>\r\n          <span v-else-if=\"index === 1\" class=\"rank-badge\"></span>\r\n          <span v-else-if=\"index === 2\" class=\"rank-badge\"></span>\r\n        </div>\r\n\r\n        <div class=\"restaurant-info\">\r\n          <h4 class=\"restaurant-name\">{{ item.name }}</h4>\r\n          <div class=\"restaurant-meta\">\r\n            <span class=\"location\">{{ item.city }}<template v-if=\"item.city && item.state\">, </template>{{ item.state }}</span>\r\n            <span class=\"stat-badge\">\r\n              <span v-if=\"trendType === 'most-reviewed'\" class=\"stat-value\">{{ item.weekReviews }} reviews</span>\r\n              <span v-else class=\"stat-value\">{{ item.averageRating.toFixed(1) }} </span>\r\n            </span>\r\n          </div>\r\n          <div class=\"trend-indicator\">\r\n            <span v-if=\"trendType === 'most-reviewed'\" class=\"indicator-text\">\r\n               {{ item.weekReviews }} new reviews this week\r\n            </span>\r\n            <span v-else class=\"indicator-text\">\r\n              Based on {{ item.ratingCount }} reviews\r\n            </span>\r\n          </div>\r\n        </div>\r\n\r\n        <button @click=\"viewRestaurant(item.id)\" class=\"btn-view\" title=\"View restaurant\">\r\n          View\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, computed, onMounted } from 'vue';\r\nimport { db } from '../firebase';\r\nimport { collection, getDocs, query, where, Timestamp } from 'firebase/firestore';\r\n\r\nexport default {\r\n  name: 'TrendingRestaurants',\r\n  emits: ['restaurant-selected'],\r\n  setup(props, { emit }) {\r\n    const trendType = ref('most-reviewed');\r\n    const restaurants = ref([]);\r\n    const loading = ref(true);\r\n\r\n    const loadTrendingRestaurants = async () => {\r\n      loading.value = true;\r\n      try {\r\n        // Get all restaurants\r\n        const restaurantsSnap = await getDocs(collection(db, 'restaurants'));\r\n        const restaurantsList = [];\r\n\r\n        // Calculate one week ago\r\n        const oneWeekAgo = new Date();\r\n        oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);\r\n\r\n        // Get all reviews to calculate trending stats\r\n        const reviewsSnap = await getDocs(collection(db, 'reviews'));\r\n        const statsMap = new Map();\r\n\r\n        reviewsSnap.docs.forEach(doc => {\r\n          const review = doc.data();\r\n          const restaurantId = review.restaurantId;\r\n          const createdAt = review.createdAt?.toDate ? review.createdAt.toDate() : new Date(review.createdAt);\r\n\r\n          if (!statsMap.has(restaurantId)) {\r\n            statsMap.set(restaurantId, {\r\n              totalReviews: 0,\r\n              weekReviews: 0,\r\n              ratings: [],\r\n              ratingCount: 0\r\n            });\r\n          }\r\n\r\n          const stats = statsMap.get(restaurantId);\r\n          stats.totalReviews++;\r\n          stats.ratings.push(review.rating);\r\n          stats.ratingCount++;\r\n\r\n          if (createdAt > oneWeekAgo) {\r\n            stats.weekReviews++;\r\n          }\r\n        });\r\n\r\n        // Build restaurant list with stats\r\n        restaurantsSnap.docs.forEach(doc => {\r\n          const restaurant = doc.data();\r\n          const stats = statsMap.get(doc.id) || {\r\n            totalReviews: 0,\r\n            weekReviews: 0,\r\n            ratings: [],\r\n            ratingCount: 0\r\n          };\r\n\r\n          const avgRating = stats.ratings.length > 0\r\n            ? stats.ratings.reduce((a, b) => a + b, 0) / stats.ratings.length\r\n            : 0;\r\n\r\n          restaurantsList.push({\r\n            id: doc.id,\r\n            name: restaurant.name,\r\n            city: restaurant.city,\r\n            state: restaurant.state,\r\n            weekReviews: stats.weekReviews,\r\n            totalReviews: stats.totalReviews,\r\n            averageRating: avgRating,\r\n            ratingCount: stats.ratingCount\r\n          });\r\n        });\r\n\r\n        restaurants.value = restaurantsList;\r\n      } catch (error) {\r\n        console.error('Error loading trending restaurants:', error);\r\n        restaurants.value = [];\r\n      } finally {\r\n        loading.value = false;\r\n      }\r\n    };\r\n\r\n    const trendingList = computed(() => {\r\n      if (trendType.value === 'most-reviewed') {\r\n        return restaurants.value\r\n          .filter(r => r.weekReviews > 0)\r\n          .sort((a, b) => b.weekReviews - a.weekReviews)\r\n          .slice(0, 10);\r\n      } else {\r\n        return restaurants.value\r\n          .filter(r => r.ratingCount >= 3) // Need at least 3 reviews\r\n          .sort((a, b) => b.averageRating - a.averageRating)\r\n          .slice(0, 10);\r\n      }\r\n    });\r\n\r\n    const viewRestaurant = (restaurantId) => {\r\n      emit('restaurant-selected', restaurantId);\r\n    };\r\n\r\n    onMounted(() => {\r\n      loadTrendingRestaurants();\r\n    });\r\n\r\n    return {\r\n      trendType,\r\n      trendingList,\r\n      loading,\r\n      viewRestaurant\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.trending-section {\r\n  width: 100%;\r\n  margin-bottom: 2rem;\r\n}\r\n\r\n.trending-section h2 {\r\n  color: var(--primary-color);\r\n  font-size: 1.5rem;\r\n  margin: 0 0 1rem 0;\r\n}\r\n\r\n.trend-tabs {\r\n  display: flex;\r\n  gap: 0.5rem;\r\n  margin-bottom: 1.5rem;\r\n  border-bottom: 2px solid var(--background-color);\r\n}\r\n\r\n.trend-tab {\r\n  background: none;\r\n  border: none;\r\n  padding: 0.75rem 1rem;\r\n  cursor: pointer;\r\n  color: var(--text-color);\r\n  font-weight: 600;\r\n  border-bottom: 3px solid transparent;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.trend-tab:hover {\r\n  color: var(--primary-color);\r\n}\r\n\r\n.trend-tab.active {\r\n  color: var(--primary-color);\r\n  border-bottom-color: var(--primary-color);\r\n}\r\n\r\n.loading-indicator {\r\n  text-align: center;\r\n  padding: 2rem;\r\n  color: var(--text-color);\r\n}\r\n\r\n.empty-state {\r\n  text-align: center;\r\n  padding: 2rem;\r\n  background: var(--background-color);\r\n  border-radius: 8px;\r\n  color: var(--text-color);\r\n}\r\n\r\n.trending-list {\r\n  display: grid;\r\n  gap: 1rem;\r\n}\r\n\r\n.trending-item {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 1rem;\r\n  background: var(--card-background);\r\n  border: 1px solid #e0e0e0;\r\n  border-radius: 8px;\r\n  padding: 1rem;\r\n  box-shadow: 0 1px 3px var(--shadow-color);\r\n  transition: all 0.2s;\r\n}\r\n\r\n.trending-item:hover {\r\n  box-shadow: 0 2px 8px var(--shadow-color);\r\n  border-color: var(--primary-color);\r\n}\r\n\r\n.ranking {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  gap: 0.25rem;\r\n  min-width: 50px;\r\n}\r\n\r\n.rank-number {\r\n  font-size: 1.25rem;\r\n  font-weight: bold;\r\n  color: var(--primary-color);\r\n}\r\n\r\n.rank-badge {\r\n  font-size: 1.5rem;\r\n}\r\n\r\n.restaurant-info {\r\n  flex: 1;\r\n}\r\n\r\n.restaurant-name {\r\n  margin: 0 0 0.5rem 0;\r\n  color: var(--secondary-color);\r\n  font-size: 1.1rem;\r\n}\r\n\r\n.restaurant-meta {\r\n  display: flex;\r\n  gap: 1rem;\r\n  align-items: center;\r\n  margin-bottom: 0.5rem;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.location {\r\n  font-size: 0.9rem;\r\n  color: var(--text-color);\r\n  opacity: 0.7;\r\n}\r\n\r\n.stat-badge {\r\n  background: var(--primary-color);\r\n  color: white;\r\n  padding: 0.25rem 0.75rem;\r\n  border-radius: 20px;\r\n  font-size: 0.85rem;\r\n  font-weight: 600;\r\n}\r\n\r\n.stat-value {\r\n  white-space: nowrap;\r\n}\r\n\r\n.trend-indicator {\r\n  font-size: 0.9rem;\r\n  color: var(--primary-color);\r\n  font-weight: 500;\r\n}\r\n\r\n.indicator-text {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n}\r\n\r\n.btn-view {\r\n  background: var(--primary-color);\r\n  color: white;\r\n  border: none;\r\n  padding: 0.5rem 1rem;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n  transition: background 0.2s;\r\n  white-space: nowrap;\r\n}\r\n\r\n.btn-view:hover {\r\n  background: #2980b9;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .trending-item {\r\n    flex-direction: column;\r\n    align-items: flex-start;\r\n  }\r\n\r\n  .restaurant-meta {\r\n    flex-direction: column;\r\n    gap: 0.5rem;\r\n  }\r\n\r\n  .btn-view {\r\n    width: 100%;\r\n    text-align: center;\r\n  }\r\n\r\n  .ranking {\r\n    flex-direction: row;\r\n    gap: 0.5rem;\r\n  }\r\n}\r\n</style>\r\n","import { render } from \"./TrendingRestaurants.vue?vue&type=template&id=518e26e8&scoped=true\"\nimport script from \"./TrendingRestaurants.vue?vue&type=script&lang=js\"\nexport * from \"./TrendingRestaurants.vue?vue&type=script&lang=js\"\n\nimport \"./TrendingRestaurants.vue?vue&type=style&index=0&id=518e26e8&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-518e26e8\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"recommendations-section\">\r\n    <h2>Suggested Users to Follow</h2>\r\n    <p class=\"description\">Users similar to reviewers you already follow</p>\r\n\r\n    <div v-if=\"loading\" class=\"loading-indicator\">Loading recommendations...</div>\r\n    <div v-else-if=\"recommendedUsers.length === 0\" class=\"empty-state\">\r\n      <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"48px\" viewBox=\"0 0 24 24\" width=\"48px\" fill=\"var(--primary-color)\" opacity=\"0.3\">\r\n        <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z\"/>\r\n      </svg>\r\n      <h3>No Recommendations Yet</h3>\r\n      <p>Follow more users to get better recommendations!</p>\r\n    </div>\r\n\r\n    <div v-else class=\"recommendations-grid\">\r\n      <div v-for=\"user in recommendedUsers\" :key=\"user.uid\" class=\"user-card\">\r\n        <img :src=\"user.photoURL || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" alt=\"User\" class=\"user-photo\" referrerpolicy=\"no-referrer\" />\r\n        \r\n        <h4 class=\"user-name\">{{ user.displayName }}</h4>\r\n        \r\n        <div class=\"user-stats\">\r\n          <div class=\"stat\">\r\n            <span class=\"stat-label\">Reviews</span>\r\n            <span class=\"stat-value\">{{ user.reviewCount || 0 }}</span>\r\n          </div>\r\n          <div class=\"stat\">\r\n            <span class=\"stat-label\">Followers</span>\r\n            <span class=\"stat-value\">{{ user.followerCount || 0 }}</span>\r\n          </div>\r\n        </div>\r\n\r\n        <div v-if=\"user.badges && user.badges.length > 0\" class=\"user-badges\">\r\n          <span v-for=\"badgeId in user.badges.slice(0, 3)\" :key=\"badgeId\" class=\"badge-icon\" :title=\"getBadgeName(badgeId)\">\r\n            {{ getBadgeEmoji(badgeId) }}\r\n          </span>\r\n          <span v-if=\"user.badges.length > 3\" class=\"badge-more\">+{{ user.badges.length - 3 }}</span>\r\n        </div>\r\n\r\n        <div class=\"reason\" v-if=\"user.reason\">\r\n          <span class=\"reason-label\">Why we recommend this:</span>\r\n          <span class=\"reason-text\">{{ user.reason }}</span>\r\n        </div>\r\n\r\n        <button @click=\"followUser(user.uid)\" :disabled=\"isFollowing(user.uid)\" class=\"btn-follow\">\r\n          {{ isFollowing(user.uid) ? 'Following' : 'Follow' }}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, computed, onMounted } from 'vue';\r\nimport { db } from '../firebase';\r\nimport { collection, getDocs, query, where, doc, getDoc, setDoc, deleteDoc } from 'firebase/firestore';\r\nimport { getBadgeById } from '../utils/badges';\r\n\r\nexport default {\r\n  name: 'FollowRecommendations',\r\n  props: {\r\n    user: {\r\n      type: Object,\r\n      required: true\r\n    },\r\n    following: {\r\n      type: Array,\r\n      default: () => []\r\n    }\r\n  },\r\n  emits: ['follow-user'],\r\n  setup(props, { emit }) {\r\n    const recommendedUsers = ref([]);\r\n    const loading = ref(true);\r\n    const userFollowing = ref(new Set(props.following || []));\r\n\r\n    const loadRecommendations = async () => {\r\n      loading.value = true;\r\n      try {\r\n        if (!props.user || !props.following || props.following.length === 0) {\r\n          recommendedUsers.value = [];\r\n          loading.value = false;\r\n          return;\r\n        }\r\n\r\n        // Get all users that people you follow are following\r\n        const followsSnap = await getDocs(\r\n          query(\r\n            collection(db, 'follows'),\r\n            where('followerId', 'in', props.following)\r\n          )\r\n        );\r\n\r\n        const recommendedUserIds = new Set();\r\n        const followCountMap = new Map();\r\n\r\n        followsSnap.docs.forEach(doc => {\r\n          const follow = doc.data();\r\n          const followingId = follow.followingId;\r\n\r\n          // Don't recommend users already followed or the current user\r\n          if (\r\n            followingId !== props.user.uid &&\r\n            !props.following.includes(followingId)\r\n          ) {\r\n            recommendedUserIds.add(followingId);\r\n            followCountMap.set(followingId, (followCountMap.get(followingId) || 0) + 1);\r\n          }\r\n        });\r\n\r\n        if (recommendedUserIds.size === 0) {\r\n          recommendedUsers.value = [];\r\n          loading.value = false;\r\n          return;\r\n        }\r\n\r\n        // Get user details\r\n        const userIds = Array.from(recommendedUserIds).slice(0, 12); // Limit to top 12\r\n        const usersSnap = await getDocs(\r\n          query(collection(db, 'users'), where('uid', 'in', userIds))\r\n        );\r\n\r\n        const users = [];\r\n        usersSnap.docs.forEach(doc => {\r\n          const userData = doc.data();\r\n          const mutualFollowCount = followCountMap.get(doc.id) || 0;\r\n\r\n          users.push({\r\n            uid: doc.id,\r\n            displayName: userData.displayName,\r\n            photoURL: userData.photoURL,\r\n            reviewCount: userData.reviewCount || 0,\r\n            followerCount: userData.followerCount || 0,\r\n            badges: userData.earnedBadges || [],\r\n            mutualFollowCount,\r\n            reason: generateReason(userData, mutualFollowCount)\r\n          });\r\n        });\r\n\r\n        // Sort by mutual follows and review count\r\n        users.sort((a, b) => {\r\n          if (b.mutualFollowCount !== a.mutualFollowCount) {\r\n            return b.mutualFollowCount - a.mutualFollowCount;\r\n          }\r\n          return b.reviewCount - a.reviewCount;\r\n        });\r\n\r\n        recommendedUsers.value = users;\r\n      } catch (error) {\r\n        console.error('Error loading recommendations:', error);\r\n        recommendedUsers.value = [];\r\n      } finally {\r\n        loading.value = false;\r\n      }\r\n    };\r\n\r\n    const generateReason = (user, mutualCount) => {\r\n      if (mutualCount >= 3) {\r\n        return `Followed by ${mutualCount} reviewers you know`;\r\n      }\r\n      if (user.reviewCount >= 25) {\r\n        return 'Prolific reviewer with quality content';\r\n      }\r\n      if (user.badges && user.badges.length > 0) {\r\n        return 'Earned multiple achievements';\r\n      }\r\n      return 'Similar taste in restaurants';\r\n    };\r\n\r\n    const isFollowing = (userId) => {\r\n      return userFollowing.value.has(userId);\r\n    };\r\n\r\n    const followUser = async (userId) => {\r\n      try {\r\n        const followRef = doc(\r\n          collection(db, 'follows'),\r\n          `${props.user.uid}_${userId}`\r\n        );\r\n\r\n        if (isFollowing(userId)) {\r\n          // Unfollow\r\n          await deleteDoc(followRef);\r\n          userFollowing.value.delete(userId);\r\n        } else {\r\n          // Follow\r\n          await setDoc(followRef, {\r\n            followerId: props.user.uid,\r\n            followingId: userId,\r\n            createdAt: new Date()\r\n          });\r\n          userFollowing.value.add(userId);\r\n        }\r\n\r\n        emit('follow-user', { userId, isFollowing: !isFollowing(userId) });\r\n      } catch (error) {\r\n        console.error('Error following user:', error);\r\n      }\r\n    };\r\n\r\n    const getBadgeName = (badgeId) => {\r\n      const badge = getBadgeById(badgeId);\r\n      return badge ? badge.name : 'Achievement';\r\n    };\r\n\r\n    const getBadgeEmoji = (badgeId) => {\r\n      const badge = getBadgeById(badgeId);\r\n      return badge ? badge.emoji : '';\r\n    };\r\n\r\n    onMounted(() => {\r\n      loadRecommendations();\r\n    });\r\n\r\n    return {\r\n      recommendedUsers,\r\n      loading,\r\n      isFollowing,\r\n      followUser,\r\n      getBadgeName,\r\n      getBadgeEmoji\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.recommendations-section {\r\n  width: 100%;\r\n  margin-bottom: 2rem;\r\n}\r\n\r\n.recommendations-section h2 {\r\n  color: var(--primary-color);\r\n  font-size: 1.5rem;\r\n  margin: 0 0 0.5rem 0;\r\n}\r\n\r\n.description {\r\n  color: var(--text-color);\r\n  margin: 0 0 1.5rem 0;\r\n  font-size: 0.95rem;\r\n  opacity: 0.8;\r\n}\r\n\r\n.loading-indicator {\r\n  text-align: center;\r\n  padding: 2rem;\r\n  color: var(--text-color);\r\n}\r\n\r\n.empty-state {\r\n  text-align: center;\r\n  padding: 2rem;\r\n  background: var(--background-color);\r\n  border-radius: 8px;\r\n  color: var(--text-color);\r\n}\r\n\r\n.empty-state svg {\r\n  display: block;\r\n  margin: 0 auto 1rem;\r\n}\r\n\r\n.empty-state h3 {\r\n  margin: 0.5rem 0;\r\n  color: var(--secondary-color);\r\n}\r\n\r\n.empty-state p {\r\n  margin: 0.5rem 0 0;\r\n  font-size: 0.95rem;\r\n}\r\n\r\n.recommendations-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\r\n  gap: 1.5rem;\r\n}\r\n\r\n.user-card {\r\n  background: var(--card-background);\r\n  border: 1px solid #e0e0e0;\r\n  border-radius: 8px;\r\n  padding: 1.5rem;\r\n  text-align: center;\r\n  box-shadow: 0 1px 3px var(--shadow-color);\r\n  transition: all 0.2s;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 1rem;\r\n}\r\n\r\n.user-card:hover {\r\n  box-shadow: 0 4px 12px var(--shadow-color);\r\n  border-color: var(--primary-color);\r\n  transform: translateY(-2px);\r\n}\r\n\r\n.user-photo {\r\n  width: 80px;\r\n  height: 80px;\r\n  border-radius: 50%;\r\n  object-fit: cover;\r\n  margin: 0 auto;\r\n  border: 3px solid var(--primary-color);\r\n}\r\n\r\n.user-name {\r\n  margin: 0.5rem 0 0;\r\n  color: var(--secondary-color);\r\n  font-size: 1.1rem;\r\n}\r\n\r\n.user-stats {\r\n  display: flex;\r\n  justify-content: space-around;\r\n  padding: 0.75rem;\r\n  background: var(--background-color);\r\n  border-radius: 6px;\r\n}\r\n\r\n.stat {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 0.25rem;\r\n}\r\n\r\n.stat-label {\r\n  font-size: 0.75rem;\r\n  color: var(--text-color);\r\n  opacity: 0.7;\r\n  text-transform: uppercase;\r\n}\r\n\r\n.stat-value {\r\n  font-weight: 700;\r\n  color: var(--primary-color);\r\n  font-size: 1.1rem;\r\n}\r\n\r\n.user-badges {\r\n  display: flex;\r\n  gap: 0.5rem;\r\n  justify-content: center;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.badge-icon {\r\n  font-size: 1.5rem;\r\n  cursor: help;\r\n}\r\n\r\n.badge-more {\r\n  font-size: 0.9rem;\r\n  color: var(--primary-color);\r\n  font-weight: 600;\r\n  align-self: center;\r\n}\r\n\r\n.reason {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 0.25rem;\r\n  font-size: 0.85rem;\r\n  background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);\r\n  padding: 0.75rem;\r\n  border-radius: 6px;\r\n}\r\n\r\n.reason-label {\r\n  color: var(--primary-color);\r\n  font-weight: 600;\r\n}\r\n\r\n.reason-text {\r\n  color: var(--text-color);\r\n}\r\n\r\n.btn-follow {\r\n  background: var(--primary-color);\r\n  color: white;\r\n  border: none;\r\n  padding: 0.65rem 1rem;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.btn-follow:hover:not(:disabled) {\r\n  background: #2980b9;\r\n  transform: scale(1.02);\r\n}\r\n\r\n.btn-follow:disabled {\r\n  background: #95a5a6;\r\n  cursor: not-allowed;\r\n  opacity: 0.8;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .recommendations-grid {\r\n    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\r\n    gap: 1rem;\r\n  }\r\n\r\n  .user-card {\r\n    padding: 1rem;\r\n  }\r\n\r\n  .user-photo {\r\n    width: 70px;\r\n    height: 70px;\r\n  }\r\n}\r\n</style>\r\n","import { render } from \"./FollowRecommendations.vue?vue&type=template&id=6e74fdb3&scoped=true\"\nimport script from \"./FollowRecommendations.vue?vue&type=script&lang=js\"\nexport * from \"./FollowRecommendations.vue?vue&type=script&lang=js\"\n\nimport \"./FollowRecommendations.vue?vue&type=style&index=0&id=6e74fdb3&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-6e74fdb3\"]])\n\nexport default __exports__","export function getDistance(lat1, lon1, lat2, lon2) {\r\n  if (lat1 === null || lon1 === null || lat2 === null || lon2 === null) {\r\n    return null;\r\n  }\r\n  if (lat1 === lat2 && lon1 === lon2) {\r\n    return 0;\r\n  }\r\n  const R = 3959; // Radius of the earth in miles\r\n  const dLat = (lat2 - lat1) * Math.PI / 180;\r\n  const dLon = (lon2 - lon1) * Math.PI / 180;\r\n  const a =\r\n    Math.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n    Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *\r\n    Math.sin(dLon / 2) * Math.sin(dLon / 2);\r\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n  return R * c;\r\n}","import { render } from \"./Home.vue?vue&type=template&id=159b487c&scoped=true\"\nimport script from \"./Home.vue?vue&type=script&lang=js\"\nexport * from \"./Home.vue?vue&type=script&lang=js\"\n\nimport \"./Home.vue?vue&type=style&index=0&id=159b487c&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-159b487c\"]])\n\nexport default __exports__","<template>\n  <div class=\"restaurants-page\">\n    <EditRestaurantModal \n      v-if=\"isEditModalVisible\"\n      :restaurant=\"restaurantToEdit\"\n      @close=\"closeEditModal\"\n      @save=\"saveRestaurantChanges\"\n    />\n    <AddReviewModal\n      v-if=\"isAddReviewModalVisible\"\n      :restaurant-id=\"restaurantIdForNewReview\"\n      :user=\"user\"\n      @close=\"closeAddReviewModal\"\n      @review-added=\"handleReviewAdded\"\n    />\n    <RestaurantReviewsModal\n      v-if=\"isReviewsModalVisible\"\n      :restaurant=\"restaurantForReviews\"\n      :user=\"user\"\n      @close=\"closeReviewsModal\"\n      @reviews-updated=\"handleReviewOrUpdate\"\n    />\n    <div class=\"search-box\">\n      <input type=\"text\" v-model=\"searchQuery\" placeholder=\"Search by name, address, city, state, or zip...\" class=\"search-input\" aria-label=\"Search restaurants\" />\n    </div>\n    <div v-if=\"user\" class=\"add-restaurant-container\">\n      <button @click=\"showAddForm = !showAddForm\" class=\"btn-toggle-add\">\n        {{ showAddForm ? 'Cancel' : 'Add New Restaurant' }}\n      </button>\n      <form v-if=\"showAddForm\" @submit.prevent=\"addNewRestaurant\" class=\"add-restaurant-form\">\n        <h3>Add a New Restaurant</h3>\n        <div class=\"form-group\">\n          <label for=\"new-name\">Name</label>\n          <input id=\"new-name\" type=\"text\" v-model=\"newRestaurant.name\" required />\n        </div>\n        <div class=\"form-group\">\n          <label for=\"new-address\">Address</label>\n          <input id=\"new-address\" type=\"text\" v-model=\"newRestaurant.address\" required />\n        </div>\n        <div class=\"form-group-row\">\n          <div class=\"form-group\"><label for=\"new-city\">City</label><input id=\"new-city\" type=\"text\" v-model=\"newRestaurant.city\" /></div>\n          <div class=\"form-group\"><label for=\"new-state\">State</label><input id=\"new-state\" type=\"text\" v-model=\"newRestaurant.state\" /></div>\n          <div class=\"form-group\"><label for=\"new-zip\">Zip</label><input id=\"new-zip\" type=\"text\" v-model=\"newRestaurant.zip\" /></div>\n        </div>\n        <div class=\"form-group\">\n          <label for=\"new-url\">Website URL</label>\n          <input id=\"new-url\" type=\"url\" v-model=\"newRestaurant.url\" placeholder=\"https://example.com\" />\n        </div>\n        <p v-if=\"addError\" class=\"error-message\">{{ addError }}</p>\n        <button type=\"submit\" :disabled=\"isSaving\" class=\"btn-save\">{{ isSaving ? 'Saving...' : 'Save Restaurant' }}</button>\n      </form>\n    </div>\n    <div v-if=\"loading\" class=\"loading-indicator\">Loading restaurants...</div>\n    <div v-else class=\"restaurant-list-container\">\n      <ul v-if=\"filteredRestaurants.length > 0\" class=\"restaurant-list\">\n        <li v-for=\"restaurant in filteredRestaurants\" :key=\"restaurant.id\" class=\"restaurant-item\">\n          <div class=\"restaurant-details\">\n            <span class=\"restaurant-name\">{{ restaurant.name }}</span>\n            <div class=\"restaurant-meta\">\n              <div v-if=\"restaurant.averageRating > 0\" class=\"rating\" :title=\"`${restaurant.averageRating.toFixed(2)} average rating`\">\n                <StarRating :rating=\"restaurant.averageRating\" />\n                <span class=\"rating-text\">{{ restaurant.averageRating.toFixed(1) }}</span>\n                <span class=\"rating-count\">({{ restaurant.ratingCount }})</span>\n              </div>\n              <span v-if=\"restaurant.distance !== null\" class=\"distance\">{{ restaurant.distance.toFixed(1) }} miles away </span>\n            </div>\n            <span class=\"restaurant-address\">\n              {{ restaurant.address }}<template v-if=\"restaurant.city\">, {{ restaurant.city }}</template><template v-if=\"restaurant.state\">, {{ restaurant.state }}</template><template v-if=\"restaurant.zip\"> {{ restaurant.zip }}</template>\n            </span>\n          </div>\n          <div class=\"restaurant-actions\">\n            <button v-if=\"user\" @click=\"toggleBucketList(restaurant)\" class=\"action-btn\" :class=\"{ 'in-bucket-list': isInBucketList(restaurant.id) }\" :title=\"isInBucketList(restaurant.id) ? 'Remove from Bucket List' : 'Add to Bucket List'\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M18 7h-2.06c-.33-3.2-2.46-5.8-5.94-5.8S4.39 3.8 4.06 7H2v12h16V7zM6.14 7c.2-1.92 1.6-3.48 3.86-3.8A4.002 4.002 0 0 1 14 7h-2.14c-.2-1.92-1.6-3.48-3.86-3.8zM16 17H4v-8h12v8z\"/></svg>\n            </button>\n            <button @click=\"openReviewsModal(restaurant)\" class=\"action-btn\" title=\"View Reviews\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z\"/></svg>\n            </button>\n            <button v-if=\"user\" @click=\"openEditModal(restaurant)\" class=\"action-btn\" title=\"Edit Restaurant\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z\"/></svg>\n            </button>\n            <a :href=\"getDirectionsUrl(restaurant)\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"action-btn\" title=\"Get Directions\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M22.43 10.59l-9.01-9.01c-.75-.75-2.07-.76-2.83 0l-9.01 9.01c-.76.75-.76 2.07 0 2.83l9.01 9.01c.75.75 2.07.75 2.83 0l9.01-9.01c.75-.76.75-2.08 0-2.83zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4z\"/></svg>\n            </a>\n            <a :href=\"getDetailsUrl(restaurant)\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"action-btn\" title=\"View Details on Google\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 5 1.41-1.41L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\"/></svg>\n            </a>\n            <a v-if=\"restaurant.url\" :href=\"getValidUrl(restaurant.url)\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"action-btn\" title=\"Visit Website\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z\"/></svg>\n            </a>\n            <button v-if=\"user\" class=\"check-in-btn\" @click=\"openAddReviewModal(restaurant.id)\">Review</button>\n          </div>\n        </li>\n      </ul>\n      <p v-else class=\"no-restaurants-message\">No restaurants found matching your search.</p>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted, onUnmounted, computed, watch } from 'vue';\nimport { db } from '../firebase';\nimport { collection, getDocs, doc, updateDoc, query, where, addDoc, deleteDoc, serverTimestamp, onSnapshot } from 'firebase/firestore';\nimport StarRating from './StarRating.vue';\nimport EditRestaurantModal from './EditRestaurantModal.vue'; \nimport AddReviewModal from './AddReviewModal.vue';\nimport RestaurantReviewsModal from './RestaurantReviewsModal.vue'; \nimport { getDistance } from '../utils/geolocation.js';\nimport { showToast } from '../utils/toast.js';\n\nexport default {\n  name: 'Restaurants',\n  components: { EditRestaurantModal, StarRating, RestaurantReviewsModal, AddReviewModal },\n  props: {\n    user: {\n      type: Object,\n      default: null\n    }\n  },\n  setup(props) {\n    const restaurants = ref([]);\n    const rawReviews = ref([]);\n    const loading = ref(true);\n    const searchQuery = ref('');\n    const isEditModalVisible = ref(false);\n    const isAddReviewModalVisible = ref(false);\n    const isReviewsModalVisible = ref(false);\n    const restaurantToEdit = ref(null);\n    const restaurantIdForNewReview = ref(null);\n    const restaurantForReviews = ref(null);\n    const userLocation = ref(null);\n    const bucketList = ref(new Set());\n    const showAddForm = ref(false);\n    const newRestaurant = ref({\n      name: '',\n      address: '',\n      city: '',\n      state: '',\n      zip: '',\n      url: ''\n    });\n    const addError = ref('');\n    const isSaving = ref(false);\n    let bucketListUnsubscribe = () => {};\n    let restaurantsUnsubscribe = () => {};\n    let reviewsUnsubscribe = () => {};\n\n    const restaurantsWithRatings = computed(() => {\n      const ratings = {};\n      rawReviews.value.forEach(review => {\n        if (review.restaurantId && typeof review.rating === 'number') {\n          if (!ratings[review.restaurantId]) {\n            ratings[review.restaurantId] = { total: 0, count: 0, reviews: [] };\n          }\n          ratings[review.restaurantId].total += review.rating;\n          ratings[review.restaurantId].count++;\n          ratings[review.restaurantId].reviews.push(review);\n        }\n      });\n\n      return restaurants.value.map(restaurantDoc => {\n        const ratingInfo = ratings[restaurantDoc.id];\n        const sortedReviews = ratingInfo ? ratingInfo.reviews.sort((a, b) => (b.createdAt?.seconds ?? 0) - (a.createdAt?.seconds ?? 0)) : [];\n        return {\n          ...restaurantDoc,\n          averageRating: ratingInfo ? ratingInfo.total / ratingInfo.count : 0,\n          ratingCount: ratingInfo ? ratingInfo.count : 0,\n          reviews: sortedReviews,\n        };\n      });\n    });\n\n\n    onMounted(() => {\n      loading.value = true;\n      \n      const restaurantsQuery = collection(db, 'restaurants');\n      restaurantsUnsubscribe = onSnapshot(restaurantsQuery, (snapshot) => {\n        restaurants.value = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n        // If reviews are already loaded, we can stop loading. Otherwise, wait for reviews.\n        if (rawReviews.value.length > 0) {\n          loading.value = false;\n        }\n      }, (error) => {\n        console.error(\"Error fetching restaurants:\", error);\n        loading.value = false;\n      });\n\n      const reviewsQuery = collection(db, 'reviews');\n      reviewsUnsubscribe = onSnapshot(reviewsQuery, (snapshot) => {\n        rawReviews.value = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n        loading.value = false; // Data is ready to be computed and displayed\n      }, (error) => {\n        console.error(\"Error fetching reviews:\", error);\n        loading.value = false;\n      });\n\n      if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(position => {\n          userLocation.value = {\n            lat: position.coords.latitude,\n            lng: position.coords.longitude\n          };\n        }, (error) => {\n          console.error(\"Error getting location\", error);\n        });\n      } else {\n        console.error(\"Geolocation is not supported by this browser.\");\n      }\n    });\n\n    onUnmounted(() => {\n      bucketListUnsubscribe();\n      restaurantsUnsubscribe();\n      reviewsUnsubscribe();\n    });\n\n    const subscribeToBucketList = (userId) => {\n      bucketListUnsubscribe();\n      const q = query(collection(db, 'bucketListItems'), where('userId', '==', userId));\n      bucketListUnsubscribe = onSnapshot(q, (snapshot) => {\n        const newBucketList = new Set();\n        snapshot.forEach(doc => newBucketList.add(doc.data().restaurantId));\n        bucketList.value = newBucketList;\n      });\n    };\n\n    watch(() => props.user, (newUser) => {\n      if (newUser) {\n        subscribeToBucketList(newUser.uid);\n      } else {\n        bucketListUnsubscribe();\n        bucketList.value.clear();\n      }\n    }, { immediate: true });\n\n    const restaurantsWithDistance = computed(() => {\n      return restaurantsWithRatings.value.map(r => {\n        const distance = userLocation.value && r.location ? getDistance(userLocation.value.lat, userLocation.value.lng, r.location.lat, r.location.lng) : null;\n        return { ...r, distance };\n      }).sort((a, b) => {\n        if (a.distance === null) return 1;\n        if (b.distance === null) return -1;\n        return a.distance - b.distance;\n      });\n    });\n\n    const filteredRestaurants = computed(() => {\n      if (!searchQuery.value.trim()) {\n        return restaurantsWithDistance.value;\n      }\n      const lowerCaseQuery = searchQuery.value.toLowerCase();\n      return restaurantsWithDistance.value.filter(r =>\n        (r.name && r.name.toLowerCase().includes(lowerCaseQuery)) ||\n        (r.address && r.address.toLowerCase().includes(lowerCaseQuery)) ||\n        (r.city && r.city.toLowerCase().includes(lowerCaseQuery)) ||\n        (r.state && r.state.toLowerCase().includes(lowerCaseQuery)) ||\n        (r.zip && r.zip.toLowerCase().includes(lowerCaseQuery))\n      );\n    });\n\n    const getDirectionsUrl = (restaurant) => {\n      const destination = encodeURIComponent(`${restaurant.name}, ${restaurant.address}`);\n      return `https://www.google.com/maps/dir/?api=1&destination=${destination}`;\n    };\n\n    const getDetailsUrl = (restaurant) => {\n      const query = encodeURIComponent(`${restaurant.name}, ${restaurant.address}`);\n      return `https://www.google.com/search?q=${query}`;\n    };\n\n    const getValidUrl = (url) => {\n      if (!url) return '#';\n      if (url.startsWith('http://') || url.startsWith('https://')) {\n        return url;\n      }\n      return `https://${url}`;\n    };\n\n    const openEditModal = (restaurant) => {\n      restaurantToEdit.value = restaurant;\n      isEditModalVisible.value = true;\n    };\n\n    const closeEditModal = () => {\n      isEditModalVisible.value = false;\n      restaurantToEdit.value = null;\n    };\n\n    const openReviewsModal = (restaurant) => {\n      restaurantForReviews.value = restaurant;\n      isReviewsModalVisible.value = true;\n    };\n\n    const closeReviewsModal = () => {\n      isReviewsModalVisible.value = false;\n      restaurantForReviews.value = null;\n    };\n    \n    const openAddReviewModal = (restaurantId) => {\n      restaurantIdForNewReview.value = restaurantId;\n      isAddReviewModalVisible.value = true;\n    };\n\n    const closeAddReviewModal = () => {\n      isAddReviewModalVisible.value = false;\n      restaurantIdForNewReview.value = null;\n    };\n\n    const handleReviewAdded = async (restaurantId) => {\n      closeAddReviewModal();\n    };\n\n    const handleReviewOrUpdate = async () => {\n      // This is now handled automatically by the real-time listeners.\n      // We can keep the function in case the modal needs to be closed or other UI logic is added.\n    };\n\n    const saveRestaurantChanges = async (updatedData) => {\n      const updatedRestaurant = { ...updatedData };\n      if (!updatedRestaurant || !updatedRestaurant.id) return;\n\n      const original = restaurantToEdit.value;\n      const dataToSave = {};\n\n      const nameChanged = original.name !== updatedRestaurant.name;\n      if (nameChanged) {\n        dataToSave.name = updatedRestaurant.name;\n        dataToSave.name_lowercase = updatedRestaurant.name.trim().toLowerCase();\n      }\n\n      const addressParts = ['address', 'city', 'state', 'zip'];\n      const addressChanged = addressParts.some(part => original[part] !== updatedRestaurant[part]);\n\n      if (addressChanged) {\n        dataToSave.address = updatedRestaurant.address;\n        dataToSave.city = updatedRestaurant.city;\n        dataToSave.state = updatedRestaurant.state;\n        dataToSave.zip = updatedRestaurant.zip;\n        dataToSave.address_lowercase = (updatedRestaurant.address || '').trim().toLowerCase();\n        \n        const fullAddress = [updatedRestaurant.address, updatedRestaurant.city, updatedRestaurant.state, updatedRestaurant.zip].filter(Boolean).join(', ');\n        const { geocodeAddress } = await import('../utils/geocoding.js');\n        const location = await geocodeAddress(fullAddress);\n        if (location) {\n          dataToSave.location = location;\n        } else {\n          showToast(\"Could not find a location for the provided address. The restaurant will be saved without a location.\", 'warning', 5000);\n          dataToSave.location = null;\n        }\n      }\n\n      if (original.url !== updatedRestaurant.url) {\n        dataToSave.url = updatedRestaurant.url;\n      }\n\n      if (Object.keys(dataToSave).length === 0) {\n        closeEditModal();\n        return;\n      }\n\n      const restaurantRef = doc(db, 'restaurants', updatedRestaurant.id);\n      try {\n        await updateDoc(restaurantRef, dataToSave);\n        closeEditModal();\n      } catch (error) {\n        console.error(\"Error updating restaurant: \", error);\n        showToast(\"Failed to save changes. Please try again.\", 'error');\n      }\n    };\n\n    const addNewRestaurant = async () => {\n      if (!props.user) {\n        addError.value = \"You must be logged in to add a restaurant.\";\n        return;\n      }\n      if (!newRestaurant.value.name.trim() || !newRestaurant.value.address.trim()) {\n        addError.value = 'Restaurant name and address are required.';\n        return;\n      }\n      isSaving.value = true;\n      addError.value = '';\n      const normalizedName = newRestaurant.value.name.trim().toLowerCase();\n      const normalizedAddress = newRestaurant.value.address.trim().toLowerCase();\n      try {\n        const q = query(collection(db, 'restaurants'), where('name_lowercase', '==', normalizedName), where('address_lowercase', '==', normalizedAddress));\n        const querySnapshot = await getDocs(q);\n        if (!querySnapshot.empty) {\n          addError.value = 'This restaurant already exists.';\n          isSaving.value = false;\n          return;\n        }\n        const fullAddress = [newRestaurant.value.address, newRestaurant.value.city, newRestaurant.value.state, newRestaurant.value.zip].filter(Boolean).join(', ');\n        const { geocodeAddress } = await import('../utils/geocoding.js');\n        const location = await geocodeAddress(fullAddress);\n        if (!location) {\n          addError.value = \"Could not find a location for the provided address. Please check the address and try again.\";\n          isSaving.value = false;\n          return;\n        }\n        const docData = {\n          name: newRestaurant.value.name.trim(),\n          address: newRestaurant.value.address.trim(),\n          city: newRestaurant.value.city.trim(),\n          state: newRestaurant.value.state.trim(),\n          zip: newRestaurant.value.zip.trim(),\n          url: newRestaurant.value.url.trim(),\n          name_lowercase: normalizedName,\n          address_lowercase: normalizedAddress,\n          location,\n          createdAt: serverTimestamp(),\n          userId: props.user.uid,\n          userDisplayName: props.user.displayName || 'Anonymous'\n        };\n        const docRef = await addDoc(collection(db, 'restaurants'), docData);\n        showAddForm.value = false;\n        newRestaurant.value = { name: '', address: '', city: '', state: '', zip: '', url: '' };\n      } catch (error) {\n        console.error(\"Error adding new restaurant:\", error);\n        addError.value = 'Failed to add restaurant. Please try again.';\n      } finally {\n        isSaving.value = false;\n      }\n    };\n\n    const isInBucketList = (restaurantId) => {\n      return bucketList.value.has(restaurantId);\n    };\n\n    const toggleBucketList = async (restaurant) => {\n      const currentUser = props.user;\n      if (!currentUser) return;\n\n      if (isInBucketList(restaurant.id)) {\n        const q = query(collection(db, 'bucketListItems'), where('userId', '==', currentUser.uid), where('restaurantId', '==', restaurant.id));\n        const snapshot = await getDocs(q);\n        snapshot.forEach(doc => deleteDoc(doc.ref));\n      } else {\n        await addDoc(collection(db, 'bucketListItems'), {\n          userId: currentUser.uid,\n          restaurantId: restaurant.id,\n          createdAt: serverTimestamp()\n        });\n      }\n    };\n\n    return {\n      user: props.user,\n      loading,\n      searchQuery,\n      filteredRestaurants,\n      getDirectionsUrl,\n      getDetailsUrl,\n      getValidUrl,\n      isEditModalVisible,\n      restaurantToEdit,\n      isReviewsModalVisible,\n      restaurantForReviews,\n      openEditModal,\n      closeEditModal,\n      saveRestaurantChanges,\n      openReviewsModal,\n      closeReviewsModal,\n      handleReviewOrUpdate,\n      isInBucketList,\n      toggleBucketList,\n      showAddForm,\n      newRestaurant,\n      addNewRestaurant,\n      addError,\n      isSaving,\n      isAddReviewModalVisible,\n      restaurantIdForNewReview,\n      openAddReviewModal,\n      closeAddReviewModal,\n      handleReviewAdded\n    };\n  }\n};\n</script>\n\n<style scoped>\n.search-box {\n  margin-bottom: 2em;\n}\n.search-input {\n  width: 100%;\n  padding: 12px;\n  border-radius: 8px;\n  border: 1px solid #ddd;\n  font-size: 1em;\n}\n.add-restaurant-container {\n  background: var(--card-background);\n  border-radius: 12px;\n  padding: 1.5em;\n  margin-bottom: 2em;\n  box-shadow: 0 4px 15px var(--shadow-color);\n}\n.btn-toggle-add {\n  background-color: var(--primary-color);\n  color: white;\n  border: none;\n  padding: 10px 20px;\n  border-radius: 8px;\n  cursor: pointer;\n  font-weight: 600;\n  width: 100%;\n}\n.add-restaurant-form {\n  margin-top: 1.5em;\n  border-top: 1px solid #eee;\n  padding-top: 1.5em;\n}\n.add-restaurant-form h3 {\n  margin-top: 0;\n  margin-bottom: 1em;\n}\n.form-group {\n  margin-bottom: 1em;\n}\n.form-group-row {\n  display: flex;\n  gap: 1em;\n}\n.form-group-row .form-group {\n  flex: 1;\n}\n.form-group label {\n  display: block;\n  margin-bottom: 0.5em;\n  font-weight: 600;\n}\n.form-group input {\n  width: 100%;\n  padding: 10px;\n  border-radius: 8px;\n  border: 1px solid #ccc;\n  box-sizing: border-box;\n}\n.loading-indicator, .no-restaurants-message {\n  text-align: center;\n  color: #777;\n  padding: 3em;\n}\n.restaurant-list {\n  list-style: none;\n  padding: 0;\n  margin: 0;\n}\n.restaurant-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1.5em;\n  background: var(--card-background);\n  border-radius: 12px;\n  box-shadow: 0 4px 15px var(--shadow-color);\n  margin-bottom: 1.5em;\n}\n.restaurant-details {\n  display: flex;\n  flex-direction: column;\n}\n.restaurant-name {\n  font-weight: 600;\n  font-size: 1.2em;\n  margin-bottom: 0.25em;\n  word-break: break-word;\n}\n.restaurant-meta {\n  display: flex;\n  align-items: center;\n  flex-wrap: wrap;\n  gap: 1em;\n  margin-bottom: 0.5em;\n  color: #555;\n  font-size: 0.9em;\n}\n.rating {\n  display: flex;\n  align-items: center;\n  gap: 0.25em;\n}\n.rating-text {\n  font-weight: bold;\n  margin-left: 0.25em;\n}\n.rating-count {\n  color: #777;\n}\n.distance {\n  font-style: italic;\n}\n.restaurant-address {\n  color: #777;\n  font-size: 0.9em;\n  word-break: break-word;\n}\n.restaurant-actions {\n  display: flex;\n  gap: 0.75em;\n}\n.action-btn, .check-in-btn {\n  background: none;\n  border: 1px solid #ccc;\n  border-radius: 8px;\n  padding: 8px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s;\n  color: #555;\n}\n.action-btn:hover {\n  background-color: #f0f0f0;\n  border-color: #bbb;\n}\n.action-btn svg {\n  width: 20px;\n  height: 20px;\n}\n.check-in-btn {\n  background-color: var(--primary-color);\n  color: white;\n  border-color: var(--primary-color);\n  padding: 8px 16px;\n  font-weight: 600;\n}\n.check-in-btn:hover {\n  background-color: var(--primary-dark-color);\n}\n.btn-save {\n  background-color: #27ae60;\n  color: white;\n  border: none;\n  padding: 10px 20px;\n  border-radius: 8px;\n  cursor: pointer;\n  font-weight: 600;\n}\n.btn-save:disabled {\n  background-color: #bdc3c7;\n  cursor: not-allowed;\n}\n.error-message {\n  color: #e74c3c;\n  margin-top: 1em;\n}\n\n.in-bucket-list {\n  color: var(--primary-color) !important;\n}\n\n@media (max-width: 768px) {\n  .restaurant-item {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 1em;\n  }\n  .restaurant-actions {\n    width: 100%;\n    flex-wrap: wrap;\n    gap: 0.5em;\n  }\n  .restaurant-actions .action-btn,\n  .restaurant-actions .check-in-btn {\n    flex-grow: 1;\n    justify-content: center;\n  }\n}\n</style>","<template>\r\n  <div class=\"modal-overlay\" @click.self=\"$emit('close')\">\r\n    <div class=\"modal-content\">\r\n      <h2>Edit Restaurant</h2>\r\n      <form @submit.prevent=\"onSave\" v-if=\"editableRestaurant\">\r\n        <div class=\"form-group\">\r\n          <label for=\"name\">Name</label>\r\n          <input id=\"name\" v-model=\"editableRestaurant.name\" type=\"text\" required>\r\n        </div>\r\n        <div class=\"form-group\">\r\n          <label for=\"address\">Address</label>\r\n          <input id=\"address\" v-model=\"editableRestaurant.address\" type=\"text\">\r\n        </div>\r\n        <div class=\"form-group\">\r\n          <label for=\"city\">City</label>\r\n          <input id=\"city\" v-model=\"editableRestaurant.city\" type=\"text\">\r\n        </div>\r\n        <div class=\"form-group\">\r\n          <label for=\"state\">State</label>\r\n          <input id=\"state\" v-model=\"editableRestaurant.state\" type=\"text\">\r\n        </div>\r\n        <div class=\"form-group\">\r\n          <label for=\"zip\">Zip Code</label>\r\n          <input id=\"zip\" v-model=\"editableRestaurant.zip\" type=\"text\">\r\n        </div>\r\n        <div class=\"form-group\">\r\n          <label for=\"url\">Website URL</label>\r\n          <input id=\"url\" v-model=\"editableRestaurant.url\" type=\"url\" placeholder=\"https://example.com\">\r\n        </div>\r\n        <div class=\"modal-actions\">\r\n          <button type=\"button\" class=\"btn-cancel\" @click=\"$emit('close')\">Cancel</button>\r\n          <button type=\"submit\" class=\"btn-save\">Save Changes</button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, watch } from 'vue';\r\n\r\nexport default {\r\n  name: 'EditRestaurantModal',\r\n  props: {\r\n    restaurant: {\r\n      type: Object,\r\n      required: true\r\n    }\r\n  },\r\n  emits: ['close', 'save'],\r\n  setup(props, { emit }) {\r\n    const editableRestaurant = ref(null);\r\n\r\n    watch(() => props.restaurant, (newVal) => {\r\n      if (newVal) {\r\n        // Create a deep copy to avoid mutating the prop directly\r\n        editableRestaurant.value = JSON.parse(JSON.stringify(newVal));\r\n      }\r\n    }, { immediate: true, deep: true });\r\n\r\n    const onSave = () => {\r\n      emit('save', editableRestaurant.value);\r\n    };\r\n\r\n    return {\r\n      editableRestaurant,\r\n      onSave\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.modal-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: rgba(0, 0, 0, 0.6);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 1000;\r\n}\r\n.modal-content {\r\n  background: var(--card-background);\r\n  padding: 2em;\r\n  border-radius: 12px;\r\n  width: 90%;\r\n  max-width: 500px;\r\n  box-shadow: 0 5px 15px rgba(0,0,0,0.3);\r\n}\r\n.form-group {\r\n  margin-bottom: 1.5em;\r\n}\r\n.form-group label {\r\n  display: block;\r\n  margin-bottom: 0.5em;\r\n  font-weight: 600;\r\n}\r\n.form-group input {\r\n  width: 100%;\r\n  padding: 10px;\r\n  border-radius: 8px;\r\n  border: 1px solid #ccc;\r\n  box-sizing: border-box;\r\n}\r\n.modal-actions {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  gap: 1em;\r\n  margin-top: 2em;\r\n}\r\n.modal-actions button {\r\n  padding: 10px 20px;\r\n  border-radius: 8px;\r\n  border: none;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n}\r\n.btn-save {\r\n  background-color: var(--primary-color);\r\n  color: white;\r\n}\r\n.btn-cancel {\r\n  background-color: #ecf0f1;\r\n  color: var(--secondary-color);\r\n}\r\n</style>","import { render } from \"./EditRestaurantModal.vue?vue&type=template&id=2288406c&scoped=true\"\nimport script from \"./EditRestaurantModal.vue?vue&type=script&lang=js\"\nexport * from \"./EditRestaurantModal.vue?vue&type=script&lang=js\"\n\nimport \"./EditRestaurantModal.vue?vue&type=style&index=0&id=2288406c&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2288406c\"]])\n\nexport default __exports__","<template>\n  <div class=\"modal-overlay\" @click.self=\"$emit('close')\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h2>Add Your Review</h2>\n        <button @click=\"$emit('close')\" class=\"close-btn\" :disabled=\"isUploading\">&times;</button>\n      </div>\n      <div class=\"modal-body\">\n        <form @submit.prevent=\"submitReview\">\n          <div class=\"form-group\">\n            <label>Your Rating</label>\n            <StarRating :rating=\"review.rating\" :editable=\"true\" @update:rating=\"newVal => review.rating = newVal\" />\n          </div>\n          <div class=\"form-group\">\n            <label for=\"review-text\">Your Review</label>\n            <textarea id=\"review-text\" v-model=\"review.text\" placeholder=\"What did you think?\"></textarea>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"review-photo\">Add a Photo</label>\n            <input type=\"file\" id=\"review-photo\" @change=\"handleFileChange\" accept=\"image/*\" />\n            <div v-if=\"photoPreview\" class=\"photo-preview-container\">\n              <img :src=\"photoPreview\" alt=\"Photo preview\" class=\"photo-preview\" />\n            </div>\n          </div>\n          <div v-if=\"isUploading\" class=\"upload-progress\">\n            <p>Uploading... {{ uploadProgress.toFixed(0) }}%</p>\n            <progress :value=\"uploadProgress\" max=\"100\"></progress>\n          </div>\n          <div v-if=\"error\" class=\"error-message\">{{ error }}</div>\n          <div class=\"form-actions\">\n            <button type=\"submit\" class=\"btn-primary\" :disabled=\"isUploading || review.rating === 0\">\n              {{ isUploading ? 'Submitting...' : 'Submit Review' }}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref } from 'vue';\nimport { db, storage } from '../firebase';\nimport { collection, addDoc, serverTimestamp, doc, updateDoc, increment } from 'firebase/firestore';\nimport { ref as storageRef, uploadBytesResumable, getDownloadURL } from 'firebase/storage';\nimport StarRating from './StarRating.vue';\nimport { showToast } from '../utils/toast.js';\n\nexport default {\n  name: 'AddReviewModal',\n  components: { StarRating },\n  props: {\n    restaurantId: { type: String, required: true },\n    user: { type: Object, required: true }\n  },\n  emits: ['close', 'review-added'],\n  setup(props, { emit }) {\n    const review = ref({ rating: 0, text: '' });\n    const photoFile = ref(null);\n    const photoPreview = ref(null);\n    const isUploading = ref(false);\n    const uploadProgress = ref(0);\n    const error = ref('');\n\n    const handleFileChange = (event) => {\n      const file = event.target.files[0];\n      if (!file) {\n        photoFile.value = null;\n        photoPreview.value = null;\n        return;\n      }\n      if (!file.type.startsWith('image/')) {\n        error.value = 'Please select an image file.';\n        return;\n      }\n      photoPreview.value = URL.createObjectURL(file);\n\n      // Image resizing logic\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        const img = new Image();\n        img.onload = () => {\n          const MAX_DIMENSION = 1024;\n          let { width, height } = img;\n\n          if (width > height) {\n            if (width > MAX_DIMENSION) {\n              height *= MAX_DIMENSION / width;\n              width = MAX_DIMENSION;\n            }\n          } else {\n            if (height > MAX_DIMENSION) {\n              width *= MAX_DIMENSION / height;\n              height = MAX_DIMENSION;\n            }\n          }\n\n          const canvas = document.createElement('canvas');\n          canvas.width = width;\n          canvas.height = height;\n          const ctx = canvas.getContext('2d');\n          ctx.drawImage(img, 0, 0, width, height);\n\n          canvas.toBlob((blob) => {\n            photoFile.value = blob;\n          }, file.type, 0.9); // Compress JPEG to 90% quality\n        };\n        img.src = e.target.result;\n      };\n      reader.readAsDataURL(file);\n    };\n\n    const submitReview = async () => {\n      if (review.value.rating === 0) {\n        error.value = \"Please provide a star rating.\";\n        return;\n      }\n      isUploading.value = true;\n      error.value = '';\n\n      try {\n        let photoURL = null;\n        if (photoFile.value) {\n          const filePath = `reviews/${props.restaurantId}/${Date.now()}_${props.user.uid}`;\n          const fileRef = storageRef(storage, filePath);\n          const uploadTask = uploadBytesResumable(fileRef, photoFile.value);\n\n          await new Promise((resolve, reject) => {\n            uploadTask.on('state_changed',\n              (snapshot) => {\n                uploadProgress.value = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\n              },\n              (uploadError) => {\n                console.error(\"Upload failed:\", uploadError);\n                error.value = \"Image upload failed. Please try again.\";\n                isUploading.value = false;\n                reject(uploadError);\n              },\n              async () => {\n                photoURL = await getDownloadURL(uploadTask.snapshot.ref);\n                resolve();\n              }\n            );\n          });\n        }\n\n        const timestamp = serverTimestamp();\n        const reviewData = {\n          userId: props.user.uid,\n          userName: props.user.displayName || 'Anonymous',\n          userPhoto: props.user.photoURL,\n          restaurantId: props.restaurantId,\n          rating: review.value.rating,\n          text: review.value.text,\n          photoURL: photoURL,\n          tags: [], // AddReviewModal doesn't support tags yet\n          createdAt: timestamp,\n          lastActivityAt: timestamp\n        };\n\n        await addDoc(collection(db, 'reviews'), reviewData);\n        \n        // Update the user's reviewCount atomically\n        // Using increment() ensures thread-safe updates and handles the case where reviewCount doesn't exist yet\n        const userRef = doc(db, 'users', props.user.uid);\n        try {\n          await updateDoc(userRef, { reviewCount: increment(1) });\n        } catch (countError) {\n          console.warn(\"Failed to update reviewCount (non-critical):\", countError);\n        }\n        \n        showToast('Review added successfully!', 'success', 2000);\n        emit('review-added', props.restaurantId);\n      } catch (e) {\n        if (!error.value) { // Don't overwrite upload-specific error\n          console.error(\"Error submitting review:\", e);\n          error.value = \"Failed to submit review. Please try again.\";\n          showToast(\"Failed to submit review. Please try again.\", 'error');\n        }\n        isUploading.value = false;\n      }\n    };\n\n    return { review, photoPreview, isUploading, uploadProgress, error, handleFileChange, submitReview };\n  }\n};\n</script>\n\n<style scoped>\n.modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.6); display: flex; justify-content: center; align-items: center; z-index: 1000; }\n.modal-content { background: var(--card-background); padding: 2em; border-radius: 12px; width: 90%; max-width: 500px; max-height: 90vh; display: flex; flex-direction: column; box-shadow: 0 5px 20px rgba(0,0,0,0.3); }\n.modal-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #eee; padding-bottom: 1em; margin-bottom: 1em; }\n.modal-header h2 { margin: 0; }\n.close-btn { background: none; border: none; font-size: 2em; cursor: pointer; color: #777; }\n.modal-body { overflow-y: auto; }\n.form-group { margin-bottom: 1.5em; }\n.form-group label { display: block; margin-bottom: 0.5em; font-weight: 600; }\n.form-group textarea { width: 100%; min-height: 100px; border: 1px solid #ccc; border-radius: 8px; padding: 10px; font-family: inherit; }\n.form-group input[type=\"file\"] { width: 100%; }\n.photo-preview-container { margin-top: 1em; }\n.photo-preview { max-width: 100%; max-height: 200px; border-radius: 8px; }\n.upload-progress { margin-top: 1em; }\n.upload-progress progress { width: 100%; }\n.error-message { color: #e74c3c; margin-bottom: 1em; }\n.form-actions { display: flex; justify-content: flex-end; }\n.btn-primary { background-color: var(--primary-color); color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; }\n.btn-primary:disabled { background-color: #bdc3c7; cursor: not-allowed; }\n</style>","import { render } from \"./AddReviewModal.vue?vue&type=template&id=b8084282&scoped=true\"\nimport script from \"./AddReviewModal.vue?vue&type=script&lang=js\"\nexport * from \"./AddReviewModal.vue?vue&type=script&lang=js\"\n\nimport \"./AddReviewModal.vue?vue&type=style&index=0&id=b8084282&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-b8084282\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"modal-overlay\" @click.self=\"$emit('close')\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h2>Reviews for {{ restaurant.name }}</h2>\r\n        <button @click=\"$emit('close')\" class=\"close-btn\">&times;</button>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <div v-if=\"restaurant.reviews && restaurant.reviews.length === 0\" class=\"no-reviews-message\">\r\n          No reviews yet for this restaurant.\r\n        </div>\r\n        <ul v-else class=\"reviews-list\">\r\n          <li v-for=\"review in restaurant.reviews\" :key=\"review.id\" class=\"review-item\">\r\n            <div v-if=\"editingReview && editingReview.id === review.id\">\r\n              <!-- Edit Form -->\r\n              <div class=\"edit-review-form\">\r\n                <StarRating :rating=\"editingReview.rating\" :editable=\"true\" @update:rating=\"newVal => editingReview.rating = newVal\" />\r\n                <textarea v-model=\"editingReview.text\" class=\"edit-textarea\"></textarea>\r\n                <div class=\"edit-actions\">\r\n                  <button @click=\"saveEdit\" class=\"btn-primary\">Save</button>\r\n                  <button @click=\"cancelEdit\" class=\"btn-secondary\">Cancel</button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div v-else>\r\n              <!-- Display Review -->\r\n              <div class=\"review-header\">\r\n                <img :src=\"review.userPhoto || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" alt=\"User\" class=\"user-avatar\" />\r\n                <div class=\"user-info\">\r\n                  <span class=\"user-name\">{{ review.userName }}</span>\r\n                  <span class=\"review-date\">{{ formatDate(review.createdAt) }}</span>\r\n                </div>\r\n                <div class=\"review-actions\" v-if=\"user && user.uid === review.userId\">\r\n                  <button @click=\"startEditing(review)\" class=\"action-btn\" title=\"Edit Review\">\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"18px\" viewBox=\"0 0 24 24\" width=\"18px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z\"/></svg>\r\n                  </button>\r\n                  <button @click=\"deleteReview(review.id)\" class=\"action-btn\" title=\"Delete Review\">\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"18px\" viewBox=\"0 0 24 24\" width=\"18px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z\"/></svg>\r\n                  </button>\r\n                </div>\r\n              </div>\r\n              <div class=\"review-body\">\r\n                <StarRating :rating=\"review.rating\" />\r\n                <p v-if=\"review.text\" class=\"review-text\">\"{{ review.text }}\"</p>\r\n                <div v-if=\"review.photoURL\" class=\"review-photo-container\">\r\n                  <img :src=\"review.photoURL\" alt=\"Review photo\" class=\"review-photo\" loading=\"lazy\" />\r\n                </div>\r\n                <div v-if=\"review.tags && review.tags.length > 0\" class=\"tags-container\">\r\n                  <span v-for=\"tag in review.tags\" :key=\"tag\" class=\"tag\">{{ tag }}</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref } from 'vue';\r\nimport { db } from '../firebase';\r\nimport { doc, updateDoc, deleteDoc } from 'firebase/firestore';\r\nimport StarRating from './StarRating.vue';\r\nimport { showToast } from '../utils/toast.js';\r\n\r\nexport default {\r\n  name: 'RestaurantReviewsModal',\r\n  components: { StarRating },\r\n  props: {\r\n    restaurant: {\r\n      type: Object,\r\n      required: true\r\n    },\r\n    user: {\r\n      type: Object,\r\n      default: null\r\n    }\r\n  },\r\n  emits: ['close', 'reviews-updated'],\r\n  setup(props, { emit }) {\r\n    const editingReview = ref(null);\r\n\r\n    const formatDate = (timestamp) => {\r\n      if (!timestamp || !timestamp.toDate) return '';\r\n      return timestamp.toDate().toLocaleDateString();\r\n    };\r\n\r\n    const startEditing = (review) => {\r\n      editingReview.value = JSON.parse(JSON.stringify(review));\r\n    };\r\n\r\n    const cancelEdit = () => {\r\n      editingReview.value = null;\r\n    };\r\n\r\n    const saveEdit = async () => {\r\n      if (!editingReview.value) return;\r\n      const reviewRef = doc(db, 'reviews', editingReview.value.id);\r\n      try {\r\n        await updateDoc(reviewRef, {\r\n          rating: editingReview.value.rating,\r\n          text: editingReview.value.text\r\n        });\r\n        emit('reviews-updated');\r\n        cancelEdit();\r\n        showToast('Review updated successfully!', 'success');\r\n      } catch (error) {\r\n        console.error(\"Error updating review:\", error);\r\n        showToast(\"Failed to save review. Please try again.\", 'error');\r\n      }\r\n    };\r\n\r\n    const deleteReview = async (reviewId) => {\r\n      if (confirm(\"Are you sure you want to delete this review?\")) {\r\n        try {\r\n          await deleteDoc(doc(db, 'reviews', reviewId));\r\n          emit('reviews-updated');\r\n          showToast('Review deleted successfully', 'success');\r\n        } catch (error) {\r\n          console.error(\"Error deleting review:\", error);\r\n          showToast(\"Failed to delete review. Please try again.\", 'error');\r\n        }\r\n      }\r\n    };\r\n\r\n    return {\r\n      formatDate,\r\n      editingReview,\r\n      startEditing,\r\n      cancelEdit,\r\n      saveEdit,\r\n      deleteReview\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.6); display: flex; justify-content: center; align-items: center; z-index: 1000; }\r\n.modal-content { background: var(--card-background); padding: 2em; border-radius: 12px; width: 90%; max-width: 700px; max-height: 90vh; display: flex; flex-direction: column; box-shadow: 0 5px 20px rgba(0,0,0,0.3); }\r\n.modal-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #eee; padding-bottom: 1em; margin-bottom: 1em; }\r\n.modal-header h2 { margin: 0; }\r\n.close-btn { background: none; border: none; font-size: 2em; cursor: pointer; color: #777; }\r\n.modal-body { overflow-y: auto; }\r\n.loading-indicator, .no-reviews-message { text-align: center; color: #777; padding: 3em; }\r\n.reviews-list { list-style: none; padding: 0; margin: 0; }\r\n.review-item { border-bottom: 1px solid #eee; padding: 1.5em 0; }\r\n.review-item:last-child { border-bottom: none; }\r\n.review-header { display: flex; align-items: center; gap: 1em; margin-bottom: 1em; position: relative; }\r\n.user-avatar { width: 40px; height: 40px; border-radius: 50%; }\r\n.user-info { display: flex; flex-direction: column; }\r\n.user-name { font-weight: 600; }\r\n.review-date { font-size: 0.85em; color: #777; }\r\n.review-body { padding-left: 50px; }\r\n.review-text { margin: 0.5em 0; font-style: italic; }\r\n.review-photo-container { margin-top: 1em; }\r\n.review-photo { max-width: 100%; max-height: 300px; border-radius: 8px; }\r\n.tags-container { margin-top: 1em; display: flex; flex-wrap: wrap; gap: 0.5em; }\r\n.tag { background-color: #ecf0f1; color: var(--secondary-color); padding: 4px 10px; border-radius: 15px; font-size: 0.85em; }\r\n.review-actions { margin-left: auto; display: flex; gap: 0.5em; }\r\n.action-btn { background: none; border: none; cursor: pointer; color: #777; padding: 4px; }\r\n.action-btn:hover { color: #333; }\r\n.edit-review-form { display: flex; flex-direction: column; gap: 1em; }\r\n.edit-textarea { width: 100%; min-height: 80px; border: 1px solid #ccc; border-radius: 8px; padding: 10px; font-family: inherit; }\r\n.edit-actions { display: flex; justify-content: flex-end; gap: 0.5em; }\r\n.btn-primary {\r\n  background-color: var(--primary-color);\r\n  color: white;\r\n  border: none;\r\n  padding: 8px 16px;\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n}\r\n.btn-secondary {\r\n  background-color: #ecf0f1;\r\n  color: #34495e;\r\n  border: none;\r\n  padding: 8px 16px;\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n}\r\n</style>","import { render } from \"./RestaurantReviewsModal.vue?vue&type=template&id=6bcdd790&scoped=true\"\nimport script from \"./RestaurantReviewsModal.vue?vue&type=script&lang=js\"\nexport * from \"./RestaurantReviewsModal.vue?vue&type=script&lang=js\"\n\nimport \"./RestaurantReviewsModal.vue?vue&type=style&index=0&id=6bcdd790&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-6bcdd790\"]])\n\nexport default __exports__","import { render } from \"./Restaurants.vue?vue&type=template&id=14b51ebe&scoped=true\"\nimport script from \"./Restaurants.vue?vue&type=script&lang=js\"\nexport * from \"./Restaurants.vue?vue&type=script&lang=js\"\n\nimport \"./Restaurants.vue?vue&type=style&index=0&id=14b51ebe&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-14b51ebe\"]])\n\nexport default __exports__","<template>\n  <UserReviewsModal v-if=\"isReviewsModalVisible\" :user=\"userForReviews\" @close=\"closeReviewsModal\" />\n  <div class=\"user-search-page\">\n    <div class=\"search-box\">\n      <input type=\"text\" v-model=\"searchQuery\" placeholder=\"Search for users by name...\" class=\"search-input\">\n    </div>\n\n    <div v-if=\"loading\">Loading users...</div>\n    <div v-else>\n      <div v-if=\"filteredUsers.length === 0\" class=\"no-users-message\">\n        <div v-if=\"searchQuery\">\n          <h3>No users found</h3>\n          <p>Try adjusting your search terms or check out the Leaderboard to find active reviewers.</p>\n        </div>\n        <div v-else>\n          <h3>No other users yet</h3>\n          <p>Be the first to share reviews! Create your first review and invite others to join.</p>\n        </div>\n      </div>\n      <div v-for=\"user in filteredUsers\" :key=\"user.uid\" class=\"user-card\">\n        <div class=\"user-card-content\">\n          <div class=\"user-info\">\n            <img :src=\"user.photoURL || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" class=\"user-avatar\" alt=\"User\" />\n            <div class=\"user-details\">\n              <div class=\"user-name-line\">\n                <span class=\"user-name\">{{ user.displayName }}</span>\n                <span v-if=\"user.medal\" class=\"medal\">{{ user.medal }}</span>\n              </div>\n              <div v-if=\"user.distance !== null\" class=\"user-distance\">{{ user.distance.toFixed(1) }} miles away</div>\n            </div>\n          </div>\n          <div v-if=\"user.lastReview\" class=\"last-review\">\n            <div class=\"review-header\">\n              Latest review: <strong>{{ user.lastReview.restaurantName }}</strong>\n            </div>\n            <div class=\"review-body\">\n              <StarRating :rating=\"user.lastReview.rating\" />\n              <p v-if=\"user.lastReview.text\" class=\"review-text\">\"{{ user.lastReview.text }}\"</p>\n            </div>\n          </div>\n          <div v-else class=\"last-review no-review\">\n            No reviews yet.\n          </div>\n        </div>\n        <div class=\"user-actions\">\n          <button @click=\"openReviewsModal(user)\" class=\"action-btn\" title=\"View Reviews\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z\"/></svg>\n          </button>\n          <button @click=\"toggleFollow(user)\" class=\"follow-btn\" :class=\"{ 'unfollow-btn': user.isFollowing }\">{{ user.isFollowing ? 'Unfollow' : 'Follow' }}</button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted, onUnmounted, computed } from 'vue';\nimport { db, auth } from '../firebase';\nimport { collection, query, where, getDocs, doc, deleteDoc, addDoc, orderBy, limit, onSnapshot } from 'firebase/firestore';\nimport StarRating from './StarRating.vue';\nimport { getDistance } from '../utils/geolocation.js';\nimport UserReviewsModal from './UserReviewsModal.vue';\n\nexport default {\n  name: 'UserSearch',\n  components: { StarRating, UserReviewsModal },\n  setup() {\n    const users = ref([]);\n    const loading = ref(true);\n    const userLocation = ref(null);\n    const following = ref([]);\n    const searchQuery = ref('');\n    const isReviewsModalVisible = ref(false);\n    const userForReviews = ref(null);\n    const leaderboardRanks = ref(new Map());\n    let followsUnsubscribe = () => {};\n    \n    const getMedal = (index) => {\n      // Medals are assigned based on position (0-indexed)\n      // Position 1 (index 0): Gold medal \n      // Position 2 (index 1): Silver medal \n      // Position 3 (index 2): Bronze medal \n      // Positions 4-10 (index 3-9): Participation medal \n      if (typeof index !== 'number') return null;\n      if (index === 0) return '';\n      if (index === 1) return '';\n      if (index === 2) return '';\n      if (index >= 3 && index < 10) return '';\n      return null;\n    };\n\n    const fetchUsers = async () => {\n      loading.value = true;\n      const currentUser = auth.currentUser;\n      if (!currentUser) return;\n\n      // Subscribe to real-time updates for the user's follows\n      const followsQuery = query(collection(db, 'follows'), where('followerId', '==', currentUser.uid));\n      followsUnsubscribe = onSnapshot(followsQuery, (snapshot) => {\n        const newFollowing = snapshot.docs.map(d => d.data().followingId);\n        following.value = newFollowing;\n        // Update the isFollowing status on the already-loaded users\n        users.value = users.value.map(u => ({\n          ...u,\n          isFollowing: newFollowing.includes(u.uid)\n        }));\n      });\n\n      // Fetch leaderboard ranks\n      const leaderboardSnap = await getDocs(query(collection(db, 'users'), orderBy('reviewCount', 'desc'), limit(30)));\n      const usersWithReviews = leaderboardSnap.docs\n        .map(doc => ({ id: doc.id, ...doc.data() }))\n        .filter(user => {\n          const count = Number(user.reviewCount) || 0;\n          return count > 0;\n        })\n        .sort((a, b) => {\n          const countA = Number(a.reviewCount) || 0;\n          const countB = Number(b.reviewCount) || 0;\n          return countB - countA;\n        })\n        .slice(0, 10);\n      \n      const ranks = new Map();\n      usersWithReviews.forEach((user, index) => {\n        ranks.set(user.id, index);\n      });\n      leaderboardRanks.value = ranks;\n\n      const restaurantsSnap = await getDocs(collection(db, 'restaurants'));\n      const restaurantsMap = new Map();\n      restaurantsSnap.forEach(doc => {\n        restaurantsMap.set(doc.id, doc.data());\n      });\n\n      // NOTE: This page performs a query for every user to get their last review.\n      // This can be inefficient (N+1 problem). For better performance at scale,\n      // consider denormalizing the last review data onto the user document.\n      const usersQuery = query(collection(db, 'users'), where('uid', '!=', currentUser.uid));\n      const usersSnap = await getDocs(usersQuery);\n      const allUsers = usersSnap.docs\n        .map(doc => ({ uid: doc.id, ...doc.data() }))\n\n      const usersWithDetails = await Promise.all(\n        allUsers.map(async user => {\n          const reviewQuery = query(\n            collection(db, 'reviews'),\n            where('userId', '==', user.uid),\n            orderBy('createdAt', 'desc'),\n            limit(1)\n          );\n          const reviewSnap = await getDocs(reviewQuery);\n          let lastReview = null;\n          let distance = null;\n\n          if (!reviewSnap.empty) {\n            const reviewData = reviewSnap.docs[0].data();\n            const restaurant = restaurantsMap.get(reviewData.restaurantId);\n            lastReview = {\n              ...reviewData,\n              restaurantName: restaurant?.name || 'Unknown Restaurant'\n            };\n            \n            if (userLocation.value && restaurant?.location) {\n              distance = getDistance(\n                userLocation.value.lat,\n                userLocation.value.lng,\n                restaurant.location.lat,\n                restaurant.location.lng\n              );\n            }\n          }\n\n          const rank = leaderboardRanks.value.get(user.uid);\n          return {\n            ...user,\n            isFollowing: following.value.includes(user.uid),\n            lastReview,\n            distance,\n            medal: getMedal(rank)\n          };\n        })\n      );\n\n      users.value = usersWithDetails;\n      loading.value = false;\n    };\n\n    onMounted(() => {\n      if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(pos => {\n          userLocation.value = {\n            lat: pos.coords.latitude,\n            lng: pos.coords.longitude\n          };\n          fetchUsers();\n        }, (error) => {\n          console.error(\"Error getting location\", error);\n          fetchUsers();\n        });\n      } else {\n        console.error(\"Geolocation is not supported by this browser.\");\n        fetchUsers();\n      }\n    });\n\n    onUnmounted(() => {\n      followsUnsubscribe();\n    });\n\n    const filteredUsers = computed(() => {\n      const sorted = [...users.value].sort((a, b) => {\n        if (a.distance === null && b.distance !== null) return 1;\n        if (a.distance !== null && b.distance === null) return -1;\n        if (a.distance === null && b.distance === null) return 0;\n        return a.distance - b.distance;\n      });\n\n      if (!searchQuery.value.trim()) {\n        return sorted;\n      }\n      const lowerCaseQuery = searchQuery.value.toLowerCase();\n      return sorted.filter(user =>\n        user.displayName.toLowerCase().includes(lowerCaseQuery)\n      );\n    });\n\n    const toggleFollow = async (user) => {\n      const currentUser = auth.currentUser;\n      if (!currentUser) return;\n\n      const followsRef = collection(db, 'follows');\n      if (user.isFollowing) {\n        // Unfollow\n        const q = query(followsRef, where('followerId', '==', currentUser.uid), where('followingId', '==', user.uid));\n        const followsSnap = await getDocs(q);\n        if (!followsSnap.empty) {\n          const docId = followsSnap.docs[0].id;\n          await deleteDoc(doc(db, 'follows', docId));\n        }\n      } else {\n        // Follow\n        await addDoc(followsRef, {\n          followerId: currentUser.uid,\n          followingId: user.uid,\n        });\n      }\n    };\n\n    const openReviewsModal = (user) => {\n      userForReviews.value = user;\n      isReviewsModalVisible.value = true;\n    };\n\n    const closeReviewsModal = () => {\n      isReviewsModalVisible.value = false;\n      userForReviews.value = null;\n    };\n\n    return { \n      filteredUsers, \n      loading, \n      toggleFollow, \n      searchQuery,\n      isReviewsModalVisible,\n      userForReviews,\n      openReviewsModal,\n      closeReviewsModal\n    };\n  }\n};\n</script>\n\n<style scoped>\n.user-search-page {\n  max-width: 800px;\n  margin: 0 auto;\n}\n\n.search-box {\n  margin-bottom: 2em;\n}\n\n.search-input {\n  width: 100%;\n  padding: 12px 15px;\n  font-size: 1em;\n  border-radius: 8px;\n  border: 1px solid #ddd;\n  box-sizing: border-box;\n}\n\n.no-users-message {\n  text-align: center;\n  color: #777;\n  padding: 3em 2em;\n  background: var(--card-background);\n  border-radius: 12px;\n  box-shadow: 0 4px 15px var(--shadow-color);\n}\n\n.no-users-message h3 {\n  margin: 0 0 0.5em 0;\n  color: var(--text-color);\n}\n\n.no-users-message p {\n  margin: 0;\n  font-size: 0.95em;\n}\n\n.user-card {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  background: var(--card-background);\n  padding: 1.5em;\n  border-radius: 12px;\n  box-shadow: 0 4px 15px var(--shadow-color);\n  margin-bottom: 1.5em;\n  gap: 1.5em;\n}\n.user-card-content { flex-grow: 1; min-width: 0; }\n.user-info {\n  display: flex;\n  align-items: center;\n  gap: 1em;\n  min-width: 0;\n}\n.user-details {\n  min-width: 0;\n}\n.user-avatar {\n  width: 60px;\n  height: 60px;\n  border-radius: 50%;\n  flex-shrink: 0;\n}\n.user-name-line {\n  display: flex;\n  align-items: center;\n  gap: 0.5em;\n}\n.user-name {\n  font-weight: 600;\n  font-size: 1.1em;\n  word-break: break-word;\n}\n.medal {\n  font-size: 1.1em;\n}\n.user-distance {\n  font-size: 0.9em;\n  color: #777;\n}\n.user-actions {\n  display: flex;\n  gap: 0.75em;\n  align-items: center;\n}\n.user-actions .action-btn {\n  background: none;\n  border: 1px solid #ccc;\n  border-radius: 8px;\n  padding: 8px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s;\n  color: #555;\n}\n.user-actions .action-btn:hover {\n  background-color: #f0f0f0;\n  border-color: #bbb;\n}\n.user-actions .follow-btn {\n  background-color: var(--primary-color);\n  color: white;\n  border: none;\n  padding: 10px 20px;\n  border-radius: 8px;\n  cursor: pointer;\n  font-weight: 600;\n  transition: background-color 0.2s;\n}\n.user-actions .follow-btn.unfollow-btn {\n  background-color: #e74c3c;\n}\n.user-actions .follow-btn:hover {\n  opacity: 0.9;\n}\n.last-review { margin-top: 1em; padding-top: 1em; border-top: 1px solid #eee; font-size: 0.9em; min-width: 0; }\n.review-header { margin-bottom: 0.5em; color: #555; word-break: break-word; }\n.review-body .star-rating { margin-bottom: 0.5em; }\n.review-text {\n  margin: 0.5em 0 0;\n  font-style: italic;\n  color: #333;\n  word-break: break-word;\n}\n.no-review { color: #888; font-style: italic; }\n\n@media (max-width: 768px) {\n  .user-card {\n    flex-direction: column;\n    align-items: stretch;\n  }\n  .user-actions {\n    margin-top: 1em;\n  }\n  .user-actions button {\n    width: 100%;\n  }\n}\n</style>\n","<template>\r\n  <div class=\"modal-overlay\" @click.self=\"$emit('close')\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h2>Reviews by {{ user.displayName }}</h2>\r\n        <button @click=\"$emit('close')\" class=\"close-btn\">&times;</button>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <div v-if=\"loading\" class=\"loading-indicator\">Loading reviews...</div>\r\n        <p v-else-if=\"reviews.length === 0\" class=\"no-reviews-message\">\r\n          This user hasn't posted any reviews yet.\r\n        </p>\r\n        <ul v-else class=\"reviews-list\">\r\n          <li v-for=\"review in reviews\" :key=\"review.id\" class=\"review-item\">\r\n            <div class=\"review-header\">\r\n              <span class=\"restaurant-name\">{{ review.restaurantName }}</span>\r\n              <span class=\"review-date\">{{ formatDate(review.createdAt) }}</span>\r\n            </div>\r\n            <div class=\"review-body\">\r\n              <StarRating :rating=\"review.rating\" />\r\n              <p v-if=\"review.text\" class=\"review-text\">\"{{ review.text }}\"</p>\r\n              <img v-if=\"review.photoURL\" :src=\"review.photoURL\" alt=\"Review photo\" class=\"review-photo\" />\r\n              <div v-if=\"review.tags && review.tags.length > 0\" class=\"tags-container\">\r\n                <span v-for=\"tag in review.tags\" :key=\"tag\" class=\"tag\">{{ tag }}</span>\r\n              </div>\r\n            </div>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, watch } from 'vue';\r\nimport { db } from '../firebase';\r\nimport { collection, query, where, getDocs, orderBy } from 'firebase/firestore';\r\nimport StarRating from './StarRating.vue';\r\n\r\nexport default {\r\n  name: 'UserReviewsModal',\r\n  components: { StarRating },\r\n  props: {\r\n    user: {\r\n      type: Object,\r\n      required: true\r\n    }\r\n  },\r\n  emits: ['close'],\r\n  setup(props) {\r\n    const reviews = ref([]);\r\n    const loading = ref(true);\r\n\r\n    const fetchReviews = async () => {\r\n      if (!props.user?.uid) {\r\n        reviews.value = [];\r\n        loading.value = false;\r\n        return;\r\n      }\r\n      loading.value = true;\r\n      reviews.value = [];\r\n      try {\r\n        const restaurantsSnap = await getDocs(collection(db, 'restaurants'));\r\n        const restaurantsMap = new Map();\r\n        restaurantsSnap.forEach(doc => {\r\n          restaurantsMap.set(doc.id, doc.data().name);\r\n        });\r\n\r\n        const q = query(\r\n          collection(db, 'reviews'),\r\n          where('userId', '==', props.user.uid),\r\n          orderBy('createdAt', 'desc')\r\n        );\r\n        const querySnapshot = await getDocs(q);\r\n        reviews.value = querySnapshot.docs.map(doc => {\r\n          const data = doc.data();\r\n          return {\r\n            id: doc.id,\r\n            ...data,\r\n            restaurantName: restaurantsMap.get(data.restaurantId) || 'Unknown Restaurant'\r\n          };\r\n        });\r\n      } catch (error) {\r\n        console.error(\"Error fetching user reviews:\", error);\r\n      } finally {\r\n        loading.value = false;\r\n      }\r\n    };\r\n\r\n    watch(() => props.user, (newUser) => {\r\n      if (newUser) {\r\n        fetchReviews();\r\n      }\r\n    }, { immediate: true });\r\n\r\n    const formatDate = (timestamp) => {\r\n      return timestamp && timestamp.toDate ? timestamp.toDate().toLocaleDateString() : '';\r\n    };\r\n\r\n    return { reviews, loading, formatDate };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.6); display: flex; justify-content: center; align-items: center; z-index: 1000; }\r\n.modal-content { background: white; padding: 2em; border-radius: 12px; width: 90%; max-width: 600px; max-height: 90vh; display: flex; flex-direction: column; }\r\n.modal-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #eee; padding-bottom: 1em; margin-bottom: 1em; }\r\n.modal-header h2 { margin: 0; font-size: 1.5em; }\r\n.close-btn { background: none; border: none; font-size: 2em; cursor: pointer; line-height: 1; }\r\n.modal-body { overflow-y: auto; }\r\n.loading-indicator, .no-reviews-message { text-align: center; padding: 2em; color: #777; }\r\n.reviews-list { list-style: none; padding: 0; margin: 0; }\r\n.review-item { padding: 1.5em 0; border-bottom: 1px solid #eee; }\r\n.review-item:last-child { border-bottom: none; }\r\n.review-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1em; }\r\n.restaurant-name { font-weight: 600; font-size: 1.1em; }\r\n.review-date { font-size: 0.9em; color: #777; }\r\n.review-body .star-rating { margin-bottom: 0.5em; }\r\n.review-text { margin: 0.5em 0 0; font-style: italic; color: #333; }\r\n.review-photo { max-width: 100%; border-radius: 8px; margin-top: 1em; }\r\n.tags-container { margin-top: 1em; display: flex; flex-wrap: wrap; gap: 0.5em; }\r\n.tag { background-color: #ecf0f1; color: var(--secondary-color); padding: 4px 10px; border-radius: 15px; font-size: 0.85em; }\r\n</style>","import { render } from \"./UserReviewsModal.vue?vue&type=template&id=4e60c4e2&scoped=true\"\nimport script from \"./UserReviewsModal.vue?vue&type=script&lang=js\"\nexport * from \"./UserReviewsModal.vue?vue&type=script&lang=js\"\n\nimport \"./UserReviewsModal.vue?vue&type=style&index=0&id=4e60c4e2&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4e60c4e2\"]])\n\nexport default __exports__","import { render } from \"./UserSearch.vue?vue&type=template&id=51cdc354&scoped=true\"\nimport script from \"./UserSearch.vue?vue&type=script&lang=js\"\nexport * from \"./UserSearch.vue?vue&type=script&lang=js\"\n\nimport \"./UserSearch.vue?vue&type=style&index=0&id=51cdc354&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-51cdc354\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"review-page\">\r\n    <div class=\"review-card\">\r\n      <form @submit.prevent=\"submitReview\">\r\n        <div class=\"form-group\">\r\n          <label for=\"restaurant\">Restaurant</label>\r\n          <select id=\"restaurant\" v-model=\"selectedRestaurant\" :disabled=\"!!selectedRestaurantId\" required>\r\n            <option disabled value=\"\">Please select a restaurant</option>\r\n            <option v-for=\"restaurant in restaurants\" :key=\"restaurant.id\" :value=\"restaurant.id\">\r\n              {{ restaurant.name }}\r\n            </option>\r\n          </select>\r\n          <div class=\"add-restaurant-prompt\" v-if=\"!selectedRestaurantId\">\r\n            Can't find the restaurant?\r\n            <button type=\"button\" class=\"link-button\" @click=\"showAddRestaurantForm = !showAddRestaurantForm\">\r\n              {{ showAddRestaurantForm ? 'Cancel' : 'Add a new one' }}\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div v-if=\"showAddRestaurantForm\" class=\"add-restaurant-form\">\r\n          <h3 class=\"add-restaurant-header\">Add New Restaurant</h3>\r\n          <div class=\"form-group\">\r\n            <label for=\"new-rest-name\">Name</label>\r\n            <input id=\"new-rest-name\" v-model=\"newRestaurant.name\" type=\"text\" required>\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"new-rest-address\">Address</label>\r\n            <input id=\"new-rest-address\" v-model=\"newRestaurant.address\" type=\"text\" required>\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"new-rest-city\">City</label>\r\n            <input id=\"new-rest-city\" v-model=\"newRestaurant.city\" type=\"text\">\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"new-rest-state\">State</label>\r\n            <input id=\"new-rest-state\" v-model=\"newRestaurant.state\" type=\"text\">\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"new-rest-zip\">Zip Code</label>\r\n            <input id=\"new-rest-zip\" v-model=\"newRestaurant.zip\" type=\"text\">\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"url\">Website URL</label>\r\n            <input id=\"url\" v-model=\"newRestaurant.url\" type=\"url\" placeholder=\"https://example.com\" />\r\n          </div>\r\n          <button type=\"button\" class=\"btn-save-restaurant\" @click=\"saveNewRestaurant\" :disabled=\"isSavingRestaurant\">\r\n            {{ isSavingRestaurant ? 'Saving...' : 'Save Restaurant' }}\r\n          </button>\r\n          <p v-if=\"addRestaurantError\" class=\"error-message\">{{ addRestaurantError }}</p>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label>Photo</label>\r\n          <div v-if=\"!photoDataUrl\" class=\"photo-actions\">\r\n            <button type=\"button\" @click=\"openCamera\" class=\"btn-secondary\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><circle cx=\"12\" cy=\"12\" r=\"3.2\"/><path d=\"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z\"/></svg>\r\n              Take a Picture\r\n            </button>\r\n            <button type=\"button\" @click=\"triggerFileUpload\" class=\"btn-secondary\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M9 16h6v-6h4l-7-7-7 7h4v6zm3-10.17L14.17 8H13v6h-2V8H9.83L12 5.83zM5 18h14v2H5v-2z\"/></svg>\r\n              Upload Photo\r\n            </button>\r\n            <input type=\"file\" ref=\"fileInput\" @change=\"handleFileUpload\" accept=\"image/*\" style=\"display: none\">\r\n          </div>\r\n          <div v-else class=\"photo-preview\">\r\n            <img :src=\"photoDataUrl\" alt=\"Review photo preview\" />\r\n            <button type=\"button\" @click=\"removePhoto\" class=\"btn-remove-photo\" title=\"Remove Photo\">&times;</button>\r\n          </div>\r\n        </div>\r\n        <div v-if=\"isCameraOpen\" class=\"camera-modal\">\r\n          <video ref=\"videoPlayer\" class=\"camera-video\" autoplay playsinline></video>\r\n          <button type=\"button\" @click=\"capturePhoto\" class=\"btn-capture\">Capture</button>\r\n          <button type=\"button\" @click=\"closeCamera\" class=\"btn-cancel-camera\">Cancel</button>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label>Rating</label>\r\n          <div class=\"star-rating-input\">\r\n            <span v-for=\"star in 5\" :key=\"star\"\r\n              class=\"star\"\r\n              @mouseover=\"hoverRating = star\"\r\n              @mouseleave=\"hoverRating = 0\"\r\n              @click=\"rating = star\"\r\n              :title=\"`${star} star${star > 1 ? 's' : ''}`\"\r\n            >\r\n              <svg height=\"28px\" width=\"28px\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\r\n                <path :d=\"getStarPath(star)\" />\r\n              </svg>\r\n            </span>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label>Tags</label>\r\n          <div class=\"tags-container\">\r\n            <button\r\n              v-for=\"tag in tags\"\r\n              :key=\"tag.id\"\r\n              type=\"button\"\r\n              class=\"tag-btn\"\r\n              :class=\"{ selected: selectedTags.includes(tag.name) }\"\r\n              @click=\"toggleTag(tag.name)\"\r\n            >\r\n              {{ tag.name }}\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label for=\"new-tag\">Add a new tag</label>\r\n          <div class=\"new-tag-input\">\r\n            <input id=\"new-tag\" v-model.trim=\"newTag\" @keydown.enter.prevent=\"addNewTag\" placeholder=\"e.g., crispy, peppery, huge\">\r\n            <button type=\"button\" @click=\"addNewTag\" :disabled=\"!newTag.trim()\">Add Tag</button>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label for=\"comment\">Comment</label>\r\n          <textarea id=\"comment\" v-model=\"comment\" rows=\"4\" placeholder=\"How was the tenderloin?\"></textarea>\r\n          <span v-if=\"comment.length > 0\" class=\"char-count\">{{ comment.length }} characters</span>\r\n        </div>\r\n\r\n        <div v-if=\"showPreview && selectedRestaurant && rating\" class=\"review-preview\">\r\n          <h3>Preview</h3>\r\n          <div class=\"preview-content\">\r\n            <div class=\"preview-restaurant\">{{ getRestaurantName(selectedRestaurant) }}</div>\r\n            <StarRating :rating=\"rating\" />\r\n            <p v-if=\"comment\">{{ comment }}</p>\r\n            <div v-if=\"selectedTags.length > 0\" class=\"tags-container\">\r\n              <span v-for=\"tag in selectedTags\" :key=\"tag\" class=\"tag\">{{ tag }}</span>\r\n            </div>\r\n            <div v-if=\"photoDataUrl\" class=\"photo-preview\">\r\n              <img :src=\"photoDataUrl\" alt=\"Review photo preview\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"form-actions\">\r\n          <button type=\"button\" @click=\"showPreview = !showPreview\" class=\"btn-secondary\" v-if=\"selectedRestaurant && rating\">\r\n            {{ showPreview ? 'Hide Preview' : 'Preview Review' }}\r\n          </button>\r\n          <button type=\"submit\" :disabled=\"submitting || !selectedRestaurant || !rating\">\r\n            {{ submitting ? 'Submitting...' : 'Submit Review' }}\r\n          </button>\r\n        </div>\r\n        <p v-if=\"errorMessage\" class=\"error-message\">{{ errorMessage }}</p>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { ref, onMounted, nextTick } from 'vue';\r\nimport { db, auth } from '../firebase';\r\nimport { collection, getDocs, addDoc, serverTimestamp, query, orderBy, where, doc, getDoc, updateDoc, increment } from 'firebase/firestore';\r\nimport { getDistance } from '../utils/geolocation.js';\r\nimport { geocodeAddress } from '../utils/geocoding.js';\r\nimport { getStorage, ref as storageRef, uploadString, getDownloadURL } from 'firebase/storage';\r\nimport { showToast } from '../utils/toast.js';\r\n\r\nexport default {\r\n  name: 'Review',\r\n  props: {\r\n    selectedRestaurantId: {\r\n      type: String,\r\n      default: null\r\n    }\r\n  },\r\n  emits: ['reviewed'],\r\n  setup(props, { emit }) {\r\n    const restaurants = ref([]);\r\n    const selectedRestaurant = ref(props.selectedRestaurantId || null);\r\n    const rating = ref(null);\r\n    const hoverRating = ref(0);\r\n    const comment = ref('');\r\n    const submitting = ref(false);\r\n    const errorMessage = ref('');\r\n    const tags = ref([]);\r\n    const selectedTags = ref([]);\r\n    const newTag = ref('');\r\n    const showAddRestaurantForm = ref(false);\r\n    const newRestaurant = ref({ name: '', address: '', city: '', state: '', zip: '', url: '' });\r\n    const isSavingRestaurant = ref(false);\r\n    const addRestaurantError = ref('');\r\n    const isCameraOpen = ref(false);\r\n    const photoDataUrl = ref(null);\r\n    const videoPlayer = ref(null);\r\n    const stream = ref(null);\r\n    const fileInput = ref(null);\r\n    const userLocation = ref(null);\r\n    const showPreview = ref(false);\r\n\r\n    // SVG paths for stars\r\n    const fullStarPath = \"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27z\";\r\n    const emptyStarPath = \"M22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.64-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z\";\r\n\r\n    const fetchTags = async () => {\r\n      const tagsQuery = query(collection(db, 'tags'), orderBy('name'));\r\n      const tagsSnapshot = await getDocs(tagsQuery);\r\n      tags.value = tagsSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n    };\r\n\r\n    const getUserLocation = () => {\r\n      return new Promise((resolve) => {\r\n        if (navigator.geolocation && !props.selectedRestaurantId) {\r\n          navigator.geolocation.getCurrentPosition(\r\n            (position) => {\r\n              userLocation.value = {\r\n                lat: position.coords.latitude,\r\n                lng: position.coords.longitude,\r\n              };\r\n              resolve();\r\n            },\r\n            () => resolve(), // Resolve even on error to not block\r\n            { timeout: 5000 }\r\n          );\r\n        } else {\r\n          resolve();\r\n        }\r\n      });\r\n    };\r\n\r\n    const selectClosestRestaurant = () => {\r\n      if (!userLocation.value || restaurants.value.length === 0) return;\r\n\r\n      let closestRestaurant = null;\r\n      let minDistance = Infinity;\r\n\r\n      restaurants.value.forEach(restaurant => {\r\n        if (restaurant.location) {\r\n          const distance = getDistance(\r\n            userLocation.value.lat,\r\n            userLocation.value.lng,\r\n            restaurant.location.lat,\r\n            restaurant.location.lng\r\n          );\r\n          if (distance !== null && distance < minDistance) {\r\n            minDistance = distance;\r\n            closestRestaurant = restaurant;\r\n          }\r\n        }\r\n      });\r\n\r\n      if (closestRestaurant) {\r\n        selectedRestaurant.value = closestRestaurant.id;\r\n      }\r\n    };\r\n\r\n    const fetchInitialData = async () => {\r\n      if (props.selectedRestaurantId) {\r\n        const restaurantRef = doc(db, 'restaurants', props.selectedRestaurantId);\r\n        const restaurantSnap = await getDoc(restaurantRef);\r\n        if (restaurantSnap.exists()) {\r\n            restaurants.value = [{ id: restaurantSnap.id, ...restaurantSnap.data() }];\r\n        }\r\n      } else {\r\n        const restaurantsQuery = query(collection(db, 'restaurants'), orderBy('name'));\r\n        const restaurantsSnapshot = await getDocs(restaurantsQuery);\r\n        restaurants.value = restaurantsSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n        await getUserLocation();\r\n        selectClosestRestaurant();\r\n      }\r\n    };\r\n\r\n    onMounted(async () => {\r\n      await Promise.all([fetchTags(), fetchInitialData()]);\r\n    });\r\n\r\n    const getStarPath = (starIndex) => {\r\n      const displayRating = hoverRating.value || rating.value;\r\n      return displayRating >= starIndex ? fullStarPath : emptyStarPath;\r\n    };\r\n\r\n    const getRestaurantName = (restaurantId) => {\r\n      const restaurant = restaurants.value.find(r => r.id === restaurantId);\r\n      return restaurant?.name || 'Selected Restaurant';\r\n    };\r\n\r\n    const toggleTag = (tagName) => {\r\n      const index = selectedTags.value.indexOf(tagName);\r\n      if (index > -1) {\r\n        selectedTags.value.splice(index, 1);\r\n      } else {\r\n        selectedTags.value.push(tagName);\r\n      }\r\n    };\r\n\r\n    const addNewTag = async () => {\r\n      const tagName = newTag.value.toLowerCase();\r\n      if (!tagName || tags.value.some(t => t.name === tagName)) {\r\n        newTag.value = '';\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const newDocRef = await addDoc(collection(db, 'tags'), {\r\n          name: tagName,\r\n          createdAt: serverTimestamp()\r\n        });\r\n        const newTagObject = { id: newDocRef.id, name: tagName };\r\n        tags.value.push(newTagObject);\r\n        tags.value.sort((a, b) => a.name.localeCompare(b.name));\r\n        selectedTags.value.push(tagName);\r\n        newTag.value = '';\r\n      } catch (error) {\r\n        errorMessage.value = \"Failed to add new tag.\";\r\n        console.error(\"Error adding new tag: \", error);\r\n      }\r\n    };\r\n\r\n    const saveNewRestaurant = async () => {\r\n      const name = newRestaurant.value.name.trim();\r\n      const address = newRestaurant.value.address.trim();\r\n\r\n      if (!name || !address) {\r\n        addRestaurantError.value = \"Restaurant name and address are required.\";\r\n        return;\r\n      }\r\n      isSavingRestaurant.value = true;\r\n      addRestaurantError.value = '';\r\n\r\n      try {\r\n        // Check for duplicates\r\n        const q = query(collection(db, 'restaurants'), where('name', '==', name), where('address', '==', address));\r\n        const querySnapshot = await getDocs(q);\r\n\r\n        if (!querySnapshot.empty) {\r\n          addRestaurantError.value = \"This restaurant already exists in the database.\";\r\n          isSavingRestaurant.value = false;\r\n          return;\r\n        }\r\n\r\n        const fullAddress = [newRestaurant.value.address, newRestaurant.value.city, newRestaurant.value.state, newRestaurant.value.zip].filter(Boolean).join(', ');\r\n        const location = await geocodeAddress(fullAddress);\r\n\r\n        if (!location) {\r\n          addRestaurantError.value = \"Could not find a location for the provided address. Please check the address and try again.\";\r\n          isSavingRestaurant.value = false;\r\n          return;\r\n        }\r\n\r\n        // Add new restaurant\r\n        const docData = {\r\n          ...newRestaurant.value,\r\n          name,\r\n          address,\r\n          location,\r\n          createdAt: serverTimestamp(),\r\n        };\r\n        const newDocRef = await addDoc(collection(db, 'restaurants'), docData);\r\n\r\n        // Update local state\r\n        const addedRestaurant = { id: newDocRef.id, ...docData };\r\n        restaurants.value.push(addedRestaurant);\r\n        restaurants.value.sort((a, b) => a.name.localeCompare(b.name));\r\n        selectedRestaurant.value = newDocRef.id;\r\n\r\n        // Reset form\r\n        showAddRestaurantForm.value = false;\r\n        newRestaurant.value = { name: '', address: '', city: '', state: '', zip: '', url: '' };\r\n      } catch (error) {\r\n        console.error(\"Error saving new restaurant:\", error);\r\n        addRestaurantError.value = \"Failed to save restaurant. Please try again.\";\r\n      } finally {\r\n        isSavingRestaurant.value = false;\r\n      }\r\n    };\r\n\r\n    const openCamera = async () => {\r\n      isCameraOpen.value = true;\r\n      await nextTick();\r\n      try {\r\n        stream.value = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });\r\n        if (videoPlayer.value) {\r\n          videoPlayer.value.srcObject = stream.value;\r\n        }\r\n      } catch (err) {\r\n        console.error(\"Error accessing camera: \", err);\r\n        errorMessage.value = \"Could not access the camera. Please check permissions.\";\r\n        isCameraOpen.value = false;\r\n      }\r\n    };\r\n\r\n    const closeCamera = () => {\r\n      if (stream.value) {\r\n        stream.value.getTracks().forEach(track => track.stop());\r\n      }\r\n      isCameraOpen.value = false;\r\n    };\r\n\r\n    const capturePhoto = () => {\r\n      const canvas = document.createElement('canvas');\r\n      const video = videoPlayer.value;\r\n      const MAX_WIDTH = 1280;\r\n      const MAX_HEIGHT = 1280;\r\n      let width = video.videoWidth;\r\n      let height = video.videoHeight;\r\n\r\n      if (width > height) {\r\n        if (width > MAX_WIDTH) {\r\n          height *= MAX_WIDTH / width;\r\n          width = MAX_WIDTH;\r\n        }\r\n      } else {\r\n        if (height > MAX_HEIGHT) {\r\n          width *= MAX_HEIGHT / height;\r\n          height = MAX_HEIGHT;\r\n        }\r\n      }\r\n      canvas.width = width;\r\n      canvas.height = height;\r\n      const context = canvas.getContext('2d');\r\n      context.drawImage(video, 0, 0, width, height);\r\n      photoDataUrl.value = canvas.toDataURL('image/jpeg', 0.8);\r\n      closeCamera();\r\n    };\r\n\r\n    const removePhoto = () => {\r\n      photoDataUrl.value = null;\r\n    };\r\n\r\n    const triggerFileUpload = () => {\r\n      fileInput.value.click();\r\n    };\r\n\r\n    const handleFileUpload = (event) => {\r\n      const file = event.target.files[0];\r\n      if (file) {\r\n        const reader = new FileReader();\r\n        reader.onload = (e) => {\r\n          photoDataUrl.value = e.target.result;\r\n        };\r\n        reader.readAsDataURL(file);\r\n      }\r\n    };\r\n\r\n    const submitReview = async () => {\r\n      const currentUser = auth.currentUser;\r\n      if (!currentUser || !selectedRestaurant.value || !rating.value) {\r\n        errorMessage.value = \"Please select a restaurant and provide a rating.\";\r\n        return;\r\n      }\r\n      submitting.value = true;\r\n      errorMessage.value = '';\r\n\r\n      try {\r\n        let photoURL = null;\r\n        if (photoDataUrl.value) {\r\n            const storage = getStorage();\r\n            const filePath = `reviews/${currentUser.uid}/${Date.now()}.jpg`;\r\n            const photoRef = storageRef(storage, filePath);\r\n            const uploadResult = await uploadString(photoRef, photoDataUrl.value, 'data_url');\r\n            photoURL = await getDownloadURL(uploadResult.ref);\r\n        }\r\n\r\n        const timestamp = serverTimestamp();\r\n\r\n        // Add a review document\r\n        await addDoc(collection(db, 'reviews'), {\r\n          userId: currentUser.uid,\r\n          userName: currentUser.displayName || 'Anonymous',\r\n          userPhoto: currentUser.photoURL || null,\r\n          restaurantId: selectedRestaurant.value,\r\n          photoURL,\r\n          rating: rating.value,\r\n          text: comment.value,\r\n          tags: selectedTags.value,\r\n          createdAt: timestamp,\r\n          lastActivityAt: timestamp\r\n        });\r\n\r\n        // Update the user's reviewCount atomically (non-blocking - don't fail if this errors)\r\n        // Using increment() ensures thread-safe updates and handles the case where reviewCount doesn't exist yet\r\n        try {\r\n          const userRef = doc(db, 'users', currentUser.uid);\r\n          await updateDoc(userRef, { reviewCount: increment(1) });\r\n        } catch (countError) {\r\n          console.warn(\"Failed to update reviewCount (non-critical):\", countError);\r\n          // Don't fail the entire submission if reviewCount update fails\r\n        }\r\n\r\n        // Check if this restaurant is on the bucket list and mark as complete (non-blocking)\r\n        try {\r\n          const bucketListQuery = query(\r\n            collection(db, 'bucketListItems'),\r\n            where('userId', '==', currentUser.uid),\r\n            where('restaurantId', '==', selectedRestaurant.value)\r\n          );\r\n          const bucketListSnapshot = await getDocs(bucketListQuery);\r\n          if (!bucketListSnapshot.empty) {\r\n            const bucketListItemDoc = bucketListSnapshot.docs[0];\r\n            await updateDoc(bucketListItemDoc.ref, { completedAt: timestamp });\r\n          }\r\n        } catch (bucketError) {\r\n          console.warn(\"Failed to update bucket list (non-critical):\", bucketError);\r\n          // Don't fail the entire submission if bucket list update fails\r\n        }\r\n\r\n        showToast('Review submitted successfully!', 'success', 2000);\r\n        // Small delay to show success message before navigation\r\n        await new Promise(resolve => setTimeout(resolve, 500));\r\n        emit('reviewed');\r\n      } catch (error) {\r\n        console.error(\"Error submitting check-in: \", error);\r\n        errorMessage.value = \"Failed to submit check-in. Please try again.\";\r\n        showToast(\"Failed to submit check-in. Please try again.\", 'error');\r\n      } finally {\r\n        submitting.value = false;\r\n      }\r\n    };\r\n\r\n    return {\r\n      restaurants,\r\n      selectedRestaurant,\r\n      rating,\r\n      hoverRating,\r\n      comment,\r\n      submitting,\r\n      errorMessage,\r\n      getStarPath,\r\n      submitReview,\r\n      tags,\r\n      selectedTags,\r\n      newTag,\r\n      toggleTag,\r\n      addNewTag,\r\n      showAddRestaurantForm,\r\n      newRestaurant,\r\n      isSavingRestaurant,\r\n      addRestaurantError,\r\n      saveNewRestaurant,\r\n      isCameraOpen,\r\n      photoDataUrl,\r\n      videoPlayer,\r\n      openCamera, closeCamera, capturePhoto, removePhoto,\r\n      fileInput,\r\n      triggerFileUpload,\r\n      handleFileUpload,\r\n      showPreview,\r\n      getRestaurantName\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.review-page {\r\n  max-width: 700px;\r\n  margin: 0 auto;\r\n}\r\n.review-card {\r\n  background: var(--card-background);\r\n  padding: 2em;\r\n  border-radius: 12px;\r\n  box-shadow: 0 4px 15px var(--shadow-color);\r\n}\r\n.form-group {\r\n  margin-bottom: 1.5em;\r\n}\r\n.form-group label {\r\n  display: block;\r\n  margin-bottom: 0.5em;\r\n  font-weight: 600;\r\n}\r\n.form-group input[type=\"text\"],\r\n.form-group input[type=\"url\"],\r\n.form-group select,\r\n.form-group textarea {\r\n  width: 100%;\r\n  padding: 12px;\r\n  border-radius: 8px;\r\n  border: 1px solid #ddd;\r\n  box-sizing: border-box;\r\n  font-family: inherit;\r\n  font-size: 1em;\r\n}\r\n.star-rating-input {\r\n  display: flex;\r\n  gap: 0.5em;\r\n}\r\n.star {\r\n  cursor: pointer;\r\n  color: #ccc;\r\n  transition: color 0.2s;\r\n}\r\n.star:hover,\r\n.star:hover ~ .star {\r\n  color: #ccc;\r\n}\r\n.photo-actions {\r\n  display: flex;\r\n  gap: 1em;\r\n}\r\n.star-rating-input:hover .star {\r\n  color: #f39c12;\r\n}\r\n.photo-actions .btn-secondary {\r\n  background-color: #ecf0f1;\r\n  color: var(--secondary-color);\r\n  border: 1px solid #bdc3c7;\r\n  padding: 10px 15px;\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  gap: 0.5em;\r\n}\r\n.photo-preview {\r\n  position: relative;\r\n  display: inline-block;\r\n}\r\n.photo-preview img {\r\n  max-width: 100%;\r\n  max-height: 200px;\r\n  border-radius: 8px;\r\n  border: 1px solid #ddd;\r\n}\r\n.btn-remove-photo {\r\n  position: absolute;\r\n  top: -10px;\r\n  right: -10px;\r\n  background-color: #e74c3c;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 50%;\r\n  width: 28px;\r\n  height: 28px;\r\n  font-size: 1.2em;\r\n  line-height: 1;\r\n  cursor: pointer;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n.camera-modal {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: rgba(0, 0, 0, 0.9);\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 1001;\r\n}\r\n.camera-video {\r\n  width: 100%;\r\n  max-width: 800px;\r\n  height: auto;\r\n}\r\n.btn-capture, .btn-cancel-camera {\r\n  margin-top: 1em;\r\n  padding: 12px 24px;\r\n  border-radius: 8px;\r\n  border: none;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n}\r\n.btn-capture { background-color: var(--primary-color); color: white; }\r\n.btn-cancel-camera { background-color: #e74c3c; color: white; margin-left: 1em; }\r\n.add-restaurant-prompt {\r\n  font-size: 0.9em;\r\n  margin-top: 0.8em;\r\n}\r\n.link-button {\r\n  background: none;\r\n  border: none;\r\n  color: var(--primary-color);\r\n  text-decoration: underline;\r\n  cursor: pointer;\r\n  padding: 0;\r\n  font-size: inherit;\r\n}\r\n.add-restaurant-form {\r\n  border: 1px solid #ddd;\r\n  border-radius: 8px;\r\n  padding: 1.5em;\r\n  margin-top: 1.5em;\r\n  margin-bottom: 1.5em;\r\n  background-color: #f9f9f9;\r\n}\r\n.add-restaurant-header {\r\n  margin-top: 0;\r\n  margin-bottom: 1em;\r\n  font-size: 1.2em;\r\n}\r\n.btn-save-restaurant {\r\n  background-color: #27ae60;\r\n  color: white;\r\n  border: none;\r\n  padding: 10px 15px;\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n}\r\n.tags-container {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 0.5em;\r\n  margin-bottom: 1em;\r\n}\r\n.tag-btn {\r\n  background-color: #ecf0f1;\r\n  color: var(--secondary-color);\r\n  border: 1px solid #bdc3c7;\r\n  padding: 6px 12px;\r\n  border-radius: 20px;\r\n  cursor: pointer;\r\n  transition: all 0.2s;\r\n  font-size: 0.9em;\r\n}\r\n.tag-btn.selected {\r\n  background-color: var(--primary-color);\r\n  color: white;\r\n  border-color: var(--primary-color);\r\n}\r\n.char-count {\r\n  font-size: 0.85em;\r\n  color: #777;\r\n  margin-top: 0.25em;\r\n  display: block;\r\n}\r\n.review-preview {\r\n  background: var(--card-background);\r\n  border: 2px solid var(--primary-color);\r\n  border-radius: 8px;\r\n  padding: 1.5em;\r\n  margin: 1.5em 0;\r\n}\r\n.review-preview h3 {\r\n  margin: 0 0 1em 0;\r\n  color: var(--primary-color);\r\n}\r\n.preview-content {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 0.75em;\r\n}\r\n.preview-restaurant {\r\n  font-weight: 600;\r\n  font-size: 1.1em;\r\n  color: var(--text-color);\r\n}\r\n.photo-preview {\r\n  margin-top: 0.5em;\r\n}\r\n.photo-preview img {\r\n  max-width: 100%;\r\n  max-height: 300px;\r\n  border-radius: 8px;\r\n}\r\n.form-actions {\r\n  display: flex;\r\n  gap: 1em;\r\n  align-items: center;\r\n  margin-top: 1em;\r\n}\r\n.btn-secondary {\r\n  background-color: #95a5a6;\r\n  color: white;\r\n  border: none;\r\n  padding: 10px 20px;\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n}\r\n.btn-secondary:hover {\r\n  background-color: #7f8c8d;\r\n}\r\n.new-tag-input {\r\n  display: flex;\r\n  gap: 0.5em;\r\n}\r\n.new-tag-input input {\r\n  flex-grow: 1;\r\n  width: 100%;\r\n  padding: 12px;\r\n  border-radius: 8px;\r\n  border: 1px solid #ddd;\r\n  box-sizing: border-box;\r\n}\r\n.new-tag-input button {\r\n  background-color: #2ecc71;\r\n  white-space: nowrap;\r\n}\r\n.new-tag-input button:disabled {\r\n  background-color: #bdc3c7;\r\n  cursor: not-allowed;\r\n}\r\n.error-message {\r\n  color: #e74c3c;\r\n  margin-top: 1em;\r\n}\r\nbutton {\r\n  background-color: var(--primary-color);\r\n  color: white;\r\n  border: none;\r\n  padding: 12px 24px;\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n  font-size: 1em;\r\n  transition: background-color 0.2s;\r\n}\r\nbutton:disabled {\r\n  background-color: #bdc3c7;\r\n  cursor: not-allowed;\r\n}\r\n</style>","import { render } from \"./Review.vue?vue&type=template&id=ba576472&scoped=true\"\nimport script from \"./Review.vue?vue&type=script&lang=js\"\nexport * from \"./Review.vue?vue&type=script&lang=js\"\n\nimport \"./Review.vue?vue&type=style&index=0&id=ba576472&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-ba576472\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"recommendations-page\">\r\n    <div class=\"page-header\">\r\n      <h2>Top 10 Recommendations</h2>\r\n      <p>Based on reviews in the last 6 months within 100 miles of your location.</p>\r\n    </div>\r\n    <div v-if=\"loading\" class=\"loading-indicator\">Loading recommendations...</div>\r\n    <div v-else>\r\n      <p v-if=\"restaurants.length === 0\" class=\"no-restaurants-message\">\r\n        No recommendations found.\r\n      </p>\r\n      <ul v-else class=\"restaurant-list\">\r\n        <li v-for=\"restaurant in restaurants\" :key=\"restaurant.id\" class=\"restaurant-item\">\r\n          <div class=\"restaurant-details\">\r\n            <span class=\"restaurant-name\">{{ restaurant.name }}</span>\r\n            <div class=\"restaurant-meta\">\r\n              <div v-if=\"restaurant.averageRating > 0\" class=\"rating\" :title=\"`${restaurant.averageRating.toFixed(2)} average rating`\">\r\n                <StarRating :rating=\"restaurant.averageRating\" />\r\n                <span class=\"rating-text\">{{ restaurant.averageRating.toFixed(1) }}</span>\r\n                <span class=\"rating-count\">({{ restaurant.reviewCount }} recent reviews)</span>\r\n              </div>\r\n              <span v-if=\"restaurant.distance !== null\" class=\"distance\">{{ restaurant.distance.toFixed(1) }} miles away</span>\r\n            </div>\r\n            <span class=\"restaurant-address\">{{ restaurant.address }}, {{ restaurant.city }}, {{ restaurant.state }} {{ restaurant.zip }}</span>\r\n          </div>\r\n          <div class=\"restaurant-actions\">\r\n            <button @click=\"toggleBucketList(restaurant)\" class=\"action-btn\" :class=\"{ 'in-bucket-list': isInBucketList(restaurant.id) }\" :title=\"isInBucketList(restaurant.id) ? 'Remove from Bucket List' : 'Add to Bucket List'\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M18 7h-2.06c-.33-3.2-2.46-5.8-5.94-5.8S4.39 3.8 4.06 7H2v12h16V7zM6.14 7c.2-1.92 1.6-3.48 3.86-3.8A4.002 4.002 0 0 1 14 7h-2.14c-.2-1.92-1.6-3.48-3.86-3.8zM16 17H4v-8h12v8z\"/></svg>\r\n            </button>\r\n            <a :href=\"getDirectionsUrl(restaurant)\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"action-btn\" title=\"Get Directions\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M22.43 10.59l-9.01-9.01c-.75-.75-2.07-.76-2.83 0l-9.01 9.01c-.76.75-.76 2.07 0 2.83l9.01 9.01c.75.75 2.07.75 2.83 0l9.01-9.01c.75-.76.75-2.08 0-2.83zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4z\"/></svg>\r\n            </a>\r\n            <a :href=\"getDetailsUrl(restaurant)\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"action-btn\" title=\"View Details on Google\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 5 1.41-1.41L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\"/></svg>\r\n            </a>\r\n            <button class=\"check-in-btn\" @click=\"$emit('review-at', restaurant.id)\">Review</button>\r\n          </div>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, onUnmounted } from 'vue';\r\nimport { db, auth } from '../firebase';\r\nimport { collection, getDocs, query, where, Timestamp, onSnapshot, addDoc, deleteDoc, serverTimestamp } from 'firebase/firestore';\r\nimport StarRating from './StarRating.vue';\r\nimport { getDistance } from '../utils/geolocation.js';\r\n\r\nexport default {\r\n  name: 'Recommendations',\r\n  components: { StarRating },\r\n  emits: ['review-at'],\r\n  setup() {\r\n    const restaurants = ref([]);\r\n    const loading = ref(true);\r\n    const userLocation = ref(null);\r\n    const bucketList = ref(new Set());\r\n    let bucketListUnsubscribe = () => {};\r\n\r\n    const fetchRecommendations = async () => {\r\n      if (!userLocation.value) {\r\n        console.error(\"User location not available.\");\r\n        loading.value = false;\r\n        restaurants.value = [];\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const allRestaurantsSnapshot = await getDocs(collection(db, 'restaurants'));\r\n        const allRestaurants = allRestaurantsSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n\r\n        const nearbyRestaurants = allRestaurants.filter(r => {\r\n          if (!r.location || typeof r.location.lat !== 'number' || typeof r.location.lng !== 'number') {\r\n            return false;\r\n          }\r\n          const distance = getDistance(userLocation.value.lat, userLocation.value.lng, r.location.lat, r.location.lng);\r\n          r.distance = distance;\r\n          return distance !== null && distance <= 100;\r\n        });\r\n\r\n        const sixMonthsAgo = new Date();\r\n        sixMonthsAgo.setMonth(sixMonthsAgo.getMonth() - 6);\r\n        const sixMonthsAgoTimestamp = Timestamp.fromDate(sixMonthsAgo);\r\n\r\n        const reviewsQuery = query(collection(db, 'reviews'), where('createdAt', '>=', sixMonthsAgoTimestamp));\r\n        const reviewsSnapshot = await getDocs(reviewsQuery);\r\n        const recentReviews = reviewsSnapshot.docs.map(doc => doc.data());\r\n\r\n        const recommendations = nearbyRestaurants.map(restaurant => {\r\n          const relevantReviews = recentReviews.filter(review => review.restaurantId === restaurant.id && typeof review.rating === 'number');\r\n          let averageRating = 0;\r\n          let reviewCount = 0;\r\n\r\n          if (relevantReviews.length > 0) {\r\n            const totalRating = relevantReviews.reduce((sum, review) => sum + review.rating, 0);\r\n            averageRating = totalRating / relevantReviews.length;\r\n            reviewCount = relevantReviews.length;\r\n          }\r\n\r\n          return { ...restaurant, averageRating, reviewCount };\r\n        }).filter(r => r.reviewCount > 0);\r\n\r\n        recommendations.sort((a, b) => b.averageRating - a.averageRating);\r\n        restaurants.value = recommendations.slice(0, 10);\r\n\r\n      } catch (error) {\r\n        console.error(\"Error fetching recommendations:\", error);\r\n      } finally {\r\n        loading.value = false;\r\n      }\r\n    };\r\n\r\n    onMounted(() => {\r\n      if (navigator.geolocation) {\r\n        navigator.geolocation.getCurrentPosition(position => {\r\n          userLocation.value = {\r\n            lat: position.coords.latitude,\r\n            lng: position.coords.longitude\r\n          };\r\n          fetchRecommendations();\r\n          subscribeToBucketList();\r\n        }, (error) => {\r\n          console.error(\"Geolocation failed. Using default location.\", error);\r\n          userLocation.value = { lat: 41.5, lng: -90.5 }; // Default to Quad Cities\r\n          fetchRecommendations();\r\n          subscribeToBucketList();\r\n        });\r\n      } else {\r\n        console.error(\"Geolocation is not supported by this browser.\");\r\n        userLocation.value = { lat: 41.5, lng: -90.5 }; // Default to Quad Cities\r\n        fetchRecommendations();\r\n        subscribeToBucketList();\r\n      }\r\n    });\r\n\r\n    onUnmounted(() => {\r\n      bucketListUnsubscribe();\r\n    });\r\n\r\n    const getDirectionsUrl = (restaurant) => {\r\n      const destination = encodeURIComponent(`${restaurant.name}, ${restaurant.address}`);\r\n      return `https://www.google.com/maps/dir/?api=1&destination=${destination}`;\r\n    };\r\n\r\n    const getDetailsUrl = (restaurant) => {\r\n      const query = encodeURIComponent(`${restaurant.name}, ${restaurant.address}`);\r\n      return `https://www.google.com/search?q=${query}`;\r\n    };\r\n\r\n    const subscribeToBucketList = () => {\r\n      const currentUser = auth.currentUser;\r\n      if (!currentUser) return;\r\n      const q = query(collection(db, 'bucketListItems'), where('userId', '==', currentUser.uid));\r\n      bucketListUnsubscribe = onSnapshot(q, (snapshot) => {\r\n        const newBucketList = new Set();\r\n        snapshot.forEach(doc => newBucketList.add(doc.data().restaurantId));\r\n        bucketList.value = newBucketList;\r\n      });\r\n    };\r\n\r\n    const isInBucketList = (restaurantId) => {\r\n      return bucketList.value.has(restaurantId);\r\n    };\r\n\r\n    const toggleBucketList = async (restaurant) => {\r\n      const currentUser = auth.currentUser;\r\n      if (!currentUser) return;\r\n\r\n      if (isInBucketList(restaurant.id)) {\r\n        const q = query(collection(db, 'bucketListItems'), where('userId', '==', currentUser.uid), where('restaurantId', '==', restaurant.id));\r\n        const snapshot = await getDocs(q);\r\n        snapshot.forEach(doc => deleteDoc(doc.ref));\r\n      } else {\r\n        await addDoc(collection(db, 'bucketListItems'), {\r\n          userId: currentUser.uid,\r\n          restaurantId: restaurant.id,\r\n          createdAt: serverTimestamp()\r\n        });\r\n      }\r\n    };\r\n\r\n    return {\r\n      restaurants,\r\n      loading,\r\n      getDirectionsUrl,\r\n      getDetailsUrl,\r\n      isInBucketList,\r\n      toggleBucketList\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.page-header {\r\n  text-align: center;\r\n  margin-bottom: 2em;\r\n}\r\n.page-header h2 {\r\n  margin-bottom: 0.25em;\r\n}\r\n.page-header p {\r\n  color: #777;\r\n  max-width: 500px;\r\n  margin: 0 auto;\r\n}\r\n.loading-indicator, .no-restaurants-message {\r\n  text-align: center;\r\n  color: #777;\r\n  padding: 3em;\r\n}\r\n.restaurant-list {\r\n  list-style: none;\r\n  padding: 0;\r\n  margin: 0;\r\n}\r\n.restaurant-item {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 1.5em;\r\n  background: var(--card-background);\r\n  border-radius: 12px;\r\n  box-shadow: 0 4px 15px var(--shadow-color);\r\n  margin-bottom: 1.5em;\r\n}\r\n.restaurant-details {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n.restaurant-name {\r\n  font-weight: 600;\r\n  font-size: 1.2em;\r\n  margin-bottom: 0.25em;\r\n  word-break: break-word;\r\n}\r\n.restaurant-meta {\r\n  display: flex;\r\n  align-items: center;\r\n  flex-wrap: wrap;\r\n  gap: 1em;\r\n  margin-bottom: 0.5em;\r\n  color: #555;\r\n  font-size: 0.9em;\r\n}\r\n.rating {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.25em;\r\n}\r\n.rating-text {\r\n  font-weight: bold;\r\n  margin-left: 0.25em;\r\n}\r\n.rating-count {\r\n  color: #777;\r\n}\r\n.distance {\r\n  font-style: italic;\r\n}\r\n.restaurant-address {\r\n  color: #777;\r\n  font-size: 0.9em;\r\n  word-break: break-word;\r\n}\r\n.restaurant-actions {\r\n  display: flex;\r\n  gap: 0.75em;\r\n}\r\n.action-btn, .check-in-btn {\r\n  background: none;\r\n  border: 1px solid #ccc;\r\n  border-radius: 8px;\r\n  padding: 8px;\r\n  cursor: pointer;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  transition: all 0.2s;\r\n  color: #555;\r\n}\r\n.action-btn:hover {\r\n  background-color: #f0f0f0;\r\n  border-color: #bbb;\r\n}\r\n.action-btn svg {\r\n  width: 20px;\r\n  height: 20px;\r\n}\r\n.check-in-btn {\r\n  background-color: var(--primary-color);\r\n  color: white;\r\n  border-color: var(--primary-color);\r\n  padding: 8px 16px;\r\n  font-weight: 600;\r\n}\r\n.check-in-btn:hover {\r\n  background-color: var(--primary-dark-color);\r\n}\r\n.in-bucket-list {\r\n  color: var(--primary-color) !important;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .restaurant-item {\r\n    flex-direction: column;\r\n    align-items: flex-start;\r\n    gap: 1em;\r\n  }\r\n  .restaurant-actions {\r\n    width: 100%;\r\n    flex-wrap: wrap;\r\n    gap: 0.5em;\r\n  }\r\n  .restaurant-actions .action-btn,\r\n  .restaurant-actions .check-in-btn {\r\n    flex-grow: 1;\r\n    justify-content: center;\r\n  }\r\n}\r\n</style>","import { render } from \"./Recommendations.vue?vue&type=template&id=7a582d05&scoped=true\"\nimport script from \"./Recommendations.vue?vue&type=script&lang=js\"\nexport * from \"./Recommendations.vue?vue&type=script&lang=js\"\n\nimport \"./Recommendations.vue?vue&type=style&index=0&id=7a582d05&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7a582d05\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"stats-page\">\r\n    <h2>Database Stats</h2>\r\n    <div class=\"stats-container\">\r\n      <div v-if=\"statsLoading\">Loading stats...</div>\r\n      <ul v-else-if=\"stats\" class=\"stats-grid\">\r\n        <li class=\"stat-card\">\r\n          <strong>Restaurants</strong>\r\n          <span>{{ stats.restaurants }}</span>\r\n        </li>\r\n        <li class=\"stat-card\">\r\n          <strong>Users</strong>\r\n          <span>{{ stats.users }}</span>\r\n        </li>\r\n        <li class=\"stat-card\">\r\n          <strong>Reviews</strong>\r\n          <span>{{ stats.reviews }}</span>\r\n        </li>\r\n        <li class=\"stat-card\">\r\n          <strong>Follows</strong>\r\n          <span>{{ stats.follows }}</span>\r\n        </li>\r\n      </ul>\r\n      <div v-else>Could not load stats.</div>\r\n      <div v-if=\"log.length > 0\" class=\"log-container\">\r\n        <h3>Log:</h3>\r\n        <pre>{{ log.join('\\n') }}</pre>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted } from 'vue';\r\nimport { db } from '../firebase';\r\nimport { collection, getCountFromServer } from 'firebase/firestore';\r\n\r\nexport default {\r\n  name: 'DatabaseStats',\r\n  setup() {\r\n    const stats = ref(null);\r\n    const statsLoading = ref(true);\r\n    const log = ref([]);\r\n\r\n    const fetchCollectionStats = async () => {\r\n      statsLoading.value = true;\r\n      try {\r\n        const collectionsToCount = ['restaurants', 'users', 'reviews', 'follows'];\r\n        const counts = {};\r\n        const promises = collectionsToCount.map(async (colName) => {\r\n          const coll = collection(db, colName);\r\n          const snapshot = await getCountFromServer(coll);\r\n          counts[colName] = snapshot.data().count;\r\n        });\r\n        await Promise.all(promises);\r\n        stats.value = counts;\r\n      } catch (error) {\r\n        log.value.push('Error fetching collection stats: ' + error.message);\r\n        console.error(\"Error fetching stats:\", error);\r\n      } finally {\r\n        statsLoading.value = false;\r\n      }\r\n    };\r\n\r\n    onMounted(fetchCollectionStats);\r\n\r\n    return { stats, statsLoading, log };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.stats-page {\r\n  max-width: 900px;\r\n  margin: 0 auto;\r\n}\r\n.stats-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\r\n  gap: 1.5em;\r\n  list-style: none;\r\n  padding: 0;\r\n}\r\n.stat-card {\r\n  background: var(--card-background);\r\n  padding: 1.5em;\r\n  border-radius: 12px;\r\n  box-shadow: 0 4px 15px var(--shadow-color);\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 0.5em;\r\n}\r\n.stat-card strong {\r\n  font-size: 1.1em;\r\n  color: var(--text-color);\r\n}\r\n.stat-card span {\r\n  font-size: 2.5em;\r\n  font-weight: 700;\r\n  color: var(--primary-color);\r\n}\r\n.log-container {\r\n  margin-top: 24px;\r\n  background: #fff;\r\n  padding: 16px;\r\n  border-radius: 8px;\r\n  border: 1px solid #eee;\r\n}\r\npre {\r\n    white-space: pre-wrap;\r\n    word-wrap: break-word;\r\n}\r\n</style>","import { render } from \"./DatabaseStats.vue?vue&type=template&id=7fa04ecf&scoped=true\"\nimport script from \"./DatabaseStats.vue?vue&type=script&lang=js\"\nexport * from \"./DatabaseStats.vue?vue&type=script&lang=js\"\n\nimport \"./DatabaseStats.vue?vue&type=style&index=0&id=7fa04ecf&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7fa04ecf\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"my-reviews-page\">\r\n    <div v-if=\"loading\" class=\"loading-indicator\">Loading your reviews...</div>\r\n    <div v-else-if=\"populatedReviews.length === 0\" class=\"no-reviews-message\">\r\n      <h3>You haven't posted any reviews yet.</h3>\r\n      <button @click=\"$emit('go-to-review')\" class=\"btn-primary\">Post your first review!</button>\r\n    </div>\r\n    <div v-else class=\"feed\">\r\n      <div v-for=\"review in populatedReviews\" :key=\"review.id\" class=\"post-card\">\r\n        <div class=\"post-header\">\r\n          <img :src=\"review.userPhoto || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" alt=\"User\" class=\"user-avatar\" referrerpolicy=\"no-referrer\" />\r\n          <div class=\"post-info\">\r\n            <div class=\"user-line\">\r\n              <span class=\"user-name\">{{ review.userName }}</span>\r\n              <span v-if=\"review.medal\" class=\"medal\">{{ review.medal }}</span>\r\n            </div>\r\n            <span class=\"post-date\">{{ formatDate(review.createdAt) }}</span>\r\n          </div>\r\n        </div>\r\n        <div class=\"post-content\">\r\n          <div class=\"post-title-line\">\r\n            <div class=\"restaurant-title-group\">\r\n              <h2 class=\"restaurant-name\">{{ review.restaurantName }}</h2>\r\n              <div v-if=\"editingReviewId !== review.id\" class=\"review-actions\">\r\n                <button @click=\"startEditing(review)\" class=\"action-btn\" title=\"Edit Review\">\r\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"20px\" viewBox=\"0 0 24 24\" width=\"20px\" fill=\"currentColor\">\r\n                    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\r\n                    <path d=\"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z\"/>\r\n                  </svg>\r\n                </button>\r\n                <button @click=\"deleteReview(review.id)\" class=\"action-btn delete\" title=\"Delete Review\">\r\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"20px\" viewBox=\"0 0 24 24\" width=\"20px\" fill=\"currentColor\">\r\n                    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\r\n                    <path d=\"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z\"/>\r\n                  </svg>\r\n                </button>\r\n              </div>\r\n            </div>\r\n            <div v-if=\"review.distance !== null\" class=\"distance\">\r\n              {{ review.distance.toFixed(1) }} miles away\r\n            </div>\r\n          </div>\r\n          <div v-if=\"review.restaurantCity || review.restaurantState\" class=\"restaurant-location\">\r\n            {{ review.restaurantCity }}<template v-if=\"review.restaurantCity && review.restaurantState\">, </template>{{ review.restaurantState }}\r\n          </div>\r\n          <div v-if=\"editingReviewId === review.id\" class=\"edit-review-form\">\r\n            <div class=\"form-group\">\r\n              <label>Rating</label>\r\n              <StarRating :rating=\"editingRating\" :editable=\"true\" @update:rating=\"editingRating = $event\" />\r\n            </div>\r\n            <div class=\"form-group\">\r\n              <label>Comment</label>\r\n              <textarea v-model=\"editingText\" class=\"edit-textarea\" rows=\"4\"></textarea>\r\n            </div>\r\n            <div class=\"edit-actions\">\r\n              <button @click=\"saveEdit\" class=\"btn-primary\">Save</button>\r\n              <button @click=\"cancelEdit\" class=\"btn-secondary\">Cancel</button>\r\n            </div>\r\n          </div>\r\n          <div v-else class=\"review-body\">\r\n            <StarRating :rating=\"review.rating\" />\r\n            <p v-if=\"review.text\" class=\"review-text\">\"{{ review.text }}\"</p>\r\n            <img v-if=\"review.photoURL\" :src=\"review.photoURL\" alt=\"Review photo\" class=\"review-photo\" loading=\"lazy\" />\r\n            <div v-if=\"review.tags && review.tags.length > 0\" class=\"tags-container\">\r\n              <span v-for=\"tag in review.tags\" :key=\"tag\" class=\"tag\">{{ tag }}</span>\r\n            </div>\r\n          </div>\r\n          <div class=\"post-actions\">\r\n            <button @click=\"toggleLike(review.id)\" class=\"like-btn\" :class=\"{ 'liked': review.isLiked }\" :disabled=\"!user\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"20px\" viewBox=\"0 0 24 24\" width=\"20px\" fill=\"currentColor\">\r\n                <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\r\n                <path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\"/>\r\n              </svg>\r\n              <span>{{ review.likeCount || 0 }}</span>\r\n            </button>\r\n            <button @click=\"shareReview(review.id)\" class=\"share-btn\" :title=\"'Share this review'\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"20px\" viewBox=\"0 0 24 24\" width=\"20px\" fill=\"currentColor\">\r\n                <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\r\n                <path d=\"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z\"/>\r\n              </svg>\r\n              <span>Share</span>\r\n            </button>\r\n          </div>\r\n          <Comments :post-id=\"review.id\"\r\n                    :user=\"user\"\r\n                    post-type=\"reviews\"\r\n                    :post-author-id=\"review.userId\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted, onUnmounted, watch } from 'vue';\r\nimport { db, auth } from '../firebase';\r\nimport { collection, query, where, orderBy, onSnapshot, doc, updateDoc, deleteDoc, getDocs, limit, addDoc, serverTimestamp, getDoc } from 'firebase/firestore';\r\nimport StarRating from './StarRating.vue';\r\nimport Comments from './Comments.vue';\r\nimport { getDistance } from '../utils/geolocation.js';\r\nimport { showToast } from '../utils/toast.js';\r\n\r\nconst props = defineProps({\r\n  user: {\r\n    type: Object,\r\n    default: null\r\n  }\r\n});\r\n\r\ndefineEmits(['go-to-review']);\r\n\r\nconst loading = ref(true);\r\nconst reviews = ref([]);\r\nconst restaurantsMap = ref(new Map());\r\nconst editingReviewId = ref(null);\r\nconst editingText = ref('');\r\nconst editingRating = ref(0);\r\nconst originalEditData = ref(null);\r\nconst userLocation = ref(null);\r\nconst leaderboardRanks = ref(new Map());\r\n\r\nconst getMedal = (index) => {\r\n  // Medals are assigned based on position (0-indexed)\r\n  // Position 1 (index 0): Gold medal \r\n  // Position 2 (index 1): Silver medal \r\n  // Position 3 (index 2): Bronze medal \r\n  // Positions 4-10 (index 3-9): Participation medal \r\n  if (typeof index !== 'number') return null;\r\n  if (index === 0) return '';\r\n  if (index === 1) return '';\r\n  if (index === 2) return '';\r\n  if (index >= 3 && index < 10) return '';\r\n  return null;\r\n};\r\n\r\nlet reviewsUnsubscribe = () => {};\r\nlet restaurantsUnsubscribe = () => {};\r\n\r\nconst setupListeners = (currentUser) => {\r\n  if (!currentUser) {\r\n    reviews.value = [];\r\n    loading.value = false;\r\n    if (reviewsUnsubscribe) reviewsUnsubscribe();\r\n    return;\r\n  }\r\n\r\n  loading.value = true;\r\n\r\n  // Real-time listener for the user's reviews\r\n  const reviewsQuery = query(\r\n    collection(db, \"reviews\"),\r\n    where(\"userId\", \"==\", currentUser.uid),\r\n    orderBy(\"createdAt\", \"desc\")\r\n  );\r\n\r\n  reviewsUnsubscribe = onSnapshot(reviewsQuery, (snapshot) => {\r\n    reviews.value = snapshot.docs.map(doc => ({ \r\n      id: doc.id, \r\n      ...doc.data(),\r\n      likeCount: 0,\r\n      isLiked: false\r\n    }));\r\n    loading.value = false;\r\n    \r\n    // Set up like listeners for each review\r\n    reviews.value.forEach(review => {\r\n      setupLikeListener(review.id);\r\n    });\r\n  }, (error) => {\r\n    console.error(\"Error fetching reviews:\", error);\r\n    loading.value = false;\r\n  });\r\n};\r\n\r\nconst setupLikeListener = (reviewId) => {\r\n  const currentUser = props.user;\r\n  const reviewRef = doc(db, 'reviews', reviewId);\r\n  const likesCollection = collection(reviewRef, 'likes');\r\n  const likesQuery = query(likesCollection);\r\n  \r\n  onSnapshot(likesQuery, (snapshot) => {\r\n    const review = reviews.value.find(r => r.id === reviewId);\r\n    if (review) {\r\n      review.likeCount = snapshot.size;\r\n      review.isLiked = currentUser ? snapshot.docs.some(doc => doc.data().userId === currentUser.uid) : false;\r\n    }\r\n  }, (error) => {\r\n    console.error('Error fetching likes:', error);\r\n  });\r\n};\r\n\r\nconst toggleLike = async (reviewId) => {\r\n  const currentUser = props.user;\r\n  if (!currentUser) return;\r\n  \r\n  const reviewRef = doc(db, 'reviews', reviewId);\r\n  const likesCollection = collection(reviewRef, 'likes');\r\n  const likeQuery = query(likesCollection, where('userId', '==', currentUser.uid));\r\n  const likeSnap = await getDocs(likeQuery);\r\n  \r\n  if (!likeSnap.empty) {\r\n    // Unlike - delete the like document\r\n    await deleteDoc(likeSnap.docs[0].ref);\r\n  } else {\r\n    // Like - create a like document\r\n    await addDoc(likesCollection, {\r\n      userId: currentUser.uid,\r\n      createdAt: serverTimestamp()\r\n    });\r\n  }\r\n};\r\n\r\nconst shareReview = async (reviewId) => {\r\n  const baseUrl = window.location.origin;\r\n  // Use query parameter format for better compatibility with social media sharing\r\n  // The app's handleDeepLink() in App.vue will parse the ?review= query parameter\r\n  const shareableLink = `${baseUrl}/?review=${reviewId}`;\r\n  \r\n  // Try Web Share API first (mobile-friendly)\r\n  if (navigator.share) {\r\n    try {\r\n      await navigator.share({\r\n        title: 'Check out this review on PorkHub',\r\n        text: 'Check out this review on PorkHub',\r\n        url: shareableLink\r\n      });\r\n      return;\r\n    } catch (err) {\r\n      // User cancelled or error - fall through to copy\r\n      if (err.name !== 'AbortError') {\r\n        console.error('Error sharing:', err);\r\n      }\r\n    }\r\n  }\r\n  \r\n      // Fallback: Copy to clipboard\r\n      try {\r\n        await navigator.clipboard.writeText(shareableLink);\r\n        showToast('Link copied to clipboard!', 'success');\r\n      } catch (err) {\r\n        console.error('Failed to copy link:', err);\r\n        // Fallback: Show link in prompt\r\n        const copied = prompt('Copy this link:', shareableLink);\r\n        if (copied) {\r\n          showToast('Link copied!', 'success');\r\n        }\r\n      }\r\n};\r\n\r\nonMounted(() => {\r\n  // Get user location if available\r\n  if (navigator.geolocation) {\r\n    navigator.geolocation.getCurrentPosition(position => {\r\n      userLocation.value = {\r\n        lat: position.coords.latitude,\r\n        lng: position.coords.longitude\r\n      };\r\n    }, (error) => {\r\n      console.error(\"Error getting location\", error);\r\n    });\r\n  }\r\n\r\n  // Fetch leaderboard ranks\r\n  getDocs(query(collection(db, 'users'), orderBy('reviewCount', 'desc'), limit(30))).then(leaderboardSnap => {\r\n    const usersWithReviews = leaderboardSnap.docs\r\n      .map(doc => ({ id: doc.id, ...doc.data() }))\r\n      .filter(user => {\r\n        const count = Number(user.reviewCount) || 0;\r\n        return count > 0;\r\n      })\r\n      .sort((a, b) => {\r\n        const countA = Number(a.reviewCount) || 0;\r\n        const countB = Number(b.reviewCount) || 0;\r\n        return countB - countA;\r\n      })\r\n      .slice(0, 10);\r\n    \r\n    const ranks = new Map();\r\n    usersWithReviews.forEach((user, index) => {\r\n      ranks.set(user.id, index);\r\n    });\r\n    leaderboardRanks.value = ranks;\r\n  });\r\n\r\n  // Real-time listener for all restaurants to get their names\r\n  restaurantsUnsubscribe = onSnapshot(collection(db, 'restaurants'), (snapshot) => {\r\n    const newMap = new Map();\r\n    snapshot.forEach(doc => {\r\n      newMap.set(doc.id, doc.data());\r\n    });\r\n    restaurantsMap.value = newMap;\r\n  });\r\n\r\n  // Watch for user prop changes to set up or tear down listeners\r\n  watch(() => props.user, (newUser) => {\r\n    setupListeners(newUser);\r\n  }, { immediate: true });\r\n});\r\n\r\nonUnmounted(() => {\r\n  if (reviewsUnsubscribe) reviewsUnsubscribe();\r\n  if (restaurantsUnsubscribe) restaurantsUnsubscribe();\r\n});\r\n\r\nconst populatedReviews = computed(() => {\r\n  const currentUser = props.user;\r\n  return reviews.value.map(review => {\r\n    const restaurant = restaurantsMap.value.get(review.restaurantId);\r\n    const rank = leaderboardRanks.value.get(currentUser?.uid);\r\n    return {\r\n      ...review,\r\n      restaurantName: restaurant?.name || \"Unknown Restaurant\",\r\n      restaurantCity: restaurant?.city,\r\n      restaurantState: restaurant?.state,\r\n      userName: currentUser?.displayName || 'You',\r\n      userPhoto: currentUser?.photoURL || null,\r\n      distance: userLocation.value && restaurant?.location ? getDistance(userLocation.value.lat, userLocation.value.lng, restaurant.location.lat, restaurant.location.lng) : null,\r\n      medal: getMedal(rank)\r\n    };\r\n  });\r\n});\r\n\r\nconst formatDate = (timestamp) => {\r\n  return timestamp && timestamp.toDate ? timestamp.toDate().toLocaleString() : '';\r\n};\r\n\r\nconst startEditing = (review) => {\r\n  editingReviewId.value = review.id;\r\n  editingText.value = review.text || '';\r\n  editingRating.value = review.rating || 0;\r\n  originalEditData.value = {\r\n    text: review.text || '',\r\n    rating: review.rating || 0\r\n  };\r\n};\r\n\r\nconst cancelEdit = () => {\r\n  if (originalEditData.value && \r\n      (editingText.value !== originalEditData.value.text || \r\n       editingRating.value !== originalEditData.value.rating)) {\r\n    if (confirm('You have unsaved changes. Are you sure you want to cancel?')) {\r\n      editingReviewId.value = null;\r\n      editingText.value = '';\r\n      editingRating.value = 0;\r\n      originalEditData.value = null;\r\n    }\r\n  } else {\r\n    editingReviewId.value = null;\r\n    editingText.value = '';\r\n    editingRating.value = 0;\r\n    originalEditData.value = null;\r\n  }\r\n};\r\n\r\nconst saveEdit = async () => {\r\n  if (!editingReviewId.value) return;\r\n  \r\n  try {\r\n    const reviewRef = doc(db, 'reviews', editingReviewId.value);\r\n    await updateDoc(reviewRef, {\r\n      rating: editingRating.value,\r\n      text: editingText.value,\r\n      lastActivityAt: serverTimestamp() // Update lastActivityAt when editing\r\n    });\r\n    cancelEdit();\r\n    showToast('Review updated successfully!', 'success');\r\n  } catch (error) {\r\n    console.error('Error updating review:', error);\r\n    showToast('Failed to save review. Please try again.', 'error');\r\n  }\r\n};\r\n\r\nconst deleteReview = async (reviewId) => {\r\n  if (!confirm('Are you sure you want to delete this review?')) return;\r\n  \r\n  try {\r\n    await deleteDoc(doc(db, 'reviews', reviewId));\r\n    showToast('Review deleted successfully', 'success');\r\n  } catch (error) {\r\n    console.error('Error deleting review:', error);\r\n    showToast('Failed to delete review. Please try again.', 'error');\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.my-reviews-page {\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n}\r\n\r\n.loading-indicator, .no-reviews-message {\r\n  text-align: center;\r\n  color: #777;\r\n  padding: 3em;\r\n}\r\n\r\n.no-reviews-message h3 {\r\n  margin-bottom: 0.5em;\r\n}\r\n\r\n.btn-primary {\r\n  margin-top: 1em;\r\n  background-color: var(--primary-color);\r\n  color: white;\r\n  border: none;\r\n  padding: 10px 20px;\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n}\r\n\r\n.post-card {\r\n  background: var(--card-background);\r\n  border-radius: 12px;\r\n  box-shadow: 0 4px 15px var(--shadow-color);\r\n  margin-bottom: 2em;\r\n  overflow: hidden;\r\n}\r\n\r\n.post-header {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 1em;\r\n  padding: 1em 1.5em;\r\n  border-bottom: 1px solid #eee;\r\n}\r\n\r\n.user-avatar {\r\n  width: 45px;\r\n  height: 45px;\r\n  border-radius: 50%;\r\n}\r\n\r\n.post-info {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.user-line {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5em;\r\n}\r\n\r\n.user-name {\r\n  font-weight: 600;\r\n}\r\n\r\n.medal {\r\n  font-size: 1.1em;\r\n}\r\n\r\n.post-date {\r\n  color: #7f8c8d;\r\n  font-size: 0.85em;\r\n}\r\n\r\n.post-content {\r\n  padding: 0.5em 1.5em 1.5em;\r\n}\r\n\r\n.post-title-line {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: baseline;\r\n  margin-bottom: 0.25em;\r\n}\r\n\r\n.restaurant-title-group {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5em;\r\n}\r\n\r\n.restaurant-name {\r\n  font-size: 1.1em;\r\n  font-weight: 600;\r\n  margin: 0;\r\n}\r\n\r\n.review-actions {\r\n  display: flex;\r\n  gap: 0.25em;\r\n}\r\n\r\n.action-btn {\r\n  background: none;\r\n  border: none;\r\n  cursor: pointer;\r\n  padding: 0;\r\n  display: flex;\r\n  align-items: center;\r\n  color: #555;\r\n  transition: color 0.2s;\r\n}\r\n\r\n.action-btn:hover {\r\n  color: var(--primary-color);\r\n}\r\n\r\n.action-btn.delete:hover {\r\n  color: #e74c3c;\r\n}\r\n\r\n.distance {\r\n  font-size: 0.9em;\r\n  color: #777;\r\n  font-style: italic;\r\n}\r\n\r\n.restaurant-location {\r\n  font-size: 0.9em;\r\n  color: #777;\r\n  margin-bottom: 0.75em;\r\n}\r\n\r\n.review-body {\r\n  margin-bottom: 1em;\r\n}\r\n\r\n.review-text {\r\n  font-style: italic;\r\n  color: #333;\r\n  margin: 0.5em 0;\r\n}\r\n\r\n.review-photo {\r\n  max-width: 100%;\r\n  height: auto;\r\n  border-radius: 8px;\r\n  margin: 0.5em 0;\r\n}\r\n\r\n.tags-container {\r\n  margin-top: 0.75em;\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 0.5em;\r\n}\r\n\r\n.tag {\r\n  background-color: #eee;\r\n  padding: 0.25em 0.75em;\r\n  border-radius: 15px;\r\n  font-size: 0.8em;\r\n}\r\n\r\n.edit-review-form {\r\n  margin-top: 0.5em;\r\n  padding: 1em;\r\n  background-color: #f9f9f9;\r\n  border-radius: 8px;\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 1em;\r\n}\r\n\r\n.form-group label {\r\n  display: block;\r\n  margin-bottom: 0.5em;\r\n  font-weight: 600;\r\n}\r\n\r\n.edit-textarea {\r\n  width: 100%;\r\n  padding: 12px;\r\n  border-radius: 8px;\r\n  border: 1px solid #ddd;\r\n  box-sizing: border-box;\r\n  font-family: inherit;\r\n  font-size: 1em;\r\n  resize: vertical;\r\n}\r\n\r\n.edit-actions {\r\n  display: flex;\r\n  gap: 0.5em;\r\n  margin-top: 1em;\r\n}\r\n\r\n.btn-primary, .btn-secondary {\r\n  padding: 8px 16px;\r\n  border-radius: 8px;\r\n  border: none;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n}\r\n\r\n.btn-primary {\r\n  background-color: var(--primary-color);\r\n  color: white;\r\n}\r\n\r\n.btn-secondary {\r\n  background-color: #ecf0f1;\r\n  color: #555;\r\n}\r\n\r\n.btn-secondary:hover {\r\n  background-color: #dfe6e9;\r\n}\r\n\r\n.post-actions {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-top: 0.5em;\r\n  padding-top: 0.5em;\r\n  margin-bottom: 0;\r\n  padding-bottom: 0;\r\n  border-top: 1px solid #eee;\r\n}\r\n\r\n.like-btn {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5em;\r\n  background: none;\r\n  border: none;\r\n  cursor: pointer;\r\n  padding: 0.5em 0.75em;\r\n  border-radius: 8px;\r\n  color: #555;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.like-btn:hover:not(:disabled) {\r\n  background-color: #f0f0f0;\r\n}\r\n\r\n.like-btn:disabled {\r\n  cursor: not-allowed;\r\n  opacity: 0.6;\r\n}\r\n\r\n.like-btn.liked {\r\n  color: #e74c3c;\r\n}\r\n\r\n.like-btn svg {\r\n  width: 20px;\r\n  height: 20px;\r\n  fill: currentColor;\r\n}\r\n\r\n.share-btn {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5em;\r\n  background: none;\r\n  border: none;\r\n  cursor: pointer;\r\n  padding: 0.5em 0.75em;\r\n  border-radius: 8px;\r\n  color: #555;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.share-btn:hover {\r\n  background-color: #f0f0f0;\r\n}\r\n\r\n.share-btn svg {\r\n  width: 20px;\r\n  height: 20px;\r\n  fill: currentColor;\r\n}\r\n</style>","import script from \"./MyReviews.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./MyReviews.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./MyReviews.vue?vue&type=style&index=0&id=0bcf4dba&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0bcf4dba\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"leaderboard-page\">\r\n    <div class=\"page-header\">\r\n      <h2>Leaderboard</h2>\r\n      <p>Top 10 reviewers</p>\r\n    </div>\r\n    <div v-if=\"loading\" class=\"loading-indicator\">Loading leaderboard...</div>\r\n    <div v-else-if=\"users.length === 0\" class=\"no-users-message\">\r\n      <p>No users to display on the leaderboard yet.</p>\r\n    </div>\r\n    <ol v-else class=\"leaderboard-list\">\r\n      <li v-for=\"(user, index) in users\" :key=\"user.uid\" class=\"leaderboard-item\" :class=\"getRankClass(index)\">\r\n        <div class=\"rank-container\">\r\n          <span class=\"rank\">{{ index + 1 }}</span>\r\n          <span v-if=\"getMedal(index)\" class=\"medal\">{{ getMedal(index) }}</span>\r\n        </div>\r\n        <img :src=\"user.photoURL || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" alt=\"User\" class=\"user-avatar\" referrerpolicy=\"no-referrer\" />\r\n        <div class=\"user-info\">\r\n          <span class=\"user-name\">{{ user.displayName }}</span>\r\n          <span class=\"review-count\">{{ user.reviewCount || 0 }} reviews</span>\r\n        </div>\r\n      </li>\r\n    </ol>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, onUnmounted } from 'vue';\r\nimport { db } from '../firebase';\r\nimport { collection, query, orderBy, limit, onSnapshot } from 'firebase/firestore';\r\n\r\nexport default {\r\n  name: 'Leaderboard',\r\n  setup() {\r\n    const loading = ref(true);\r\n    const users = ref([]);\r\n    let unsubscribe = () => {};\r\n\r\n    onMounted(() => {\r\n      try {\r\n        // Fetch more users initially (e.g., 30) to account for filtering out users with 0 reviews\r\n        // After filtering and sorting, we'll display the top 10 reviewers\r\n        const usersQuery = query(\r\n          collection(db, 'users'),\r\n          orderBy('reviewCount', 'desc'),\r\n          limit(30)\r\n        );\r\n        \r\n        unsubscribe = onSnapshot(usersQuery, (querySnapshot) => {\r\n          // Map documents to user data\r\n          const fetchedUsers = querySnapshot.docs.map(doc => doc.data());\r\n          \r\n          // Filter out users with 0 or undefined reviewCount\r\n          // Only show users who have actually made reviews (leaders should have reviews)\r\n          const usersWithReviews = fetchedUsers.filter(user => {\r\n            const count = Number(user.reviewCount) || 0;\r\n            return count > 0;\r\n          });\r\n          \r\n          // Sort by reviewCount numerically in descending order (highest first)\r\n          // This ensures proper sorting even if Firestore ordering has issues\r\n          // Convert reviewCount to number for reliable numerical comparison\r\n          const sortedUsers = usersWithReviews.sort((a, b) => {\r\n            const countA = Number(a.reviewCount) || 0;\r\n            const countB = Number(b.reviewCount) || 0;\r\n            return countB - countA; // Descending order (highest first)\r\n          });\r\n          \r\n          // Take only the top 10 users after filtering and sorting\r\n          users.value = sortedUsers.slice(0, 10);\r\n          \r\n          loading.value = false;\r\n        }, (error) => {\r\n          console.error(\"Error fetching leaderboard:\", error);\r\n          loading.value = false;\r\n        });\r\n\r\n      } catch (error) {\r\n        console.error(\"Error setting up leaderboard listener:\", error);\r\n        loading.value = false;\r\n      }\r\n    });\r\n\r\n    onUnmounted(() => {\r\n      unsubscribe();\r\n    });\r\n\r\n    const getMedal = (index) => {\r\n      // Medals are assigned based on position (0-indexed)\r\n      // Position 1 (index 0): Gold medal \r\n      // Position 2 (index 1): Silver medal \r\n      // Position 3 (index 2): Bronze medal \r\n      // Positions 4-10 (index 3-9): Participation medal \r\n      if (index === 0) return '';\r\n      if (index === 1) return '';\r\n      if (index === 2) return '';\r\n      if (index >= 3 && index < 10) return '';\r\n      return null;\r\n    };\r\n\r\n    const getRankClass = (index) => {\r\n      if (index === 0) return 'rank-gold';\r\n      if (index === 1) return 'rank-silver';\r\n      if (index === 2) return 'rank-bronze';\r\n      if (index >= 3 && index < 10) return 'rank-regular';\r\n      return '';\r\n    };\r\n\r\n    return {\r\n      loading,\r\n      users,\r\n      getMedal,\r\n      getRankClass\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.leaderboard-page { max-width: 800px; margin: 0 auto; }\r\n.page-header { text-align: center; margin-bottom: 2em; }\r\n.page-header h2 { margin-bottom: 0.2em; }\r\n.page-header p { color: #777; margin-top: 0; }\r\n.loading-indicator, .no-users-message { text-align: center; color: #777; padding: 3em; }\r\n.leaderboard-list { list-style: none; padding: 0; }\r\n.leaderboard-item {\r\n  display: flex;\r\n  align-items: center;\r\n  background: var(--card-background);\r\n  border-radius: 12px;\r\n  box-shadow: 0 4px 15px var(--shadow-color);\r\n  margin-bottom: 1em;\r\n  padding: 1em 1.5em;\r\n  transition: transform 0.2s, box-shadow 0.2s;\r\n}\r\n.leaderboard-item:hover {\r\n  transform: translateY(-3px);\r\n  box-shadow: 0 6px 20px rgba(0,0,0,0.12);\r\n}\r\n.rank-container {\r\n  display: flex;\r\n  align-items: center;\r\n  font-size: 1.5em;\r\n  font-weight: 700;\r\n  color: var(--secondary-color);\r\n  margin-right: 1.5em;\r\n  width: 60px;\r\n  justify-content: center;\r\n}\r\n.medal { font-size: 1.2em; margin-left: 0.3em; }\r\n.rank-gold { border-left: 5px solid #ffd700; }\r\n.rank-silver { border-left: 5px solid #c0c0c0; }\r\n.rank-bronze { border-left: 5px solid #cd7f32; }\r\n.user-avatar {\r\n  width: 50px;\r\n  height: 50px;\r\n  border-radius: 50%;\r\n  margin-right: 1em;\r\n  object-fit: cover;\r\n}\r\n.user-info {\r\n  display: flex;\r\n  flex-direction: column;\r\n  flex-grow: 1;\r\n}\r\n.user-name {\r\n  font-weight: 600;\r\n  font-size: 1.1em;\r\n}\r\n.review-count {\r\n  color: #777;\r\n  font-size: 0.9em;\r\n}\r\n</style>","import { render } from \"./Leaderboard.vue?vue&type=template&id=7088546b&scoped=true\"\nimport script from \"./Leaderboard.vue?vue&type=script&lang=js\"\nexport * from \"./Leaderboard.vue?vue&type=script&lang=js\"\n\nimport \"./Leaderboard.vue?vue&type=style&index=0&id=7088546b&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7088546b\"]])\n\nexport default __exports__","<template>\r\n  <UserReviewsModal v-if=\"isReviewsModalVisible\" :user=\"userForReviews\" @close=\"closeReviewsModal\" />\r\n  <div class=\"followers-page\">\r\n    <div v-if=\"loading\" class=\"loading-indicator\">Loading followers...</div>\r\n    <div v-else>\r\n      <div v-if=\"followers.length === 0\" class=\"no-followers-message\">\r\n        <h3>No followers yet</h3>\r\n        <p>Start sharing reviews to attract followers! The more you review, the more visible you'll be.</p>\r\n      </div>\r\n      <div v-for=\"user in followers\" :key=\"user.uid\" class=\"user-card\">\r\n        <div class=\"user-card-content\">\r\n          <div class=\"user-info\">\r\n            <img :src=\"user.photoURL || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" class=\"user-avatar\" alt=\"User\" referrerpolicy=\"no-referrer\" />\r\n            <div class=\"user-name-line\">\r\n              <span class=\"user-name\">{{ user.displayName }}</span>\r\n              <span v-if=\"user.medal\" class=\"medal\">{{ user.medal }}</span>\r\n            </div>\r\n          </div>\r\n          <div v-if=\"user.lastReview\" class=\"last-review\">\r\n            <div class=\"review-header\">\r\n              Latest review: <strong>{{ user.lastReview.restaurantName }}</strong>\r\n            </div>\r\n            <div class=\"review-body\">\r\n              <StarRating :rating=\"user.lastReview.rating\" />\r\n              <p v-if=\"user.lastReview.text\" class=\"review-text\">\"{{ user.lastReview.text }}\"</p>\r\n            </div>\r\n          </div>\r\n          <div v-else class=\"last-review no-review\">\r\n            No reviews yet.\r\n          </div>\r\n        </div>\r\n        <div class=\"user-actions\">\r\n          <button @click=\"openReviewsModal(user)\" class=\"action-btn\" title=\"View Reviews\">\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z\"/></svg>\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted } from 'vue';\r\nimport { db, auth } from '../firebase';\r\nimport { collection, query, where, getDocs, orderBy, limit } from 'firebase/firestore';\r\nimport UserReviewsModal from './UserReviewsModal.vue';\r\nimport StarRating from './StarRating.vue';\r\n\r\nconst getMedal = (index) => {\r\n  // Medals are assigned based on position (0-indexed)\r\n  // Position 1 (index 0): Gold medal \r\n  // Position 2 (index 1): Silver medal \r\n  // Position 3 (index 2): Bronze medal \r\n  // Positions 4-10 (index 3-9): Participation medal \r\n  if (typeof index !== 'number') return null;\r\n  if (index === 0) return '';\r\n  if (index === 1) return '';\r\n  if (index === 2) return '';\r\n  if (index >= 3 && index < 10) return '';\r\n  return null;\r\n};\r\n\r\nexport default {\r\n  name: 'Followers',\r\n  components: { UserReviewsModal, StarRating },\r\n  setup() {\r\n    const followers = ref([]);\r\n    const loading = ref(true);\r\n    const isReviewsModalVisible = ref(false);\r\n    const userForReviews = ref(null);\r\n    const leaderboardRanks = ref(new Map());\r\n\r\n    const fetchFollowers = async () => {\r\n      loading.value = true;\r\n      const currentUser = auth.currentUser;\r\n      if (!currentUser) {\r\n        loading.value = false;\r\n        return;\r\n      }\r\n\r\n      // Fetch leaderboard ranks\r\n      const leaderboardSnap = await getDocs(query(collection(db, 'users'), orderBy('reviewCount', 'desc'), limit(30)));\r\n      const usersWithReviews = leaderboardSnap.docs\r\n        .map(doc => ({ id: doc.id, ...doc.data() }))\r\n        .filter(user => {\r\n          const count = Number(user.reviewCount) || 0;\r\n          return count > 0;\r\n        })\r\n        .sort((a, b) => {\r\n          const countA = Number(a.reviewCount) || 0;\r\n          const countB = Number(b.reviewCount) || 0;\r\n          return countB - countA;\r\n        })\r\n        .slice(0, 10);\r\n      \r\n      const ranks = new Map();\r\n      usersWithReviews.forEach((user, index) => {\r\n        ranks.set(user.id, index);\r\n      });\r\n      leaderboardRanks.value = ranks;\r\n\r\n      const followsQuery = query(collection(db, 'follows'), where('followingId', '==', currentUser.uid));\r\n      const followsSnap = await getDocs(followsQuery);\r\n      const followerIds = followsSnap.docs.map(doc => doc.data().followerId);\r\n\r\n      if (followerIds.length === 0) {\r\n        followers.value = [];\r\n        loading.value = false;\r\n        return;\r\n      }\r\n      \r\n      const restaurantsSnap = await getDocs(collection(db, 'restaurants'));\r\n      const restaurantsMap = new Map();\r\n      restaurantsSnap.forEach(doc => {\r\n        restaurantsMap.set(doc.id, doc.data().name);\r\n      });\r\n\r\n      const usersData = [];\r\n      for (let i = 0; i < followerIds.length; i += 30) {\r\n        const batchIds = followerIds.slice(i, i + 30);\r\n        if (batchIds.length > 0) {\r\n            const usersQuery = query(collection(db, 'users'), where('uid', 'in', batchIds));\r\n            const usersSnap = await getDocs(usersQuery);\r\n            usersSnap.forEach(doc => {\r\n                usersData.push({ uid: doc.id, ...doc.data() });\r\n            });\r\n        }\r\n      }\r\n\r\n      const followersWithDetails = await Promise.all(\r\n        usersData.map(async user => {\r\n          const reviewQuery = query(\r\n            collection(db, 'reviews'),\r\n            where('userId', '==', user.uid),\r\n            orderBy('createdAt', 'desc'),\r\n            limit(1)\r\n          );\r\n          const reviewSnap = await getDocs(reviewQuery);\r\n          let lastReview = null;\r\n          if (!reviewSnap.empty) {\r\n            const reviewData = reviewSnap.docs[0].data();\r\n            lastReview = {\r\n              ...reviewData,\r\n              restaurantName: restaurantsMap.get(reviewData.restaurantId) || 'Unknown Restaurant'\r\n            };\r\n          }\r\n          const rank = leaderboardRanks.value.get(user.uid);\r\n          return { ...user, lastReview, medal: getMedal(rank) };\r\n        })\r\n      );\r\n\r\n      followers.value = followersWithDetails;\r\n      loading.value = false;\r\n    };\r\n\r\n    onMounted(fetchFollowers);\r\n\r\n    const openReviewsModal = (user) => {\r\n      userForReviews.value = user;\r\n      isReviewsModalVisible.value = true;\r\n    };\r\n\r\n    const closeReviewsModal = () => {\r\n      isReviewsModalVisible.value = false;\r\n      userForReviews.value = null;\r\n    };\r\n\r\n    return { followers, loading, isReviewsModalVisible, userForReviews, openReviewsModal, closeReviewsModal };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.followers-page { max-width: 800px; margin: 0 auto; }\r\n.loading-indicator, .no-followers-message { \r\n  text-align: center; \r\n  color: #777; \r\n  padding: 3em 2em;\r\n  background: var(--card-background);\r\n  border-radius: 12px;\r\n  box-shadow: 0 4px 15px var(--shadow-color);\r\n}\r\n\r\n.no-followers-message h3 {\r\n  margin: 0 0 0.5em 0;\r\n  color: var(--text-color);\r\n}\r\n\r\n.no-followers-message p {\r\n  margin: 0;\r\n  font-size: 0.95em;\r\n}\r\n.user-card { display: flex; align-items: center; justify-content: space-between; background: var(--card-background); padding: 1.5em; border-radius: 12px; box-shadow: 0 4px 15px var(--shadow-color); margin-bottom: 1.5em; gap: 1.5em; }\r\n.user-card-content { flex-grow: 1; }\r\n.user-info { display: flex; align-items: center; gap: 1em; }\r\n.user-avatar { width: 60px; height: 60px; border-radius: 50%; }\r\n.user-name-line {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5em;\r\n}\r\n.user-name { font-weight: 600; font-size: 1.1em; }\r\n.medal {\r\n  font-size: 1.1em;\r\n}\r\n.user-actions .action-btn { background: none; border: 1px solid #ccc; border-radius: 8px; padding: 8px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s; color: #555; }\r\n.user-actions .action-btn:hover { background-color: #f0f0f0; border-color: #bbb; }\r\n.last-review { margin-top: 1em; padding-top: 1em; border-top: 1px solid #eee; font-size: 0.9em; }\r\n.review-header { margin-bottom: 0.5em; color: #555; }\r\n.review-body .star-rating { margin-bottom: 0.5em; }\r\n.review-text {\r\n  margin: 0.5em 0 0;\r\n  font-style: italic;\r\n  color: #333;\r\n  word-break: break-word;\r\n}\r\n.no-review { color: #888; font-style: italic; }\r\n\r\n@media (max-width: 768px) {\r\n  .user-card {\r\n    flex-direction: column;\r\n    align-items: stretch;\r\n  }\r\n  .user-actions {\r\n    margin-top: 1em;\r\n    align-self: stretch;\r\n  }\r\n  .user-actions .action-btn {\r\n    width: 100%;\r\n  }\r\n}\r\n</style>","import { render } from \"./Followers.vue?vue&type=template&id=a8a6c8f6&scoped=true\"\nimport script from \"./Followers.vue?vue&type=script&lang=js\"\nexport * from \"./Followers.vue?vue&type=script&lang=js\"\n\nimport \"./Followers.vue?vue&type=style&index=0&id=a8a6c8f6&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-a8a6c8f6\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"bucket-list-page\">\r\n    <div class=\"page-header\">\r\n      <div class=\"view-toggle\">\r\n        <button @click=\"showCompleted = false\" :class=\"{ active: !showCompleted }\">To Try</button>\r\n        <button @click=\"showCompleted = true\" :class=\"{ active: showCompleted }\">Completed</button>\r\n      </div>\r\n      <div v-if=\"filteredItems.length > 0 && selectedItems.size > 0\" class=\"batch-actions\">\r\n        <span>{{ selectedItems.size }} item(s) selected</span>\r\n        <button @click=\"removeSelectedItems\" class=\"btn-delete-batch\">Remove Selected</button>\r\n        <button @click=\"selectedItems.clear()\" class=\"btn-cancel-selection\">Cancel</button>\r\n      </div>\r\n      <button v-else-if=\"filteredItems.length > 0\" @click=\"selectAll\" class=\"btn-select-all\">Select All</button>\r\n    </div>\r\n    <div v-if=\"!currentUser\" class=\"no-items-message\">\r\n      <p>Please log in to view your bucket list.</p>\r\n    </div>\r\n    <div v-else-if=\"loading\" class=\"loading-indicator\">Loading your bucket list...</div>\r\n    <div v-else-if=\"filteredItems.length === 0\" class=\"no-items-message\">\r\n      <p v-if=\"!showCompleted\">Your bucket list is empty. Add some restaurants to try!</p>\r\n      <p v-else>You haven't completed any bucket list items yet.</p>\r\n    </div>\r\n    <div v-else class=\"restaurant-list\">\r\n      <div v-for=\"item in filteredItems\" :key=\"item.id\" class=\"restaurant-item\" :class=\"{ 'selected': selectedItems.has(item.id) }\">\r\n        <div v-if=\"selectedItems.size > 0\" class=\"item-checkbox\">\r\n          <input type=\"checkbox\" :checked=\"selectedItems.has(item.id)\" @change=\"toggleItemSelection(item.id)\" />\r\n        </div>\r\n        <!-- Restaurant details, similar to Restaurants.vue -->\r\n        <div class=\"restaurant-details\">\r\n            <span class=\"restaurant-name\">{{ item.restaurant.name }}</span>\r\n            <div class=\"restaurant-meta\">\r\n              <div v-if=\"item.restaurant.averageRating > 0\" class=\"rating\" :title=\"`${item.restaurant.averageRating.toFixed(2)} average rating`\">\r\n                <StarRating :rating=\"item.restaurant.averageRating\" />\r\n                <span class=\"rating-text\">{{ item.restaurant.averageRating.toFixed(1) }}</span>\r\n                <span class=\"rating-count\">({{ item.restaurant.ratingCount }})</span>\r\n              </div>\r\n              <span v-if=\"item.restaurant.distance !== null\" class=\"distance\">{{ item.restaurant.distance.toFixed(1) }} miles away </span>\r\n            </div>\r\n            <span class=\"restaurant-address\">\r\n              {{ item.restaurant.address }}<template v-if=\"item.restaurant.city\">, {{ item.restaurant.city }}</template><template v-if=\"item.restaurant.state\">, {{ item.restaurant.state }}</template><template v-if=\"item.restaurant.zip\"> {{ item.restaurant.zip }}</template>\r\n            </span>\r\n        </div>\r\n        <div class=\"restaurant-actions\">\r\n            <!-- Actions -->\r\n            <button @click=\"removeFromBucketList(item.id)\" class=\"action-btn delete-btn\">Remove</button>\r\n            <button class=\"check-in-btn\" @click=\"$emit('review-at', item.restaurantId)\">Review</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, onUnmounted, computed } from 'vue';\r\nimport { db, auth } from '../firebase';\r\nimport { collection, query, where, getDocs, onSnapshot, doc, deleteDoc, documentId } from 'firebase/firestore';\r\nimport StarRating from './StarRating.vue';\r\nimport { getDistance } from '../utils/geolocation.js';\r\nimport { showToast } from '../utils/toast.js';\r\n\r\nexport default {\r\n  name: 'BucketList',\r\n  components: { StarRating },\r\n  emits: ['review-at'],\r\n  setup() {\r\n    const bucketListItems = ref([]);\r\n    const loading = ref(true);\r\n    const showCompleted = ref(false);\r\n    const userLocation = ref(null);\r\n    const currentUser = ref(auth.currentUser);\r\n    const selectedItems = ref(new Set());\r\n    let unsubscribe = () => {};\r\n\r\n    // Watch for auth state changes\r\n    auth.onAuthStateChanged((user) => {\r\n      currentUser.value = user;\r\n      if (!user) {\r\n        loading.value = false;\r\n        bucketListItems.value = [];\r\n        if (unsubscribe) unsubscribe();\r\n      } else {\r\n        fetchBucketList();\r\n      }\r\n    });\r\n\r\n    const fetchBucketList = () => {\r\n      const user = auth.currentUser;\r\n      if (!user) {\r\n        loading.value = false;\r\n        bucketListItems.value = [];\r\n        return;\r\n      }\r\n\r\n      const q = query(collection(db, 'bucketListItems'), where('userId', '==', user.uid));\r\n      \r\n      unsubscribe = onSnapshot(q, async (snapshot) => {\r\n        loading.value = true;\r\n        \r\n        try {\r\n          const items = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n          \r\n          if (items.length === 0) {\r\n            bucketListItems.value = [];\r\n            loading.value = false;\r\n            return;\r\n          }\r\n\r\n          const restaurantIds = [...new Set(items.map(item => item.restaurantId).filter(Boolean))];\r\n          const restaurantsMap = new Map();\r\n          \r\n          if (restaurantIds.length > 0) {\r\n              // Batch fetch restaurants\r\n              for (let i = 0; i < restaurantIds.length; i += 30) {\r\n                const batchIds = restaurantIds.slice(i, i + 30);\r\n                const restaurantsQuery = query(collection(db, 'restaurants'), where(documentId(), 'in', batchIds));\r\n                const restaurantsSnapshot = await getDocs(restaurantsQuery);\r\n                restaurantsSnapshot.forEach(doc => restaurantsMap.set(doc.id, { id: doc.id, ...doc.data() }));\r\n              }\r\n\r\n              // Batch fetch review counts and ratings\r\n              const reviewsQuery = query(collection(db, 'reviews'), where('restaurantId', 'in', restaurantIds));\r\n              const reviewsSnapshot = await getDocs(reviewsQuery);\r\n              const ratings = {};\r\n              reviewsSnapshot.forEach(doc => {\r\n                const review = doc.data();\r\n                if (review.restaurantId && typeof review.rating === 'number') {\r\n                  if (!ratings[review.restaurantId]) {\r\n                    ratings[review.restaurantId] = { total: 0, count: 0 };\r\n                  }\r\n                  ratings[review.restaurantId].total += review.rating;\r\n                  ratings[review.restaurantId].count++;\r\n                }\r\n              });\r\n\r\n              bucketListItems.value = items.map(item => {\r\n                const restaurant = restaurantsMap.get(item.restaurantId);\r\n                if (!restaurant) return null;\r\n\r\n                const ratingInfo = ratings[restaurant.id];\r\n                restaurant.averageRating = ratingInfo ? ratingInfo.total / ratingInfo.count : 0;\r\n                restaurant.ratingCount = ratingInfo ? ratingInfo.count : 0;\r\n                restaurant.distance = userLocation.value && restaurant.location ? getDistance(userLocation.value.lat, userLocation.value.lng, restaurant.location.lat, restaurant.location.lng) : null;\r\n\r\n                return { ...item, restaurant };\r\n              }).filter(Boolean);\r\n          } else {\r\n              // No valid restaurant IDs found in items\r\n              bucketListItems.value = [];\r\n          }\r\n        } catch (error) {\r\n          console.error('Error loading bucket list:', error);\r\n          bucketListItems.value = [];\r\n        } finally {\r\n          loading.value = false;\r\n        }\r\n      }, (error) => {\r\n        console.error('Error in bucket list snapshot:', error);\r\n        bucketListItems.value = [];\r\n        loading.value = false;\r\n      });\r\n    };\r\n\r\n    onMounted(() => {\r\n      // Get user location if available, but don't block on it\r\n      if (navigator.geolocation) {\r\n        navigator.geolocation.getCurrentPosition(position => {\r\n          userLocation.value = {\r\n            lat: position.coords.latitude,\r\n            lng: position.coords.longitude\r\n          };\r\n          // Location updated - refresh distances if bucket list is already loaded\r\n          if (bucketListItems.value.length > 0 && currentUser.value) {\r\n            fetchBucketList();\r\n          }\r\n        }, (error) => {\r\n          console.error(\"Error getting location for bucket list\", error);\r\n        });\r\n      }\r\n      \r\n      // Fetch bucket list if user is already logged in (onAuthStateChanged handles new logins)\r\n      if (currentUser.value) {\r\n        fetchBucketList();\r\n      } else {\r\n        loading.value = false;\r\n      }\r\n    });\r\n\r\n    onUnmounted(() => {\r\n      unsubscribe();\r\n    });\r\n\r\n    const filteredItems = computed(() => {\r\n      const filtered = bucketListItems.value.filter(item => {\r\n        return showCompleted.value ? !!item.completedAt : !item.completedAt;\r\n      });\r\n      return filtered.sort((a, b) => {\r\n        if (a.restaurant.distance === null) return 1;\r\n        if (b.restaurant.distance === null) return -1;\r\n        return a.restaurant.distance - b.restaurant.distance;\r\n      });\r\n    });\r\n\r\n    const removeFromBucketList = async (itemId) => {\r\n      if (confirm('Are you sure you want to remove this from your bucket list?')) {\r\n        try {\r\n          await deleteDoc(doc(db, 'bucketListItems', itemId));\r\n          showToast('Removed from bucket list', 'success');\r\n        } catch (error) {\r\n          console.error('Error removing from bucket list:', error);\r\n          showToast('Failed to remove item. Please try again.', 'error');\r\n        }\r\n      }\r\n    };\r\n\r\n    const toggleItemSelection = (itemId) => {\r\n      if (selectedItems.value.has(itemId)) {\r\n        selectedItems.value.delete(itemId);\r\n      } else {\r\n        selectedItems.value.add(itemId);\r\n      }\r\n    };\r\n\r\n    const selectAll = () => {\r\n      filteredItems.value.forEach(item => {\r\n        selectedItems.value.add(item.id);\r\n      });\r\n    };\r\n\r\n    const removeSelectedItems = async () => {\r\n      if (selectedItems.value.size === 0) return;\r\n      if (!confirm(`Are you sure you want to remove ${selectedItems.value.size} item(s) from your bucket list?`)) return;\r\n      \r\n      try {\r\n        const deletePromises = Array.from(selectedItems.value).map(itemId => \r\n          deleteDoc(doc(db, 'bucketListItems', itemId))\r\n        );\r\n        await Promise.all(deletePromises);\r\n        showToast(`Removed ${selectedItems.value.size} item(s) from bucket list`, 'success');\r\n        selectedItems.value.clear();\r\n      } catch (error) {\r\n        console.error('Error removing items:', error);\r\n        showToast('Failed to remove items. Please try again.', 'error');\r\n      }\r\n    };\r\n\r\n    const getDirectionsUrl = (restaurant) => {\r\n      const destination = encodeURIComponent(`${restaurant.name}, ${restaurant.address}`);\r\n      return `https://www.google.com/maps/dir/?api=1&destination=${destination}`;\r\n    };\r\n\r\n    const getDetailsUrl = (restaurant) => {\r\n      const query = encodeURIComponent(`${restaurant.name}, ${restaurant.address}`);\r\n      return `https://www.google.com/search?q=${query}`;\r\n    };\r\n\r\n    return {\r\n      loading,\r\n      showCompleted,\r\n      filteredItems,\r\n      selectedItems,\r\n      removeFromBucketList,\r\n      toggleItemSelection,\r\n      selectAll,\r\n      removeSelectedItems,\r\n      getDirectionsUrl,\r\n      getDetailsUrl,\r\n      currentUser\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* styles for BucketList.vue */\r\n.bucket-list-page {\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n}\r\n.page-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  flex-wrap: wrap;\r\n  gap: 1em;\r\n  margin-bottom: 2em;\r\n}\r\n\r\n.batch-actions {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 1em;\r\n}\r\n\r\n.btn-delete-batch,\r\n.btn-cancel-selection,\r\n.btn-select-all {\r\n  padding: 8px 16px;\r\n  border: none;\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n  font-size: 0.9em;\r\n}\r\n\r\n.btn-delete-batch {\r\n  background-color: #e74c3c;\r\n  color: white;\r\n}\r\n\r\n.btn-delete-batch:hover {\r\n  background-color: #c0392b;\r\n}\r\n\r\n.btn-cancel-selection,\r\n.btn-select-all {\r\n  background-color: #95a5a6;\r\n  color: white;\r\n}\r\n\r\n.btn-cancel-selection:hover,\r\n.btn-select-all:hover {\r\n  background-color: #7f8c8d;\r\n}\r\n.view-toggle button {\r\n  background: none;\r\n  border: 1px solid #ccc;\r\n  padding: 8px 16px;\r\n  cursor: pointer;\r\n}\r\n.view-toggle button.active {\r\n  background-color: var(--primary-color);\r\n  color: white;\r\n  border-color: var(--primary-color);\r\n}\r\n.view-toggle button:first-child {\r\n  border-top-left-radius: 8px;\r\n  border-bottom-left-radius: 8px;\r\n}\r\n.view-toggle button:last-child {\r\n  border-top-right-radius: 8px;\r\n  border-bottom-right-radius: 8px;\r\n  border-left: none;\r\n}\r\n.loading-indicator, .no-items-message {\r\n  text-align: center;\r\n  color: #777;\r\n  padding: 3em;\r\n}\r\n.restaurant-list {\r\n  list-style: none;\r\n  padding: 0;\r\n  margin: 0;\r\n}\r\n.restaurant-item {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 1.5em;\r\n  background: var(--card-background);\r\n  border-radius: 12px;\r\n  box-shadow: 0 4px 15px var(--shadow-color);\r\n  margin-bottom: 1.5em;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.restaurant-item.selected {\r\n  background: rgba(52, 152, 219, 0.1);\r\n  border: 2px solid #3498db;\r\n}\r\n\r\n.item-checkbox {\r\n  margin-right: 1em;\r\n}\r\n\r\n.item-checkbox input[type=\"checkbox\"] {\r\n  width: 20px;\r\n  height: 20px;\r\n  cursor: pointer;\r\n}\r\n.restaurant-details {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n.restaurant-name {\r\n  font-weight: 600;\r\n  font-size: 1.2em;\r\n  margin-bottom: 0.25em;\r\n}\r\n.restaurant-meta {\r\n  display: flex;\r\n  align-items: center;\r\n  flex-wrap: wrap;\r\n  gap: 1em;\r\n  margin-bottom: 0.5em;\r\n  color: #555;\r\n  font-size: 0.9em;\r\n}\r\n.rating {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.25em;\r\n}\r\n.rating-text {\r\n  font-weight: bold;\r\n  margin-left: 0.25em;\r\n}\r\n.rating-count {\r\n  color: #777;\r\n}\r\n.distance {\r\n  font-style: italic;\r\n}\r\n.restaurant-address {\r\n  color: #777;\r\n  font-size: 0.9em;\r\n}\r\n.restaurant-actions {\r\n  display: flex;\r\n  gap: 0.75em;\r\n}\r\n.action-btn, .check-in-btn {\r\n  background: none;\r\n  border: 1px solid #ccc;\r\n  border-radius: 8px;\r\n  padding: 8px;\r\n  cursor: pointer;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  transition: all 0.2s;\r\n  color: #555;\r\n}\r\n.action-btn:hover {\r\n  background-color: #f0f0f0;\r\n  border-color: #bbb;\r\n}\r\n.delete-btn {\r\n  color: #e74c3c;\r\n  border-color: #e74c3c;\r\n}\r\n.delete-btn:hover {\r\n  background-color: #e74c3c;\r\n  color: white;\r\n}\r\n.check-in-btn {\r\n  background-color: var(--primary-color);\r\n  color: white;\r\n  border-color: var(--primary-color);\r\n  padding: 8px 16px;\r\n  font-weight: 600;\r\n}\r\n.check-in-btn:hover {\r\n  background-color: var(--primary-dark-color);\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .restaurant-item {\r\n    flex-direction: column;\r\n    align-items: flex-start;\r\n    gap: 1em;\r\n  }\r\n  .restaurant-actions {\r\n    width: 100%;\r\n    flex-wrap: wrap;\r\n    gap: 0.5em;\r\n  }\r\n  .restaurant-actions .action-btn,\r\n  .restaurant-actions .check-in-btn {\r\n    flex-grow: 1;\r\n    text-align: center;\r\n  }\r\n}\r\n</style>","import { render } from \"./BucketList.vue?vue&type=template&id=11aea084&scoped=true\"\nimport script from \"./BucketList.vue?vue&type=script&lang=js\"\nexport * from \"./BucketList.vue?vue&type=script&lang=js\"\n\nimport \"./BucketList.vue?vue&type=style&index=0&id=11aea084&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-11aea084\"]])\n\nexport default __exports__","<template>\r\n  <UserReviewsModal v-if=\"isReviewsModalVisible\" :user=\"userForReviews\" @close=\"closeReviewsModal\" />\r\n  <div class=\"following-page\">\r\n    <div v-if=\"loading\" class=\"loading-indicator\">Loading users you follow...</div>\r\n    <div v-else>\r\n      <div v-if=\"following.length === 0\" class=\"no-users-message\">\r\n        <h3>Not following anyone yet</h3>\r\n        <p>Visit the \"Follow Users\" page to discover and follow other reviewers to see their posts in your feed.</p>\r\n      </div>\r\n      <div v-for=\"user in following\" :key=\"user.uid\" class=\"user-card\">\r\n        <div class=\"user-card-content\">\r\n          <div class=\"user-info\">\r\n            <img :src=\"user.photoURL || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" class=\"user-avatar\" alt=\"User\" referrerpolicy=\"no-referrer\" />\r\n            <div class=\"user-details\">\r\n              <div class=\"user-name-line\">\r\n                <span class=\"user-name\">{{ user.displayName }}</span>\r\n                <span v-if=\"user.medal\" class=\"medal\">{{ user.medal }}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div v-if=\"user.lastReview\" class=\"last-review\">\r\n            <div class=\"review-header\">\r\n              Latest review: <strong>{{ user.lastReview.restaurantName }}</strong>\r\n            </div>\r\n            <div class=\"review-body\">\r\n              <StarRating :rating=\"user.lastReview.rating\" />\r\n              <p v-if=\"user.lastReview.text\" class=\"review-text\">\"{{ user.lastReview.text }}\"</p>\r\n            </div>\r\n          </div>\r\n          <div v-else class=\"last-review no-review\">\r\n            No reviews yet.\r\n          </div>\r\n        </div>\r\n        <div class=\"user-actions\">\r\n          <button @click=\"openReviewsModal(user)\" class=\"action-btn\" title=\"View Reviews\">\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z\"/></svg>\r\n          </button>\r\n          <button @click=\"unfollowUser(user)\" class=\"unfollow-btn\">Unfollow</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, onUnmounted } from 'vue';\r\nimport { db, auth } from '../firebase';\r\nimport { collection, query, where, getDocs, doc, deleteDoc, orderBy, limit, onSnapshot } from 'firebase/firestore';\r\nimport StarRating from './StarRating.vue';\r\nimport UserReviewsModal from './UserReviewsModal.vue';\r\nimport { showToast } from '../utils/toast.js';\r\n\r\nconst getMedal = (index) => {\r\n  // Medals are assigned based on position (0-indexed)\r\n  // Position 1 (index 0): Gold medal \r\n  // Position 2 (index 1): Silver medal \r\n  // Position 3 (index 2): Bronze medal \r\n  // Positions 4-10 (index 3-9): Participation medal \r\n  if (typeof index !== 'number') return null;\r\n  if (index === 0) return '';\r\n  if (index === 1) return '';\r\n  if (index === 2) return '';\r\n  if (index >= 3 && index < 10) return '';\r\n  return null;\r\n};\r\n\r\nexport default {\r\n  name: 'Following',\r\n  components: { StarRating, UserReviewsModal },\r\n  setup() {\r\n    const following = ref([]);\r\n    const loading = ref(true);\r\n    const isReviewsModalVisible = ref(false);\r\n    const userForReviews = ref(null);\r\n    const leaderboardRanks = ref(new Map());\r\n    let unsubscribe = () => {};\r\n\r\n    const fetchFollowing = async () => {\r\n      loading.value = true;\r\n      const currentUser = auth.currentUser;\r\n      if (!currentUser) {\r\n        loading.value = false;\r\n        return;\r\n      }\r\n\r\n      // Fetch leaderboard ranks\r\n      const leaderboardSnap = await getDocs(query(collection(db, 'users'), orderBy('reviewCount', 'desc'), limit(30)));\r\n      const usersWithReviews = leaderboardSnap.docs\r\n        .map(doc => ({ id: doc.id, ...doc.data() }))\r\n        .filter(user => {\r\n          const count = Number(user.reviewCount) || 0;\r\n          return count > 0;\r\n        })\r\n        .sort((a, b) => {\r\n          const countA = Number(a.reviewCount) || 0;\r\n          const countB = Number(b.reviewCount) || 0;\r\n          return countB - countA;\r\n        })\r\n        .slice(0, 10);\r\n      \r\n      const ranks = new Map();\r\n      usersWithReviews.forEach((user, index) => {\r\n        ranks.set(user.id, index);\r\n      });\r\n      leaderboardRanks.value = ranks;\r\n\r\n      const followsQuery = query(collection(db, 'follows'), where('followerId', '==', currentUser.uid));      \r\n      unsubscribe = onSnapshot(followsQuery, async (followsSnap) => {\r\n        const followingIds = followsSnap.docs.map(doc => doc.data().followingId);\r\n\r\n      if (followingIds.length === 0) {\r\n        following.value = [];\r\n        loading.value = false;\r\n        return;\r\n      }\r\n\r\n      const restaurantsSnap = await getDocs(collection(db, 'restaurants'));\r\n      const restaurantsMap = new Map();\r\n      restaurantsSnap.forEach(doc => {\r\n        restaurantsMap.set(doc.id, doc.data().name);\r\n      });\r\n\r\n      const usersData = [];\r\n      // Firestore 'in' query supports a maximum of 30 elements in the array.\r\n      for (let i = 0; i < followingIds.length; i += 30) {\r\n        const batchIds = followingIds.slice(i, i + 30);\r\n        if (batchIds.length > 0) {\r\n            const usersQuery = query(collection(db, 'users'), where('uid', 'in', batchIds));\r\n            const usersSnap = await getDocs(usersQuery);\r\n            usersSnap.forEach(doc => {\r\n                usersData.push({ uid: doc.id, ...doc.data() });\r\n            });\r\n        }\r\n      }\r\n\r\n      const followingWithDetails = await Promise.all(\r\n        usersData.map(async user => {\r\n          const reviewQuery = query(\r\n            collection(db, 'reviews'),\r\n            where('userId', '==', user.uid),\r\n            orderBy('createdAt', 'desc'),\r\n            limit(1)\r\n          );\r\n          const reviewSnap = await getDocs(reviewQuery);\r\n          let lastReview = null;\r\n          if (!reviewSnap.empty) {\r\n            const reviewData = reviewSnap.docs[0].data();\r\n            lastReview = {\r\n              ...reviewData,\r\n              restaurantName: restaurantsMap.get(reviewData.restaurantId) || 'Unknown Restaurant'\r\n            };\r\n          }\r\n          const rank = leaderboardRanks.value.get(user.uid);\r\n          return { ...user, lastReview, medal: getMedal(rank) };\r\n        })\r\n      );\r\n\r\n      following.value = followingWithDetails;\r\n      loading.value = false;\r\n      });\r\n    };\r\n\r\n    onMounted(fetchFollowing);\r\n    onUnmounted(() => unsubscribe());\r\n\r\n    const unfollowUser = async (userToUnfollow) => {\r\n      const currentUser = auth.currentUser;\r\n      if (!currentUser || !window.confirm(`Are you sure you want to unfollow ${userToUnfollow.displayName}?`)) return;\r\n\r\n      try {\r\n        const q = query(collection(db, 'follows'), where('followerId', '==', currentUser.uid), where('followingId', '==', userToUnfollow.uid));\r\n        const querySnapshot = await getDocs(q);\r\n        if (!querySnapshot.empty) {\r\n          const docId = querySnapshot.docs[0].id;\r\n          await deleteDoc(doc(db, 'follows', docId));\r\n          showToast(`Unfollowed ${userToUnfollow.displayName}`, 'success');\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error unfollowing user:\", error);\r\n        showToast(\"Failed to unfollow user. Please try again.\", 'error');\r\n      }\r\n    };\r\n\r\n    const openReviewsModal = (user) => {\r\n      userForReviews.value = user;\r\n      isReviewsModalVisible.value = true;\r\n    };\r\n\r\n    const closeReviewsModal = () => {\r\n      isReviewsModalVisible.value = false;\r\n      userForReviews.value = null;\r\n    };\r\n\r\n    return { following, loading, unfollowUser, isReviewsModalVisible, userForReviews, openReviewsModal, closeReviewsModal };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.following-page { max-width: 800px; margin: 0 auto; }\r\n.loading-indicator, .no-users-message { text-align: center; color: #777; padding: 2em; }\r\n.user-card { display: flex; align-items: center; justify-content: space-between; background: var(--card-background); padding: 1.5em; border-radius: 12px; box-shadow: 0 4px 15px var(--shadow-color); margin-bottom: 1.5em; gap: 1.5em; }\r\n.user-card-content { flex-grow: 1; min-width: 0; }\r\n.user-info { display: flex; align-items: center; gap: 1em; min-width: 0; }\r\n.user-details { min-width: 0; }\r\n.user-avatar { width: 60px; height: 60px; border-radius: 50%; flex-shrink: 0; }\r\n.user-name-line {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5em;\r\n}\r\n.user-name { font-weight: 600; font-size: 1.1em; word-break: break-word; }\r\n.medal {\r\n  font-size: 1.1em;\r\n}\r\n.user-actions { display: flex; gap: 0.75em; }\r\n.user-actions .action-btn { background: none; border: 1px solid #ccc; border-radius: 8px; padding: 8px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s; color: #555; }\r\n.user-actions .action-btn:hover { background-color: #f0f0f0; border-color: #bbb; }\r\n.user-actions button.unfollow-btn { background-color: #e74c3c; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; transition: background-color 0.2s; }\r\n.user-actions button.unfollow-btn:hover { opacity: 0.9; }\r\n.last-review { margin-top: 1em; padding-top: 1em; border-top: 1px solid #eee; font-size: 0.9em; }\r\n.review-header { margin-bottom: 0.5em; color: #555; word-break: break-word; }\r\n.review-body .star-rating { margin-bottom: 0.5em; }\r\n.review-text {\r\n  margin: 0.5em 0 0;\r\n  font-style: italic;\r\n  color: #333;\r\n  word-break: break-word;\r\n}\r\n.no-review { color: #888; font-style: italic; }\r\n\r\n@media (max-width: 768px) {\r\n  .user-card { flex-direction: column; align-items: stretch; }\r\n  .user-actions { margin-top: 1em; }\r\n  .user-actions button { flex-grow: 1; justify-content: center; }\r\n}\r\n</style>","import { render } from \"./Following.vue?vue&type=template&id=614462e6&scoped=true\"\nimport script from \"./Following.vue?vue&type=script&lang=js\"\nexport * from \"./Following.vue?vue&type=script&lang=js\"\n\nimport \"./Following.vue?vue&type=style&index=0&id=614462e6&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-614462e6\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"help-page\">\r\n    <div class=\"help-container\">\r\n      <div class=\"help-sidebar\">\r\n        <h3>Table of Contents</h3>\r\n        <nav class=\"toc-nav\">\r\n          <a href=\"#getting-started\" @click.prevent=\"scrollToSection('getting-started')\" :class=\"{ active: activeSection === 'getting-started' }\">Getting Started</a>\r\n          <a href=\"#navigation\" @click.prevent=\"scrollToSection('navigation')\" :class=\"{ active: activeSection === 'navigation' }\">Navigation</a>\r\n          <a href=\"#core-features\" @click.prevent=\"scrollToSection('core-features')\" :class=\"{ active: activeSection === 'core-features' }\">Core Features</a>\r\n          <a href=\"#user-accounts\" @click.prevent=\"scrollToSection('user-accounts')\" :class=\"{ active: activeSection === 'user-accounts' }\">User Accounts & Social</a>\r\n          <a href=\"#gamification\" @click.prevent=\"scrollToSection('gamification')\" :class=\"{ active: activeSection === 'gamification' }\">Gamification & Social</a>\r\n          <a href=\"#tips\" @click.prevent=\"scrollToSection('tips')\" :class=\"{ active: activeSection === 'tips' }\">Tips & Best Practices</a>\r\n          <a href=\"#faq\" @click.prevent=\"scrollToSection('faq')\" :class=\"{ active: activeSection === 'faq' }\">FAQ</a>\r\n        </nav>\r\n      </div>\r\n\r\n      <div class=\"help-content\" ref=\"contentRef\">\r\n        <h1>PorkHub User Guide</h1>\r\n        <p class=\"intro\">Welcome to <strong>PorkHub</strong>  your community-driven platform for discovering, rating, and reviewing US Breaded Pork Tenderloin restaurants!</p>\r\n\r\n        <section id=\"getting-started\">\r\n          <h2>Getting Started</h2>\r\n          \r\n          <h3>Logging In</h3>\r\n          <p>When you first visit PorkHub, you'll see a <strong>\"Login with Google\"</strong> button at the bottom of the sidebar. Click it to access your account using your Google credentials. Once logged in, your profile information (name and avatar) will appear at the top of the sidebar, and you'll unlock all member-only features.</p>\r\n\r\n          <h3>What You Can Do Without Logging In</h3>\r\n          <ul>\r\n            <li>Browse the <strong>Home</strong> feed</li>\r\n            <li>View the <strong>Leaderboard</strong></li>\r\n            <li>Explore <strong>Restaurants</strong> and view their reviews</li>\r\n            <li>View <strong>Recommendations</strong></li>\r\n            <li>Search for users</li>\r\n          </ul>\r\n\r\n          <h3>What Requires Login</h3>\r\n          <ul>\r\n            <li>Write and submit reviews</li>\r\n            <li>Follow other users</li>\r\n            <li>Like reviews and add comments</li>\r\n            <li>Manage your bucket list</li>\r\n            <li>View and edit your own reviews</li>\r\n            <li>Share reviews with others</li>\r\n          </ul>\r\n        </section>\r\n\r\n        <section id=\"navigation\">\r\n          <h2>Navigation</h2>\r\n          <p>The <strong>sidebar</strong> on the left is your main navigation hub. Click the <strong>hamburger menu icon</strong> (three horizontal lines) to collapse/expand the sidebar for more screen space.</p>\r\n\r\n          <h3>Public Pages (Available to Everyone)</h3>\r\n          <div class=\"feature-list\">\r\n            <div class=\"feature-item\">\r\n              <h4>Home</h4>\r\n              <p>Your personalized feed of reviews from followed users and recent activity, with options to sort by Most Recent or Nearby</p>\r\n            </div>\r\n            <div class=\"feature-item\">\r\n              <h4>Leaderboard</h4>\r\n              <p>Top-ranked reviewers in the community, ranked by activity and reputation</p>\r\n            </div>\r\n            <div class=\"feature-item\">\r\n              <h4>Restaurants</h4>\r\n              <p>Browse and search all restaurants, view details, and see reviews</p>\r\n            </div>\r\n            <div class=\"feature-item\">\r\n              <h4>Recommendations</h4>\r\n              <p>Discover new restaurants based on highly-rated reviews from the community</p>\r\n            </div>\r\n          </div>\r\n\r\n          <h3>Account-Only Pages (Requires Login)</h3>\r\n          <div class=\"feature-list\">\r\n            <div class=\"feature-item\">\r\n              <h4>Write a Review</h4>\r\n              <p>Submit a new review for a restaurant you've visited</p>\r\n            </div>\r\n            <div class=\"feature-item\">\r\n              <h4>Follow Users</h4>\r\n              <p>Search for and follow other reviewers</p>\r\n            </div>\r\n            <div class=\"feature-item\">\r\n              <h4>My Bucket List</h4>\r\n              <p>Track restaurants you want to visit</p>\r\n            </div>\r\n            <div class=\"feature-item\">\r\n              <h4>My Reviews</h4>\r\n              <p>View and manage all your submitted reviews</p>\r\n            </div>\r\n            <div class=\"feature-item\">\r\n              <h4>My Followers</h4>\r\n              <p>See who is following your reviews</p>\r\n            </div>\r\n            <div class=\"feature-item\">\r\n              <h4>Following</h4>\r\n              <p>View the users you're following</p>\r\n            </div>\r\n          </div>\r\n        </section>\r\n\r\n        <section id=\"core-features\">\r\n          <h2>Core Features</h2>\r\n\r\n          <h3> Home Feed</h3>\r\n          <p>The <strong>Home</strong> page displays a personalized feed of reviews from users you follow.</p>\r\n          <p><strong>Features:</strong></p>\r\n          <ul>\r\n            <li>See recent reviews from users you follow</li>\r\n            <li><strong>Location Permission:</strong> On your first visit, you may be prompted to share your location. This unlocks the \"Nearby\" sorting feature</li>\r\n            <li><strong>Sort by:</strong>\r\n              <ul>\r\n                <li><strong>Most Recent</strong>  Shows the newest reviews first</li>\r\n                <li><strong>Nearby</strong>  Shows restaurants closest to your current location (requires location permission and enabled sorting)</li>\r\n              </ul>\r\n            </li>\r\n          </ul>\r\n          <p><strong>Review Actions:</strong></p>\r\n          <ul>\r\n            <li><strong>Like</strong>  Click the heart icon to like a review (requires login)</li>\r\n            <li><strong>Share</strong>  Share the review using the share button</li>\r\n            <li><strong>Comment</strong>  Add comments to reviews to engage with other reviewers</li>\r\n            <li><strong>Bucket List</strong>  Add restaurants to your bucket list with the heart icon</li>\r\n            <li><strong>View Details</strong>  Click the restaurant name to view full restaurant details</li>\r\n          </ul>\r\n\r\n          <h3> Leaderboard</h3>\r\n          <p>View the community's top contributors ranked by their activity and reputation.</p>\r\n          <p><strong>What You See:</strong></p>\r\n          <ul>\r\n            <li>Users ranked by number of reviews and community engagement</li>\r\n            <li>Medals or badges displayed next to top reviewers</li>\r\n            <li>Click on a user to view their profile and all their reviews</li>\r\n          </ul>\r\n\r\n          <h3> Restaurants</h3>\r\n          <p>Browse, search, and manage restaurant listings.</p>\r\n          <p><strong>Searching:</strong></p>\r\n          <ul>\r\n            <li>Search by restaurant <strong>name</strong>, <strong>address</strong>, <strong>city</strong>, <strong>state</strong>, or <strong>ZIP code</strong></li>\r\n            <li>Results update as you type</li>\r\n            <li>See average ratings and review counts for each restaurant</li>\r\n            <li>Distance to each restaurant displayed (when location is enabled)</li>\r\n          </ul>\r\n          <p><strong>What You Can Do:</strong></p>\r\n          <ul>\r\n            <li><strong>View Reviews</strong>  Click the comments icon to see all reviews for a restaurant</li>\r\n            <li><strong>Add Review</strong>  Click \"View Reviews\" then \"Write a Review\" button</li>\r\n            <li><strong>Bucket List</strong>  Click the bucket/heart icon to save restaurants you want to visit (requires login)</li>\r\n            <li><strong>Edit Details</strong> (Admin only)  Update restaurant information</li>\r\n            <li><strong>Add New Restaurant</strong> (Logged-in users)  Click \"Add New Restaurant\" to submit a new location</li>\r\n          </ul>\r\n\r\n          <h3> Write a Review</h3>\r\n          <p>Submit detailed reviews for restaurants you've visited.</p>\r\n          <p><strong>To Write a Review:</strong></p>\r\n          <ol>\r\n            <li>Click <strong>\"Write a Review\"</strong> in the sidebar</li>\r\n            <li>Choose a restaurant from the dropdown or add a new one</li>\r\n            <li>Fill in your review details:\r\n              <ul>\r\n                <li><strong>Star Rating</strong>  Rate from 1-5 stars</li>\r\n                <li><strong>Review Title</strong>  Short summary of your experience</li>\r\n                <li><strong>Review Text</strong>  Detailed comments about the food, service, atmosphere, etc.</li>\r\n                <li><strong>Tags</strong>  Add tags to categorize your experience</li>\r\n                <li><strong>Visit Date</strong>  When you visited</li>\r\n                <li><strong>Photo</strong>  Optionally take a photo with your camera or upload one from your device</li>\r\n              </ul>\r\n            </li>\r\n            <li>Click <strong>\"Submit Review\"</strong></li>\r\n          </ol>\r\n          <p><strong>Tips:</strong></p>\r\n          <ul>\r\n            <li>Be specific and constructive in your feedback</li>\r\n            <li>Include details about flavors, portions, preparation, and service</li>\r\n            <li>Mention the occasion (family dinner, quick lunch, date night, etc.)</li>\r\n            <li>Use tags to help others quickly understand the experience</li>\r\n            <li>Review soon after your visit while details are fresh</li>\r\n          </ul>\r\n\r\n          <h3> Recommendations</h3>\r\n          <p>Discover new restaurants based on community reviews.</p>\r\n          <p><strong>How It Works:</strong></p>\r\n          <ul>\r\n            <li>Analyzes highly-rated reviews from users you follow</li>\r\n            <li>Shows personalized restaurant suggestions</li>\r\n            <li>Recommendations are tailored based on the reviews and ratings in the community</li>\r\n          </ul>\r\n\r\n          <h3> Follow Users</h3>\r\n          <p>Find and follow other PorkHub members to personalize your feed.</p>\r\n          <p><strong>To Follow a User:</strong></p>\r\n          <ol>\r\n            <li>Click <strong>\"Follow Users\"</strong> in the sidebar</li>\r\n            <li>Search for a username to find members</li>\r\n            <li>View their profile showing recent reviews and activity</li>\r\n            <li>Click <strong>\"Follow\"</strong> to add them to your following list</li>\r\n          </ol>\r\n          <p><strong>Benefits:</strong></p>\r\n          <ul>\r\n            <li>Your Home feed will include their reviews</li>\r\n            <li>See their ratings and activity</li>\r\n            <li>Build a community of reviewers with similar tastes</li>\r\n          </ul>\r\n\r\n          <h3> My Bucket List</h3>\r\n          <p>Create and manage a list of restaurants you want to visit.</p>\r\n          <p><strong>Managing Your List:</strong></p>\r\n          <ul>\r\n            <li>Click the <strong>heart icon</strong> on any restaurant card or in the feed to add/remove from bucket list</li>\r\n            <li>View all saved restaurants in <strong>\"My Bucket List\"</strong></li>\r\n            <li>See distance to each restaurant (when location is enabled)</li>\r\n            <li>View previous reviews and ratings before visiting</li>\r\n            <li>Remove restaurants once you've visited and reviewed them</li>\r\n          </ul>\r\n\r\n          <h3> My Reviews</h3>\r\n          <p>View and manage all your submitted reviews.</p>\r\n          <p><strong>Features:</strong></p>\r\n          <ul>\r\n            <li>See all reviews you've written with their ratings and engagement</li>\r\n            <li><strong>Edit</strong>  Update your review text, rating, tags, or photo</li>\r\n            <li><strong>Delete</strong>  Remove a review (this action cannot be undone)</li>\r\n            <li><strong>Share</strong>  Share individual reviews with others</li>\r\n            <li>View how many likes and comments each review has received</li>\r\n            <li>See all reviews sorted by date</li>\r\n          </ul>\r\n\r\n          <h3> My Followers /  Following</h3>\r\n          <p>Manage your social connections.</p>\r\n          <p><strong>My Followers:</strong></p>\r\n          <ul>\r\n            <li>See all users who are following your reviews</li>\r\n            <li>View each follower's profile and recent activity</li>\r\n            <li>Click to view all their reviews</li>\r\n          </ul>\r\n          <p><strong>Following:</strong></p>\r\n          <ul>\r\n            <li>View all users you're following</li>\r\n            <li>See previews of their latest reviews and ratings</li>\r\n            <li>Unfollow users by clicking the unfollow button</li>\r\n            <li>Click on a user to view their full profile and all their reviews</li>\r\n          </ul>\r\n        </section>\r\n\r\n        <section id=\"user-accounts\">\r\n          <h2>User Accounts & Social</h2>\r\n\r\n          <h3>Your Profile</h3>\r\n          <p>Your profile appears in the sidebar and displays:</p>\r\n          <ul>\r\n            <li>Your profile photo (from your Google account)</li>\r\n            <li>Your display name</li>\r\n            <li>Badge/medal (if you're a top reviewer)</li>\r\n          </ul>\r\n          <p>When you log out, you'll see a <strong>\"Login with\"</strong> button to sign back in.</p>\r\n\r\n          <h3>Comments & Interaction</h3>\r\n          <p><strong>Adding Comments:</strong></p>\r\n          <ul>\r\n            <li>Click on any review to expand it and see the comments section</li>\r\n            <li>Type your comment and submit to engage with other reviewers</li>\r\n            <li>Comments appear immediately for all users to see</li>\r\n            <li>Engage in discussions about restaurants and dining experiences</li>\r\n          </ul>\r\n          <p><strong>Liking Reviews:</strong></p>\r\n          <ul>\r\n            <li>Click the heart icon on any review to like it (requires login)</li>\r\n            <li>Like counts are displayed on each review</li>\r\n            <li>Your likes help promote helpful reviews</li>\r\n          </ul>\r\n          <p><strong>Sharing Reviews:</strong></p>\r\n          <ul>\r\n            <li>Click the share icon on any review to share it</li>\r\n            <li>Share via your device's native sharing options, email, social media, or copy the link to clipboard</li>\r\n            <li>Shared reviews include all details (rating, text, photo, tags) when opened by others</li>\r\n          </ul>\r\n          <p><strong>View User Profiles:</strong></p>\r\n          <ul>\r\n            <li>Click on any username to see their complete profile</li>\r\n            <li>View their review history</li>\r\n            <li>Check out their recent activity</li>\r\n            <li>Follow them if interested in their reviews</li>\r\n          </ul>\r\n        </section>\r\n\r\n        <section id=\"gamification\">\r\n          <h2> Gamification & Social Features</h2>\r\n          \r\n          <h3>Your Stats & Achievements</h3>\r\n          <p>Click on your <strong>profile image</strong> in the sidebar to view your personal stats dashboard. Here you can track:</p>\r\n          <ul>\r\n            <li><strong>Total Reviews</strong>  Your contribution count</li>\r\n            <li><strong>Photo Reviews</strong>  Reviews you've submitted with photos</li>\r\n            <li><strong>States Visited</strong>  How many different US states you've reviewed restaurants in</li>\r\n            <li><strong>Followers</strong>  Number of users following your reviews</li>\r\n          </ul>\r\n\r\n          <h3> Badges</h3>\r\n          <p>Earn badges as you reach milestones and accomplish goals! Current badges include:</p>\r\n          <div class=\"feature-list\">\r\n            <div class=\"feature-item\">\r\n              <h4> 10 Reviews</h4>\r\n              <p>Written 10 reviews</p>\r\n            </div>\r\n            <div class=\"feature-item\">\r\n              <h4> 25 Reviews</h4>\r\n              <p>Written 25 reviews</p>\r\n            </div>\r\n            <div class=\"feature-item\">\r\n              <h4> 50 Reviews</h4>\r\n              <p>Written 50 reviews</p>\r\n            </div>\r\n            <div class=\"feature-item\">\r\n              <h4> 100 Reviews</h4>\r\n              <p>Written 100 reviews  Master Reviewer status!</p>\r\n            </div>\r\n            <div class=\"feature-item\">\r\n              <h4> Photo Master</h4>\r\n              <p>Written 10+ reviews with photos</p>\r\n            </div>\r\n            <div class=\"feature-item\">\r\n              <h4> All 50 States</h4>\r\n              <p>Reviewed restaurants across all 50 US states</p>\r\n            </div>\r\n          </div>\r\n\r\n          <h3> Trending Restaurants</h3>\r\n          <p>Discover what's hot in the community! On the Home page, see two trending views:</p>\r\n          <ul>\r\n            <li><strong> Most Reviewed This Week</strong>  Restaurants that have generated the most new reviews in the past 7 days</li>\r\n            <li><strong> Highest Rated This Week</strong>  Restaurants with the best average ratings from recent reviews</li>\r\n          </ul>\r\n\r\n          <h3> Follow Recommendations</h3>\r\n          <p>The Home page suggests quality reviewers to follow. Recommendations are based on:</p>\r\n          <ul>\r\n            <li>Users who share similar reviewer interests</li>\r\n            <li>Reviewers followed by people you follow (mutual connections)</li>\r\n            <li>Highly-rated reviewers in the community</li>\r\n          </ul>\r\n          <p>Hover over recommendations to see why they're suggested, then click Follow to add them to your feed!</p>\r\n\r\n          <h3> Activity Feed</h3>\r\n          <p>Your Home page feeds you the latest activity from users you follow, including:</p>\r\n          <ul>\r\n            <li>New reviews from people you follow</li>\r\n            <li>Recent badges they've earned</li>\r\n            <li>Ratings, reviews, and photos</li>\r\n            <li>Links to view the full review and restaurant details</li>\r\n          </ul>\r\n          <p>The Activity Feed shows the 15 most recent activities, giving you a real-time window into your community.</p>\r\n        </section>\r\n\r\n        <section id=\"tips\">\r\n          <h2>Tips & Best Practices</h2>\r\n\r\n          <h3> For Great Reviews</h3>\r\n          <ol>\r\n            <li><strong>Be Specific</strong>  Instead of \"good food,\" describe the breaded pork tenderloin, flavors, preparation, and portion size</li>\r\n            <li><strong>Include Context</strong>  Mention the occasion (family dinner, quick lunch, date night, etc.)</li>\r\n            <li><strong>Balanced Feedback</strong>  Note both strengths (great breading, generous portions) and areas for improvement</li>\r\n            <li><strong>Use Tags</strong>  Categorize your experience (e.g., \"crispy-exterior\", \"family-friendly\", \"generous-portion\", \"authentic\")</li>\r\n            <li><strong>Add a Photo</strong>  Include a photo of your meal to help others see what to expect</li>\r\n            <li><strong>Be Timely</strong>  Review soon after your visit while details are fresh in your mind</li>\r\n          </ol>\r\n\r\n          <h3> Location Tips</h3>\r\n          <ol>\r\n            <li><strong>Enable Location</strong>  Accept the location prompt on the Home page to unlock the \"Nearby\" sorting feature</li>\r\n            <li><strong>Privacy</strong>  Your location is only used to calculate distances to restaurants and is not stored permanently</li>\r\n            <li><strong>Better Results</strong>  Location data helps show you restaurants closest to you and sorts your feed accordingly</li>\r\n          </ol>\r\n\r\n          <h3> Following Strategy</h3>\r\n          <ol>\r\n            <li><strong>Follow Quality Reviewers</strong>  Find users whose tastes align with yours</li>\r\n            <li><strong>Build Your Feed Gradually</strong>  Start with a few followers and expand over time</li>\r\n            <li><strong>Engage</strong>  Comment on reviews and share your thoughts to build community connections</li>\r\n            <li><strong>Explore Profiles</strong>  Click on reviewers from the Leaderboard to find high-quality contributors</li>\r\n          </ol>\r\n\r\n          <h3> Before Visiting a Restaurant</h3>\r\n          <ol>\r\n            <li>Check <strong>My Bucket List</strong> to see the distance and view saved restaurants</li>\r\n            <li>Read the <strong>latest reviews</strong> to see current conditions and recent experiences</li>\r\n            <li>Check the <strong>restaurant's website</strong> (if available) for hours and menu updates</li>\r\n            <li>Read <strong>recent comments</strong> on reviews for tips and warnings from other reviewers</li>\r\n          </ol>\r\n\r\n          <h3> Search Tips</h3>\r\n          <ul>\r\n            <li>Search by <strong>restaurant name</strong> for direct matches</li>\r\n            <li>Use <strong>address</strong> searches for accuracy when multiple restaurants have similar names</li>\r\n            <li>Try <strong>city names</strong> for broad searches in a specific area</li>\r\n            <li>Search by <strong>ZIP code</strong> to find restaurants in a specific neighborhood</li>\r\n            <li>Try <strong>partial names</strong> if you're unsure of the exact spelling</li>\r\n          </ul>\r\n        </section>\r\n\r\n        <section id=\"faq\">\r\n          <h2>Frequently Asked Questions</h2>\r\n          \r\n          <div class=\"faq-item\">\r\n            <h4>Q: Is there a cost to use PorkHub?</h4>\r\n            <p>A: No! PorkHub is completely free to use and enjoy.</p>\r\n          </div>\r\n\r\n          <div class=\"faq-item\">\r\n            <h4>Q: How does the Leaderboard work?</h4>\r\n            <p>A: Users are ranked based on the number of reviews they've written and community engagement. Top reviewers earn badges or medals.</p>\r\n          </div>\r\n\r\n          <div class=\"faq-item\">\r\n            <h4>Q: Can I delete my account?</h4>\r\n            <p>A: You can delete individual reviews at any time. For full account deletion requests, please contact support.</p>\r\n          </div>\r\n\r\n          <div class=\"faq-item\">\r\n            <h4>Q: What if I see incorrect restaurant information?</h4>\r\n            <p>A: Admins can edit restaurant details directly. If you spot an error, you can also leave a comment noting the issue.</p>\r\n          </div>\r\n\r\n          <div class=\"faq-item\">\r\n            <h4>Q: How are Recommendations calculated?</h4>\r\n            <p>A: Recommendations are based on highly-rated reviews from users in the community and users you follow.</p>\r\n          </div>\r\n\r\n          <div class=\"faq-item\">\r\n            <h4>Q: Are all reviews public?</h4>\r\n            <p>A: Yes, all reviews are public to encourage community engagement and help others discover great restaurants. You can delete reviews if desired.</p>\r\n          </div>\r\n\r\n          <div class=\"faq-item\">\r\n            <h4>Q: Can I edit my review after posting?</h4>\r\n            <p>A: Yes! Go to \"My Reviews\" and click the edit button on any review to update your text, rating, tags, or photo.</p>\r\n          </div>\r\n\r\n          <div class=\"faq-item\">\r\n            <h4>Q: How do I report inappropriate content?</h4>\r\n            <p>A: Contact support with details about the concerning review or comment.</p>\r\n          </div>\r\n\r\n          <div class=\"faq-item\">\r\n            <h4>Q: Do you collect my location data?</h4>\r\n            <p>A: Your location is only used temporarily to calculate distances and sort the feed nearby. It's not stored permanently in your profile.</p>\r\n          </div>\r\n\r\n          <div class=\"faq-item\">\r\n            <h4>Q: Can I search for restaurants without logging in?</h4>\r\n            <p>A: Yes! The Restaurants page is available to all users. You only need to log in to write reviews, follow users, or like reviews.</p>\r\n          </div>\r\n\r\n          <div class=\"faq-item\">\r\n            <h4>Q: How do I earn badges?</h4>\r\n            <p>A: Badges are earned automatically as you reach milestones! Write more reviews, include photos, and visit restaurants in different states to unlock achievements. Check your stats on your profile page to see your progress toward the next badge.</p>\r\n          </div>\r\n\r\n          <div class=\"faq-item\">\r\n            <h4>Q: Can I see badges earned by other users?</h4>\r\n            <p>A: Yes! When viewing other users' profiles or in the Follow Recommendations section, you can see the badges they've earned. This helps you identify quality reviewers in the community.</p>\r\n          </div>\r\n\r\n          <div class=\"faq-item\">\r\n            <h4>Q: How are trending restaurants calculated?</h4>\r\n            <p>A: We calculate trending restaurants based on activity this week. \"Most Reviewed\" shows restaurants with the most new reviews, while \"Highest Rated\" shows restaurants with the best average ratings from recent reviews.</p>\r\n          </div>\r\n        </section>\r\n\r\n        <div class=\"help-footer\">\r\n          <p>Need more help? Please reach out to the PorkHub support team.</p>\r\n          <p>Happy reviewing and pork tenderloin hunting! </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted } from 'vue';\r\n\r\nexport default {\r\n  name: 'Help',\r\n  setup() {\r\n    const activeSection = ref('getting-started');\r\n    const contentRef = ref(null);\r\n\r\n    const scrollToSection = (sectionId) => {\r\n      activeSection.value = sectionId;\r\n      const element = document.querySelector(`#${sectionId}`);\r\n      if (element && contentRef.value) {\r\n        const offsetTop = element.offsetTop;\r\n        contentRef.value.scrollTop = offsetTop - 100;\r\n      }\r\n    };\r\n\r\n    onMounted(() => {\r\n      // Track which section is in view as user scrolls\r\n      if (contentRef.value) {\r\n        contentRef.value.addEventListener('scroll', () => {\r\n          const sections = ['getting-started', 'navigation', 'core-features', 'user-accounts', 'tips', 'faq'];\r\n          for (const section of sections) {\r\n            const element = document.querySelector(`#${section}`);\r\n            if (element) {\r\n              const rect = element.getBoundingClientRect();\r\n              const contentRect = contentRef.value.getBoundingClientRect();\r\n              if (rect.top < contentRect.bottom && rect.bottom > contentRect.top) {\r\n                activeSection.value = section;\r\n                break;\r\n              }\r\n            }\r\n          }\r\n        });\r\n      }\r\n    });\r\n\r\n    return { activeSection, scrollToSection, contentRef };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.help-page {\r\n  background: var(--background-color);\r\n  min-height: 100vh;\r\n}\r\n\r\n.help-container {\r\n  display: flex;\r\n  max-width: 1400px;\r\n  margin: 0 auto;\r\n  gap: 2rem;\r\n  padding: 2rem;\r\n}\r\n\r\n.help-sidebar {\r\n  width: 250px;\r\n  position: sticky;\r\n  top: 2rem;\r\n  height: fit-content;\r\n  background: var(--card-background);\r\n  padding: 1.5rem;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 8px var(--shadow-color);\r\n}\r\n\r\n.help-sidebar h3 {\r\n  margin: 0 0 1rem 0;\r\n  color: var(--secondary-color);\r\n  font-size: 1rem;\r\n  text-transform: uppercase;\r\n  letter-spacing: 0.5px;\r\n}\r\n\r\n.toc-nav {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 0.5rem;\r\n}\r\n\r\n.toc-nav a {\r\n  color: var(--text-color);\r\n  text-decoration: none;\r\n  padding: 0.5rem 0.75rem;\r\n  border-radius: 4px;\r\n  font-size: 0.95rem;\r\n  transition: all 0.2s;\r\n  cursor: pointer;\r\n  border-left: 3px solid transparent;\r\n}\r\n\r\n.toc-nav a:hover {\r\n  background: var(--background-color);\r\n  color: var(--primary-color);\r\n}\r\n\r\n.toc-nav a.active {\r\n  background: var(--background-color);\r\n  color: var(--primary-color);\r\n  border-left-color: var(--primary-color);\r\n  font-weight: 600;\r\n}\r\n\r\n.help-content {\r\n  flex: 1;\r\n  background: var(--card-background);\r\n  padding: 2rem;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 8px var(--shadow-color);\r\n  max-height: 90vh;\r\n  overflow-y: auto;\r\n}\r\n\r\n.help-content h1 {\r\n  color: var(--secondary-color);\r\n  margin-top: 0;\r\n  font-size: 2.5rem;\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n.intro {\r\n  color: var(--text-color);\r\n  font-size: 1.1rem;\r\n  margin-bottom: 2rem;\r\n}\r\n\r\n.help-content section {\r\n  margin-bottom: 3rem;\r\n  scroll-margin-top: 100px;\r\n}\r\n\r\n.help-content h2 {\r\n  color: var(--primary-color);\r\n  font-size: 1.8rem;\r\n  margin-bottom: 1rem;\r\n  border-bottom: 2px solid var(--primary-color);\r\n  padding-bottom: 0.5rem;\r\n}\r\n\r\n.help-content h3 {\r\n  color: var(--secondary-color);\r\n  font-size: 1.3rem;\r\n  margin-top: 1.5rem;\r\n  margin-bottom: 0.75rem;\r\n}\r\n\r\n.help-content h4 {\r\n  color: var(--text-color);\r\n  font-size: 1.1rem;\r\n  margin: 0.75rem 0 0.5rem 0;\r\n}\r\n\r\n.help-content p {\r\n  line-height: 1.6;\r\n  color: var(--text-color);\r\n  margin: 0.75rem 0;\r\n}\r\n\r\n.help-content ul, \r\n.help-content ol {\r\n  margin: 1rem 0;\r\n  padding-left: 2rem;\r\n}\r\n\r\n.help-content li {\r\n  margin: 0.5rem 0;\r\n  line-height: 1.6;\r\n}\r\n\r\n.feature-list {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\r\n  gap: 1rem;\r\n  margin: 1rem 0;\r\n}\r\n\r\n.feature-item {\r\n  background: var(--background-color);\r\n  padding: 1rem;\r\n  border-radius: 6px;\r\n  border-left: 4px solid var(--primary-color);\r\n}\r\n\r\n.feature-item h4 {\r\n  margin-top: 0;\r\n  color: var(--primary-color);\r\n}\r\n\r\n.feature-item p {\r\n  margin: 0.5rem 0 0 0;\r\n  font-size: 0.95rem;\r\n}\r\n\r\n.faq-item {\r\n  background: var(--background-color);\r\n  padding: 1rem;\r\n  border-radius: 6px;\r\n  margin: 1rem 0;\r\n  border-left: 4px solid var(--primary-color);\r\n}\r\n\r\n.faq-item h4 {\r\n  margin-top: 0;\r\n  color: var(--secondary-color);\r\n  font-weight: 600;\r\n}\r\n\r\n.faq-item p {\r\n  margin: 0.5rem 0 0 0;\r\n}\r\n\r\n.help-footer {\r\n  text-align: center;\r\n  margin-top: 3rem;\r\n  padding-top: 2rem;\r\n  border-top: 2px solid var(--background-color);\r\n  color: var(--text-color);\r\n}\r\n\r\n.help-footer p {\r\n  margin: 0.5rem 0;\r\n}\r\n\r\n/* Scrollbar styling */\r\n.help-content::-webkit-scrollbar {\r\n  width: 8px;\r\n}\r\n\r\n.help-content::-webkit-scrollbar-track {\r\n  background: var(--background-color);\r\n  border-radius: 10px;\r\n}\r\n\r\n.help-content::-webkit-scrollbar-thumb {\r\n  background: var(--primary-color);\r\n  border-radius: 10px;\r\n}\r\n\r\n.help-content::-webkit-scrollbar-thumb:hover {\r\n  background: var(--secondary-color);\r\n}\r\n\r\n/* Responsive design */\r\n@media (max-width: 1024px) {\r\n  .help-container {\r\n    flex-direction: column;\r\n  }\r\n\r\n  .help-sidebar {\r\n    position: relative;\r\n    top: 0;\r\n    width: 100%;\r\n  }\r\n\r\n  .help-content {\r\n    max-height: none;\r\n    overflow-y: visible;\r\n  }\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .help-container {\r\n    padding: 1rem;\r\n    gap: 1rem;\r\n  }\r\n\r\n  .help-sidebar {\r\n    padding: 1rem;\r\n  }\r\n\r\n  .help-content {\r\n    padding: 1rem;\r\n  }\r\n\r\n  .help-content h1 {\r\n    font-size: 1.8rem;\r\n  }\r\n\r\n  .help-content h2 {\r\n    font-size: 1.4rem;\r\n  }\r\n\r\n  .feature-list {\r\n    grid-template-columns: 1fr;\r\n  }\r\n}\r\n</style>\r\n","import { render } from \"./Help.vue?vue&type=template&id=641548e4&scoped=true\"\nimport script from \"./Help.vue?vue&type=script&lang=js\"\nexport * from \"./Help.vue?vue&type=script&lang=js\"\n\nimport \"./Help.vue?vue&type=style&index=0&id=641548e4&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-641548e4\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"profile-page\">\r\n    <div v-if=\"user\" class=\"profile-container\">\r\n      <div class=\"profile-header\">\r\n        <img :src=\"user.photoURL || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" alt=\"User\" class=\"profile-avatar\" referrerpolicy=\"no-referrer\" />\r\n        <div class=\"profile-info\">\r\n          <h1>{{ user.displayName }}</h1>\r\n          <p class=\"profile-email\">{{ user.email }}</p>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- User Stats Panel -->\r\n      <UserStatsPanel :user=\"user\" />\r\n    </div>\r\n    <div v-else class=\"empty-state\">\r\n      <p>Please log in to view your profile.</p>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport UserStatsPanel from './UserStatsPanel.vue';\r\n\r\nexport default {\r\n  name: 'Profile',\r\n  components: {\r\n    UserStatsPanel\r\n  },\r\n  props: {\r\n    user: {\r\n      type: Object,\r\n      default: null\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.profile-page {\r\n  padding: 2em;\r\n  max-width: 1200px;\r\n  margin: 0 auto;\r\n}\r\n\r\n.profile-container {\r\n  background: var(--card-background);\r\n  border-radius: 8px;\r\n  padding: 2em;\r\n  box-shadow: 0 2px 8px var(--shadow-color);\r\n}\r\n\r\n.profile-header {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 2em;\r\n  margin-bottom: 2em;\r\n  padding-bottom: 2em;\r\n  border-bottom: 2px solid #e0e0e0;\r\n}\r\n\r\n.profile-avatar {\r\n  width: 120px;\r\n  height: 120px;\r\n  border-radius: 50%;\r\n  object-fit: cover;\r\n  border: 4px solid var(--primary-color);\r\n}\r\n\r\n.profile-info {\r\n  flex: 1;\r\n}\r\n\r\n.profile-info h1 {\r\n  margin: 0 0 0.5em 0;\r\n  color: var(--text-color);\r\n  font-size: 2em;\r\n}\r\n\r\n.profile-email {\r\n  color: #7f8c8d;\r\n  margin: 0;\r\n  font-size: 1em;\r\n}\r\n\r\n.empty-state {\r\n  text-align: center;\r\n  padding: 3em;\r\n  color: #7f8c8d;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .profile-page {\r\n    padding: 1em;\r\n  }\r\n\r\n  .profile-container {\r\n    padding: 1em;\r\n  }\r\n\r\n  .profile-header {\r\n    flex-direction: column;\r\n    text-align: center;\r\n    gap: 1em;\r\n  }\r\n\r\n  .profile-avatar {\r\n    width: 100px;\r\n    height: 100px;\r\n  }\r\n\r\n  .profile-info h1 {\r\n    font-size: 1.5em;\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"user-stats-panel\">\r\n    <h2>Your Stats</h2>\r\n    \r\n    <div class=\"stats-grid\">\r\n      <div class=\"stat-card\">\r\n        <div class=\"stat-icon\"></div>\r\n        <div class=\"stat-content\">\r\n          <div class=\"stat-label\">Total Reviews</div>\r\n          <div class=\"stat-value\">{{ stats.reviewCount }}</div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"stat-card\">\r\n        <div class=\"stat-icon\"></div>\r\n        <div class=\"stat-content\">\r\n          <div class=\"stat-label\">Photo Reviews</div>\r\n          <div class=\"stat-value\">{{ stats.photoReviewCount }}</div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"stat-card\">\r\n        <div class=\"stat-icon\"></div>\r\n        <div class=\"stat-content\">\r\n          <div class=\"stat-label\">States Visited</div>\r\n          <div class=\"stat-value\">{{ stats.statesVisited?.size || 0 }}/50</div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"stat-card\">\r\n        <div class=\"stat-icon\"></div>\r\n        <div class=\"stat-content\">\r\n          <div class=\"stat-label\">Followers</div>\r\n          <div class=\"stat-value\">{{ stats.followerCount || 0 }}</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div v-if=\"earnedBadges.length > 0\" class=\"badges-section\">\r\n      <BadgeDisplay :badges=\"earnedBadges\" title=\"Your Achievements\" />\r\n    </div>\r\n\r\n    <div class=\"achievement-progress\">\r\n      <h3>Next Achievement</h3>\r\n      <div v-for=\"badge in nextBadges\" :key=\"badge.id\" class=\"progress-item\">\r\n        <div class=\"progress-header\">\r\n          <span class=\"badge-preview\">{{ badge.emoji }}</span>\r\n          <span class=\"badge-name\">{{ badge.name }}</span>\r\n          <span class=\"progress-count\">{{ getProgress(badge.id) }}%</span>\r\n        </div>\r\n        <div class=\"progress-bar\">\r\n          <div class=\"progress-fill\" :style=\"{ width: getProgress(badge.id) + '%' }\"></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, computed } from 'vue';\r\nimport { db } from '../firebase';\r\nimport { collection, query, where, getDocs, doc, getDoc } from 'firebase/firestore';\r\nimport { calculateEarnedBadges, BADGES } from '../utils/badges';\r\nimport BadgeDisplay from './BadgeDisplay.vue';\r\n\r\nexport default {\r\n  name: 'UserStatsPanel',\r\n  components: { BadgeDisplay },\r\n  props: {\r\n    user: {\r\n      type: Object,\r\n      required: true\r\n    }\r\n  },\r\n  setup(props) {\r\n    const stats = ref({\r\n      reviewCount: 0,\r\n      photoReviewCount: 0,\r\n      statesVisited: new Set(),\r\n      followerCount: 0\r\n    });\r\n    const earnedBadges = ref([]);\r\n    const loading = ref(true);\r\n\r\n    const loadUserStats = async () => {\r\n      loading.value = true;\r\n      try {\r\n        // Get user's reviews\r\n        const reviewsSnap = await getDocs(\r\n          query(collection(db, 'reviews'), where('userId', '==', props.user.uid))\r\n        );\r\n\r\n        const reviews = reviewsSnap.docs.map(doc => doc.data());\r\n        \r\n        // Count photo reviews and collect states from restaurants\r\n        let photoReviewCount = 0;\r\n        const statesVisited = new Set();\r\n        \r\n        for (const review of reviews) {\r\n          if (review.photoURL) {\r\n            photoReviewCount++;\r\n          }\r\n          \r\n          // Fetch the restaurant document to get the state\r\n          if (review.restaurantId) {\r\n            try {\r\n              const restaurantRef = doc(db, 'restaurants', review.restaurantId);\r\n              const restaurantSnap = await getDoc(restaurantRef);\r\n              if (restaurantSnap.exists()) {\r\n                const restaurantData = restaurantSnap.data();\r\n                if (restaurantData.state) {\r\n                  statesVisited.add(restaurantData.state.toUpperCase());\r\n                }\r\n              }\r\n            } catch (error) {\r\n              console.error('Error fetching restaurant:', error);\r\n            }\r\n          }\r\n        }\r\n\r\n        // Get follower count\r\n        const followersSnap = await getDocs(\r\n          query(collection(db, 'follows'), where('followingId', '==', props.user.uid))\r\n        );\r\n\r\n        stats.value = {\r\n          reviewCount: reviews.length,\r\n          photoReviewCount,\r\n          statesVisited,\r\n          followerCount: followersSnap.docs.length\r\n        };\r\n\r\n        // Calculate earned badges\r\n        earnedBadges.value = calculateEarnedBadges(stats.value);\r\n      } catch (error) {\r\n        console.error('Error loading user stats:', error);\r\n      } finally {\r\n        loading.value = false;\r\n      }\r\n    };\r\n\r\n    const nextBadges = computed(() => {\r\n      return Object.values(BADGES)\r\n        .filter(badge => !earnedBadges.value.includes(badge.id))\r\n        .slice(0, 3);\r\n    });\r\n\r\n    const getProgress = (badgeId) => {\r\n      const badge = Object.values(BADGES).find(b => b.id === badgeId);\r\n      if (!badge) return 0;\r\n\r\n      let progress = 0;\r\n\r\n      if (badgeId.includes('reviewer-')) {\r\n        const requiredCount = parseInt(badgeId.match(/\\d+/)[0]);\r\n        progress = Math.min(100, (stats.value.reviewCount / requiredCount) * 100);\r\n      } else if (badgeId === 'photo-master') {\r\n        progress = Math.min(100, (stats.value.photoReviewCount / 10) * 100);\r\n      } else if (badgeId === 'all-50-states') {\r\n        progress = Math.min(100, ((stats.value.statesVisited?.size || 0) / 50) * 100);\r\n      }\r\n\r\n      return Math.round(progress);\r\n    };\r\n\r\n    onMounted(() => {\r\n      loadUserStats();\r\n    });\r\n\r\n    return {\r\n      stats,\r\n      earnedBadges,\r\n      nextBadges,\r\n      getProgress,\r\n      loading\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.user-stats-panel {\r\n  background: var(--card-background);\r\n  border-radius: 8px;\r\n  padding: 2rem;\r\n  box-shadow: 0 2px 8px var(--shadow-color);\r\n}\r\n\r\n.user-stats-panel h2 {\r\n  color: var(--primary-color);\r\n  margin: 0 0 1.5rem 0;\r\n  font-size: 1.5rem;\r\n}\r\n\r\n.stats-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\r\n  gap: 1rem;\r\n  margin-bottom: 2rem;\r\n}\r\n\r\n.stat-card {\r\n  background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);\r\n  border: 1px solid var(--primary-color);\r\n  border-radius: 8px;\r\n  padding: 1rem;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 1rem;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.stat-card:hover {\r\n  transform: translateY(-2px);\r\n  box-shadow: 0 4px 12px var(--shadow-color);\r\n}\r\n\r\n.stat-icon {\r\n  font-size: 2rem;\r\n}\r\n\r\n.stat-content {\r\n  flex: 1;\r\n}\r\n\r\n.stat-label {\r\n  font-size: 0.8rem;\r\n  color: var(--text-color);\r\n  opacity: 0.8;\r\n  text-transform: uppercase;\r\n  letter-spacing: 0.5px;\r\n}\r\n\r\n.stat-value {\r\n  font-size: 1.75rem;\r\n  font-weight: 700;\r\n  color: var(--primary-color);\r\n  margin-top: 0.25rem;\r\n}\r\n\r\n.badges-section {\r\n  margin-bottom: 2rem;\r\n}\r\n\r\n.achievement-progress {\r\n  padding-top: 2rem;\r\n  border-top: 2px solid var(--background-color);\r\n}\r\n\r\n.achievement-progress h3 {\r\n  color: var(--secondary-color);\r\n  font-size: 1.1rem;\r\n  margin: 0 0 1rem 0;\r\n}\r\n\r\n.progress-item {\r\n  margin-bottom: 1.5rem;\r\n}\r\n\r\n.progress-header {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.75rem;\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n.badge-preview {\r\n  font-size: 1.5rem;\r\n}\r\n\r\n.badge-name {\r\n  flex: 1;\r\n  color: var(--secondary-color);\r\n  font-weight: 600;\r\n}\r\n\r\n.progress-count {\r\n  background: var(--primary-color);\r\n  color: white;\r\n  padding: 0.25rem 0.5rem;\r\n  border-radius: 4px;\r\n  font-size: 0.85rem;\r\n  font-weight: 600;\r\n}\r\n\r\n.progress-bar {\r\n  background: var(--background-color);\r\n  border-radius: 4px;\r\n  height: 6px;\r\n  overflow: hidden;\r\n}\r\n\r\n.progress-fill {\r\n  background: linear-gradient(90deg, var(--primary-color) 0%, #2980b9 100%);\r\n  height: 100%;\r\n  transition: width 0.3s ease;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .user-stats-panel {\r\n    padding: 1rem;\r\n  }\r\n\r\n  .stats-grid {\r\n    grid-template-columns: repeat(2, 1fr);\r\n  }\r\n\r\n  .stat-card {\r\n    padding: 0.75rem;\r\n  }\r\n\r\n  .stat-icon {\r\n    font-size: 1.5rem;\r\n  }\r\n\r\n  .stat-value {\r\n    font-size: 1.25rem;\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <div v-if=\"badges && badges.length > 0\" class=\"badges-container\">\r\n    <h4 class=\"badges-title\">{{ title }}</h4>\r\n    <div class=\"badges-list\">\r\n      <div v-for=\"badgeId in badges\" :key=\"badgeId\" class=\"badge-item\" :title=\"getBadgeDescription(badgeId)\">\r\n        <span class=\"badge-emoji\">{{ getBadgeEmoji(badgeId) }}</span>\r\n        <span class=\"badge-name\">{{ getBadgeName(badgeId) }}</span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getBadgeById } from '../utils/badges';\r\n\r\nexport default {\r\n  name: 'BadgeDisplay',\r\n  props: {\r\n    badges: {\r\n      type: Array,\r\n      default: () => []\r\n    },\r\n    title: {\r\n      type: String,\r\n      default: 'Badges'\r\n    }\r\n  },\r\n  setup() {\r\n    const getBadgeById_fn = getBadgeById;\r\n\r\n    const getBadgeName = (badgeId) => {\r\n      const badge = getBadgeById_fn(badgeId);\r\n      return badge ? badge.name : 'Achievement';\r\n    };\r\n\r\n    const getBadgeEmoji = (badgeId) => {\r\n      const badge = getBadgeById_fn(badgeId);\r\n      return badge ? badge.emoji : '';\r\n    };\r\n\r\n    const getBadgeDescription = (badgeId) => {\r\n      const badge = getBadgeById_fn(badgeId);\r\n      return badge ? `${badge.name}: ${badge.description}` : 'Achievement';\r\n    };\r\n\r\n    return {\r\n      getBadgeName,\r\n      getBadgeEmoji,\r\n      getBadgeDescription\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.badges-container {\r\n  margin: 1rem 0;\r\n  padding: 1rem;\r\n  background: linear-gradient(135deg, #fff9e6 0%, #fff 100%);\r\n  border: 1px solid #ffe082;\r\n  border-radius: 8px;\r\n}\r\n\r\n.badges-title {\r\n  margin: 0 0 0.75rem 0;\r\n  color: #f57f17;\r\n  font-size: 0.9rem;\r\n  text-transform: uppercase;\r\n  letter-spacing: 0.5px;\r\n}\r\n\r\n.badges-list {\r\n  display: flex;\r\n  gap: 1rem;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.badge-item {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n  background: white;\r\n  padding: 0.5rem 0.75rem;\r\n  border-radius: 20px;\r\n  border: 1px solid #ffe082;\r\n  cursor: help;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.badge-item:hover {\r\n  transform: scale(1.05);\r\n  box-shadow: 0 2px 8px rgba(255, 193, 7, 0.3);\r\n}\r\n\r\n.badge-emoji {\r\n  font-size: 1.25rem;\r\n}\r\n\r\n.badge-name {\r\n  font-size: 0.85rem;\r\n  font-weight: 600;\r\n  color: #f57f17;\r\n  white-space: nowrap;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .badges-list {\r\n    gap: 0.75rem;\r\n  }\r\n\r\n  .badge-item {\r\n    padding: 0.4rem 0.6rem;\r\n  }\r\n\r\n  .badge-emoji {\r\n    font-size: 1.1rem;\r\n  }\r\n\r\n  .badge-name {\r\n    font-size: 0.75rem;\r\n  }\r\n}\r\n</style>\r\n","import { render } from \"./BadgeDisplay.vue?vue&type=template&id=b869d4a4&scoped=true\"\nimport script from \"./BadgeDisplay.vue?vue&type=script&lang=js\"\nexport * from \"./BadgeDisplay.vue?vue&type=script&lang=js\"\n\nimport \"./BadgeDisplay.vue?vue&type=style&index=0&id=b869d4a4&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-b869d4a4\"]])\n\nexport default __exports__","import { render } from \"./UserStatsPanel.vue?vue&type=template&id=6c01ec51&scoped=true\"\nimport script from \"./UserStatsPanel.vue?vue&type=script&lang=js\"\nexport * from \"./UserStatsPanel.vue?vue&type=script&lang=js\"\n\nimport \"./UserStatsPanel.vue?vue&type=style&index=0&id=6c01ec51&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-6c01ec51\"]])\n\nexport default __exports__","import { render } from \"./Profile.vue?vue&type=template&id=6e6011ae&scoped=true\"\nimport script from \"./Profile.vue?vue&type=script&lang=js\"\nexport * from \"./Profile.vue?vue&type=script&lang=js\"\n\nimport \"./Profile.vue?vue&type=style&index=0&id=6e6011ae&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-6e6011ae\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"modal-overlay\" @click.self=\"$emit('close')\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h2>Review</h2>\r\n        <button @click=\"$emit('close')\" class=\"close-btn\">&times;</button>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <div v-if=\"loading\" class=\"loading-indicator\">Loading review...</div>\r\n        <div v-else-if=\"error\" class=\"error-message\">{{ error }}</div>\r\n        <div v-else-if=\"review\" class=\"review-detail\">\r\n          <div class=\"post-header\">\r\n            <img :src=\"review.userPhoto || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'\" alt=\"User\" class=\"user-avatar\" referrerpolicy=\"no-referrer\" />\r\n            <div class=\"post-info\">\r\n              <div class=\"user-line\">\r\n                <span class=\"user-name\">{{ review.userName }}</span>\r\n                <span v-if=\"review.medal\" class=\"medal\">{{ review.medal }}</span>\r\n              </div>\r\n              <span class=\"post-date\">{{ formatDate(review.createdAt) }}</span>\r\n            </div>\r\n          </div>\r\n          <div class=\"post-content\">\r\n            <div class=\"post-title-line\">\r\n              <h2 class=\"restaurant-name\">{{ review.restaurantName }}</h2>\r\n              <div v-if=\"review.distance !== null\" class=\"distance\">\r\n                {{ review.distance.toFixed(1) }} miles away\r\n              </div>\r\n            </div>\r\n            <div v-if=\"review.restaurantCity || review.restaurantState\" class=\"restaurant-location\">\r\n              {{ review.restaurantCity }}<template v-if=\"review.restaurantCity && review.restaurantState\">, </template>{{ review.restaurantState }}\r\n            </div>\r\n            <div class=\"review-body\">\r\n              <StarRating :rating=\"review.rating\" />\r\n              <p v-if=\"review.text\" class=\"review-text\">\"{{ review.text }}\"</p>\r\n              <img v-if=\"review.photoURL\" :src=\"review.photoURL\" alt=\"Review photo\" class=\"review-photo\" />\r\n              <div v-if=\"review.tags && review.tags.length > 0\" class=\"tags-container\">\r\n                <span v-for=\"tag in review.tags\" :key=\"tag\" class=\"tag\">{{ tag }}</span>\r\n              </div>\r\n            </div>\r\n            <div class=\"post-actions\">\r\n              <button @click=\"toggleLike\" class=\"like-btn\" :class=\"{ 'liked': review.isLiked }\" :disabled=\"!user\">\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"20px\" viewBox=\"0 0 24 24\" width=\"20px\" fill=\"currentColor\">\r\n                  <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\r\n                  <path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\"/>\r\n                </svg>\r\n                <span>{{ review.likeCount || 0 }}</span>\r\n              </button>\r\n            </div>\r\n            <Comments :post-id=\"review.id\"\r\n                      :user=\"user\"\r\n                      post-type=\"reviews\"\r\n                      :post-author-id=\"review.userId\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, watch, onUnmounted } from 'vue';\r\nimport { db } from '../firebase';\r\nimport { doc, getDoc, collection, query, onSnapshot, addDoc, deleteDoc, getDocs, where, serverTimestamp, orderBy, limit } from 'firebase/firestore';\r\nimport StarRating from './StarRating.vue';\r\nimport Comments from './Comments.vue';\r\nimport { getDistance } from '../utils/geolocation.js';\r\nimport { updateMetaTags, resetMetaTags } from '../utils/meta.js';\r\n\r\nexport default {\r\n  name: 'ReviewDetailModal',\r\n  components: { StarRating, Comments },\r\n  props: {\r\n    reviewId: {\r\n      type: String,\r\n      required: true\r\n    },\r\n    user: {\r\n      type: Object,\r\n      default: null\r\n    }\r\n  },\r\n  emits: ['close'],\r\n  setup(props) {\r\n    const review = ref(null);\r\n    const loading = ref(true);\r\n    const error = ref('');\r\n    const restaurantsMap = ref(new Map());\r\n    const leaderboardRanks = ref(new Map());\r\n    const userLocation = ref(null);\r\n    let likeUnsubscribe = () => {};\r\n\r\n    const getMedal = (index) => {\r\n      if (typeof index !== 'number') return null;\r\n      if (index === 0) return '';\r\n      if (index === 1) return '';\r\n      if (index === 2) return '';\r\n      if (index >= 3 && index < 10) return '';\r\n      return null;\r\n    };\r\n\r\n    const formatDate = (timestamp) => {\r\n      if (!timestamp || !timestamp.toDate) return '';\r\n      return timestamp.toDate().toLocaleString();\r\n    };\r\n\r\n    const fetchReview = async () => {\r\n      loading.value = true;\r\n      error.value = '';\r\n      \r\n      try {\r\n        // Fetch restaurant data\r\n        const restaurantsSnap = await getDocs(collection(db, 'restaurants'));\r\n        restaurantsSnap.forEach(doc => {\r\n          restaurantsMap.value.set(doc.id, doc.data());\r\n        });\r\n\r\n        // Fetch leaderboard ranks\r\n        const leaderboardSnap = await getDocs(query(collection(db, 'users'), orderBy('reviewCount', 'desc'), limit(30)));\r\n        const usersWithReviews = leaderboardSnap.docs\r\n          .map(doc => ({ id: doc.id, ...doc.data() }))\r\n          .filter(user => {\r\n            const count = Number(user.reviewCount) || 0;\r\n            return count > 0;\r\n          })\r\n          .sort((a, b) => {\r\n            const countA = Number(a.reviewCount) || 0;\r\n            const countB = Number(b.reviewCount) || 0;\r\n            return countB - countA;\r\n          })\r\n          .slice(0, 10);\r\n        \r\n        const ranks = new Map();\r\n        usersWithReviews.forEach((user, index) => {\r\n          ranks.set(user.id, index);\r\n        });\r\n        leaderboardRanks.value = ranks;\r\n\r\n        // Get user location for distance calculation\r\n        if (navigator.geolocation) {\r\n          navigator.geolocation.getCurrentPosition(position => {\r\n            userLocation.value = {\r\n              lat: position.coords.latitude,\r\n              lng: position.coords.longitude\r\n            };\r\n            updateReviewDistance();\r\n          }, () => {\r\n            // Ignore location errors\r\n          });\r\n        }\r\n\r\n        // Fetch the review\r\n        const reviewRef = doc(db, 'reviews', props.reviewId);\r\n        const reviewSnap = await getDoc(reviewRef);\r\n        \r\n        if (!reviewSnap.exists()) {\r\n          error.value = 'Review not found.';\r\n          loading.value = false;\r\n          return;\r\n        }\r\n\r\n        const reviewData = { id: reviewSnap.id, ...reviewSnap.data() };\r\n        const restaurant = restaurantsMap.value.get(reviewData.restaurantId);\r\n        const rank = leaderboardRanks.value.get(reviewData.userId);\r\n\r\n        review.value = {\r\n          ...reviewData,\r\n          restaurantName: restaurant?.name || 'Unknown Restaurant',\r\n          restaurantCity: restaurant?.city,\r\n          restaurantState: restaurant?.state,\r\n          location: restaurant?.location || null,\r\n          distance: null, // Will be updated if location available\r\n          medal: getMedal(rank),\r\n          likeCount: 0,\r\n          isLiked: false\r\n        };\r\n\r\n        updateReviewDistance();\r\n\r\n        // Set up like listener\r\n        setupLikeListener();\r\n\r\n        // Update meta tags for social media sharing\r\n        // Use query parameter format that works with the current routing setup\r\n        const shareUrl = `${window.location.origin}/?review=${review.value.id}`;\r\n        const shareTitle = `${review.value.userName}'s Review of ${review.value.restaurantName}`;\r\n        const shareDescription = review.value.text \r\n          ? `\"${review.value.text.substring(0, 150)}${review.value.text.length > 150 ? '...' : ''}\"` \r\n          : `${review.value.userName} rated ${review.value.restaurantName} ${review.value.rating} stars`;\r\n        const shareImage = review.value.photoURL || '';\r\n\r\n        updateMetaTags({\r\n          title: shareTitle,\r\n          description: shareDescription,\r\n          image: shareImage,\r\n          url: shareUrl,\r\n          type: 'article'\r\n        });\r\n\r\n      } catch (err) {\r\n        console.error('Error fetching review:', err);\r\n        error.value = 'Failed to load review. Please try again.';\r\n      } finally {\r\n        loading.value = false;\r\n      }\r\n    };\r\n\r\n    const updateReviewDistance = () => {\r\n      if (review.value && userLocation.value && review.value.location) {\r\n        review.value.distance = getDistance(\r\n          userLocation.value.lat,\r\n          userLocation.value.lng,\r\n          review.value.location.lat,\r\n          review.value.location.lng\r\n        );\r\n      }\r\n    };\r\n\r\n    const setupLikeListener = () => {\r\n      if (!review.value) return;\r\n      \r\n      const reviewRef = doc(db, 'reviews', review.value.id);\r\n      const likesCollection = collection(reviewRef, 'likes');\r\n      const likesQuery = query(likesCollection);\r\n      \r\n      likeUnsubscribe = onSnapshot(likesQuery, (snapshot) => {\r\n        if (review.value) {\r\n          review.value.likeCount = snapshot.size;\r\n          review.value.isLiked = props.user ? snapshot.docs.some(doc => doc.data().userId === props.user.uid) : false;\r\n        }\r\n      }, (err) => {\r\n        console.error('Error fetching likes:', err);\r\n      });\r\n    };\r\n\r\n    const toggleLike = async () => {\r\n      if (!props.user || !review.value) return;\r\n      \r\n      const reviewRef = doc(db, 'reviews', review.value.id);\r\n      const likesCollection = collection(reviewRef, 'likes');\r\n      const likeQuery = query(likesCollection, where('userId', '==', props.user.uid));\r\n      const likeSnap = await getDocs(likeQuery);\r\n      \r\n      if (!likeSnap.empty) {\r\n        await deleteDoc(likeSnap.docs[0].ref);\r\n      } else {\r\n        await addDoc(likesCollection, {\r\n          userId: props.user.uid,\r\n          createdAt: serverTimestamp()\r\n        });\r\n      }\r\n    };\r\n\r\n    watch(() => props.reviewId, () => {\r\n      if (props.reviewId) {\r\n        if (likeUnsubscribe) likeUnsubscribe();\r\n        fetchReview();\r\n      } else {\r\n        resetMetaTags();\r\n      }\r\n    }, { immediate: true });\r\n\r\n    onMounted(() => {\r\n      if (props.reviewId) {\r\n        fetchReview();\r\n      }\r\n    });\r\n\r\n    onUnmounted(() => {\r\n      resetMetaTags();\r\n      if (likeUnsubscribe) {\r\n        likeUnsubscribe();\r\n      }\r\n    });\r\n\r\n    return {\r\n      review,\r\n      loading,\r\n      error,\r\n      formatDate,\r\n      toggleLike\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.modal-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: rgba(0, 0, 0, 0.6);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 1000;\r\n}\r\n\r\n.modal-content {\r\n  background: var(--card-background);\r\n  padding: 2em;\r\n  border-radius: 12px;\r\n  width: 90%;\r\n  max-width: 700px;\r\n  max-height: 90vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  box-shadow: 0 5px 20px rgba(0,0,0,0.3);\r\n}\r\n\r\n.modal-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  border-bottom: 1px solid #eee;\r\n  padding-bottom: 1em;\r\n  margin-bottom: 1em;\r\n}\r\n\r\n.modal-header h2 {\r\n  margin: 0;\r\n}\r\n\r\n.close-btn {\r\n  background: none;\r\n  border: none;\r\n  font-size: 2em;\r\n  cursor: pointer;\r\n  color: #777;\r\n}\r\n\r\n.modal-body {\r\n  overflow-y: auto;\r\n}\r\n\r\n.loading-indicator, .error-message {\r\n  text-align: center;\r\n  color: #777;\r\n  padding: 3em;\r\n}\r\n\r\n.error-message {\r\n  color: #e74c3c;\r\n}\r\n\r\n.review-detail {\r\n  max-width: 100%;\r\n}\r\n\r\n.post-header {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 1em;\r\n  padding: 1em 0;\r\n  border-bottom: 1px solid #eee;\r\n  margin-bottom: 1em;\r\n}\r\n\r\n.user-avatar {\r\n  width: 45px;\r\n  height: 45px;\r\n  border-radius: 50%;\r\n}\r\n\r\n.post-info {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.user-line {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5em;\r\n}\r\n\r\n.user-name {\r\n  font-weight: 600;\r\n}\r\n\r\n.medal {\r\n  font-size: 1.1em;\r\n}\r\n\r\n.post-date {\r\n  color: #7f8c8d;\r\n  font-size: 0.85em;\r\n}\r\n\r\n.post-content {\r\n  padding: 0.5em 0;\r\n}\r\n\r\n.post-title-line {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: baseline;\r\n  margin-bottom: 0.25em;\r\n}\r\n\r\n.restaurant-name {\r\n  font-size: 1.1em;\r\n  font-weight: 600;\r\n  margin: 0;\r\n}\r\n\r\n.distance {\r\n  font-size: 0.9em;\r\n  color: #777;\r\n  font-style: italic;\r\n}\r\n\r\n.restaurant-location {\r\n  font-size: 0.9em;\r\n  color: #777;\r\n  margin-bottom: 0.75em;\r\n}\r\n\r\n.review-body {\r\n  margin-bottom: 1em;\r\n}\r\n\r\n.review-text {\r\n  font-style: italic;\r\n  color: #333;\r\n  margin: 0.5em 0;\r\n}\r\n\r\n.review-photo {\r\n  max-width: 100%;\r\n  height: auto;\r\n  border-radius: 8px;\r\n  margin: 0.5em 0;\r\n}\r\n\r\n.tags-container {\r\n  margin-top: 0.75em;\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 0.5em;\r\n}\r\n\r\n.tag {\r\n  background-color: #eee;\r\n  padding: 0.25em 0.75em;\r\n  border-radius: 15px;\r\n  font-size: 0.8em;\r\n}\r\n\r\n.post-actions {\r\n  display: flex;\r\n  gap: 1em;\r\n  margin-top: 0.75em;\r\n  padding-top: 0.75em;\r\n  border-top: 1px solid #eee;\r\n}\r\n\r\n.like-btn {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5em;\r\n  background: none;\r\n  border: none;\r\n  cursor: pointer;\r\n  padding: 0.5em 0.75em;\r\n  border-radius: 8px;\r\n  color: #555;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.like-btn:hover:not(:disabled) {\r\n  background-color: #f0f0f0;\r\n}\r\n\r\n.like-btn:disabled {\r\n  cursor: not-allowed;\r\n  opacity: 0.6;\r\n}\r\n\r\n.like-btn.liked {\r\n  color: #e74c3c;\r\n}\r\n\r\n.like-btn svg {\r\n  width: 20px;\r\n  height: 20px;\r\n  fill: currentColor;\r\n}\r\n</style>\r\n","// Utility for managing Open Graph and meta tags for social media sharing\r\n\r\nexport const updateMetaTags = (options = {}) => {\r\n  const {\r\n    title = 'PorkHub',\r\n    description = 'Find, review, and share the best breaded pork tenderloin sandwiches.',\r\n    image = '',\r\n    url = window.location.href,\r\n    type = 'website'\r\n  } = options;\r\n\r\n  // Update or create meta tags\r\n  const setMetaTag = (property, content) => {\r\n    if (!content) return;\r\n    \r\n    let element = document.querySelector(`meta[property=\"${property}\"]`) || \r\n                  document.querySelector(`meta[name=\"${property}\"]`);\r\n    \r\n    if (!element) {\r\n      element = document.createElement('meta');\r\n      if (property.startsWith('og:')) {\r\n        element.setAttribute('property', property);\r\n      } else {\r\n        element.setAttribute('name', property);\r\n      }\r\n      document.head.appendChild(element);\r\n    }\r\n    \r\n    element.setAttribute('content', content);\r\n  };\r\n\r\n  // Basic meta tags\r\n  document.title = title;\r\n  setMetaTag('description', description);\r\n\r\n  // Open Graph tags\r\n  setMetaTag('og:title', title);\r\n  setMetaTag('og:description', description);\r\n  setMetaTag('og:image', image);\r\n  setMetaTag('og:url', url);\r\n  setMetaTag('og:type', type);\r\n  setMetaTag('og:site_name', 'PorkHub');\r\n\r\n  // Twitter Card tags\r\n  setMetaTag('twitter:card', 'summary_large_image');\r\n  setMetaTag('twitter:title', title);\r\n  setMetaTag('twitter:description', description);\r\n  setMetaTag('twitter:image', image);\r\n\r\n  // Update canonical URL\r\n  let canonical = document.querySelector('link[rel=\"canonical\"]');\r\n  if (!canonical) {\r\n    canonical = document.createElement('link');\r\n    canonical.setAttribute('rel', 'canonical');\r\n    document.head.appendChild(canonical);\r\n  }\r\n  canonical.setAttribute('href', url);\r\n};\r\n\r\nexport const resetMetaTags = () => {\r\n  updateMetaTags({\r\n    title: 'PorkHub',\r\n    description: 'Find, review, and share the best breaded pork tenderloin sandwiches. Join the PorkHub community to discover hidden gems and top-rated restaurants.',\r\n    image: '',\r\n    url: window.location.origin\r\n  });\r\n};\r\n","import { render } from \"./ReviewDetailModal.vue?vue&type=template&id=a904abd6&scoped=true\"\nimport script from \"./ReviewDetailModal.vue?vue&type=script&lang=js\"\nexport * from \"./ReviewDetailModal.vue?vue&type=script&lang=js\"\n\nimport \"./ReviewDetailModal.vue?vue&type=style&index=0&id=a904abd6&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-a904abd6\"]])\n\nexport default __exports__","<template>\r\n  <TransitionGroup name=\"toast\" tag=\"div\" class=\"toast-container\">\r\n    <div\r\n      v-for=\"toast in toasts\"\r\n      :key=\"toast.id\"\r\n      :class=\"['toast', `toast-${toast.type}`]\"\r\n      @click=\"removeToast(toast.id)\"\r\n    >\r\n      <span class=\"toast-message\">{{ toast.message }}</span>\r\n      <button class=\"toast-close\" @click.stop=\"removeToast(toast.id)\">&times;</button>\r\n    </div>\r\n  </TransitionGroup>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, onUnmounted } from 'vue';\r\nimport { subscribeToToasts } from '../utils/toast.js';\r\n\r\nexport default {\r\n  name: 'Toast',\r\n  setup() {\r\n    const toasts = ref([]);\r\n    let unsubscribe = null;\r\n    \r\n    const removeToast = (id) => {\r\n      const index = toasts.value.findIndex(t => t.id === id);\r\n      if (index > -1) {\r\n        toasts.value.splice(index, 1);\r\n      }\r\n    };\r\n    \r\n    onMounted(() => {\r\n      unsubscribe = subscribeToToasts((toast) => {\r\n        toasts.value.push(toast);\r\n        \r\n        if (toast.duration > 0) {\r\n          setTimeout(() => {\r\n            removeToast(toast.id);\r\n          }, toast.duration);\r\n        }\r\n      });\r\n    });\r\n    \r\n    onUnmounted(() => {\r\n      if (unsubscribe) {\r\n        unsubscribe();\r\n      }\r\n    });\r\n    \r\n    return {\r\n      toasts,\r\n      removeToast\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.toast-container {\r\n  position: fixed;\r\n  top: 20px;\r\n  right: 20px;\r\n  z-index: 10000;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 10px;\r\n  pointer-events: none;\r\n}\r\n\r\n.toast {\r\n  background: var(--card-background);\r\n  color: var(--text-color);\r\n  padding: 12px 16px;\r\n  border-radius: 8px;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  gap: 12px;\r\n  min-width: 250px;\r\n  max-width: 400px;\r\n  pointer-events: auto;\r\n  cursor: pointer;\r\n  border-left: 4px solid var(--primary-color);\r\n}\r\n\r\n.toast-success {\r\n  border-left-color: #27ae60;\r\n}\r\n\r\n.toast-error {\r\n  border-left-color: #e74c3c;\r\n}\r\n\r\n.toast-warning {\r\n  border-left-color: #f39c12;\r\n}\r\n\r\n.toast-info {\r\n  border-left-color: var(--primary-color);\r\n}\r\n\r\n.toast-message {\r\n  flex: 1;\r\n  font-size: 0.95em;\r\n}\r\n\r\n.toast-close {\r\n  background: none;\r\n  border: none;\r\n  color: #777;\r\n  font-size: 1.5em;\r\n  line-height: 1;\r\n  cursor: pointer;\r\n  padding: 0;\r\n  width: 20px;\r\n  height: 20px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.toast-close:hover {\r\n  color: #333;\r\n}\r\n\r\n.toast-enter-active,\r\n.toast-leave-active {\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.toast-enter-from {\r\n  opacity: 0;\r\n  transform: translateX(100%);\r\n}\r\n\r\n.toast-leave-to {\r\n  opacity: 0;\r\n  transform: translateX(100%);\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .toast-container {\r\n    top: 10px;\r\n    right: 10px;\r\n    left: 10px;\r\n  }\r\n  \r\n  .toast {\r\n    min-width: auto;\r\n    max-width: 100%;\r\n  }\r\n}\r\n</style>\r\n","import { render } from \"./Toast.vue?vue&type=template&id=285b30f8&scoped=true\"\nimport script from \"./Toast.vue?vue&type=script&lang=js\"\nexport * from \"./Toast.vue?vue&type=script&lang=js\"\n\nimport \"./Toast.vue?vue&type=style&index=0&id=285b30f8&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-285b30f8\"]])\n\nexport default __exports__","import { render } from \"./App.vue?vue&type=template&id=cbb3efbc\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=cbb3efbc&lang=css\"\n\nimport exportComponent from \"../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { createApp } from 'vue';\r\nimport App from './App.vue';\r\nimport { seedSampleData } from './sampleData';\r\n\r\n// --- How to seed your database ---\r\n// 1. Uncomment the line below.\r\n// 2. Run your app (e.g., 'npm run dev') and let the page load. An alert will pop up when it's done.\r\n// 3. Re-comment the line so it doesn't run again on the next app launch.\r\n// seedSampleData();\r\n\r\ncreateApp(App).mount('#app');","// We will use OpenStreetMap's Nominatim API for geocoding.\r\n// It's a free service and doesn't require an API key.\r\n// See usage policy: https://operations.osmfoundation.org/policies/nominatim/\r\n// It's recommended to provide a valid email in the request for contact purposes.\r\nconst YOUR_EMAIL_FOR_NOMINATIM = 'kennected.com@gmail.com';\r\n\r\n/**\r\n * Geocodes an address string into latitude and longitude using Nominatim.\r\n * @param {string} address The address to geocode.\r\n * @returns {Promise<{lat: number, lng: number}|null>} A promise that resolves to the location or null.\r\n */\r\nexport async function geocodeAddress(address) {\r\n  if (!address || !address.trim()) {\r\n    console.error('Geocoding error: Address is empty.');\r\n    return null;\r\n  }\r\n\r\n  const url = `https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(address)}&format=json&limit=1&email=${YOUR_EMAIL_FOR_NOMINATIM}`;\r\n\r\n  try {\r\n    const response = await fetch(url);\r\n    const data = await response.json();\r\n\r\n    if (data && data.length > 0) {\r\n      const { lat, lon } = data[0];\r\n      // Nominatim returns 'lon', but the app uses 'lng'.\r\n      return { lat: parseFloat(lat), lng: parseFloat(lon) };\r\n    }\r\n    return null;\r\n  } catch (error) {\r\n    console.error('Error during geocoding fetch:', error);\r\n    return null;\r\n  }\r\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t524: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkmy_vue_app\"] = self[\"webpackChunkmy_vue_app\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [504], () => (__webpack_require__(489)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["id","class","xmlns","height","viewBox","width","fill","src","alt","_createElementBlock","_hoisted_1","_createElementVNode","_normalizeClass","$setup","isSidebarCollapsed","_hoisted_2","_hoisted_3","onClick","_cache","args","toggleSidebar","title","_hoisted_5","_hoisted_4","d","user","_hoisted_6","photoURL","referrerpolicy","goToProfile","style","_hoisted_8","_toDisplayString","displayName","_hoisted_9","currentPage","goToHome","goToLeaderboard","goToRestaurants","goToRecommendations","goToReview","goToUserSearch","goToBucketList","goToMyReviews","goToFollowers","goToFollowing","cx","cy","r","_hoisted_10","goToHelp","isAdmin","goToDatabaseStats","logout","loginWithGoogle","_hoisted_11","appVersion","_hoisted_12","sharedReviewId","_hoisted_14","_hoisted_13","_createBlock","_KeepAlive","include","_resolveDynamicComponent","currentComponent","onReviewed","onCheckInAt","reviewAt","onReviewAt","onGoToReview","selectedRestaurantForReview","_component_ReviewDetailModal","onClose","closeReviewModal","_createVNode","_component_Toast","ref","locationPermission","requestLocationAccess","userLocation","$event","setSortOrder","active","sortOrder","loading","_hoisted_7","posts","length","$props","_Fragment","_renderList","post","key","userPhoto","_hoisted_15","userName","medal","_hoisted_16","_hoisted_17","createdAt","toDate","toLocaleString","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","restaurantName","toggleBucketList","isInBucketList","restaurantId","distance","_hoisted_23","toFixed","restaurantCity","restaurantState","_hoisted_24","_hoisted_25","_component_StarRating","rating","text","_hoisted_26","tags","_hoisted_28","tag","_hoisted_29","toggleLike","isLiked","disabled","likeCount","shareReview","_component_Comments","userId","_hoisted_32","loadingMore","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_component_TrendingRestaurants","onRestaurantSelected","handleRestaurantSelected","_hoisted_37","_component_ActivityFeed","following","userFollowing","_hoisted_38","_component_FollowRecommendations","onFollowUser","handleFollowUser","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","app","initializeApp","auth","getAuth","provider","GoogleAuthProvider","db","getFirestore","storage","getStorage","comments","comment","formatDate","editingCommentId","canEdit","startEditing","canDelete","deleteComment","editingText","onKeyup","_withKeys","saveEdit","cancelEdit","newComment","placeholder","addComment","trim","toastListeners","toastId","showToast","message","type","duration","toast","forEach","listener","subscribeToToasts","callback","push","index","indexOf","splice","name","props","postId","String","required","postType","postAuthorId","Object","default","setup","unsubscribe","onMounted","parentDocRef","doc","commentsCollection","collection","commentsQuery","query","orderBy","onSnapshot","async","commentData","snapshot","docs","map","data","userIds","Set","c","usersMap","Map","i","batchIds","slice","usersQuery","where","documentId","usersSnapshot","getDocs","set","value","get","onUnmounted","currentUser","now","serverTimestamp","reviewDocRef","Promise","all","addDoc","uid","updateDoc","lastActivityAt","commentDoc","confirm","commentId","deleteDoc","error","console","timestamp","__exports__","editable","n","setRating","onMouseover","handleMouseover","onMouseleave","handleMouseleave","getStarPath","Number","Boolean","emits","emit","hoverRating","fullStarPath","halfStarPath","emptyStarPath","starIndex","displayRating","activities","opacity","activity","badgesEarned","formatTime","badgeId","getBadgeName","getBadgeEmoji","reviewRestaurant","star","filled","reviewTitle","_hoisted_22","viewRestaurant","BADGES","REVIEWER_10","description","emoji","requirement","stats","reviewCount","category","REVIEWER_25","REVIEWER_50","REVIEWER_100","PHOTO_MASTER","photoReviewCount","ALL_50_STATES","statesVisited","size","calculateEarnedBadges","userStats","earned","values","badge","getBadgeById","find","Array","loadActivityFeed","reviewsQuery","limit","reviewsSnap","usersSnap","restaurantIds","review","add","restaurantsMap","restaurantsSnap","from","activityList","restaurant","date","Date","diffMs","diffMins","Math","floor","diffHours","diffDays","toLocaleDateString","trendType","trendingList","item","city","state","weekReviews","averageRating","ratingCount","restaurants","loadTrendingRestaurants","restaurantsList","oneWeekAgo","setDate","getDate","statsMap","has","totalReviews","ratings","avgRating","reduce","a","b","computed","filter","sort","recommendedUsers","followerCount","badges","reason","followUser","isFollowing","loadRecommendations","followsSnap","recommendedUserIds","followCountMap","follow","followingId","includes","users","userData","mutualFollowCount","earnedBadges","generateReason","mutualCount","followRef","delete","setDoc","followerId","getDistance","lat1","lon1","lat2","lon2","R","dLat","PI","dLon","sin","cos","atan2","sqrt","components","StarRating","Comments","ActivityFeed","TrendingRestaurants","FollowRecommendations","loadMoreTrigger","allPosts","fullSortedPosts","pageSize","observer","unsubscribes","bucketList","leaderboardRanks","isSettingUpListeners","processAndSetPosts","rank","getMedal","sortedPosts","distanceA","Infinity","distanceB","timeA","timeB","seconds","unsub","disconnect","IntersectionObserver","entries","isIntersecting","loadMorePosts","checkLocationPermission","loadUserFollowing","watch","newLocation","location","lat","lng","newUser","oldUser","setupFeedListeners","newValue","oldValue","unobserve","observe","err","warn","clear","resolve","setTimeout","bucketListQuery","unsubBucketList","newBucketList","followsPromise","leaderboardSnap","usersWithReviews","count","countA","countB","initialRanks","leaderboardQuery","unsubLeaderboard","newRanks","processSnapshot","docChanges","change","docData","setupLikeListener","followingIds","q","nearbyRestaurantIds","recentReviewsQuery","currentLength","nextPosts","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","timeout","permissions","permissionStatus","onchange","order","reviewId","reviewRef","likesCollection","likesQuery","some","likeQuery","likeSnap","empty","baseUrl","window","origin","shareableLink","share","url","clipboard","writeText","copied","prompt","log","nowFollowing","isEditModalVisible","_component_EditRestaurantModal","restaurantToEdit","closeEditModal","onSave","saveRestaurantChanges","isAddReviewModalVisible","_component_AddReviewModal","restaurantIdForNewReview","closeAddReviewModal","onReviewAdded","handleReviewAdded","isReviewsModalVisible","_component_RestaurantReviewsModal","restaurantForReviews","closeReviewsModal","onReviewsUpdated","handleReviewOrUpdate","searchQuery","showAddForm","onSubmit","_withModifiers","addNewRestaurant","for","newRestaurant","address","zip","addError","isSaving","filteredRestaurants","openReviewsModal","openEditModal","href","getDirectionsUrl","target","rel","getDetailsUrl","getValidUrl","openAddReviewModal","_hoisted_31","_ctx","$emit","editableRestaurant","newVal","JSON","parse","stringify","immediate","deep","isUploading","submitReview","onChange","handleFileChange","accept","photoPreview","uploadProgress","max","photoFile","event","file","files","startsWith","URL","createObjectURL","reader","FileReader","onload","e","img","Image","MAX_DIMENSION","canvas","document","createElement","ctx","getContext","drawImage","toBlob","blob","result","readAsDataURL","filePath","fileRef","storageRef","uploadTask","uploadBytesResumable","reject","on","bytesTransferred","totalBytes","uploadError","getDownloadURL","reviewData","userRef","increment","countError","reviews","editingReview","deleteReview","EditRestaurantModal","RestaurantReviewsModal","AddReviewModal","rawReviews","bucketListUnsubscribe","restaurantsUnsubscribe","reviewsUnsubscribe","restaurantsWithRatings","total","restaurantDoc","ratingInfo","sortedReviews","restaurantsQuery","subscribeToBucketList","restaurantsWithDistance","lowerCaseQuery","toLowerCase","destination","encodeURIComponent","updatedRestaurant","updatedData","original","dataToSave","nameChanged","name_lowercase","addressParts","addressChanged","part","address_lowercase","fullAddress","join","geocodeAddress","keys","restaurantRef","normalizedName","normalizedAddress","querySnapshot","userDisplayName","_component_UserReviewsModal","userForReviews","filteredUsers","lastReview","toggleFollow","fetchReviews","UserReviewsModal","followsUnsubscribe","fetchUsers","followsQuery","newFollowing","u","ranks","allUsers","usersWithDetails","reviewQuery","reviewSnap","pos","sorted","followsRef","docId","autoplay","playsinline","selectedRestaurant","selectedRestaurantId","showAddRestaurantForm","saveNewRestaurant","isSavingRestaurant","addRestaurantError","photoDataUrl","removePhoto","openCamera","triggerFileUpload","handleFileUpload","isCameraOpen","capturePhoto","closeCamera","_hoisted_27","selected","selectedTags","toggleTag","_hoisted_30","newTag","onKeydown","addNewTag","rows","showPreview","getRestaurantName","_hoisted_39","_hoisted_40","_hoisted_42","submitting","_hoisted_43","errorMessage","_hoisted_44","videoPlayer","stream","fileInput","fetchTags","tagsQuery","tagsSnapshot","getUserLocation","selectClosestRestaurant","closestRestaurant","minDistance","fetchInitialData","restaurantSnap","getDoc","exists","restaurantsSnapshot","tagName","t","newDocRef","newTagObject","localeCompare","addedRestaurant","nextTick","mediaDevices","getUserMedia","video","facingMode","srcObject","getTracks","track","stop","MAX_WIDTH","MAX_HEIGHT","videoWidth","videoHeight","context","toDataURL","click","photoRef","uploadResult","uploadString","bucketListSnapshot","bucketListItemDoc","completedAt","bucketError","fetchRecommendations","allRestaurantsSnapshot","allRestaurants","nearbyRestaurants","sixMonthsAgo","setMonth","getMonth","sixMonthsAgoTimestamp","Timestamp","fromDate","reviewsSnapshot","recentReviews","recommendations","relevantReviews","totalRating","sum","statsLoading","follows","fetchCollectionStats","collectionsToCount","counts","promises","coll","colName","getCountFromServer","__props","editingReviewId","editingRating","originalEditData","setupListeners","then","newMap","populatedReviews","getRankClass","fetchedUsers","sortedUsers","followers","fetchFollowers","followerIds","usersData","followersWithDetails","showCompleted","filteredItems","selectedItems","removeSelectedItems","selectAll","checked","toggleItemSelection","removeFromBucketList","bucketListItems","onAuthStateChanged","fetchBucketList","items","filtered","itemId","deletePromises","unfollowUser","fetchFollowing","followingWithDetails","userToUnfollow","scrollToSection","activeSection","contentRef","sectionId","element","querySelector","offsetTop","scrollTop","addEventListener","sections","section","rect","getBoundingClientRect","contentRect","top","bottom","email","_component_UserStatsPanel","_component_BadgeDisplay","nextBadges","getProgress","_normalizeStyle","getBadgeDescription","getBadgeById_fn","BadgeDisplay","loadUserStats","restaurantData","toUpperCase","followersSnap","progress","requiredCount","parseInt","match","min","round","UserStatsPanel","updateMetaTags","options","image","setMetaTag","property","content","setAttribute","head","appendChild","canonical","resetMetaTags","likeUnsubscribe","fetchReview","updateReviewDistance","shareUrl","shareTitle","shareDescription","substring","shareImage","_TransitionGroup","toasts","removeToast","findIndex","Home","Restaurants","BucketList","UserSearch","Review","Recommendations","DatabaseStats","MyReviews","Leaderboard","Followers","Profile","Following","Help","ReviewDetailModal","Toast","innerWidth","process","protectedPages","componentMap","userSnap","signInWithPopup","alert","signOut","handleDeepLink","pathMatch","pathname","urlParams","URLSearchParams","search","hash","reviewMatch","hashReviewId","history","replaceState","removeEventListener","render","createApp","App","mount","YOUR_EMAIL_FOR_NOMINATIM","response","fetch","json","lon","parseFloat","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","deferred","O","chunkIds","fn","priority","notFulfilled","fulfilled","j","every","definition","o","defineProperty","enumerable","g","globalThis","this","Function","obj","prop","prototype","hasOwnProperty","call","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","bind","__webpack_exports__"],"sourceRoot":""}